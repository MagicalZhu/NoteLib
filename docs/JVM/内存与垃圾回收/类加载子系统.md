---
id: ç±»åŠ è½½å­ç³»ç»Ÿ
title: ç±»åŠ è½½å­ç³»ç»Ÿ
---

## 1. JVM å†…å­˜ç»“æ„å›¾

![JVM å†…å­˜ç»“æ„å›¾](./image/2.ç±»åŠ è½½å­ç³»ç»Ÿ/image-20210324141702620.png)



## 2. ç±»åŠ è½½å­ç³»ç»Ÿ

### 2.1 ç±»åŠ è½½å­ç³»ç»Ÿçš„ä½œç”¨

- ç±»åŠ è½½å™¨å­ç³»ç»Ÿ**è´Ÿè´£ä»æ–‡ä»¶ç³»ç»Ÿæˆ–è€…ç½‘ç»œä¸­åŠ è½½Classæ–‡ä»¶**,Classæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡è¯†
  - ClassLoader åªè´Ÿè´£Classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±`æ‰§è¡Œå¼•æ“` å†³å®š
- åŠ è½½çš„ç±»ä¿¡æ¯å­˜æ”¾åœ¨æ–¹æ³•åŒºä¸­
  - ç±»åŠ è½½å™¨å°†æœ¬åœ°çš„Classå­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°JVMä¸­ï¼Œè¢«ç§°ä¸º `DNA å…ƒæ•°æ®æ¨¡æ¿`ï¼Œæ”¾åœ¨æ–¹æ³•åŒº
  - é™¤äº†ç±»çš„ä¿¡æ¯å¤–ï¼Œ**æ–¹æ³•åŒºä¸­è¿˜ä¼šå­˜æ”¾è¿è¡Œæ—¶å¸¸é‡æ± ä¿¡æ¯ï¼Œå¯èƒ½è¿˜åŒ…æ‹¬å­—ç¬¦ä¸²å­—é¢é‡å’Œæ•°å­—å¸¸é‡**
    - è¿™éƒ¨åˆ†å¸¸é‡ä¿¡æ¯æ˜¯Classæ–‡ä»¶ä¸­å¸¸é‡æ± éƒ¨åˆ†çš„å†…å­˜æ˜ å°„

![ç±»åŠ è½½å­ç³»ç»Ÿçš„ä½œç”¨](./image/2.ç±»åŠ è½½å­ç³»ç»Ÿ/image-20210324150242764.png)


### 2.2 ç±»åŠ è½½è¿‡ç¨‹

- åŠ è½½é˜¶æ®µ -> é“¾æ¥é˜¶æ®µ (éªŒè¯ã€å‡†å¤‡ã€è§£æ) -> åˆå§‹åŒ–é˜¶æ®µ

![ç±»åŠ è½½è¿‡ç¨‹](./image/2.ç±»åŠ è½½å­ç³»ç»Ÿ/image-20210324223114740.png)

#### 2.2.1 ç±»åŠ è½½è¿‡ç¨‹-åŠ è½½

- **æ‰§è¡Œæ­¥éª¤**

  1. é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ

  2. å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„

  3. **åœ¨å †å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡**ï¼Œè¿™ä¸ªç±»å°†ä½œä¸ºç¨‹åºè®¿é—®æ–¹æ³•åŒºä¸­ç±»å‹æ•°æ®çš„å¤–éƒ¨æ¥å£
- JVMè§„èŒƒä¸­æ²¡æœ‰å¯¹ä¸Šè¿°çš„ä¸‰æ­¥éª¤è¿›è¡Œè¦æ±‚ï¼Œæ¯”å¦‚ç¬¬ä¸€æ­¥å¦‚ä½•è·å–ã€æ€ä¹ˆè·å–Classå­—èŠ‚ç æ–‡ä»¶çš„äºŒè¿›åˆ¶æµï¼Œæœ‰å¾ˆå¤šæ–¹å¼ï¼š
     - `ä»æœ¬åœ°ç³»ç»Ÿä¸­ç›´æ¥åŠ è½½`
     - `é€šè¿‡ç½‘ç»œè·å–`
          - å…¸å‹åœºæ™¯ï¼šWeb Applet
     - `ä»zipå‹ç¼©åŒ…ä¸­è¯»å–ï¼Œæˆä¸ºæ—¥åjarã€waræ ¼å¼çš„åŸºç¡€`
          - æ¯”å¦‚Tomcatã€ç¬¬ä¸‰æ–¹çš„jaråŒ…
     - `è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆ`
          - å…¸å‹åœºæ™¯: <mark>åŠ¨æ€ä»£ç†æŠ€æœ¯</mark>
     - `ç”±å…¶ä»–æ–‡ä»¶ç”Ÿæˆ`
          - å…¸å‹åœºæ™¯ï¼šJSPåº”ç”¨
     - `ä»åŠ å¯†æ–‡ä»¶ä¸­è·å–`
          - å…¸å‹çš„é˜²Classæ–‡ä»¶è¢«åç¼–è¯‘çš„ä¿æŠ¤æªæ–½
     - ...
- ç›¸å¯¹äºç±»åŠ è½½çš„å…¶ä»–æ­¥éª¤ï¼ŒåŠ è½½é˜¶æ®µå¯¹å¼€å‘äººå‘˜æ¥è¯´æ˜¯æœ€å¯æ§çš„!æ—¢å¯ä»¥é€šè¿‡ JVMå†…ç½®çš„ç±»åŠ è½½å™¨å»åŠ è½½ï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨å®Œæˆ
     - <mark>å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡å®šä¹‰è‡ªå·±çš„ç±»åŠ è½½å™¨å»æ§åˆ¶å­—èŠ‚ç æ–‡ä»¶äºŒè¿›åˆ¶æµçš„è·å–æ–¹å¼ -> Â é‡å†™ç±»åŠ è½½å™¨çš„loadClass()æ–¹æ³•</mark>
- åŠ è½½é˜¶æ®µä¸è¿æ¥é˜¶æ®µçš„éƒ¨åˆ†åŠ¨ä½œ(æ¯”å¦‚ä¸€éƒ¨åˆ†è‡ªå·±å—æ–‡ä»¶æ ¼å¼æ ¡éªŒ) æ˜¯äº¤å‰è¿›è¡Œçš„,**å³åŠ è½½é˜¶æ®µå°šæœªå®Œæˆï¼Œè¿æ¥é˜¶æ®µå¯èƒ½å·²ç»å¼€å§‹äº†!**



#### 2.2.2 ç±»åŠ è½½é˜¶æ®µ-é“¾æ¥

- åŒ…å«äº†ä»¥ä¸‹çš„ä¸‰ä¸ªæ­¥éª¤
  - `éªŒè¯(Verify)`
  - `å‡†å¤‡(Prepare)`
  - `è§£æ(Resolve)`

##### 2.2.2.1 éªŒè¯

- **ç¡®ä¿Classå­—èŠ‚ç æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºè¦æ±‚ï¼Œä¿è¯è¢«åŠ è½½ç±»çš„æ­£ç¡®æ€§ï¼Œä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«å®‰å…¨**
- ä¸»è¦åŒ…æ‹¬å››ä¸ªéªŒè¯é˜¶æ®µ
  - `æ–‡ä»¶æ ¼å¼æ ¡éªŒ` -> éªŒè¯å­—èŠ‚æµæ˜¯å¦ç¬¦åˆClassæ–‡ä»¶çš„æ ¼å¼è§„èŒƒ
    - **ä¿è¯åŠ è½½çš„å­—èŠ‚æµèƒ½æ­£ç¡®çš„è§£æå¹¶å­˜å‚¨åˆ°æ–¹æ³•åŒºä¸­ï¼Œåªæœ‰é€šè¿‡è¯¥é˜¶æ®µåï¼Œå­—èŠ‚æµæ‰èƒ½è¿›å…¥JVMå†…å­˜çš„æ–¹æ³•åŒºä¸­!**
      - åé¢çš„ä¸‰ä¸ªé˜¶æ®µéƒ½æ˜¯åŸºäºæ–¹æ³•åŒºçš„å­˜å‚¨ç»“æ„è¿›è¡Œçš„ï¼Œä¸ä¼šåœ¨ç›´æ¥è¯»å–ã€æ“ä½œå­—èŠ‚æµäº†
    - å¸¸è§çš„æ ¡éªŒè§„åˆ™
      - æ˜¯å¦ä»¥é­”æ•° `0xCAFEBABE` å¼€å¤´
      - ä¸»ã€æ¬¡ç‰ˆæœ¬å·æ˜¯å¦åœ¨å½“å‰JVMèŒƒå›´å†…
      - å¸¸é‡æ± ä¸­çš„å¸¸é‡æ˜¯å¦æœ‰ä¸è¢«æ”¯æŒçš„å¸¸é‡ç±»å‹ -> æ£€æŸ¥å¸¸é‡çš„ tagæ ‡å¿—
      - æŒ‡å‘å¸¸é‡çš„å„ç§ç´¢å¼•å€¼ä¸­æ˜¯å¦æœ‰æŒ‡å‘ä¸å­˜åœ¨çš„å¸¸é‡æˆ–è€…ä¸ç¬¦åˆç±»å‹çš„å¸¸é‡
      - Classå­—èŠ‚ç æ–‡ä»¶å„ä¸ªéƒ¨åˆ†ä»¥åŠæ–‡ä»¶æœ¬èº«æ˜¯å¦æœ‰è¢«åˆ é™¤æˆ–è€…é™„åŠ çš„å…¶ä»–ä¿¡æ¯
      - ...
  - `å…ƒæ•°æ®æ ¡éªŒ` -> å¯¹å­—èŠ‚ç çš„æè¿°ä¿¡æ¯è¿›è¡Œè¯­ä¹‰åˆ†æ
    - **å¯¹ç±»çš„å…ƒæ•°æ®ä¿¡æ¯è¿›è¡Œè¯­ä¹‰åˆ†æï¼Œä¿è¯å…¶ä¸ä¸javaè¯­è¨€è§„èŒƒç›¸è¿èƒŒ**
    - å¸¸è§çš„æ ¡éªŒè§„åˆ™
      - è¿™ä¸ªç±»æ˜¯å¦æœ‰çˆ¶ç±»(é™¤äº†Objectï¼Œæ‰€æœ‰çš„ç±»éƒ½æœ‰çˆ¶ç±»)
      - ç±»æ˜¯å¦ç»§æ‰¿äº†ä¸è¢«å…è®¸ç»§æ‰¿çš„ç±»(è¢«finalä¿®é¥°çš„ç±»)
      - å¦‚æœç±»ä¸æ˜¯æŠ½è±¡ç±»ï¼Œæ˜¯å¦å®ç°äº†çˆ¶ç±»æˆ–è€…æ¥å£ä¸­çš„è¦æ±‚å®ç°çš„æ–¹æ³•
  - `å­—èŠ‚ç æ ¡éªŒ`
  - `ç¬¦å·å¼•ç”¨æ ¡éªŒ`
    - **å‘ç”ŸäºJVM å°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨çš„æ—¶å€™**

**é­”æ•° "CADEBABE"**

![é­”æ•°](./image/2.ç±»åŠ è½½å­ç³»ç»Ÿ/image-20210325100209710.png)


##### 2.2.2.2 å‡†å¤‡

- **åœ¨æ–¹æ³•åŒºä¸­ä¸ºç±»å˜é‡(`é™æ€å˜é‡`) åˆ†é…å†…å­˜ï¼Œå¹¶ä¸”ä¸ºè¯¥ç±»å˜é‡è®¾ç½®é»˜è®¤åˆå§‹å€¼**
  - å®ä¾‹å˜é‡ä¼šéšç€å¯¹è±¡çš„å®ä¾‹åŒ–åˆ†é…åˆ° å †ç©ºé—´ ä¸­
- `static ä¸ final staticçš„åŒºåˆ«ï¼Ÿ`
  - static åœ¨å‡†å¤‡é˜¶æ®µæ˜¯é»˜è®¤åˆå§‹å€¼ï¼Œåªæœ‰åœ¨åˆå§‹åŒ–é˜¶æ®µåï¼Œæ‰ä¼šé€šè¿‡putstatic æŒ‡ä»¤è®¾ç½®ä¸ºæŒ‡å®šå€¼
  - final static åœ¨ç¼–è¯‘æ—¶ä¼šåŠ ä¸ŠConstantValueå±æ€§ï¼Œå€¼ä¸ºæŒ‡å®šå€¼ã€‚å¹¶ä¸”åˆ†é…ç©ºé—´ï¼Œåœ¨å‡†å¤‡é˜¶æ®µå°±ä¼šè¢«èµ‹å€¼
    - final static ä¿®é¥°çš„å˜é‡ç›¸å½“äºæ˜¯å¸¸é‡

```java
public class HelloApp {
  	public static int age = 22;    				// å‡†å¤‡é˜¶æ®µä¸º0ï¼Œåœ¨ä¸‹ä¸ªé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯åˆå§‹åŒ–çš„æ—¶å€™æ‰æ˜¯1
    public final static int sal = 33;		  // ç¼–è¯‘æ—¶ä¼šåŠ ä¸ŠConstantValueå±æ€§ï¼Œå€¼ä¸º33ï¼Œåœ¨å‡†å¤‡é˜¶æ®µå°±ä¼šè¢«èµ‹å€¼ä¸º33
 
  
    public static void main(String[] args) {
        System.out.println(age);
    }
}

/*
	å±æ€§ageã€sal å¯¹åº”çš„å­—èŠ‚ç 
	
	  public static int age;
    descriptor: I
    flags: ACC_PUBLIC, ACC_STATIC

  public static final int sal;
    descriptor: I
    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL
    ConstantValue: int 33
    
    static {};
    descriptor: ()V
    flags: ACC_STATIC
    Code:
      stack=1, locals=0, args_size=0
         0: bipush        22									//å°†22å‹å…¥æ ˆ
         2: putstatic     #3                  // Field age:I  --> é€šè¿‡ putstatic å°† age èµ‹å€¼ä¸º 22
         5: return
      LineNumberTable:
        line 9: 0															// ä»£ç ç¬¬9è¡Œ
*/
```



##### 2.2.2.3 è§£æ

- `å°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹`
  - äº‹å®ä¸Šï¼Œè§£ææ“ä½œå¾€å¾€ä¼šä¼´éšç€JVMåœ¨æ‰§è¡Œå®Œåˆå§‹åŒ–ä¹‹åå†æ‰§è¡Œ
- ç¬¦å·å¼•ç”¨ ä¸ ç›´æ¥å¼•ç”¨ï¼Ÿ
  - `ç¬¦å·å¼•ç”¨`
    - æ˜¯ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡,ä¸JVMçš„å†…å­˜å¸ƒå±€æ— å…³ï¼Œä¸”å¼•ç”¨çš„ç›®æ ‡å¹¶ä¸ä¸€å®šè¦åŠ è½½åˆ°JVMçš„å†…å­˜ä¸­
    - ç¬¦å·å¼•ç”¨çš„å­—é¢é‡å½¢å¼æ˜ç¡®å®šä¹‰åœ¨ã€Šjavaè™šæ‹Ÿæœºè§„èŒƒã€‹çš„classæ–‡ä»¶æ ¼å¼ä¸­
  - `ç›´æ¥å¼•ç”¨`
    - ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹åç§»é‡æˆ–ä¸€ä¸ªé—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„
    - æœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£ä¹ˆå¼•ç”¨çš„ç›®æ ‡å¿…é¡»æ˜¯å·²ç»åœ¨JVMçš„å†…å­˜ä¸­å­˜åœ¨çš„
- è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ä»¥ä¸‹
  - ç±»æˆ–æ¥å£ 
    - å¯¹åº”å¸¸é‡æ± : CONSTANT_Class_info
  - å­—æ®µ
    - å¯¹åº”å¸¸é‡æ± : CONSTANTFieldref_info
  - ç±»æ–¹æ³•   
    - å¯¹åº”å¸¸é‡æ± : CONSTANT_Methodref_info
  - æ¥å£æ–¹æ³• 
    - å¯¹åº”å¸¸é‡æ± : CONSTANT_InterfaceMethodref_info
  - æ–¹æ³•ç±»å‹
    - å¯¹åº”å¸¸é‡æ± : CONSTANT_MethodType_info
  - æ–¹æ³•å¥æŸ„
    - å¯¹åº”å¸¸é‡æ± : CONSTANT_MethodHandle_info
  - ...

#### 2.2.3 ç±»åŠ è½½é˜¶æ®µ-åˆå§‹åŒ–

:::tip æ³¨æ„

å¯¹è±¡å®ä¾‹åŒ–æ‰§è¡Œé¡ºåº: é™æ€ä»£ç å—(ä¸ç®¡æ˜¯å¦å®ä¾‹åŒ–ï¼Œåªè¦åŠ è½½ç±»å°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•) -> æ„é€ å— -> æ„é€ å‡½æ•°

:::

- åˆå§‹åŒ–é˜¶æ®µå°±æ˜¯æ‰§è¡Œç±»æ„é€ å™¨ `<clinit>()`Â æ–¹æ³•çš„è¿‡ç¨‹

  - `<clinit>()`æ˜¯ javac ç¼–è¯‘å™¨çš„è‡ªåŠ¨ç”Ÿæˆç‰© 

    - æ•´åˆç±»ä¸­çš„æ‰€æœ‰`ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œ` å’Œ `é™æ€ä»£ç å—ä¸­çš„è¯­å¥`(static{...}) è€Œæ¥
    - æ•´åˆçš„é¡ºåºæ˜¯è¯­å¥åœ¨æºä»£ç ä¸­å‡ºç°çš„é¡ºåº
      - **é™æ€ä»£ç å—åªèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨é™æ€ä»£ç å—å‰é¢çš„å˜é‡!**
        - åœ¨ç±»åŠ è½½çš„é“¾æ¥çš„å‡†å¤‡é˜¶æ®µï¼Œæ‰€æœ‰çš„ç±»å˜é‡ä»¥ç¬¦å·å¼•ç”¨çš„æ–¹å¼å­˜å‚¨åœ¨æ–¹æ³•åŒºï¼Œè€Œå½“é™æ€ä»£ç å—å°è¯•è·å–ç±»å˜é‡ç¡®éœ€è¦é€šè¿‡ç›´æ¥å¼•ç”¨ï¼Œè¿™å°±å¯¼è‡´ç¼–è¯‘æŠ¥é”™
      - **å®šä¹‰åœ¨é™æ€ä»£ç å—åé¢çš„å˜é‡è™½ç„¶æ— æ³•è®¿é—®ï¼Œä½†æ˜¯å¯ä»¥å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼**
        - ç±»å˜é‡å®šä¹‰åœ¨é™æ€ä»£ç å—åé¢ï¼Œè¯¥ç±»å˜é‡å®šä¹‰çš„å€¼ä¼šè¦†ç›–å‰é¢é™æ€ä»£ç å—çš„èµ‹çš„å€¼

    ```java
    public class ClassInitTest {
        private static int num = 1;
        static {
            num = 2;
            number = 20;
            System.out.println(num);
            System.out.println(number);  //ç¼–è¯‘æŠ¥é”™ï¼Œéæ³•çš„å‘å‰å¼•ç”¨
        }
    
        private static int number = 10;
    
        public static void main(String[] args) {
            System.out.println(ClassInitTest.num); 			// 2
            System.out.println(ClassInitTest.number); 	// 10  
        }
    }
    ```

    

  - JVMä¿è¯åœ¨å­ç±»çš„`<clinit>()æ–¹æ³•æ‰§è¡Œå‰ï¼Œçˆ¶ç±»çš„<clinit>()æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæˆ`

    - `<clinit>()`æ–¹æ³•ä¸ç±»çš„æ„é€ å™¨æ–¹æ³•(`<init>()`)ä¸åŒï¼Œä¸éœ€è¦æ˜¾å¼çš„è°ƒç”¨çˆ¶ç±»æ„é€ å™¨
    - å› æ­¤JVMä¸­ç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œ`<clinit>()` çš„ç±»ä¸€å®šæ˜¯ `Object`

  - ç”±äºçˆ¶ç±»çš„`<clinit>`ä¸€å®šå…ˆæ‰§è¡Œï¼Œæ‰€ä»¥çˆ¶ç±»çš„é™æ€ä»£ç å—ä¹Ÿä¸€å®šå…ˆæ‰§è¡Œï¼

    - `<clinit>` ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœç±»ä¸­æ²¡æœ‰ç±»å˜é‡èµ‹å€¼ã€é™æ€ä»£ç å—ï¼Œjavac ç¼–è¯‘å™¨å°±å°±ä¸ä¼šä¸ºè¯¥ç±»ç”Ÿæˆ `<clinit>()` æ–¹æ³•

  - JVMä¿è¯ä¸€ä¸ªç±»çš„ `<clinit>()`Â æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸‹è¢«åŒæ­¥åŠ é”

    - `<clinit>`åªä¼šåŠ è½½ä¸€æ¬¡ï¼Œå¹¶ä¸”JVMé€šè¿‡åŠ é”çš„æ–¹å¼ä¿è¯ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼
      - **å¯ä»¥åˆ©ç”¨è¯¥æ–¹å¼å®ç° å•ä¾‹æ¨¡å¼**

    ```java
    public class InitLock {
        public static void main(String[] args) {
            new Thread(() -> {
                System.out.println(Thread.currentThread().getName() + "\t çº¿ç¨‹t1å¼€å§‹");
                new TestDemo();
            }, "t1").start();
    
            new Thread(() -> {
                System.out.println(Thread.currentThread().getName() + "\t çº¿ç¨‹t2å¼€å§‹");
                new TestDemo();
            }, "t2").start();
        }
    }
    class TestDemo{
        static {
            if (true) {
                System.out.println(Thread.currentThread().getName() + "\t åˆå§‹åŒ–å½“å‰ç±»");          
            }
        }
    }
    
    /*
    	t1	 çº¿ç¨‹t1å¼€å§‹
      t2	 çº¿ç¨‹t2å¼€å§‹
      t1	 åˆå§‹åŒ–å½“å‰ç±»
    */
    ```



### 2.3 ç±»åŠ è½½å™¨æ¶æ„

- JVMæ”¯æŒä¸¤ç§ç±»å‹çš„ç±»åŠ è½½å™¨ 
  - `å¼•å¯¼ç±»åŠ è½½å™¨`  
  - `è‡ªå®šä¹‰ç±»åŠ è½½å™¨`
    - æ´¾ç”ŸäºæŠ½è±¡ç±»ClassLoaderçš„ç±»åŠ è½½å™¨éƒ½åˆ’åˆ†ä¸ºè‡ªå®šä¹‰ç±»åŠ è½½å™¨

- é€šè¿‡ xx.class.getClassLoader() æ–¹æ³•è·å–å½“å‰ç±»çš„ç±»åŠ è½½å™¨ï¼

![ç±»åŠ è½½å™¨æ¶æ„](./image/2.ç±»åŠ è½½å­ç³»ç»Ÿ/image-20210325173814089.png)



#### 2.3.1 è·å–ClassLoader

- **è·å–å½“å‰ClassLoader**
  - xx.class.getClassLoader()
- **è·å–å½“å‰çº¿ç¨‹ä¸Šä¸‹æ–‡çš„ClassLoader**
  - Thread.currentThread().getContextClassLoader()
- **è·å–ç³»ç»Ÿçš„ClassLoader**
  - ClassLoader.getSystemClassLoader()
- **è·å–è°ƒç”¨è€…çš„ClassLoader**
  - DriverManager.getCallerClassLoader()

```java
public class ClassLaoderTest2 {
    public static void main(String[] args) {
        // 1.è·å–å½“å‰çš„ClassLoader
        ClassLoader classLoader1 = ClassLaoderTest2.class.getClassLoader();
        System.out.println(classLoader1);               // sun.misc.Launcher$AppClassLoader@18b4aac2

        // 2.é€šè¿‡å½“å‰çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»è·å–ClassLoader
        ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader();
        System.out.println(contextClassLoader);        // sun.misc.Launcher$AppClassLoader@18b4aac2      

        // 3.é€šè¿‡ClassLoader è·å–ç³»ç»Ÿ ç±»åŠ è½½å™¨
        ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();
        System.out.println(systemClassLoader);        // sun.misc.Launcher$AppClassLoader@18b4aac2

    }
}
```

#### 2.3.2 ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨

- è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„ç”¨é€”ï¼Ÿ
  - `éš”ç¦»åŠ è½½ç±»`
  - `ä¿®æ”¹ç±»åŠ è½½æ–¹å¼`
  - `æ‹“å±•åŠ è½½æº`
  - `é˜²æ­¢æºç æ³„éœ²`
- **å¦‚ä½•è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Ÿ**
  1. ç»§æ‰¿æŠ½è±¡ç±» java.1ang.ClassLoaderç±»ï¼Œå®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨ æˆ–è€…ç»§æ‰¿URIClassLoaderç±»
  2. é‡å†™ `findClass()` æ–¹æ³•,å¤„ç†è‡ªå®šä¹‰çš„ç±»åŠ è½½é€»è¾‘

#### 2.3.2 ä¸‰å±‚ç±»åŠ è½½å™¨ (<=jdk1.8)

- `BootStrap ClassLoader`
  - å¼•å¯¼ç±»åŠ è½½å™¨
    - ç”±C/C++ç¼–å†™,åµŒå¥—åœ¨JVMå†…éƒ¨,æ— æ³•è·å–
    - å¹¶ä¸ç»§æ‰¿è‡ª java.lang.ClassLoaderï¼Œæ²¡æœ‰çˆ¶åŠ è½½å™¨
    - **ç”¨æ¥åŠ è½½Javaçš„æ ¸å¿ƒåº“**
  - åŠ è½½è·¯å¾„
    - `JAVAHOME/jre/1ib/rt.jarã€resources.jar`ç­‰Â æˆ– `sun.boot.class.path` è·¯å¾„ä¸‹çš„ç±»åº“ï¼Œç”¨äºæä¾›JVMè‡ªèº«éœ€è¦çš„ç±»
- `Extension  ClassLoader`
  - æ‹“å±•ç±»åŠ è½½å™¨  -> è‡ªå®šä¹‰ç±»åŠ è½½å™¨
    - Javaè¯­è¨€ç¼–å†™ï¼Œæ´¾ç”ŸäºClassLoaderç±» [sun.misc.Launcher$ExtClassLoader]
    - ä¸Šå±‚ç±»åŠ è½½å™¨ä¸ºå¯åŠ¨ç±»åŠ è½½å™¨
  - åŠ è½½è·¯å¾„
    - `JAVA_HOME\lib\ext` æˆ– `ç¯å¢ƒå˜é‡ java.ext.dirs`è·¯å¾„ä¸‹çš„æ‰€æœ‰ç±»åº“
- `Application ClassLoader`
  - åº”ç”¨ç¨‹åº/ç³»ç»Ÿç±»åŠ è½½å™¨ -> è‡ªå®šä¹‰ç±»åŠ è½½å™¨
    - Javaè¯­è¨€ç¼–å†™ï¼Œæ´¾ç”ŸäºClassLoaderç±» [sun.misc.Launcher$AppClassLoader]
    - ä¸Šå±‚ç±»åŠ è½½å™¨ä¸ºæ‹“å±•ç±»åŠ è½½å™¨
    - **å¦‚æœæ²¡æœ‰ç‰¹æ®ŠæŒ‡å®šï¼Œè¯¥åŠ è½½å™¨åˆ™æ˜¯é»˜è®¤åŠ è½½å™¨**
  - åŠ è½½è·¯å¾„
    - `ç¯å¢ƒå˜é‡classpath`æˆ– `ç³»ç»Ÿå±æ€§java.class.path` æŒ‡å®šè·¯å¾„ä¸‹çš„ç±»åº“

```java
public class ClassLoaderTest {
    public static void main(String[] args) {
        // è·å–ç³»ç»Ÿç±»åŠ è½½å™¨
        ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();   // sun.misc.Launcher$AppClassLoader@18b4aac2
        System.out.println(systemClassLoader);

        //è·å–ç³»ç»Ÿç±»åŠ è½½å™¨ ä¸Šå±‚ -> æ‹“å±•ç±»åŠ è½½å™¨
        ClassLoader extClassLoader = systemClassLoader.getParent();           // sun.misc.Launcher$ExtClassLoader@68f7aae2
        System.out.println(extClassLoader);

        // è·å–æ‹“å±•ç±»åŠ è½½å™¨ ä¸Šå±‚ -> å¼•å¯¼ç±»åŠ è½½å™¨
        ClassLoader bootstrapClassLoader = extClassLoader.getParent();
        System.out.println(bootstrapClassLoader);                            //null -> æ— æ³•è·å–åˆ°å¼•å¯¼ç±»åŠ è½½å™¨   

        //æŸ¥çœ‹å½“å‰ç±»çš„ç±»åŠ è½½å™¨æ˜¯å“ªä¸€ä¸ª?
        ClassLoader classLoader = ClassLoaderTest.class.getClassLoader();
        System.out.println(classLoader);                                     //sun.misc.Launcher$AppClassLoader@18b4aac2 
      
      
      
        // è·å–å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½çš„ç±»åº“
        URL[] urLs = Launcher.getBootstrapClassPath().getURLs();
        for (int i = 0; i < urLs.length; i++) {
            System.out.println(urLs[i].getPath());
        }
      	/*
      			/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/resources.jar
          	/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/rt.jar
            /Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/sunrsasign.jar
            /Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/jsse.jar
            /Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/jce.jar
            /Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/charsets.jar
            /Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/jfr.jar
            /Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/classes
      	*/
    }
}
```



#### 2.3.4 åŒäº²å§”æ´¾æœºåˆ¶

- JVM å¯¹Classæ–‡ä»¶é‡‡ç”¨çš„æ˜¯ `æŒ‰éœ€åŠ è½½` çš„æ–¹å¼ï¼Œå³éœ€è¦ä½¿ç”¨æŸä¸ªç±»æ—¶æ‰ä¼šå°†å®ƒçš„classæ–‡ä»¶åŠ è½½åˆ°æ–¹æ³•åŒºä¸­ç”ŸæˆClasså¯¹è±¡
  - JVMé‡‡ç”¨åŒäº²å§”æ´¾çš„æ¨¡å¼ï¼Œå³æŠŠåŠ è½½è¯·æ±‚å±‚å±‚å‘ä¸Šäº¤ç»™çˆ¶çº§ç±»åŠ è½½å™¨å¤„ç†ï¼Œæ˜¯ä¸€ç§ä»»åŠ¡å§”æ´¾çš„æ¨¡å¼!
- ä»£ç é€»è¾‘ -> java.lang.ClassLoader#loadClass()
- **å·¥ä½œæµç¨‹**
  - å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒå¹¶ä¸ä¼šè‡ªå·±å…ˆå»åŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œ
  - æ¯ä¸€å±‚æ¬¡çš„ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥æ‰€æœ‰çš„åŠ è½½è¯·æ±‚æœ€ç»ˆéƒ½ä¼šä¼ é€’åˆ°å¼•å¯¼ç±»åŠ è½½å™¨ä¸Š
  - åªæœ‰å½“çˆ¶åŠ è½½å™¨æ— æ³•å®ŒæˆåŠ è½½çš„è¯·æ±‚ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½
- **å­˜åœ¨æ„ä¹‰ï¼Ÿ**
  - <mark>ä¿è¯Javaä¸­çš„ç±»ä¸ç±»åŠ è½½å™¨ä¸€èµ·å…·å¤‡äº†å±‚æ¬¡å…³ç³»ï¼Œæ¯”å¦‚Objectè¿™ä¸ªç±»å­˜åœ¨äºrt.jarä¸­ï¼Œè¢«å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½ï¼Œä¿è¯å„ä¸ªç±»åŠ è½½å™¨ç¯å¢ƒä¸­éƒ½æ˜¯å”¯ä¸€çš„</mark>
- **åŒäº²å§”æ´¾æœºåˆ¶çš„ä¼˜åŠ¿**
  - `é¿å…ç±»çš„é‡å¤åŠ è½½`
  - `ä¿æŠ¤ç¨‹åºå®‰å…¨ï¼Œé˜²æ­¢æ ¸å¿ƒAPIè¢«éšæ„ç¯¡æ”¹`
    - æ¯”å¦‚é‡å†™ä¸€ä¸ªä¸ rt.jarç±»åº“ä¸­ç±»é‡å(åŒ…æ‹¬åŒ…å)çš„ç±»ï¼Œä¼šå‘ç°å¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼Œä½†æ˜¯æ°¸è¿œæ— æ³•è¢«åŠ è½½è¿è¡Œ 



##### 2.3.4.1 SPIå¦‚ä½•â€œç ´åäº†â€åŒäº²å§”æ´¾æ¨¡å‹

:::danger 

- ä¸€èˆ¬æ¥è¯´ï¼ŒåŒäº²å§”æ´¾ä¿è¯äº†**è¶ŠåŸºç¡€çš„ç±»ç”±è¶Šä¸Šå±‚çš„ç±»åŠ è½½å™¨åŠ è½½** -> åŸºç¡€ç±»ä¸€èˆ¬æŒ‡çš„æ˜¯æ€»æ˜¯ä½œä¸ºè¢«ç”¨æˆ·ç»§æ‰¿ã€è°ƒç”¨çš„apiå­˜åœ¨
  
- ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæœ‰äº›åŸºç¡€ç±»å†…éƒ¨é€»è¾‘éœ€è¦ç”±ç”¨æˆ·å®ç° -> æ¯”å¦‚JNDIã€JDBC...
  
- ä»¥ServiceLoaderä¸ºä¾‹å­ -> java.util.ServiceLoader#load(java.lang.Class)

  - è¿™é‡Œçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»è·å¾—çš„ç±»åŠ è½½å™¨ä¸€èˆ¬å°±æ˜¯ `ç³»ç»Ÿç±»åŠ è½½å™¨`

  ```java
  public static <S> ServiceLoader<S> load(Class<S> service) {
      ClassLoader cl = Thread.currentThread().getContextClassLoader();
      return ServiceLoader.load(service, cl);
  }
  ```

:::

**ä»¥JDBCçš„é©±åŠ¨DriverManagerä¸ºä¾‹ -> java.sql.DriverManager#loadInitialDrivers**

- DriverManagerä¸Driver å±äº rt.jarä¸‹é¢çš„ç±»ï¼Œç”±å¼•å¯¼ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½
- ä½†æ˜¯Driverå±äºæ¥å£,å…·ä½“çš„å®ç°ç”±å„ä¸ªæ•°æ®åº“å‚å•†è¿›è¡Œå®ç°ï¼Œå¹¶ä¸”å†é€šè¿‡ SPIçš„æ–¹å¼åŠ è½½åˆ°JVMä¸­
  - è¿™ä¸ªæ­¥éª¤ä¸­ï¼ŒSPIæ˜¯é‡‡ç”¨ ç³»ç»Ÿç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½çš„ -> **å³å¼•å¯¼ç±»åŠ è½½å™¨å§”æ‰˜ç³»ç»Ÿç±»åŠ è½½å™¨åŠ è½½ç±»ï¼Œ"æ‰“ç ´äº†"åŒäº²å§”æ´¾æ¨¡å‹**

```java
ServiceLoader<Driver> loadedDrivers = ServiceLoader.load(Driver.class);
Iterator<Driver> driversIterator = loadedDrivers.iterator();
try{
    while(driversIterator.hasNext()) {
        driversIterator.next();
    }
} catch(Throwable t) {
}
return null;
```

- **JDBCè¿æ¥æ•°æ®åº“ğŸŒ°**
  - é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“çš„æ˜¯ jdbc.jaræ˜¯åŸºäºSPIæ¥å£è¿›è¡Œå®ç°çš„ï¼Œæ‰€ä»¥åœ¨åŠ è½½çš„æ—¶å€™ï¼Œä¼šè¿›è¡ŒåŒäº²å§”æ´¾
  - æœ€ç»ˆä»æ ¹åŠ è½½å™¨ä¸­åŠ è½½ SPIæ ¸å¿ƒç±»ï¼Œç„¶ååœ¨åŠ è½½SPIæ¥å£ç±»
  - æ¥ç€åœ¨è¿›è¡Œ`åå‘å§”æ´¾`ï¼Œé€šè¿‡çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨è¿›è¡Œå®ç°ç±» jdbc.jarçš„åŠ è½½

![JDBCè¿æ¥æ•°æ®åº“ğŸŒ°](./image/2.ç±»åŠ è½½å­ç³»ç»Ÿ/image-20200705105810107.png)


### 2.4 å…¶ä»–

#### 2.4.1 å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦ç›¸åŒ

- åœ¨JVMä¸­è¡¨ç¤ºä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªå¿…è¦æ¡ä»¶
  - **ç±»çš„å®Œæ•´ç±»åå¿…é¡»ä¸€è‡´ï¼ŒåŒ…æ‹¬åŒ…å**
  - **åŠ è½½è¿™ä¸ªç±»çš„ClassLoaderï¼ˆæŒ‡ClassLoaderå®ä¾‹å¯¹è±¡ï¼‰å¿…é¡»ç›¸åŒ**

#### 2.4.2 ç±»çš„ä¸»åŠ¨ä½¿ç”¨ä¸è¢«åŠ¨ä½¿ç”¨

- Javaç¨‹åºå¯¹ç±»çš„ä½¿ç”¨æ–¹å¼åˆ†ä¸º

  - **ä¸»åŠ¨ä½¿ç”¨**
    - åˆ›å»ºç±»çš„å®ä¾‹
    - è®¿é—®æŸä¸ªç±»æˆ–æ¥å£çš„é™æ€å˜é‡ï¼Œæˆ–è€…å¯¹è¯¥é™æ€å˜é‡èµ‹å€¼
    - è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•
    - åå°„ï¼ˆæ¯”å¦‚ï¼šClass.forNameï¼ˆ"com.demo.Test"ï¼‰ï¼‰
    - åˆå§‹åŒ–ä¸€ä¸ªç±»çš„å­ç±»
    - Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶è¢«æ ‡æ˜ä¸ºå¯åŠ¨ç±»çš„ç±»
    - JDK7å¼€å§‹æä¾›çš„åŠ¨æ€è¯­è¨€æ”¯æŒï¼š
      - java.lang.invoke.MethodHandleå®ä¾‹çš„è§£æç»“æœgetStaticã€putStaticã€invokeStaticå¥æŸ„å¯¹åº”çš„ç±»æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–

  - **è¢«åŠ¨ä½¿ç”¨**

    - è¢«åŠ¨ä½¿ç”¨ä¸ä¼šå¯¼è‡´ç±»çš„åˆå§‹åŒ–

    

## æ€»ç»“
```java
/*
*   åŠ è½½è¿‡ç¨‹
*       -> åŠ è½½ : ä»æ–‡ä»¶ç³»ç»Ÿ\ç½‘ç»œä¸­åŠ è½½å­—èŠ‚ç æ–‡ä»¶(å­—èŠ‚æµçš„æ–¹å¼) -> åŠ è½½æ–¹å¼:æœ¬åœ°/ç½‘ç»œ/åŠ¨æ€ä»£ç†çš„/zipæ–‡ä»¶...
*           -> é€šè¿‡ç±»çš„å…¨ç±»åè·å–ç±»çš„äºŒè¿›åˆ¶æµ
*           -> å°†å­—èŠ‚æµè½¬ä¸ºç¬¦åˆå­˜å‚¨åœ¨æ–¹æ³•åŒºçš„æ ¼å¼ -> é€šè¿‡javap -v å¯ä»¥çœ‹åˆ°
*                  -> æ¯”å¦‚å¸¸é‡æ± ConstantPool
*           -> åŠ è½½å®Œæˆå,ä¼šåœ¨å †å†…å­˜ç”Ÿæˆä¸€ä¸ªClasså¯¹è±¡
*       -> é“¾æ¥
*           -> éªŒè¯:
*               -> æ–‡ä»¶æ ¼å¼æ ¡éªŒ: æœ€é‡è¦,ä¿è¯å­—èŠ‚ç çš„äºŒè¿›åˆ¶æµä¸ä¼šå¯¹JVMé€ æˆå®‰å…¨é—®é¢˜,æ ¡éªŒé€šè¿‡å,å­—èŠ‚ç æ–‡ä»¶äºŒè¿›åˆ¶æµä¼šå­˜å‚¨åˆ°æ–¹æ³•åŒºä¸­
*                   -> é­”æ•°: 0xCAFEBABE
*               -> å…ƒæ•°æ®æ ¡éªŒ:è¯­æ³•æ ¡éªŒ
*               -> å­—èŠ‚ç æ ¡éªŒ
*               -> ç¬¦å·å¼•ç”¨æ ¡éªŒ
*           -> å‡†å¤‡ : ä¸ºç±»å˜é‡åˆ†é…å†…å­˜,å¹¶ä¸”è®¾ç½®é»˜è®¤åˆå§‹å€¼
*               -> static ä¸ final static : å‰è€…åœ¨å‡†å¤‡æ—¶é»˜è®¤ä¸º0,éœ€è¦ç»è¿‡åˆå§‹åŒ–æ­¥éª¤;åè€…å±äºå¸¸é‡(æœ‰ConstantValue),å‡†å¤‡æ—¶å°±ä¼šèµ‹ä¸Šå€¼
*           -> è§£æ: å°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨
*       -> åˆå§‹åŒ–:
*           -> <clinit>() -> åˆå¹¶ç±»å˜é‡ä¸é™æ€ä»£ç å—,é¡ºåºä¸æºç é¡ºåºä¸€è‡´ -> å¦‚æœæ²¡æœ‰å°±ä¸ä¼šç”Ÿæˆ
*               ->   é™æ€ä»£ç å—æ— æ³•è®¿é—®åé¢å£°æ˜çš„å˜é‡,ä½†æ˜¯å¯ä»¥å¯¹å…¶è¿›è¡Œèµ‹å€¼
*           -> <clinit>() æ€»æ˜¯ä¸æ–­å‘ä¸Šçš„è°ƒç”¨,å¯åŠ¨javaç¨‹åºæ—¶,æœ€å…ˆè°ƒç”¨çš„<clinit>()æ–¹æ³•ä¸€å®šæ˜¯Objectçš„
*           -> <clinit>() åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡,ä¸”åŠ è½½   -> å¯ä»¥è€ƒè™‘ç”¨è¿™ç§æ–¹å¼å®ç°å•ä¾‹
*
*   ç±»åŠ è½½å™¨
*       -> å¼•å¯¼ç±»åŠ è½½å™¨ -> javahome\lib\rt.jar ...
*       -> æ‹“å±•ç±»åŠ è½½å™¨ -> Javahome\lib\ext æ‰€æœ‰çš„ç±»åº“
*       -> ç³»ç»Ÿç±»åŠ è½½å™¨ -> classpathä¸‹é¢çš„ç±»åŠ è½½å™¨
*               -> clazz.getClassLoader
*               -> ClassLoader.getSystemClassLoader()
*               -> Thread.currentThread().getContextClassLoader()
*
*       -> åŒäº²å§”æ´¾
*           -> å°†åŠ è½½è¯·æ±‚ä¸æ–­å‘ä¸Šä¼ é€’,æ‰€æœ‰çš„åŠ è½½è¯·æ±‚éƒ½éœ€è¦ç”±å¼•å¯¼ç±»åŠ è½½å™¨å¤„ç†,å¦‚æœæ— æ³•å¤„ç†,åˆ™äº¤ç”±ä¸‹é¢çš„å¤„ç†
*           -> ä¿è¯æœ€åŸºç¡€çš„ç±»åº“æ˜¯ç”±å¼•å¯¼ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½çš„,å¹¶ä¸”ç”±äºåŠ è½½è¿‡Classå¯¹è±¡å­˜å‚¨åœ¨æ–¹æ³•åŒºä¸­.å³ä½¿ä¼ªé€ JVMæ ¸å¿ƒç±»åº“çš„Classå¯¹è±¡,ä¹Ÿæ— æ³•è¢«æ›¿æ¢
*                   -> é¿å…é‡å¤ç±»çš„åŠ è½½ -> å…¨ç±»åä¸€è‡´+åŠ è½½è¯¥ç±»çš„ç±»åŠ è½½å™¨ä¸€è‡´(ç±»åŠ è½½å™¨ä¿¡æ¯ä¹Ÿä¼šå­˜å‚¨åœ¨æ–¹æ³•åŒºä¸­!)
*                   -> ä¿æŠ¤ç¨‹åºçš„å®‰å…¨,é¿å…æ ¸å¿ƒapi è¢«ç¯¡æ”¹
*           -> spi ç ´å?
*               -> æ ¸å¿ƒç±»åº“çš„æŸäº›åŸºç¡€ç±»å‹æ²¡æœ‰å…·ä½“å®ç°,äº¤ç”±å¼€å‘äººå‘˜å®ç°,å› æ­¤æ— æ³•æŠŠClassåŠ è½½åˆ°JVMä¸­
*               -> spi åˆ™æ˜¯é€šè¿‡ç³»ç»Ÿç±»åŠ è½½å™¨å»åŠ è½½Classçš„,è¿™å°±å¯¼è‡´çœ‹èµ·æ¥æ˜¯å¼•å¯¼ç±»åŠ è½½å™¨å»è¯·æ±‚ä¸‹çº§çš„ç³»ç»Ÿç±»åŠ è½½å™¨,ç ´åäº†åŒäº²å§”æ´¾æ¨¡å‹
* */
```