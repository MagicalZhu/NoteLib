---
id: 基础知识
title: 基础知识
cssclasses:
  - wide-page
---

## 基本概念

> 三层架构分为表述层/表示层、业务逻辑层、数据访问层,表述层表示**前台页面和后台 Servlet**

SpringMVC 是**基于 Servlet API 构建的 Web 框架**, 并且作为的子项目包含在 Spring 框架中

### MVC

首先 MVC 是一种软件架构的思想, 将软件按照模型层(Model)、视图层(View)、控制器层(Controller)的三层架构来划分:

- Model(模型层): 项目中的JavaBean,作用是处理数据
- View(视图层): 项目中的html或jsp等页面, 作用是与用户进行交互,展示数据
- Controller(控制层):项目中的servlet, 作用是接收请求和响应浏览器

MVC 的大致工作流程:

- 用户通过视图层发送请求到服务器,在服务器中请求被 Controller 接收
- Controller调用相应的Model层处理请求,处理完毕将结果返回到 Controller
- Controller再根据请求处理的结果找到相应的 View 视图,渲染数据后最终响应给浏览器

### 相关组件

1. `DispatcherServlet`
    - 前端控制器,对浏览器发送的请求进行统一的处理
2. `Controller`
    - 处理器/页面控制器,也就是 MVC 中的 C
3. `HandlerMapping`
    - 请求映射处理器
    - 如果映射成功返回一个 HandlerExecutionChain 对象(包含一个 Handler 处理器(页面控制器)对象、多个 HandlerInterceptor 拦截器对象)
4. `ViewResolver`
    - 视图解析器, 用于将把逻辑视图解析为具体的 视图对象(View)
    - 它采用了策略模式,一边方便的更换其他视图技术
      -比如 *InternalResourceViewResolver* 将逻辑视图名映射为 jsp 视图
5. `LocaleResolver`
    - 本地化、国际化
6. `MultipartResolver`
    - 文件上传解析器
7. `HandlerExceptionResolver`
    - 异常处理器

## 基本示例

> 创建一个 SpringMvc 的 "HelloWorld" 项目

常见一个基本的 SpringMvc 项目的基本步骤:

1. 添加相关的依赖

    <details>
       <summary>相关的 Maven 依赖</summary>

    ```xml
    <dependencies>
        <!-- SpringMVC -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>5.3.1</version>
        </dependency>

        <!-- 日志 -->
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>1.2.3</version>
        </dependency>

        <!-- ServletAPI -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>3.1.0</version>
            <scope>provided</scope>
        </dependency>

        <!-- Spring5和 Thymeleaf 整合包 -->
        <dependency>
            <groupId>org.thymeleaf</groupId>
            <artifactId>thymeleaf-spring5</artifactId>
            <version>3.0.12.RELEASE</version>
        </dependency>
    </dependencies>
    ```

    </details>

2. 将项目打包为 `war`
3. 配置 web.xml
    - 配置前端控制器 Servlet: `DispatcherServlet`
    - 配置 Servlet 应用上下文 配置文件的路径, 参数名固定位: `contextConfigLocation`
    - 配置 DispatcherServlet 对应的 servlet-mapping, 且url-pattern 是相对于应用上下文路径的
        - 如果配置为 **/app/***, 那么请求路径需要在 应用上下文路径 后面拼接上 **/app**

    ```xml
    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <!-- 通过初始化参数指定SpringMVC配置文件的位置和名称 -->
        <init-param>
            <!-- contextConfigLocation 为固定值 -->
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/app.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <!--
            设置 DispatcherServlet 所能处理的请求的请求路径
            / 所匹配的请求可以是:  /login、.html、.js、.css方式的请求路径
            但是 / 不能匹配 .jsp请求路径的请求
        -->
        <url-pattern>/app/*</url-pattern>
    </servlet-mapping>
    ```

4. 配置 SpringMvc 应用上下文配置文件(这个和 Spring 的配置文件基本一致)

    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:context="http://www.springframework.org/schema/context"
        xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans.xsd
                http://www.springframework.org/schema/context
                    http://www.springframework.org/schema/context/spring-context-4.2.xsd">
       <!--开启注解支持-->
        <context:component-scan base-package="com.pacos"/>
    </beans>
    ```
