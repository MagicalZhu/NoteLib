---
id: 设计索引
title: 设计索引
---

## 使用索引

### 索引的分类

MySQL的索引包括 **普通索引、唯一性索引、全文索引、单列索引、多列索引**等

1. 从 **功能逻辑**上划分

   - `普通索引`
     - 在创建索引时,不附加任何限制条件,只是用于提高查询效率,这类索引可以创建在`任何数据类型`中,**其值是否唯一和非空,要由字段本身的完整性约束条件决定**
     - 建立索引后可以通过索引进行查询
     
     - 比如在表 student 的字段 name 上建立一个普通索引,查询记录的时候就可以根据该索引进行查询
     
   - `唯一索引`
     - 使用`UNIQUE`参数可以设置索引为唯一索引,在创建唯一索引时,限制该索引的值必须是唯一的,但是允许有空值
     - 在一张表中`可以有多个唯一索引`
     - 比如在表 student 的字段 email 中创建唯一索引,那么字段 email 的值就必须是唯一的。
     
   - `主键索引`

     - 主键索引就是一种`特殊的唯一索引`,在唯一索引的基础上加上了**不为空**的约束,也就是 *NOT NULL + UNIQUE*
     - 在一张表中`最多只能有一个主键索引`

   - `全文索引` 
     - 是目前搜索引擎使用的关键技术,可以充分的利用`分词技术`等多种算法智能分析出文本文字中关键词的频率和重要性,然后按照一定的算法规则筛选出需要的搜索结果
       - 全文索引很适合大型数据集。对于小的数据集,用处较小
     - 使用参数`FULLTEXT` 可以设置为全文索引

2. 从**物理实现方式**上划分
   - `聚簇索引`
   - `非聚簇索引`
3. 从**作用字段个数**上划分
   - `单列索引`
     - **在表中的单个字段上创建索引,单列索引只根据该字段进行索引**
     - 单列索引可以是普通索引,也可以是唯一索引,还可以是全文索引,**只要保证该索引只对应一个字段即可**
     - 在一张表中`可以有多个单列索引`
   - `多列(组合、联合)索引`
     - 多列索引是表的`多个字段组合`上创建一个索引,该索引指向多个字段,**可以通过这几个字段进行查询**, `只有查询条件中使用了这些字段的第一个字段才会被使用`
     - 比如:表中的字段 id、name 和 gender 上建立一个 联合索引*idx_id_name_gender*, 那么只有查询条件中使用了字段 id 时,该索引才会被使用
     - 使用组合索引时组训`最左前缀集合`

### 创建索引

> MySQL 支持多种方法在单个或者多个列上建立索引:
>
> 1. 在创建表的 create table 中指定索引列
> 2. 使用 alter table 语句在已经存在的表上建立索引
> 3. 使用 create index 语句在已经存在的表上建立索引

#### 创建表时

使用 Create Table 创建表时,除了可以指定列的数据类型,还可以定义主键约束、外键约束或者唯一约束,**不论指定哪种约束,定义约束时相当于给指定列上建立了一个索引**

**当然,也可以在创建表的时候,显式的建立索引,格式如下:**

```sql
CREATE TABLE table_name (
  	[UNIQUE | FULLTEXT | SPATIAL] [INDEX | KEY] [indexName] (col_name [length]) [ASC | DESC]
)
```

1. `[UNIQUE | FULLTEXT | SPATIAL]` 
   - 可选参数
   - 分别表示唯一索引、全文索引和空间索引
2. `INDEX | KEY`
   - 两者的作用相同，用来指定创建索引
3. `[indexName]`
   - 指定索引的名称，为可选参数。如果不指定，那么 MySQL 默认 col_name 为索引名
4. `col_name`
   - 为需要创建索引的字段列，该列必须从数据表中定义的多个列中选择
5. `[length]`
   - 可选参数
   - 表示索引的长度，只有字符串类型的字段才能指定索引长度
6. `[ASC | DESC]`
   - 指定升序或者降序的索引值存储

**1. 指定约束时自动建立索引**

```sql
CREATE TABLE dept(
	dept_id INT PRIMARY KEY AUTO_INCREMENT,
  dept_name VARCHAR(20)
);

CREATE TABLE emp(
  emp_id INT PRIMARY KEY AUTO_INCREMENT,
  emp_name VARCHAR(20) UNIQUE,
  dept_id INT,
  CONSTRAINT emp_dept_id_fk FOREIGN KEY(dept_id) REFERENCES dept(dept_id) 
);
```
