---
id: 缓冲池
title: 缓冲池
---

> 对于使用 InnoDB 作为存储引擎的表来说, 所有的数据(系统数据、索引等)都是以`页`的形式存放在表空间中的, 而所谓的表空间只不过是 InnoDB 对文件系统上一个或几个实际文件的抽象
> 
> 实际上数据还是存储在磁盘上的,但是磁盘的速度非常的慢,无法与 CPU 协同。所以 InnoDB 存储引擎在处理客户端的请求时,当需要访问某个页的数据时,就会把完整的页的数据全部加载到内存中。也就是说**即使我们只需要访问一个页的一条记录，那也需要先把整个页的数据加载到内存中**。将整个页加载到内存中后就可以进行读写访问了,在进行完**读写访问之后并不着急把该页对应的内存空间释放掉,而是将其缓存起来**,这样将来有请求再次访问该页面时,就可以省去磁盘IO的开销了

## Buffer Pool

- InnoDB 为了`缓存磁盘中的页`, 在MySQL 服务启动的时候会向 OS `申请一片连续的内存空间`,这片连续的内存空间就是`缓冲池(Buffer Pool)`。
- 缓冲池默认只有 `128M`, 可以通过参数 `innodb_buffer_pool_size ` 进行修改
- [其他的参数](/MySQL逻辑架构#查看设置缓冲池innodb)
  
### 缓冲池的组成

> 缓冲池中的缓存页的默认大小也是 `16KB`

**控制信息**
- 为了管理缓冲池中的页, InnoDB 为每个缓存也都创建了`控制信息`
  - 控制信息主要包括: `该页所属的表空间编号、页号、缓存页在缓冲池中的地址、链表节点信息、一些锁信息以及 LSN 信息`
- **每个缓存页对应的控制信息占用的内存大小是相同的**,简单的将每个缓存页对应的控制信息占用的一块内存称为一个`控制块`
  - **控制块和缓存页是一一对应的, 都被存放在缓冲池中**
  - **其中控制块被存放到缓冲池前边, 缓存页被存放到缓冲池后边**


**缓冲池的内存空间大致如下:**
> - 在控制块与缓存页之间还有一个 `碎片`
> 
> - **每个控制块都对应一个缓存页,那在分配足够多的控制块和缓存页后,可能剩余的那点儿空间不够一对控制块和缓存页的大小**,那么这个空间就是碎片。如果把Buffer Pool的大小设置的刚刚好的话，也可能不会产生碎片
>

![](http://assets.processon.com/chart_image/630876e27d9c080730b1a8a3.png?_=1661499430369)

### 管理Free链表
