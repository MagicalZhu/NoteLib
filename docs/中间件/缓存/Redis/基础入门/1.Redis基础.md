---
id: Redis基础
title: Redis基础
---

## 关于分布式架构

首先，什么是分布式架构:

1. 不同的业务模块(功能模块) 分散部署在不同的服务器
2. 每个子系统负责一个或者多个不同的业务模块
3. 服务时间可以相互交互与通信 -> `RPC / WebService / Http`
4. 可以发展为集群分布式系统架构
5. 微服务是分布式架构的一个子集!

分布式和集群有啥区别？

- `分布式`: **不同的多台服务器上面部署不同的服务模块,对外提供服务和组内协作**
- `集群`: **不同的多台服务器上面部署相同的服务模块，通过分布式调度软件进行统一的调度，对外提供服务和访问**

分布式可以实现*业务解耦、系统模块化、提升系统的并发量*，但是也存在着*系统之间通信耗时、架构复杂、调试复杂*等问题。

## CAP 和 BASE

在传统的 DBMS 中，为了保证系统中所有的数据都是符合期望的，且相互关联的数据之间不会产生矛盾，就也是达到 **一致性(Consistency)**，需要如下的3个手段:

1. `原子性(Atomic)`: 在同一项业务处理过程中，事务保证了对多个数据的修改，要么同时成功，要么同时被撤销
2. `隔离性(Isolation)`: 在不同的业务处理过程中，事务保证了各自业务正在读、写的数据互相独立，不会彼此影响
3. `持久性(Durability)`: 事务应当保证所有成功被提交的数据修改都能够正确地被持久化，不丢失数据

而对于分布式系统来说,我们以 `CAP + BASE` 作为理论基础

首先什么是 CAP:

1. `一致性(Consistency)`
    - 数据在任何时刻、任何分布式节点中所看到的都是符合预期的
    - 就是说，在分布式系统中，所有的分布式节点的数据在同一时刻都是相同的，数据都是一致的

2. `可用性(Availability)`
    - 表示系统可以不间断地提供服务的能力
    - 理解可用性要先理解与其密切相关两个指标:**可靠性(Reliability)和可维护性(Serviceability)**
        - 可靠性使用平均无故障时间(Mean Time Between Failure，MTBF)来度量
        - 可维护性使用平均可修复时间(Mean Time To Repair，MTTR)来度量
    - 可用性衡量系统可以正常使用的时间与总时间之比，其表征为:A=MTBF/(MTBF+MTTR)，即可用性是由可靠性和可维护性计算得出的比例值，譬如 99.9999%可用，即代表平均年故障修复时间为 32 秒。

3. `分区容忍性(Partition Tolerance)`
    - 分布式环境中部分节点因网络原因而彼此失联后，即与其他节点形成"网络分区"时，系统仍能正确地提供服务的能力

然后关于 BASE

1. Basically Available => 基本可用
2. Soft state => 柔性状态
3. Eventually consistent => 最终一致性

## Redis 概述

Redis 有如下的特点:

1. 分布式缓存中间件
2. 基于内存运行，数据存储在内存中
3. 支持数据的持久化,可以将内存中的数据持久化到硬盘，重启 Redis 的时候再次加载使用
4. Redis支持异步的将内存中的数据写到硬盘，同时不影响服务
5. 支持数据的备份 -> Master/Slave 模式的数据备份

### 安装

1. 安装依赖环境

    ```bash
    yum install gcc-c++ 
    ```

2. Redis 安装包解压

    ```bash
    tar -zxvf redis-xxx.tar.gz
    ```

3. 编译

    ```bash
    make
    make install
    ```

### 常用命令

> 可以在 Redis 的官网上查看所有的[命令](https://redis.io/commands/acl-cat/)

1. `select xxx`
    - 用于切换数据库
    - Redis 默认有 `16` 个数据库,数据库角标从 0 开始

2. `dbsize`
    - 查看当前库中,键的数量

3. `flushdb / flushall`
    - 分别是 清空当前库 和 清空所有的库
