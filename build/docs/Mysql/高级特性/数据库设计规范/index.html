<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Mysql/高级特性/数据库设计规范">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">数据库设计规范 | 花裤衩Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://huakucha.com/img/fav.png"><meta data-rh="true" name="twitter:image" content="https://huakucha.com/img/fav.png"><meta data-rh="true" property="og:url" content="https://huakucha.com/docs/Mysql/高级特性/数据库设计规范"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="数据库设计规范 | 花裤衩Wiki"><meta data-rh="true" name="description" content="为什么需要数据库设计"><meta data-rh="true" property="og:description" content="为什么需要数据库设计"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://huakucha.com/docs/Mysql/高级特性/数据库设计规范"><link data-rh="true" rel="alternate" href="https://huakucha.com/docs/Mysql/高级特性/数据库设计规范" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://huakucha.com/docs/Mysql/高级特性/数据库设计规范" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QZ9YPBGUYT-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="花裤衩Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="花裤衩Wiki Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="花裤衩Wiki JSON Feed">




<link rel="search" type="application/opensearchdescription+xml" title="花裤衩Wiki" href="/opensearch.xml">

<link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="stylesheet" href="https://fonts.font.im/css?family=Raleway:500,700&amp;display=swap"><link rel="stylesheet" href="/assets/css/styles.864d50a7.css">
<link rel="preload" href="/assets/js/runtime~main.bf86732a.js" as="script">
<link rel="preload" href="/assets/js/main.98457ee6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_D8pK">跳到主要内容</a></div><div class="announcementBar_s0pr" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_qxfj"></div><div class="content_zf74 announcementBarContent_dpRF">🌟欢迎来到花裤衩的博客🌟</div><button type="button" aria-label="关闭" class="clean-btn close closeButton_ZdWa announcementBarClose_iXyO"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="花裤衩的博客" class="themedImage_Pn4p themedImage--light_PnYV"><img src="/img/logo.svg" alt="花裤衩的博客" class="themedImage_Pn4p themedImage--dark_eYgw"></div><b class="navbar__title text--truncate">花裤衩</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">基础知识🤖</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/currency">并发编程</a></li><li><a class="dropdown__link" href="/docs/networrk-basic">计算机网络</a></li><li><a class="dropdown__link" href="/docs/linuxCommand">Linux</a></li><li><a class="dropdown__link" href="/docs/dataStructure">数据结构与算法</a></li><li><a class="dropdown__link" href="/docs/leetCode">LeetCode</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/mysql">MySQL</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">后端框架👨‍💻</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/spring">Spring</a></li><li><a class="dropdown__link" href="/docs/springCloud">SpringCloud</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">方法论🚧</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/distribute/protol">分布式理论</a></li><li><a class="dropdown__link" href="/docs/distribute/basicTech">分布式技术点</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">中间件🚀</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/middleware/basicMiddleware">基础中间件</a></li><li><a class="dropdown__link" href="/docs/middleware/job">定时任务</a></li><li><a class="dropdown__link" href="/docs/middleware/cache">缓存</a></li><li><a class="dropdown__link" href="/docs/middleware/searchEngine">搜索引擎</a></li><li><a class="dropdown__link" href="/docs/middleware/messageQueue">消息队列</a></li><li><a class="dropdown__link" href="/docs/middleware/database">数据库</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">底层⛽️</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/JVM">JVM</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">前端技术👩‍💻</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/front/Vue">Vue</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其他工具👹</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/Gradle">Gradle</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">物料中心👏</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/website/BE">后端产品</a></li><li><a class="dropdown__link" href="/website/COM">其他产品</a></li><li><a class="dropdown__link" href="/website/FE">前端产品</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a href="https://blog.huakucha.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">关于<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/MagicalZhu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_MW0i colorModeToggle_x44X"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_SFTY"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_ekgs"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_H2mL"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_eExm docsWrapper_W2AM"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_ntye" type="button"></button><div class="docPage_qMb8"><aside class="theme-doc-sidebar-container docSidebarContainer_rpaz"><div class="sidebar_mhZE"><nav class="menu thin-scrollbar menu_Y1UP menuWithAnnouncementBar_fPny"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/mysql">简介</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/mysql基础与高级">MySQL基础与高级</a><button aria-label="打开/收起侧边栏菜单「MySQL基础与高级」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/基础知识">基础知识</a><button aria-label="打开/收起侧边栏菜单「基础知识」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/数据库管理">数据库管理</a><button aria-label="打开/收起侧边栏菜单「数据库管理」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/架构与引擎">架构与引擎</a><button aria-label="打开/收起侧边栏菜单「架构与引擎」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/存储结构与索引">存储结构与索引</a><button aria-label="打开/收起侧边栏菜单「存储结构与索引」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/性能优化">性能优化</a><button aria-label="打开/收起侧边栏菜单「性能优化」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/性能分析工具">性能分析工具</a><button aria-label="打开/收起侧边栏菜单「性能分析工具」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Mysql/高级特性/性能监控工具">性能监控工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Mysql/高级特性/索引与查询优化">索引与查询优化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Mysql/高级特性/数据库设计规范">数据库设计规范</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Mysql/高级特性/数据库其他调优策略">数据库其他调优策略</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/事务与锁">事务与锁</a><button aria-label="打开/收起侧边栏菜单「事务与锁」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/运维">运维</a><button aria-label="打开/收起侧边栏菜单「运维」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Mysql/MySQL参数与命令">MySQL参数与命令</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_JQG6"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_Iseg"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_RiV8"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Alpn" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_SLhD"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/mysql基础与高级"><span itemprop="name">MySQL基础与高级</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/性能优化"><span itemprop="name">性能优化</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">数据库设计规范</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_IbkY theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_p7nN">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>数据库设计规范</h1></header><h2 class="anchor anchorWithStickyNavbar_loeA" id="为什么需要数据库设计">为什么需要数据库设计<a class="hash-link" href="#为什么需要数据库设计" title="标题的直接链接">​</a></h2><p><strong>我们再设计数据表的时候,需要考虑很多的问题。</strong>比如:</p><ul><li>用户都需要什么数据?需要在哪些表中保存哪些数据?</li><li>如何保证数据表中数据的<strong>正确性</strong>,当插入、删除、更新的时候该进行什么<code>约束检查</code></li><li>如何降低数据表的<code>数据冗余度</code>,保证数据表不会应为用户量的增加而迅速扩张</li><li>如何让负责数据库维护的人员<strong>更方便的</strong>使用数据库</li><li>使用数据库的应用场景也不同,可以说针对不同的情况,设计出的数据表也是<strong>千差万别</strong>的</li></ul><p><strong>以下是糟糕的数据库设计可能造成的问题:</strong></p><ul><li>数据冗余、信息重复、存储空间浪费</li><li>数据更新、插入、删除的异常</li><li>无法正确的表示信息</li><li>丢失有效信息</li></ul><p><strong>良好的数据库设计有下面的优点</strong></p><ul><li>节省数据的存储空间</li><li>保证数据的完整性</li><li>方便进行数据库应用系统的开发</li></ul><h2 class="anchor anchorWithStickyNavbar_loeA" id="范式normal-formnf">范式(Normal Form,NF)<a class="hash-link" href="#范式normal-formnf" title="标题的直接链接">​</a></h2><p><strong>在关系型数据库中，关于数据表设计的基本原则、规则就称为范式。</strong> </p><p>一张数据表的设计结构需要满足的某种设计标准的<code>级别</code>,要想设计一个结构合理的关系型数据库，必须满足一定的范式</p><h3 class="anchor anchorWithStickyNavbar_loeA" id="有哪些范式">有哪些范式<a class="hash-link" href="#有哪些范式" title="标题的直接链接">​</a></h3><p>目前关系型数据库有六种常见范式，按照范式级别，从低到高分别是</p><ul><li><strong>第一范式(</strong>1NF)</li><li><strong>第二范式 (</strong>2NF)</li><li><strong>第三范式(</strong>3NF)</li><li><strong>巴斯</strong>-<strong>科德范式(</strong>BCNF)</li><li><strong>第四范式</strong>(4NF<strong>)</strong></li><li><strong>第五范式(</strong>5NF<strong>，又称完美范式)</strong> </li></ul><p><code>数据库的范式设计越高阶,冗余度就越低</code>,同时高阶的范式一定满足低阶范式的要求</p><p>一般来说,在关系型数据库设计中,最高也就遵守到<code>BCNF</code>,普遍还是<code>3NF</code>。但也不一定,有时候<strong>为了查询性能,需要破坏范式规则,</strong>也就是<code>反范式化</code></p><h3 class="anchor anchorWithStickyNavbar_loeA" id="键和相关属性的概念">键和相关属性的概念<a class="hash-link" href="#键和相关属性的概念" title="标题的直接链接">​</a></h3><p>范式的定义会使用到主键和候选键,数据库中的键(key)由一个或者多个属性组成。</p><p>数据表中常用的几种键和属性的定义:</p><ol><li><code>超键</code><ul><li>能唯一标识元组(数据行)的属性集</li><li>即<strong>唯一键</strong></li></ul></li><li><code>候选键</code><ul><li>如果超键不包含多余的属性,那么这个超键就是候选键</li><li>即<strong>唯一键中不包含多余的其他属性</strong></li></ul></li><li><code>主键</code><ul><li>可以从候选键哪种选择一个作为主键</li></ul></li><li><code>外键</code><ul><li>如果数据表 R1 的某个属性集不是 R1 的主键,而是另外一个表 R2 的主键,那么这个属性集就是 R1 的外键</li></ul></li><li><code>主属性</code><ul><li>包含在任一候选键中的属性</li></ul></li><li><code>非主属性</code><ul><li>与主属性相对,不包含在任一候选键中的属性</li></ul></li></ol><p>通常,我们将候选键称之为<code>码</code>,把主键也叫做<code>主码</code>。因为键可能由多个属性组成,针对单个属性,还可以用<strong>主属性和非主属性来进行区分</strong> </p><div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>举例</div><div class="admonitionContent_vXIg"><div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-java codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">这里有两个表</span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    ​   球员表</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">player</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> 球员编号 </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> 姓名   </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> 身份证号   </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> 年龄 </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> 球队编号</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    ​   球队表</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">team</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">   </span><span class="token operator" style="color:rgb(12, 150, 155)">:</span><span class="token plain"> 球队编号 </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> 主教练 </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"> 球队所在地</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg class="copyButtonIcon_phi_" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_FfTR" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>超键</strong></p><ul><li>对于球员表来说，超键就是包括球员编号或者身份证号的任意组合，比如(球员编号) (球员编号，姓名)(身份证号，年龄)等。</li></ul><p><strong>候选键</strong></p><ul><li>就是最小的超键，对于球员表来说，候选键就是(球员编号)或者(身份证号)。 </li></ul><p><strong>主键</strong></p><ul><li>我们自己选定，也就是从候选键中选择一个，比如(球员编号)</li></ul><p><strong>外键</strong></p><ul><li>球员表中的球队编号</li></ul><p><strong>主属性 、 非主属性</strong></p><ul><li>在球员表中，主属性是球员编号、身份证号, 其他的属性:姓名、年龄、球队编号、都是非主属性。</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_loeA" id="第一范式1nf">第一范式(1NF)<a class="hash-link" href="#第一范式1nf" title="标题的直接链接">​</a></h3><blockquote><p>表的字段属性需要是原子性的</p></blockquote><ul><li><p>第一范式主要确保<code>数据表中的每个字段的值必须具有原子性</code>,也就是说数据表中的每个字段值为<code>不可再次拆分</code>的<strong>最小数据单元</strong></p><ul><li>即我们在设计某个字段的时候,对于字段 X 来说,不能把它拆分为 X-1、X-2</li><li><strong>事实上,任何的 DBMS 都会满足第一范式的要求,不会对字段进行拆分</strong></li></ul></li><li><mark>属性的原子性是<strong> 主观的 </strong>,比如用户信息包含住址,那是否需要将住址继续拆分为省市区呢?</mark></li></ul><p><strong>举例: user 表的设计不符合第一范式</strong></p><p>其中user_info字段为用户信息，可以进一步拆分成更小粒度的字段，不符合数据库设计对第一范式的要求</p><table><thead><tr><th>字段</th><th>字段类型</th><th>是否主键</th><th>说明</th></tr></thead><tbody><tr><td>id</td><td>INT</td><td>✅</td><td>主键id</td></tr><tr><td>username</td><td>VARCHAR(30)</td><td>❌</td><td>用户名</td></tr><tr><td>password</td><td>VARCHAR(30)</td><td>❌</td><td>密码</td></tr><tr><td>user_info</td><td>VARCHAR(255)</td><td>❌</td><td>用户信息 (包含真实姓名、电话、住址)</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_loeA" id="第二范式2nf">第二范式(2NF)<a class="hash-link" href="#第二范式2nf" title="标题的直接链接">​</a></h3><blockquote><p>一张表就是一个独立的对象，一张表只表达一个意思</p></blockquote><ul><li>在第一范式即基础上,还需要满足<code>数据表需要有主键,而且所有非主键字段都必须完全依赖主键,不能只依赖主键的一部分</code><ul><li>如果知道主键的所有属性的值,就可以检索到任何元组(行)的任何属性值</li></ul></li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>举例</div><div class="admonitionContent_vXIg"><p>比赛表 player_game,里面包含 <!-- -->[<strong>球员编号、姓名、年龄、比赛编号、比赛时间和比赛场地</strong>]<!-- -->属性,这里<strong>候选键和主键都为(球员编号，比赛编号)</strong>，我们可以通过候选键(或主键)来决定如下的关系:</p><div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-java codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">球员编号</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> 比赛编号</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><span class="token plain"> → </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">姓名</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> 年龄</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> 比赛时间</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> 比赛场地，得分</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg class="copyButtonIcon_phi_" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_FfTR" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>但是这个数据表不满足第二范式，因为数据表中的字段之间还存在着如下的对应关系:</p><div class="language-java codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-java codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token plain">球员编号 → </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">姓名，年龄</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">比赛编号 → </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">比赛时间</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain"> 比赛场地</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg class="copyButtonIcon_phi_" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_FfTR" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>对于非主属性来说，并非完全依赖候选键。这样会产生怎样的问题呢?</strong></p><ol><li><code>数据冗余</code><ul><li>一个球员可以参加 m 场比赛，那么球员的姓名和年龄就重复了 m-1 次。</li><li>一个比赛 也可能会有 n 个球员参加，比赛的时间和地点就重复了 n-1 次</li></ul></li><li><code>插入异常</code><ul><li>如果我们想要添加一场新的比赛，但是这时还没有确定参加的球员都有谁，那么就没法插入</li></ul></li><li><code>删除异常</code><ul><li>如果我要删除某个球员编号，如果没有单独保存比赛表的话，就会同时把比赛信息删除掉</li></ul></li><li><code>更新异常 </code><ul><li>如果我们调整了某个比赛的时间，那么数据表中所有这个比赛的时间都需要进行调 整，否则就会出现一场比赛时间不同的情况</li></ul></li></ol><p><strong>为了避免出现上述的情况，我们可以把球员比赛表设计为下面的三张表</strong></p><table><thead><tr><th><strong>表名</strong></th><th>属性(字段)</th></tr></thead><tbody><tr><td>球员 player 表</td><td>球员编号、姓名和年龄等属性</td></tr><tr><td>比赛 game 表</td><td>比赛编号、比赛时间和比赛场地等属性</td></tr><tr><td>球员比赛关系 player_game表</td><td>球员编号、比赛编号和得分等属性</td></tr></tbody></table></div></div><h3 class="anchor anchorWithStickyNavbar_loeA" id="第三范式3nf">第三范式(3NF)<a class="hash-link" href="#第三范式3nf" title="标题的直接链接">​</a></h3><blockquote><p>即非主键属性之间不能有依赖关系,必须相互独立</p></blockquote><ul><li>在第二范式的基础上,确保数据表中的每一个<strong>非主键字段</strong>都和主键字段直接相关,也就是说<code>要求表的所有非主键字段不能依赖于其他非主键字段</code><ul><li>比如不存在非属性 A 依赖于非属性 B,非属性 B 依赖于主键 C </li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_loeA" id="反范式化">反范式化<a class="hash-link" href="#反范式化" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_loeA" id="概述">概述<a class="hash-link" href="#概述" title="标题的直接链接">​</a></h3><blockquote><p>有时候不能简单的按照范式要求设计数据表,因为有的数据看似冗余,但是对业务来说很重要。这个时候需要遵守<code>业务优先</code>的原则,首先需要满足<strong>业务要求</strong>,再尽量减少冗余</p><p>如果数据库的数据量比较大,那完全按照三范式设计数据表,查询数据的时候会造成大量的关联查询,在一定程度上会影响性能。这个时候就可能需要<code>增加冗余字段</code>来提高数据库的读性能</p></blockquote><p><strong>规范化还是性能?</strong></p><ol><li><p>为满足某种商业目标,数据库性能比规范化数据库更重要</p></li><li><p>在数据规范化的同时,要综合考虑数据库的性能</p></li><li><p>通过在给定的表中添加额外的字段,以大量减少需要从中搜索信息所需的时间 </p></li><li><p>通过在给定的表中插入计算列,以方便查询</p></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="应用举例">应用举例<a class="hash-link" href="#应用举例" title="标题的直接链接">​</a></h3><p>员工的信息存储在<strong>employees 表</strong>中，部门信息存储在<strong>departments 表</strong>中。通过 employees 表中的 department_id字段与 departments 表建立关联关系。<strong>如果要查询一个员工所在部门的名称:</strong></p><div class="language-sql codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-sql codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">select</span><span class="token plain"> employee_id</span><span class="token punctuation" style="color:rgb(153, 76, 195)">,</span><span class="token plain">department_name </span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">from</span><span class="token plain"> employees e </span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">join</span><span class="token plain"> departments d </span><span class="token keyword" style="color:rgb(12, 150, 155)">on</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">department_id </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">department_id</span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg class="copyButtonIcon_phi_" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_FfTR" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>如果经常需要进行这个操作，连接查询就会浪费很多时间</strong>。可以在 employees 表中增加一个冗余字段 department_name，这样就不用每次都进行连接操作了</p><h3 class="anchor anchorWithStickyNavbar_loeA" id="反范式的新问题">反范式的新问题<a class="hash-link" href="#反范式的新问题" title="标题的直接链接">​</a></h3><ol><li><strong>存储空间变大了</strong></li><li>一个表中字段做了修改，另一个表中冗余的字段也需要做同步修改，否则<code>数据不一致</code><ul><li>若采用存储过程来支持数据的更新、删除等额外操作，如果更新频繁，会<code>非常消耗资源</code></li></ul></li><li>在<code>数据量小</code> 的情况下，反范式不能体现性能的优势，可能还会让数据库的设计更加<code>复杂</code></li></ol><h2 class="anchor anchorWithStickyNavbar_loeA" id="er模型">ER模型<a class="hash-link" href="#er模型" title="标题的直接链接">​</a></h2><p><img loading="lazy" alt="image-20220804105423266" src="/assets/images/image-20220804105423266-521c3674a0dffb7f946b180593710588.png" width="1908" height="916" class="img_CujE"></p><h3 class="anchor anchorWithStickyNavbar_loeA" id="er-模型的组成">ER 模型的组成<a class="hash-link" href="#er-模型的组成" title="标题的直接链接">​</a></h3><p>ER 模型中有三个要素，分别是<strong>实体、属性和关系</strong></p><ol><li><p><code>实体</code></p><ul><li>可以看做是数据对象，往往对应于现实生活中的真实存在的个体, 在 ER 模型中，用<code>矩形</code> 来表示</li><li>实体分为两类，分别是 <code>强实体</code>和<code>弱实体</code> <ul><li><strong>强实体是指不依赖于其他实体的实体</strong> </li><li><strong>弱实体是指对另一个实体有很强的依赖关系的实体</strong> </li></ul></li></ul></li><li><p><code>属性</code></p><ul><li><strong>实体的特性</strong> </li><li>比如超市的地址、联系电话、员工数等。在 ER 模型中用<code>椭圆形</code> 来表示</li></ul></li><li><p><code>关系</code></p><ul><li><strong>实体之间的联系</strong> </li><li>比如超市把商品卖给顾客，就是一种超市与顾客之间的联系。在 ER 模型中用 <code>菱形</code> 来表示</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="示例">示例<a class="hash-link" href="#示例" title="标题的直接链接">​</a></h3><p>我们设计的案例是 <code>电商业务</code> ，简单的划分电商业务有8个实体:</p><ol><li>地址实体</li><li>用户实体</li><li>购物车实体</li><li>评论实体</li><li>商品实体</li><li>商品分类实体</li><li>订单实体</li><li>订单详情实体</li></ol><p><code>用户、商品分类</code> 是强实体，因为它们不需要依赖其他任何实体。而其他属于弱实体，因为它们虽然都可以独立存在，但是它们都依赖用户这个实体，因此都是弱实体</p><p><img loading="lazy" alt="image-20220804105039352" src="/assets/images/image-20220804105039352-673c5b04259a0a5aa409e18e629b285c.png" width="1990" height="1340" class="img_CujE"></p><p>在这个图中，地址和用户之间的添加关系，是一对多的关系，而商品和商品详情示一对1的关系，商品和订单是多对多的关系。 这个 ER 模型，包括了 8个实体之间的 8种关系</p><ol><li>用户可以在电商平台添加多个地址</li><li>用户只能拥有一个购物车</li><li>用户可以生成多个订单</li><li>用户可以发表多条评论</li><li>一件商品可以有多条评论</li><li>每一个商品分类包含多种商品</li><li>一个订单可以包含多个商品，一个商品可以在多个订单里</li><li>订单中又包含多个订单详情，因为一个订单中可能包含不同种类的商品</li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="er-模型的细化">ER 模型的细化<a class="hash-link" href="#er-模型的细化" title="标题的直接链接">​</a></h3><p>进一步去设计一下这个 ER 模型的各个局部，也就是细化下电商的具体业务流程，然后把它们综合到一起，形成一个完整的 ER 模型。再分析一下各个实体都有哪些属性,如下所示:</p><ol><li><code> 地址实体</code> 包括用户编号、省、市、地区、收件人、联系电话、是否是默认地址</li><li><code>用户实体</code> 包括用户编号、用户名称、昵称、用户密码、手机号、邮箱、头像、用户级别</li><li><code> 购物车实体</code> 包括购物车编号、用户编号、商品编号、商品数量、图片文件url。</li><li><code>订单实体</code> 包括订单编号、收货人、收件人电话、总金额、用户编号、付款方式、送货地址、下单 时间</li><li><code>订单详情实体</code> 包括订单详情编号、订单编号、商品名称、商品编号、商品数量</li><li><code>商品实体</code> 包括商品编号、价格、商品名称、分类编号、是否销售，规格、颜色</li><li><code>评论实体</code> 包括评论id、评论内容、评论时间、用户编号、商品编号</li><li><code>商品分类实体</code> 包括类别编号、类别名称、父类别编号</li></ol><p><img loading="lazy" alt="image-20220804105354580" src="/assets/images/image-20220804105354580-70b29f922405319b47c1c177c9800dc7.png" width="2012" height="1406" class="img_CujE"></p><h2 class="anchor anchorWithStickyNavbar_loeA" id="数据库对象编写建议">数据库对象编写建议<a class="hash-link" href="#数据库对象编写建议" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_loeA" id="关于库">关于库<a class="hash-link" href="#关于库" title="标题的直接链接">​</a></h3><ol><li><p>【强制】库的名称必须控制在32个字符以内<strong>，只能使用英文字母、数字和下划线，建议以英文字母开头</strong></p></li><li><p>【强制】库名中英文一律小写 ，不同单词采用<code>下划线</code>分割。须见名知意。</p></li><li><p>【强制】库的名称格式:业务系统名称_子系统名</p></li><li><p>【强制】库名禁止使用关键字(如type,order等)</p></li><li><p>【强制】创建数据库时必须<code>显式指定字符集</code>,并且字符集只能是utf8或者utf8mb4。</p><div class="language-sql codeBlockContainer_APcc theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-sql codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">DATABASE</span><span class="token plain"> crm_fund </span><span class="token keyword" style="color:rgb(12, 150, 155)">DEFAULT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">CHARACTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">SET</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">&#x27;utf8&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg class="copyButtonIcon_phi_" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_FfTR" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>【建议】对于程序连接数据库账号，遵循 <code>权限最小原则</code></p><ul><li>使用数据库账号只能在一个DB下使用，<strong>不准跨库</strong></li><li>程序使用的账号 <strong>原则上不准有drop权限</strong> </li></ul></li><li><p>【建议】临时库以 <code>tmp_</code> 为前缀，并以日期为后缀;备份库以<code> bak_</code> 为前缀，并以日期为后缀。</p></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="关于表列">关于表、列<a class="hash-link" href="#关于表列" title="标题的直接链接">​</a></h3><ol><li>【强制】表和列的名称必须控制在32个字符以内，<strong>表名只能使用英文字母、数字和下划线，建议以英文字母开头</strong></li><li>【强制】表名、列名一律小写,<strong>不同单词采用下划线分割</strong>,须见名知意</li><li>【强制】表名要求有模块名强相关，<strong>同一模块的表名尽量使用统一前缀</strong> ,比如:crm_fund_item</li><li>【强制】创建表时必须 <code>显式指定字符集</code> 为utf8或utf8mb4</li><li>【强制】表名、列名禁止使用关键字(如type,order等)</li><li>【强制】创建表时必须 显式指定表存储引擎 类型。如无特殊需求，一律为InnoDB。</li><li>【强制】<strong>建表必须有comment</strong></li><li>【强制】<strong>字段命名应尽可能使用表达实际含义的英文单词或缩写</strong><ul><li>如:公司 ID，不要使用 corporation_id, 而用corp_id 即可。</li></ul></li><li>【强制】<strong>布尔值类型的字段命名为 is_描述</strong><ul><li>如member表上表示是否为enabled的会员的字段命 名为 is_enabled。</li></ul></li><li>【强制】禁止在数据库中存储图片、文件等大的二进制数据<ul><li>通常文件很大，短时间内造成数据量快速增长，数据库进行数据库读取时，通常会进行大量的随机IO操作，文件很大时，IO操作很耗时</li><li>通常存储于文件服务器，数据库只存储文件地址信息。</li></ul></li><li>【建议】<strong>建表时关于主键: 表必须有主键 </strong><ul><li>强制要求主键为id，类型为int或bigint，且为 auto_increment 建议使用unsigned无符号型。</li><li>标识表里每一行主体的字段不要设为主键，建议 设为其他字段如user_id，order_id等，并建立unique key索引。因为如果设为主键且主键值为随机 插入，则会导致innodb内部页分裂和大量随机I/O，性能下降。</li></ul></li><li>【建议】<strong>核心表(如用户表)必须有行数据的创建时间字段和 最后更新时间字段</strong>，便于查问题。</li><li>【建议】表中所有字段尽量都是 NOT NULL 属性，业务可以根据需要定义 DEFAULT值 <ul><li><strong>因为使用 NULL值会存在每一行都会占用额外存储空间、数据迁移容易出错、聚合函数计算结果偏差等问题</strong>。</li></ul></li><li>【建议】所有<code>存储相同数据的列名和列类型必须一致</code><ul><li>一般作为关联列，如果查询时关联列类型不一致会自动进行数据类型<code>隐式转换</code>，会造成列上的索引失效</li></ul></li><li>【建议】中间表(或临时表)用于保留中间结果集，名称以 <code>tmp_</code> 开头。</li><li>【建议】备份表用于备份或抓取源表快照，名称以 <code>bak_</code> 开头,中间表和备份表定期清理</li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="关于索引">关于索引<a class="hash-link" href="#关于索引" title="标题的直接链接">​</a></h3><ol><li><p>【强制】<strong>InnoDB表必须主键为id int/bigint auto_increment，且<code>主键值禁止被更新</code></strong> </p></li><li><p>【强制】InnoDB和MyISAM存储引擎表，索引类型必须为 <code>BTREE</code> 。</p></li><li><p>【建议】主键的名称以 <code>pk_</code> 开头，唯一键以 <code>uni_ 或 uk_</code> 开头，普通索引以 <code>idx_</code> 开头，一律</p><p>使用小写格式，<strong>以字段的名称或缩写作为后缀</strong></p></li><li><p>【建议】多单词组成的columnname，取前几个单词首字母，加末单词组成column_name</p><ul><li>如:sample 表 member_id 上的索引:idx_sample_mid。</li></ul></li><li><p>【建议】单个表上的索引个数 <code>不能超过 6 个</code></p></li><li><p>【建议】在建立索引时，多考虑建立<code>联合索引</code>，并<strong>把区分度最高的字段放在最前面</strong></p></li><li><p>【建议】<strong>在多表 JOIN 的SQL里，保证被驱动表的连接列上有索引，这样JOIN 执行效率最高</strong></p></li><li><p>【建议】建表或加索引时，保证表里互相不存在<code>冗余索引</code></p><ul><li>比如:如果表里已经存在key(a,b)，则key(a)为冗余索引，需要删除</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_loeA" id="sql编写">SQL编写<a class="hash-link" href="#sql编写" title="标题的直接链接">​</a></h3><ol><li><p>【强制】程序端SELECT语句必须指定具体字段名称，<code>禁止写成 *</code>。</p></li><li><p>【建议】<strong>程序端insert语句指定具体字段名称</strong>，不要写成INSERT INTO t1 VALUES(...)。</p></li><li><p>【建议】除静态表或小表(100行以内)，DML语句必须有WHERE条件，且使用索引查找。</p></li><li><p>【建议】INSERT INTO...VALUES(XX)这里XX的值不要超过5000个。</p><ul><li><code>值过多会引起主从同步延迟</code></li></ul></li><li><p>【建议】SELECT语句<strong>不要使用UNION，推荐使用UNION ALL</strong>，并且UNION子句个数限制在<code>5</code>个以内</p></li><li><p>【建议】<strong>线上环境, 多表 JOIN 不要超过5个表</strong> </p></li><li><p>【建议】<strong>减少使用ORDER BY</strong>，和业务沟通能不排序就不排序，或将排序放到程序端去做</p><ul><li>ORDER BY、GROUP BY、DISTINCT 这些语句较为耗费CPU，数据库的CPU资源是极其宝贵的。</li></ul></li><li><p>【建议】包含了<strong>ORDER BY、GROUP BY、DISTINCT</strong> 这些查询的语句，WHERE 条件过滤出来的结果集请保持在1000行以内，否则SQL会很慢。</p></li><li><p>【建议】<strong>对单表的多次alter操作必须合并为一次</strong></p><ul><li><p>对于超过100W行的大表进行alter table，必须经过DBA审核,并在业务低峰期执行,多个alter需整合在一起</p></li><li><p>因为alter table会产生<code>表锁</code>,期间阻塞对于该表的所有写入,对于业务可能会产生极大影响</p></li></ul></li><li><p>【建议】<strong>批量操作数据时，需要控制事务处理间隔时间，进行必要的sleep</strong></p></li><li><p>【建议】<strong>事务里包含SQL不超过5个</strong></p><ul><li>因为<strong>过长的事务会导致锁数据较久，MySQL内部缓存、连接消耗过多等问题</strong></li></ul></li><li><p>【建议】<strong>事务里更新语句尽量基于主键或UNIQUE KEY</strong></p></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/MagicalZhu/NoteLib/tree/main/docs/Mysql/高级特性/数据库设计规范.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_N_05" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_VsjB"><span class="theme-last-updated">最后<!-- -->由 <b>YuLiang Zhu</b> <!-- -->于 <b><time datetime="2022-12-06T01:19:52.000Z">2022年12月6日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Mysql/高级特性/索引与查询优化"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">索引与查询优化</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Mysql/高级特性/数据库其他调优策略"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">数据库其他调优策略</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar theme-doc-toc-desktop"><p class="content_nRws">Contents</p><ul class="table-of-contents table-of-contents__left-border"><li><a href="#为什么需要数据库设计" class="table-of-contents__link toc-highlight">为什么需要数据库设计</a></li><li><a href="#范式normal-formnf" class="table-of-contents__link toc-highlight">范式(Normal Form,NF)</a><ul><li><a href="#有哪些范式" class="table-of-contents__link toc-highlight">有哪些范式</a></li><li><a href="#键和相关属性的概念" class="table-of-contents__link toc-highlight">键和相关属性的概念</a></li><li><a href="#第一范式1nf" class="table-of-contents__link toc-highlight">第一范式(1NF)</a></li><li><a href="#第二范式2nf" class="table-of-contents__link toc-highlight">第二范式(2NF)</a></li><li><a href="#第三范式3nf" class="table-of-contents__link toc-highlight">第三范式(3NF)</a></li></ul></li><li><a href="#反范式化" class="table-of-contents__link toc-highlight">反范式化</a><ul><li><a href="#概述" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#应用举例" class="table-of-contents__link toc-highlight">应用举例</a></li><li><a href="#反范式的新问题" class="table-of-contents__link toc-highlight">反范式的新问题</a></li></ul></li><li><a href="#er模型" class="table-of-contents__link toc-highlight">ER模型</a><ul><li><a href="#er-模型的组成" class="table-of-contents__link toc-highlight">ER 模型的组成</a></li><li><a href="#示例" class="table-of-contents__link toc-highlight">示例</a></li><li><a href="#er-模型的细化" class="table-of-contents__link toc-highlight">ER 模型的细化</a></li></ul></li><li><a href="#数据库对象编写建议" class="table-of-contents__link toc-highlight">数据库对象编写建议</a><ul><li><a href="#关于库" class="table-of-contents__link toc-highlight">关于库</a></li><li><a href="#关于表列" class="table-of-contents__link toc-highlight">关于表、列</a></li><li><a href="#关于索引" class="table-of-contents__link toc-highlight">关于索引</a></li><li><a href="#sql编写" class="table-of-contents__link toc-highlight">SQL编写</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">前端链接</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://v3.cn.vuejs.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Vue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://react.docschina.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">React<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://ts.xcatliu.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">TypeScript<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://developer.mozilla.org/zh-CN/docs/Web" target="_blank" rel="noopener noreferrer" class="footer__link-item">MDN<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">后端链接</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://spring.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Spring<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.docker.com/get-started/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kubernetes.io/zh/docs/home/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kubernetes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/windows/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">JVM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://juejin.cn" target="_blank" rel="noopener noreferrer" class="footer__link-item">掘金<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.infoq.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">InfoQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">文档构建</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.docusaurus.cn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://typoraio.cn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Typora<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_2l9O"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 huakucha. Built With Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bf86732a.js"></script>
<script src="/assets/js/main.98457ee6.js"></script>
</body>
</html>