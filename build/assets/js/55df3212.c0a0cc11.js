"use strict";(self.webpackChunkhuakucha=self.webpackChunkhuakucha||[]).push([[5784],{55904:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var n=a(87462),l=(a(67294),a(3905));a(61839);const r={id:"GateWay",title:"\u670d\u52a1\u7f51\u5173-GateWay"},i=void 0,o={unversionedId:"SpringCloud/Netflix/GateWay",id:"SpringCloud/Netflix/GateWay",title:"\u670d\u52a1\u7f51\u5173-GateWay",description:"1.GateWay",source:"@site/docs/SpringCloud/Netflix/1.5\u670d\u52a1\u7f51\u5173-GateWay.md",sourceDirName:"SpringCloud/Netflix",slug:"/SpringCloud/Netflix/GateWay",permalink:"/docs/SpringCloud/Netflix/GateWay",draft:!1,editUrl:"https://github.com/MagicalZhu/NoteLib/tree/main/docs/SpringCloud/Netflix/1.5\u670d\u52a1\u7f51\u5173-GateWay.md",tags:[],version:"current",lastUpdatedBy:"YuLiang Zhu",lastUpdatedAt:1670289592,formattedLastUpdatedAt:"2022\u5e7412\u67086\u65e5",frontMatter:{id:"GateWay",title:"\u670d\u52a1\u7f51\u5173-GateWay"},sidebar:"springCloudSideBar",previous:{title:"\u670d\u52a1\u7194\u65ad-Hystrix",permalink:"/docs/SpringCloud/Netflix/Hystrix"},next:{title:"\u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3-Config",permalink:"/docs/SpringCloud/Netflix/Config"}},p={},u=[{value:"1.GateWay",id:"1gateway",level:2},{value:"1.1 GateWay \u6982\u8ff0",id:"11-gateway-\u6982\u8ff0",level:3},{value:"1.2 GateWay \u4e09\u4e2a\u6838\u5fc3\u6982\u5ff5",id:"12-gateway-\u4e09\u4e2a\u6838\u5fc3\u6982\u5ff5",level:3},{value:"1.3 GateWay \u5de5\u4f5c\u6d41\u7a0b",id:"13-gateway-\u5de5\u4f5c\u6d41\u7a0b",level:3},{value:"2.GateWay \u4f7f\u7528",id:"2gateway-\u4f7f\u7528",level:2},{value:"2.1 \u8def\u7531",id:"21-\u8def\u7531",level:3},{value:"2.2 \u914d\u7f6e\u8def\u7531",id:"22-\u914d\u7f6e\u8def\u7531",level:3},{value:"2.2.1 \u6ce8\u5165Bean \u7684\u65b9\u5f0f\u914d\u7f6e\u8def\u7531",id:"221-\u6ce8\u5165bean-\u7684\u65b9\u5f0f\u914d\u7f6e\u8def\u7531",level:4},{value:"2.2.2 \u901a\u8fc7\u5fae\u670d\u52a1\u540d\u5b9e\u73b0\u52a8\u6001\u8def\u7531",id:"222-\u901a\u8fc7\u5fae\u670d\u52a1\u540d\u5b9e\u73b0\u52a8\u6001\u8def\u7531",level:4},{value:"2.3 \u65ad\u8a00Predicate",id:"23-\u65ad\u8a00predicate",level:3},{value:"2.3.1 Predict\u6982\u8ff0",id:"231-predict\u6982\u8ff0",level:4},{value:"2.3.2 After/Before/BetweenPredicate",id:"232-afterbeforebetweenpredicate",level:4},{value:"2.3.2.1 \u793a\u4f8b",id:"2321-\u793a\u4f8b",level:5},{value:"2.3.3 MethodPredict",id:"233-methodpredict",level:4},{value:"2.3.3.1 \u793a\u4f8b",id:"2331-\u793a\u4f8b",level:5},{value:"2.4 \u8fc7\u6ee4\u5668Filter",id:"24-\u8fc7\u6ee4\u5668filter",level:3},{value:"2.4.1 \u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668",id:"241-\u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668",level:4}],k={toc:u};function m(e){let{components:t,...r}=e;return(0,l.kt)("wrapper",(0,n.Z)({},k,r,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"1gateway"},"1.GateWay"),(0,l.kt)("h3",{id:"11-gateway-\u6982\u8ff0"},"1.1 GateWay \u6982\u8ff0"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"GateWay \u662f\u4ec0\u4e48\uff1f")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"SpringCloud Gateway \u4f7f\u7528\u7684Webflux\u4e2d\u7684Reactor-Netty\u54cd\u5e94\u5f0f\u7f16\u7a0b\u7ec4\u4ef6\uff0c\u5e95\u5c42\u4f7f\u7528\u4e86Netty\u901a\u8baf\u6846\u67b6"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"GateWay \u53ef\u4ee5\u5e72\u4ec0\u4e48\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"\u53cd\u5411\u4ee3\u7406"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"\u9274\u6743"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"\u6d41\u91cf\u63a7\u5236"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"\u7194\u65ad"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"strong"},"\u65e5\u5fd7\u76d1\u63a7"))),(0,l.kt)("li",{parentName:"ul"},"..."))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"Gateway \u7279\u6027"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u52a8\u6001\u8def\u7531: \u53ef\u4ee5\u5339\u914d\u4efb\u4f55\u8bf7\u6c42\u5c5e\u6027\uff0c\u53ef\u4ee5\u5bf9\u8def\u7531\u6307\u5b9aPredicate(\u65ad\u8a00) \u548c Filter(\u8fc7\u6ee4\u5668)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u96c6\u6210Hystrix\u65ad\u8def\u5668\u529f\u80fd")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u96c6\u6210SpringCloud \u670d\u52a1\u53d1\u73b0\u529f\u80fd")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u6613\u4e8e\u7f16\u5199Predicate \u548c Filter")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u8bf7\u6c42\u9650\u6d41\u529f\u80fd")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u652f\u6301\u8def\u5f84\u91cd\u5199")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"GateWay \u548c Zuul1.x\u7684\u533a\u522b")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Zuul 1.x \u662f\u57fa\u4e8e\u963b\u585e\u5f0fIO \u7684API Gateway\uff0c\u57fa\u4e8e ",(0,l.kt)("font",{color:"red"},"Servlet 2.5")," \u4f7f\u7528\u963b\u585e\u5f0f\u67b6\u6784\uff0c\u4e0d\u652f\u6301\u4efb\u4f55\u957f\u8fde\u63a5(\u5982websocket)"),(0,l.kt)("li",{parentName:"ul"},"SpringCloud GateWay\u5efa\u7acb\u5728 Spring5\u3001Reactor\u548cSpringBoot2.x \u4e4b\u4e0a\uff0c\u4f7f\u7528\u975e\u963b\u585eAPI")))),(0,l.kt)("h3",{id:"12-gateway-\u4e09\u4e2a\u6838\u5fc3\u6982\u5ff5"},"1.2 GateWay \u4e09\u4e2a\u6838\u5fc3\u6982\u5ff5"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u8def\u7531"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8def\u7531\u662f\u6784\u5efa\u7f51\u5173\u7684\u57fa\u672c\u6a21\u5757"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u7531ID\u3001\u76ee\u6807URI\u3001\u4e00\u7cfb\u5217\u7684\u65ad\u8a00\u548c\u8fc7\u6ee4\u5668\u7ec4\u6210"),"\uff0c\u5982\u679c\u65ad\u8a00\u4e3atrue\u5219\u5339\u914d\u8be5\u8def\u7531"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Predicate"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8def\u7531\u8f6c\u53d1\u7684\u5224\u65ad\u6761\u4ef6"),(0,l.kt)("li",{parentName:"ul"},"\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u5339\u914dHTTP\u8bf7\u6c42\u4e2d\u7684\u6240\u6709\u5185\u5bb9\uff08\u4f8b\u5982\u8bf7\u6c42\u5934\u6216\u8bf7\u6c42\u53c2\u6570\uff09\uff0c\u5982\u679c\u8bf7\u6c42\u4e0e\u65ad\u8a00\u76f8\u5339\u914d\u5219\u8fdb\u884c\u8def\u7531",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u76ee\u524d",(0,l.kt)("inlineCode",{parentName:"li"},"SpringCloud Gateway"),"\u652f\u6301\u591a\u79cd\u65b9\u5f0f\uff0c\u5e38\u89c1\u5982\uff1a",(0,l.kt)("inlineCode",{parentName:"li"},"Path"),"\u3001",(0,l.kt)("inlineCode",{parentName:"li"},"Query"),"\u3001",(0,l.kt)("inlineCode",{parentName:"li"},"Method"),"\u3001",(0,l.kt)("inlineCode",{parentName:"li"},"Header"),"\u7b49\u3002"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Filter"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Spring\u6846\u67b6\u4e2d",(0,l.kt)("em",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"em"},"GatewayFilter")),"\u7684\u5b9e\u4f8b",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5206\u4e3a ",(0,l.kt)("font",{color:"red"},(0,l.kt)("em",null,(0,l.kt)("code",null,"pre")),"[\u524d\u7f6e]")," \u548c ",(0,l.kt)("font",{color:"red"},(0,l.kt)("em",null,(0,l.kt)("code",null,"post")),"\xa0","[\u540e\u7f6e]")," \u8fc7\u6ee4\u5668"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u4f7f\u7528\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u5728\u8bf7\u6c42\u88ab\u8def\u7531\u524d\u6216\u8005\u4e4b\u540e\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4fee\u6539"))))),(0,l.kt)("h3",{id:"13-gateway-\u5de5\u4f5c\u6d41\u7a0b"},"1.3 GateWay \u5de5\u4f5c\u6d41\u7a0b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u5de5\u4f5c\u6d41\u7a0b"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\u5411Gateway \u53d1\u9001\u8bf7\u6c42\uff0c\u7136\u540e\u5728Gateway Handler Mapping \u4e2d\u627e\u5230\u4e0e\u8bf7\u6c42\u5339\u914d\u7684\u8def\u7531\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230 Gateway Web Handler"),(0,l.kt)("li",{parentName:"ol"},"Handler \u518d\u901a\u8fc7\u6307\u5b9a\u7684\u8fc7\u6ee4\u5668\u94fe\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u6211\u4eec\u7684\u5b9e\u9645\u4e1a\u52a1\u5c42\u5904\u7406\uff0c\u7136\u540e\u8fd4\u56de",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5728 \u524d\u7f6e\u8fc7\u6ee4\u5668(pre Filter)\u4e2d\uff0c\u53ef\u4ee5\u505a ",(0,l.kt)("code",null,"\u53c2\u6570\u6821\u9a8c\u3001\u6743\u9650\u6821\u9a8c\u3001\u6d41\u91cf\u76d1\u63a7\u3001\u65e5\u5fd7\u8f93\u51fa\u3001\u534f\u8bae\u8f6c\u5316\u7b49"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5728\u540e\u7f6e\u8fc7\u6ee4\u5668(post filter)\u4e2d\uff0c\u53ef\u4ee5\u505a ",(0,l.kt)("code",null,"\u54cd\u5e94\u5185\u5bb9\u3001\u54cd\u5e94\u5934\u4fee\u6539\uff0c\u65e5\u5fd7\u7684\u8f93\u51fa\u3001\u6d41\u91cf\u76d1\u63a7\u7b49"))))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"Gateway \u81ea\u52a8\u6ce8\u5165\u7684Bean"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{alt:"image-20201209192403387",src:a(32214).Z,width:"851",height:"238"})))),(0,l.kt)("h2",{id:"2gateway-\u4f7f\u7528"},"2.GateWay \u4f7f\u7528"),(0,l.kt)("h3",{id:"21-\u8def\u7531"},"2.1 \u8def\u7531"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5e38\u89c1\u7684\u7c7b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"RouteDefinition")," \u8def\u7531\u5b9a\u4e49\u4fe1\u606f,\u5305\u542b\u4e0b\u9762\u7684\u51e0\u4e2a\u5c5e\u6027"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"PredicateDefinition"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u65ad\u8a00\u5b9a\u4e49\u4fe1\u606f"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"FilterDefinition"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fc7\u6ee4\u5668\u5b9a\u4e49\u4fe1\u606f"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"RouteDefinitionLocator")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u52a0\u8f7d\u8def\u7531\u5b9a\u4e49\u4fe1\u606f\uff0c\u5e38\u89c1\u6709\u4ee5\u4e0b\u7684\u5b9e\u73b0\u7c7b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"CachingRouteDefinitionLocator")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u57fa\u4e8eHashMap\u7f13\u5b58\u7684\u8def\u7531\u5b9a\u4e49\u4fe1\u606f\u52a0\u8f7d\u5668"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"DiscoveryClientRouteDefinitionLocator")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u57fa\u4e8e\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u7684\u8def\u7531\u5b9a\u4e49\u4fe1\u606f\u52a0\u8f7d\u5668\uff0c\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"p"},"ReactiveDiscoveryClient.getServices()")," \u8fdb\u800c\u83b7\u53d6\u5230\u6ce8\u518c\u4e2d\u5fc3\u7684\u6240\u6709\u670d\u52a1\u5b9e\u4f8b")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"green"},"ReactiveDiscoveryClient \u5e38\u89c1\u7684\u5b9e\u73b0\u7c7b\u6709"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"ConsulReactiveDiscoveryClient")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"EurekaReactiveDiscoveryClient")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728 ",(0,l.kt)("em",{parentName:"p"},"GatewayDiscoveryClientAutoConfiguration")," \u4e2d\u6ce8\u518c")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"InMemoryRouteDefinitionRepository")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u57fa\u4e8e\u5185\u5b58\u7684\u8def\u7531\u5b9a\u4e49\u4fe1\u606f\u52a0\u8f7d\u5668"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"PropertiesRouteDefinitionLocator")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u57fa\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u7531\u5b9a\u4e49\u4fe1\u606f\u52a0\u8f7d\u5668\uff0c\u6bd4\u5982application.yml"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8fd9\u4e9b\u8def\u7531\u5b9a\u4e49\u4fe1\u606f\u52a0\u8f7d\u5668 \u4f1a\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"GatewayAutoConfiguration")," \u4e2d\u8fdb\u884c\u6ce8\u518c")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u64cd\u4f5c\u6b65\u9aa4"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5f15\u5165GateWay \u548c \u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u7684\u4f9d\u8d56 (GateWay\u4e5f\u9700\u8981\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3\u54df)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u6ce8\u610f\uff1a\u4f7f\u7528GateWay\u7684\u65f6\u5019\u4e0d\u8981\u5f15\u5165 spring-web \u7684\u4f9d\u8d56\uff0c\u56e0\u4e3aGateWay \u6784\u5efa\u5728 WebFlux \xa0\u4e0a")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u914d\u7f6eapplication.yml\uff0c\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"p"},"spring.cloud.gateway.routes"),"\u914d\u7f6e\u8def\u7531\u6620\u5c04\u4fe1\u606f,\u662f\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"List<RouteDefinition>")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",null,"id"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8def\u7531ID,\u6ca1\u6709\u56fa\u5b9a\u7684\u89c4\u5219\u4f46\u8981\u6c42\u552f\u4e00\uff0c\u5efa\u8bae\u914d\u5408\u670d\u52a1\u540d"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",null,"uri"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8def\u7531\u5339\u914d\u540e,\u63d0\u4f9b\u670d\u52a1\u7684URI"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",null,"predicates"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u65ad\u8a00\uff0c\u5224\u65ad\u8bf7\u6c42\u7684\u8def\u7531\u662f\u5426\u4e0e\u4e4b\u5339\u914d",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u662f\u4e00\u4e2a ",(0,l.kt)("font",{color:"blue"},"Map<String,String>")," "))),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u8def\u7531\u4e0ePredicates \u5339\u914d\u65f6\uff0c\u4f1a\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230 \u914d\u7f6e\u7684",(0,l.kt)("font",{color:"purple"},">",(0,l.kt)("inlineCode",{parentName:"li"},"URI+\u8bf7\u6c42PATH"))," \u4e0a\u53bb"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u505a\u4e86\u8def\u7531\u6620\u5c04\u4e4b\u540e\uff0c\u65e2\u53ef\u4ee5\u901a\u8fc7\u7f51\u5173\u7684uri \u8bbf\u95ee\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 \u8def\u7531\u5730\u5740\u7684uri \u8bbf\u95ee"))))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2460\u3001 \u5f15\u5165\u4f9d\u8d56\uff0c\u4e0d\u9700\u8981\u5f15\u5165 web\u7684\u4f9d\u8d56")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n  <dependency>\n    <groupId>org.projectlombok</groupId>\n    <artifactId>lombok</artifactId>\n    <optional>true</optional>\n  </dependency>\n  <dependency>\n    <groupId>org.yoey</groupId>\n    <artifactId>cloud-api-commons</artifactId>\n    <version>${cloud-api-commons.version}</version>\n  </dependency>\n  <dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-actuator</artifactId>\n  </dependency>\n  \x3c!--\u5f15\u5165Consul-discovery \u548c Gateway --\x3e\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-consul-discovery</artifactId>\n  </dependency>\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-gateway</artifactId>\n  </dependency>\n</dependencies>\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2461\u3001 \u914d\u7f6eapplication.yml")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 9527\nspring:\n  application:\n    name: cloud-gateway-gateway-9527\n  cloud:\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        service-name: cloud-gateway\n        instance-id: ${spring.application.name}\n    gateway:\n      routes:\n        - id: payment8003_route1      # \u8def\u7531ID,\u6ca1\u6709\u56fa\u5b9a\u7684\u89c4\u5219\u4f46\u8981\u6c42\u552f\u4e00\uff0c\u5efa\u8bae\u914d\u5408\u670d\u52a1\u540d\n          uri: http://localhost:8003  # \u8def\u7531\u5339\u914d\u540e\u63d0\u4f9b\u670d\u52a1\u7684\u5730\u5740\n          predicates:\n            - Path=/payment/get/**   # \u65ad\u8a00\uff0c\u8def\u5f84\u76f8\u5339\u914d\u7684\u8fdb\u884c\u8def\u7531\n")),(0,l.kt)("h3",{id:"22-\u914d\u7f6e\u8def\u7531"},"2.2 \u914d\u7f6e\u8def\u7531"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"GateWay\u63d0\u4f9b\u4e24\u79cd\u65b9\u5f0f\u914d\u7f6e\u8def\u7531"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u914d\u7f6eapplication.yml")),(0,l.kt)("li",{parentName:"ol"},"\u5411\u5bb9\u5668\u4e2d\u6ce8\u5165 ",(0,l.kt)("inlineCode",{parentName:"li"},"RouterLocator"),"\xa0\u7684Bean")))),(0,l.kt)("h4",{id:"221-\u6ce8\u5165bean-\u7684\u65b9\u5f0f\u914d\u7f6e\u8def\u7531"},"2.2.1 \u6ce8\u5165Bean \u7684\u65b9\u5f0f\u914d\u7f6e\u8def\u7531"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"GateWay \u652f\u6301\u91c7\u7528fluent api \u7684\u65b9\u5f0f\u6ce8\u5165 RouterLocator Bean\u7684\u65b9\u5f0f\u5411\u6ce8\u5165\u8def\u7531")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5e38\u89c1\u7684\u7c7b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"RouteLocatorBuilder")," : \u7528\u4e8e\u6784\u5efa\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"RouteLocator")," \u5bf9\u8c61"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"builder.routes().route(String id, Function<PredicateSpec, Route.AsyncBuilder> fn)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"id")," : \u8def\u7531\u7684id"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"fn"),": \u51fd\u6570\u5f0f\u63a5\u53e3\uff0c\u7528\u4e8e\u6784\u5efa\u4e00\u4e2afluent api \u7684\u8def\u7531"))))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u64cd\u4f5c\u6b65\u9aa4"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5411\u5bb9\u5668\u4e2d\u6ce8\u5165 ",(0,l.kt)("inlineCode",{parentName:"li"},"RouterLocator"))))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u914d\u7f6e\u7c7b\u4e2d\u6ce8\u5165 RouterLocator \u7684Bean")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class RouteConfig {\n    @Bean\n    public RouteLocator routes(RouteLocatorBuilder builder){\n        RouteLocatorBuilder.Builder routes = builder.routes();\n        return routes.route("path_route_news",\n                r->r.path("/*")\n                     .uri("http://news.baidu.com")).build();\n    }\n}\n')),(0,l.kt)("h4",{id:"222-\u901a\u8fc7\u5fae\u670d\u52a1\u540d\u5b9e\u73b0\u52a8\u6001\u8def\u7531"},"2.2.2 \u901a\u8fc7\u5fae\u670d\u52a1\u540d\u5b9e\u73b0\u52a8\u6001\u8def\u7531"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9ed8\u8ba4\u60c5\u51b5\u4e0bGateway\u4f1a\u6839\u636e\u6ce8\u518c\u4e2d\u5fc3\u7684\u670d\u52a1\u5217\u8868\uff0c\u4ee5\u6ce8\u518c\u4e2d\u5fc3\u4e0a\u5fae\u670d\u52a1\u540d\u4e3a\u8def\u5f84\u521b\u5efa\u52a8\u6001\u8def\u7531\u8fdb\u884c\u8f6c\u53d1\uff0c\u4ece\u800c\u5b9e\u73b0\u52a8\u6001\u8def\u7531\u7684\u529f\u80fd")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u64cd\u4f5c\u6b65\u9aa4"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u914d\u7f6eapplication.yml",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.gateway.discovery.locator.enabled"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u662f\u5426\u5f00\u542f\u4ece\u6ce8\u518c\u4e2d\u5fc3\u52a8\u6001\u521b\u5efa\u8def\u7531\u7684\u529f\u80fd\uff0c\u5229\u7528\u670d\u52a1\u540d\u8fdb\u884c\u8def\u7531"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.gateway.routes.uri"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u7528\u670d\u52a1\u540d\u505a\u8def\u7531\uff0cURL\u91c7\u7528",(0,l.kt)("inlineCode",{parentName:"li"},"lb://serviceName"),"\u7684\u683c\u5f0f"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.loadbalancer.ribbon.enabled")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u662f\u5426\u542f\u7528Ribbon\u4f5c\u4e3a\u8d1f\u8f7d\u5747\u8861,\u9ed8\u8ba4\u91c7\u7528\u7684\u662f ",(0,l.kt)("em",{parentName:"li"},"SpringCloud LoadBalancer"),",\u4e14\u53ea\u6709\u8f6e\u8be2\u8d1f\u8f7d")))))),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u2460\u3001 \u914d\u7f6eapplication.yml")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 9527\nspring:\n  application:\n    name: cloud-consul-gateway-9527\n  cloud:\n    gateway:\n      discovery:\n        locator:\n          enabled: true                             # \u5f00\u542f\u4ece\u6ce8\u518c\u4e2d\u5fc3\u52a8\u6001\u521b\u5efa\u8def\u7531\u7684\u529f\u80fd\uff0c\u5229\u7528\u670d\u52a1\u540d\u8fdb\u884c\u8def\u7531\n      routes:\n        - id: route_by_consul\n          uri: lb://cloud-payment-service-consul    # \u6307\u5b9a\u4ece\u90a3\u4e2a\u670d\u52a1\u4e2d\u83b7\u53d6api\u670d\u52a1\n          predicates:\n            - Path=/payment/**\n    loadbalancer:\n      ribbon:\n        enabled: true                           # \u91c7\u7528Ribbon\u4f5c\u4e3a\u670d\u52a1\u7684\u8d1f\u8f7d\u5747\u8861\u7ec4\u4ef6\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        service-name: cloud-consul-gateway\n        instance-id: ${spring.application.name}\n")))),(0,l.kt)("p",null,"  ",(0,l.kt)("strong",{parentName:"p"},"\u2461\u3001 \u542f\u7528Ribbon\u4f5c\u4e3a\u8d1f\u8f7d\u5747\u8861\u7ec4\u4ef6\u540e\uff0c\u6ce8\u5165\u968f\u673a\u8d1f\u8f7d\u5747\u8861\u89c4\u5219")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@SpringBootApplication\npublic class GatewayConsulApplication {\n    public static void main(String[] args){\n        SpringApplication.run(GatewayConsulApplication.class,args);\n    }\n\n    @Bean\n    public IRule rule(){\n        return new RandomRule();\n    }\n}\n")),(0,l.kt)("h3",{id:"23-\u65ad\u8a00predicate"},"2.3 \u65ad\u8a00Predicate"),(0,l.kt)("h4",{id:"231-predict\u6982\u8ff0"},"2.3.1 Predict\u6982\u8ff0"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"Predicate\u5c31\u662f\u4e3a\u4e86\u5b9e\u73b0\u4e00\u7ec4\u5339\u914d\u89c4\u5219\uff0c\u8ba9\u8bf7\u6c42\u8fc7\u6765\u627e\u5230\u5bf9\u5e94\u7684 Route \u8fdb\u884c\u5904\u7406")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"GateWay \u5728\u521b\u5efa\u8def\u7531route \u5bf9\u8c61\u65f6\uff0c\u4f7f\u7528RoutePredictFactory \u521b\u5efaPredicate \u5bf9\u8c61"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u8fd9\u4e9bPredicate \u4f1a\u5339\u914d",(0,l.kt)("mark",null,"HTTP\u8bf7\u6c42\u7684\u4e0d\u540c\u5c5e\u6027"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u4e0d\u540c\u7684Predicate\u53ef\u4ee5\u7ec4\u5408\uff0c\u4f7f\u7528\u903b\u8f91and\u7ec4\u5408")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},(0,l.kt)("strong",null,"\u5e38\u89c1\u7684\u65ad\u8a00\u5bf9\u8c61\u6709\uff1a")))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20201209214424354",src:a(71513).Z,width:"1107",height:"587"})),(0,l.kt)("h4",{id:"232-afterbeforebetweenpredicate"},"2.3.2 After/Before/BetweenPredicate"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"}),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: after_route\n        uri: https://example.org\n        predicates:\n        - After=2017-01-20T17:42:47.789-07:00[America/Denver]\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"Predicate \u5982\u4f55\u5224\u65ad\u5e26\u65f6\u533a\u7684\u65f6\u95f4\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7",(0,l.kt)("font",{color:"red"},(0,l.kt)("inlineCode",{parentName:"li"},"ZonedDateTime")),"\u5224\u65ad")))),(0,l.kt)("h5",{id:"2321-\u793a\u4f8b"},"2.3.2.1 \u793a\u4f8b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 9527\nspring:\n  application:\n    name: cloud-consul-gateway-9527\n  cloud:\n    gateway:\n      discovery:\n        locator:\n          enabled: true                             # \u5f00\u542f\u4ece\u6ce8\u518c\u4e2d\u5fc3\u52a8\u6001\u521b\u5efa\u8def\u7531\u7684\u529f\u80fd\uff0c\u5229\u7528\u670d\u52a1\u540d\u8fdb\u884c\u8def\u7531\n      routes:\n        - id: route_by_consul\n          uri: lb://cloud-payment-service-consul    # \u6307\u5b9a\u4ece\u90a3\u4e2a\u670d\u52a1\u4e2d\u83b7\u53d6api\u670d\u52a1\n          predicates:\n            - Path=/payment/**\n            - After=2020-12-11T20:01:43.092+08:00[Asia/Shanghai]\n    loadbalancer:\n      ribbon:\n        enabled: true\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        service-name: cloud-consul-gateway\n        instance-id: ${spring.application.name}\n")),(0,l.kt)("h4",{id:"233-methodpredict"},"2.3.3 MethodPredict"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u8bf7\u6c42\u65b9\u6cd5\u4e0e\u6307\u5b9a\u7684\u5339\u914d"))),(0,l.kt)("h5",{id:"2331-\u793a\u4f8b"},"2.3.3.1 \u793a\u4f8b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 9527\nspring:\n  application:\n    name: cloud-consul-gateway-9527\n  cloud:\n    gateway:\n      discovery:\n        locator:\n          enabled: true                             # \u5f00\u542f\u4ece\u6ce8\u518c\u4e2d\u5fc3\u52a8\u6001\u521b\u5efa\u8def\u7531\u7684\u529f\u80fd\uff0c\u5229\u7528\u670d\u52a1\u540d\u8fdb\u884c\u8def\u7531\n      routes:\n        - id: route_by_consul\n          uri: lb://cloud-payment-service-consul    # \u6307\u5b9a\u4ece\u90a3\u4e2a\u670d\u52a1\u4e2d\u83b7\u53d6api\u670d\u52a1\n          predicates:\n            - Path=/payment/**\n            - Method=POST,DELETE,PUT\n    loadbalancer:\n      ribbon:\n        enabled: true\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        service-name: cloud-consul-gateway\n        instance-id: ${spring.application.name}\n")),(0,l.kt)("h3",{id:"24-\u8fc7\u6ee4\u5668filter"},"2.4 \u8fc7\u6ee4\u5668Filter"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u4f7f\u7528\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u5728\u8bf7\u6c42\u88ab\u8def\u7531\u524d\u6216\u8005\u4e4b\u540e\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4fee\u6539")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u8fc7\u6ee4\u5668\u5206\u7c7b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u6309\u751f\u547d\u5468\u671f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"pre")," : \u524d\u7f6e\u8fc7\u6ee4\u5668\uff0c\u5728\u6267\u884c\u4e1a\u52a1\u903b\u8f91\u4e4b\u524d\u8c03\u7528"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"post"),": \u540e\u7f6e\u8fc7\u6ee4\u5668\uff0c\u5728\u6267\u884c\u4e1a\u52a1\u903b\u8f91\u4e4b\u540e\u8c03\u7528"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u6309\u79cd\u7c7b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Global Filter")," : \u5168\u5c40\u8fc7\u6ee4\u5668"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Gateway Filter"),": \u5c40\u90e8\u8fc7\u6ee4\u5668"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#global-filters"},"\u5e38\u89c1\u7684Global Filter"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/#gatewayfilter-factories"},"\u5e38\u89c1\u7684Global Filter")))),(0,l.kt)("h4",{id:"241-\u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668"},"2.4.1 \u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6709\u4f55\u4f5c\u7528\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u5168\u5c40\u65e5\u5fd7\u8bb0\u5f55")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"},"\u7edf\u4e00\u7f51\u5173\u9274\u6743")),(0,l.kt)("li",{parentName:"ul"},"..."))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5e38\u89c1\u7684\u63a5\u53e3"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"GlobalFilter"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5168\u5c40\u8fc7\u6ee4\u5668\u63a5\u53e3"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"ServerWebExchange"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Web\u670d\u52a1\u4ea4\u6362\u673a"),(0,l.kt)("li",{parentName:"ul"},"\u63d0\u4f9b\u5bf9HTTP\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u8bbf\u95ee\uff0c\u8fd8\u516c\u5f00\u5176\u4ed6\u4e0e\u670d\u52a1\u5668\u7aef\u5904\u7406\u76f8\u5173\u7684\u5c5e\u6027\u548c\u7279\u6027\uff0c\u5982\u8bf7\u6c42\u5c5e\u6027"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"GatewayFilterChain"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5168\u5c40\u8fc7\u6ee4\u5668\u94fe"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u64cd\u4f5c\u6b65\u9aa4"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u521b\u5efa\u7c7b\u5b9e\u73b0 ",(0,l.kt)("inlineCode",{parentName:"li"},"GlobalFilter"))))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * <b>\u8bf7\u6c42\u62e6\u622a</b>\n * @author create by zyl\n * create at 2020/12/12 9:46 \u4e0a\u5348\n */\n\n@Component\n@Order(0)\n@Slf4j\npublic class LogGatewayFilter implements GlobalFilter {\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        log.warn("--------- call LogGatewayFilter --------------");\n        String hostString = exchange.getRequest().getRemoteAddress().getHostName();\n        String method = exchange.getRequest().getMethodValue();\n        String URI = exchange.getRequest().getURI().getPath();\n        log.warn("URI:{},method:{},hostString:{}",URI,method,hostString);\n        return chain.filter(exchange);\n    }\n}\n')))}m.isMDXComponent=!0},32214:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20201209192403387-870577df2df2f5cf0c42ba31e7dc069d.png"},71513:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20201209214424354-ddfe635f7382e9008e01741b0e3cd91b.png"}}]);