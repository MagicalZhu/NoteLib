"use strict";(self.webpackChunkhuakucha=self.webpackChunkhuakucha||[]).push([[2674],{20463:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>k,contentTitle:()=>i,default:()=>s,frontMatter:()=>n,metadata:()=>u,toc:()=>p});var l=a(87462),r=(a(67294),a(3905));a(61839);const n={id:"Eureka&Consul",title:"\u670d\u52a1\u6ce8\u518c-Eureka&Consul"},i=void 0,u={unversionedId:"SpringCloud/Netflix/Eureka&Consul",id:"SpringCloud/Netflix/Eureka&Consul",title:"\u670d\u52a1\u6ce8\u518c-Eureka&Consul",description:"1. Eureka \u7b80\u8ff0",source:"@site/docs/SpringCloud/Netflix/1.1\u670d\u52a1\u6ce8\u518c-Eureka\u548cConsul.md",sourceDirName:"SpringCloud/Netflix",slug:"/SpringCloud/Netflix/Eureka&Consul",permalink:"/docs/SpringCloud/Netflix/Eureka&Consul",draft:!1,editUrl:"https://github.com/MagicalZhu/NoteLib/tree/main/docs/SpringCloud/Netflix/1.1\u670d\u52a1\u6ce8\u518c-Eureka\u548cConsul.md",tags:[],version:"current",lastUpdatedBy:"YuLiang Zhu",lastUpdatedAt:1670289592,formattedLastUpdatedAt:"2022\u5e7412\u67086\u65e5",frontMatter:{id:"Eureka&Consul",title:"\u670d\u52a1\u6ce8\u518c-Eureka&Consul"},sidebar:"springCloudSideBar",previous:{title:"SpringCloud-Netflix",permalink:"/docs/category/springcloud-netflix"},next:{title:"\u670d\u52a1\u8c03\u7528-Ribbon",permalink:"/docs/SpringCloud/Netflix/Ribbon"}},k={},p=[{value:"1. Eureka \u7b80\u8ff0",id:"1-eureka-\u7b80\u8ff0",level:2},{value:"1.1 Eureka \u6982\u8ff0",id:"11-eureka-\u6982\u8ff0",level:3},{value:"1.2 Eureka\u7684\u57fa\u672c\u67b6\u6784",id:"12-eureka\u7684\u57fa\u672c\u67b6\u6784",level:4},{value:"1.3 Eureka\u5bf9\u6bd4Zookeeper",id:"13-eureka\u5bf9\u6bd4zookeeper",level:4},{value:"2. Spring Cloud \u6574\u5408Eureka - \u670d\u52a1\u6ce8\u518c",id:"2-spring-cloud-\u6574\u5408eureka---\u670d\u52a1\u6ce8\u518c",level:2},{value:"2.1 \u5355\u673a\u7248Eureka \u642d\u5efa",id:"21-\u5355\u673a\u7248eureka-\u642d\u5efa",level:3},{value:"2.1.1 Server \u642d\u5efa\u6b65\u9aa4",id:"211-server-\u642d\u5efa\u6b65\u9aa4",level:4},{value:"2.1.2 Eureka \u5ba2\u6237\u7aef\u6ce8\u518c\u5230Eureka\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3",id:"212-eureka-\u5ba2\u6237\u7aef\u6ce8\u518c\u5230eureka\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3",level:4},{value:"2.1.3 Eureka \u5ba2\u6237\u7aef\u6ce8\u518c\u4fe1\u606f\u5b8c\u5584",id:"213-eureka-\u5ba2\u6237\u7aef\u6ce8\u518c\u4fe1\u606f\u5b8c\u5584",level:4},{value:"2.1.3.1 Eureka \u5b9e\u4f8b\u7684ID(instanceId)",id:"2131-eureka-\u5b9e\u4f8b\u7684idinstanceid",level:5},{value:"2.1.3.2 \u4f7f\u7528ip\u5730\u5740\u8bbf\u95eeactuator \u76d1\u63a7\u670d\u52a1",id:"2132-\u4f7f\u7528ip\u5730\u5740\u8bbf\u95eeactuator-\u76d1\u63a7\u670d\u52a1",level:5},{value:"2.1.3.3 Eureka \u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff08\u9632\u6b62\u6389\u7ebf\u7684\u5fae\u670d\u52a1\u88ab\u610f\u5916\u5220\u9664\uff09",id:"2133-eureka-\u81ea\u6211\u4fdd\u62a4\u673a\u5236\u9632\u6b62\u6389\u7ebf\u7684\u5fae\u670d\u52a1\u88ab\u610f\u5916\u5220\u9664",level:5},{value:"2.2 \u201c\u96c6\u7fa4\u7248\u201dEureka \u642d\u5efa",id:"22-\u96c6\u7fa4\u7248eureka-\u642d\u5efa",level:3},{value:"2.3 @LoadBalanced",id:"23-loadbalanced",level:3},{value:"2.3.1 \u6539\u9020Eureka\u5ba2\u6237\u7aef\uff0c\u4f7f\u7528@LoadBalanced",id:"231-\u6539\u9020eureka\u5ba2\u6237\u7aef\u4f7f\u7528loadbalanced",level:4},{value:"2.4 \u670d\u52a1\u53d1\u73b0\u4ee5\u53ca @EnableDiscoveryClient",id:"24-\u670d\u52a1\u53d1\u73b0\u4ee5\u53ca-enablediscoveryclient",level:3},{value:"3. Consul",id:"3-consul",level:2},{value:"3.1 Consul \u6982\u8ff0",id:"31-consul-\u6982\u8ff0",level:3},{value:"3.2 \u670d\u52a1\u6ce8\u518c",id:"32-\u670d\u52a1\u6ce8\u518c",level:3}],o={toc:p};function s(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,l.Z)({},o,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"1-eureka-\u7b80\u8ff0"},"1. Eureka \u7b80\u8ff0"),(0,r.kt)("h3",{id:"11-eureka-\u6982\u8ff0"},"1.1 Eureka \u6982\u8ff0"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Eureka\u8d1f\u8d23",(0,r.kt)("font",{color:"blue"},(0,r.kt)("strong",{parentName:"li"},"\u670d\u52a1\u6ce8\u518c\u548c \u670d\u52a1\u53d1\u73b0"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"blue"},"Eureka\u662fNetflix\u7684\u4e00\u4e2a\u5b50\u6a21\u5757\uff0c\u4e5f\u662f\u6838\u5fc3\u6a21\u5757\u4e4b\u4e00")),(0,r.kt)("li",{parentName:"ul"},"Eureka\u662f\u4e00\u4e2a\u57fa\u4e8eREST\u7684\u670d\u52a1\uff0c\u7528\u4e8e\u5b9a\u4f4d\u670d\u52a1\uff0c\u4ee5\u5b9e\u73b0\u4e91\u7aef\u4e2d\u95f4\u5c42\u670d\u52a1\u53d1\u73b0\u548c\u6545\u969c\u8f6c\u79fb\u3002",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u901a\u8fc7\u670d\u52a1\u53d1\u73b0\u4e0e\u6ce8\u518c\uff0c\u53ea\u9700\u8981\u4f7f\u7528\u670d\u52a1\u7684\u6807\u8bc6\u7b26\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5230\u670d\u52a1\uff0c\u800c\u4e0d\u9700\u8981\u4fee\u6539\u670d\u52a1\u8c03\u7528\u7684\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("li",{parentName:"ul"},"\u529f\u80fd\u7c7b\u4f3c\u4e8edubbo\u7684\u6ce8\u518c\u4e2d\u5fc3\uff0c\u6bd4\u5982Zookeeper")))),(0,r.kt)("h4",{id:"12-eureka\u7684\u57fa\u672c\u67b6\u6784"},"1.2 Eureka\u7684\u57fa\u672c\u67b6\u6784"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"blue"},"Eureka \u91c7\u7528\u4e86 C-S \u7684\u8bbe\u8ba1\u67b6\u6784"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"Eureka Server \u4f5c\u4e3a\u670d\u52a1\u6ce8\u518c\u529f\u80fd\u7684\u670d\u52a1\u5668\uff0c\u5b83\u662f\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u5fae\u670d\u52a1\uff0c\u4f7f\u7528 Eureka \u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5230 Eureka Server\u5e76\u7ef4\u6301\u5fc3\u8df3\u8fde\u63a5"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Spring Cloud \u7684\u4e00\u4e9b\u5176\u4ed6\u6a21\u5757\u5c31\u53ef\u4ee5\u901a\u8fc7 Eureka Server \u6765\u53d1\u73b0\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u5fae\u670d\u52a1,\u5e76\u6267\u884c\u76f8\u5173\u7684\u903b\u8f91"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"blue"},"Eureka \u5305\u542b\u7684\u4e24\u4e2a\u7ec4\u4ef6"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Eureka Server"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u63d0\u4f9b\u670d\u52a1\u6ce8\u518c\u670d\u52a1")),(0,r.kt)("li",{parentName:"ul"},"\u5404\u4e2a\u8282\u70b9\u542f\u52a8\u540e\uff0c\u4f1a\u5728EurekaServer\u4e2d\u8fdb\u884c\u6ce8\u518c\uff0c\u8fd9\u6837Eureka Server\u4e2d\u7684\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u5c06\u4f1a\u5b58\u50a8\u6240\u6709\u53ef\u7528\u670d\u52a1\u8282\u70b9\u7684\u4fe1\u606f"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Eureka Client"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u7528\u4e8e\u7b80\u5316Eureka Server\u7684\u4ea4\u4e92,\u5ba2\u6237\u7aef\u540c\u65f6\u4e5f\u5177\u5907\u4e00\u4e2a\u5185\u7f6e\u7684\u3001\u4f7f\u7528\u8f6e\u8be2\u8d1f\u8f7d\u7b97\u6cd5\u7684\u8d1f\u8f7d\u5747\u8861\u5668"),"\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5728\u5e94\u7528\u542f\u52a8\u540e\uff0c\u5c06\u4f1a\u5411Eureka Server\u53d1\u9001\u5fc3\u8df3(\u9ed8\u8ba4\u5468\u671f\u4e3a30\u79d2),\u5982\u679cEureka Server\u5728\u591a\u4e2a\u5fc3\u8df3\u5468\u671f\u5185\u6ca1\u6709\u63a5\u6536\u5230\u67d0\u4e2a\u8282\u70b9\u7684\u5fc3\u8df3,\u5c31\u4f1a\u4ece\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u628a\u8fd9\u4e2a\u670d\u52a1\u8282\u70b9\u79fb\u9664\uff08\u9ed8\u8ba490\u79d2\uff09")))))),(0,r.kt)("h4",{id:"13-eureka\u5bf9\u6bd4zookeeper"},"1.3 Eureka\u5bf9\u6bd4Zookeeper"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Zookeeper \u6ee1\u8db3 ",(0,r.kt)("inlineCode",{parentName:"p"},"CP")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"\u4e00\u81f4\u6027 \u548c \u5206\u533a\u5bb9\u9519\u6027")),(0,r.kt)("li",{parentName:"ul"},"\u5f53\u5411\u6ce8\u518c\u4e2d\u5fc3\u67e5\u8be2\u670d\u52a1\u5217\u8868\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5bb9\u5fcd\u6ce8\u518c\u4e2d\u5fc3\u8fd4\u56de\u7684\u662f\u51e0\u5206\u949f\u4ee5\u524d\u7684\u6ce8\u518c\u4fe1\u606f\uff0c\u4f46\u4e0d\u80fd\u63a5\u53d7\u670d\u52a1\u76f4\u63a5down\u6389\u4e0d\u53ef\u7528",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u8bf4\uff0c\u670d\u52a1\u6ce8\u518c\u529f\u80fd\u5bf9\u53ef\u7528\u6027\u7684\u8981\u6c42\u8981\u9ad8\u4e8e\u4e00\u81f4\u6027"))),(0,r.kt)("li",{parentName:"ul"},"Zookeeper \u4f1a\u51fa\u73b0\u8fd9\u6837\u4e00\u79cd\u60c5\u51b5\uff0c\u5f53master\u8282\u70b9\u56e0\u4e3a\u7f51\u7edc\u6545\u969c\u4e0e\u5176\u4ed6\u8282\u70b9\u5931\u53bb\u8054\u7cfb\u65f6\uff0c\u5269\u4f59\u8282\u70b9\u4f1a\u91cd\u65b0\u8fdb\u884cleader\u9009\u4e3e",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u800c \u9009\u4e3eleader\u7684\u65f6\u95f4\u592a\u957f\uff0c30 ~ 120s, \u4e14\u9009\u4e3e\u671f\u95f4\u6574\u4e2aZookeeper  \u96c6\u7fa4\u90fd\u662f\u4e0d\u53ef\u7528\u7684\uff0c\u8fd9\u5c31\u5bfc\u81f4\u5728\u9009\u4e3e\u671f\u95f4\u6ce8\u518c\u670d\u52a1\u762b\u75ea"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Eureka \u6ee1\u8db3 ",(0,r.kt)("inlineCode",{parentName:"p"},"AP")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"\u53ef\u7528\u6027 \u548c \u5206\u533a\u5bb9\u9519\u6027"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"Eureka\u5404\u4e2a\u8282\u70b9\u90fd\u662f\u5e73\u7b49\u7684\uff0c\u51e0\u4e2a\u8282\u70b9\u6302\u6389\u4e0d\u4f1a\u5f71\u54cd\u6b63\u5e38\u8282\u70b9\u7684\u5de5\u4f5c\uff0c\u5269\u4f59\u7684\u8282\u70b9\u4f9d\u7136\u53ef\u4ee5\u63d0\u4f9b\u6ce8\u518c\u548c\u67e5\u8be2\u670d\u52a1"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Eureka\u7684\u5ba2\u6237\u7aef\u5728\u5411\u67d0\u4e2aEureka\u6ce8\u518c\u6216\u65f6\u5982\u679c\u53d1\u73b0\u8fde\u63a5\u5931\u8d25\uff0c\u5219\u4f1a\u81ea\u52a8\u5207\u6362\u81f3\u5176\u5b83\u8282\u70b9"),(0,r.kt)("li",{parentName:"ul"},"\u53ea\u8981\u6709\u4e00\u53f0Eureka\u8fd8\u5728\uff0c\u5c31\u80fd\u4fdd\u8bc1\u6ce8\u518c\u670d\u52a1\u53ef\u7528(\u4fdd\u8bc1\u53ef\u7528\u6027)"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"}," Eureka\u53ef\u4ee5\u5f88\u597d\u7684\u5e94\u5bf9\u56e0\u7f51\u7edc\u6545\u969c\u5bfc\u81f4\u90e8\u5206\u8282\u70b9\u5931\u53bb\u8054\u7cfb\u7684\u60c5\u51b5\uff0c\u800c\u4e0d\u4f1a\u50cfzookeeper\u90a3\u6837\u4f7f\u6574\u4e2a\u6ce8\u518c\u670d\u52a1\u762b\u75ea"))))),(0,r.kt)("h2",{id:"2-spring-cloud-\u6574\u5408eureka---\u670d\u52a1\u6ce8\u518c"},"2. Spring Cloud \u6574\u5408Eureka - \u670d\u52a1\u6ce8\u518c"),(0,r.kt)("blockquote",null,(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"\u670d\u52a1\u6ce8\u518c\uff1a \u5c06\u670d\u52a1\u4fe1\u606f\u6ce8\u518c\u8fdb\u6ce8\u518c\u4e2d\u5fc3",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Key\u5b58\u670d\u52a1\u540d\uff0cValue \u5b58\u670d\u52a1\u5730\u5740"))),(0,r.kt)("li",{parentName:"ul"},"\u670d\u52a1\u53d1\u73b0\uff1a \u4ece\u6ce8\u518c\u4e2d\u5fc3\u4e2d\u83b7\u53d6\u670d\u52a1\u4fe1\u606f"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image-20201204135537951",src:a(97777).Z,width:"1360",height:"423"})),(0,r.kt)("h3",{id:"21-\u5355\u673a\u7248eureka-\u642d\u5efa"},"2.1 \u5355\u673a\u7248Eureka \u642d\u5efa"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"eureka_config"},"Eureka SpringBoot \u914d\u7f6e\u6587\u4ef6\u7684\u914d\u7f6e\u4fe1\u606f\u8bf4\u660e")),(0,r.kt)("h4",{id:"211-server-\u642d\u5efa\u6b65\u9aa4"},"2.1.1 Server \u642d\u5efa\u6b65\u9aa4"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5f15\u5165",(0,r.kt)("font",{color:"green"}," ",(0,r.kt)("inlineCode",{parentName:"p"},"eureka-server"))," \u7684\u4f9d\u8d56 ")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u914d\u7f6eapplication.yml"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u4e3b\u8981\u6709\u4e09\u4e2a\u5927\u8282\u70b9",(0,r.kt)("font",{color:"red"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"instance\u3001server\u3001client")))),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},(0,r.kt)("strong",null,"instance")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"eureka \u5b9e\u4f8b\u8282\u70b9\u914d\u7f6e")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"\u5e38\u89c1\u7684\u53c2\u6570\u914d\u7f6e"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"hostname"),"\t: \u5b9e\u4f8b\u4e3b\u673a\u540d"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ip-address"),"  : \u5b9e\u4f8bip\u5730\u5740 "))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},(0,r.kt)("strong",null,"server")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"eureka \u670d\u52a1\u7aef\u914d\u7f6e "))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},(0,r.kt)("strong",null,"client")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"eureka \u5ba2\u6237\u7aef\u914d\u7f6e")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"\u5e38\u89c1\u7684\u53c2\u6570\u914d\u7f6e"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"service-url"),": eureka\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740( \u9ed8\u8ba4\u662f ",(0,r.kt)("font",{color:"green"},(0,r.kt)("em",null,"defaultZone")),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"register-with-eureka"),"\uff1a \u662f\u5426\u6ce8\u518c\u5230eureka \u6ce8\u518c\u4e2d\u5fc3"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fetch-registry")," : \u662f\u5426\u4ece\u6ce8\u518c\u4e2d\u5fc3\u83b7\u53d6\u670d\u52a1\u6ce8\u518c\u4fe1\u606f"))))))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@EnableEurekaServer"),": \u6ce8\u89e3\u542f\u7528 eureka-server"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"\u2460\u3001 \u914d\u7f6eapplication.yml")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 7001\nspring:\n  application:\n    name: cloud-eureka-server-7001\neureka:\n  instance:\n    hostname: localhost                   # eureka\u5b9e\u4f8b\u4e3b\u673a\u540d\n    ip-address: 172.24.230.136            # eureka\u5b9e\u4f8bip\n  client:\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/    # eureka\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\n    register-with-eureka: false           # \u662f\u5426\u6ce8\u518c\u5230eureka \u6ce8\u518c\u4e2d\u5fc3\n    fetch-registry: false                 # \u662f\u5426\u4eceeureka\u6ce8\u518c\u4e2d\u5fc3\u83b7\u53d6\u670d\u52a1\u6ce8\u518c\u4fe1\u606f\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"\u2461\u3001 \u6807\u8bb0\u4e00\u4e2aeureka-server")))),(0,r.kt)("p",null,"\u4f1a\u5411Spring \u5bb9\u5668\u4e2d\u6ce8\u5165eureka-server \u76f8\u5173\u7684Bean",(0,r.kt)("inlineCode",{parentName:"p"},"EurekaServerAutoConfiguration")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)\n@EnableEurekaServer\npublic class EurekaServer7001 {\n    public static void main(String[] args) {\n        SpringApplication.run(EurekaServer7001.class,args);\n    }\n}\n")),(0,r.kt)("h4",{id:"212-eureka-\u5ba2\u6237\u7aef\u6ce8\u518c\u5230eureka\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3"},"2.1.2 Eureka \u5ba2\u6237\u7aef\u6ce8\u518c\u5230Eureka\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u64cd\u4f5c\u6b65\u9aa4"))),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5f15\u5165",(0,r.kt)("font",{color:"green"}," ",(0,r.kt)("inlineCode",{parentName:"li"},"eureka-client"))," \u7684\u4f9d\u8d56 "),(0,r.kt)("li",{parentName:"ol"},"\u914d\u7f6e application.yml,\u540c eureka-server \u8282\u70b9\uff0c\u4f46\u662f\u9700\u8981\u8d4b\u4e88\u83b7\u53d6\u6ce8\u518c\u4e2d\u5fc3\u4fe1\u606f\u3001\u6ce8\u518c\u5230\u6ce8\u518c\u4e2d\u5fc3\u7684\u80fd\u529b"),(0,r.kt)("li",{parentName:"ol"},"\u4f7f\u7528",(0,r.kt)("font",{color:"red"},(0,r.kt)("inlineCode",{parentName:"li"},"@EnableEurekaClient"))," \u6ce8\u89e3\u6807\u8bb0\u4e00\u4e2aEureka\u5ba2\u6237\u7aef")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2460\u3001 \u914d\u7f6eapplication.yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"eureka:\n  instance:\n    hostname: localhost                   # eureka\u5b9e\u4f8b\u4e3b\u673a\u540d\n    ip-address: 172.24.230.136            # eureka\u5b9e\u4f8bip\n  client:\n    fetch-registry: true\n    register-with-eureka: true\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:7001/eureka/    # eureka\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2461\u3001 \u6807\u8bb0\u4e00\u4e2aeureka-client")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@SpringBootApplication\n@EnableEurekaClient\npublic class PaymentApplication8001 {\n    public static void main(String[] args) {\n        SpringApplication.run(PaymentApplication8001.class,args);\n    }\n}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2462\u3001\u6ce8\u518c\u4e2d\u5fc3\u754c\u9762")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image-20201204131424739",src:a(81129).Z,width:"1549",height:"829"})),(0,r.kt)("h4",{id:"213-eureka-\u5ba2\u6237\u7aef\u6ce8\u518c\u4fe1\u606f\u5b8c\u5584"},"2.1.3 Eureka \u5ba2\u6237\u7aef\u6ce8\u518c\u4fe1\u606f\u5b8c\u5584"),(0,r.kt)("h5",{id:"2131-eureka-\u5b9e\u4f8b\u7684idinstanceid"},"2.1.3.1 Eureka \u5b9e\u4f8b\u7684ID(instanceId)"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u5b9e\u4f8bID = ",(0,r.kt)("inlineCode",{parentName:"li"},"\u4e3b\u673aip:${spring.application.name}:${server.port}"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u901a\u8fc7",(0,r.kt)("font",{color:"blue"},(0,r.kt)("inlineCode",{parentName:"li"},"eureka.instance.instance-id"))," \u4fee\u6539 \u5b9e\u4f8bID")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2460\u3001 \u4fee\u6539yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"eureka:\n  instance:\n    hostname: localhost                   # eureka\u5b9e\u4f8b\u4e3b\u673a\u540d\n    ip-address: 172.24.230.136            # eureka\u5b9e\u4f8bip\n    instance-id: cloud-payment-service\n  client:\n    fetch-registry: true\n    register-with-eureka: true\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:7001/eureka/    # eureka\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2461\u3001 \u6ce8\u518c\u4e2d\u5fc3")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image-20201204132228243",src:a(52168).Z,width:"1363",height:"176"})),(0,r.kt)("h5",{id:"2132-\u4f7f\u7528ip\u5730\u5740\u8bbf\u95eeactuator-\u76d1\u63a7\u670d\u52a1"},"2.1.3.2 \u4f7f\u7528ip\u5730\u5740\u8bbf\u95eeactuator \u76d1\u63a7\u670d\u52a1"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528`\u4e3b\u673a\u540d` \u6ce8\u518c\u5230eureka"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5373 ",(0,r.kt)("inlineCode",{parentName:"li"},"${eureka.instance.hostname}:${server.port}/info")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u901a\u8fc7",(0,r.kt)("font",{color:"blue"},(0,r.kt)("inlineCode",{parentName:"p"},"eureka.instance.prefer-ip-address")),"  \u4f7f\u7528ip \u6ce8\u518c"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2460\u3001 \u4fee\u6539yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"eureka:\n  instance:\n    hostname: localhost                   # eureka\u5b9e\u4f8b\u4e3b\u673a\u540d\n    ip-address: 172.24.230.136            # eureka\u5b9e\u4f8bip\n    prefer-ip-address: true                             # \u4f7f\u7528ip \u6ce8\u518c\n    instance-id: cloud-payment-service\n  client:\n    fetch-registry: true\n    register-with-eureka: true\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:7001/eureka/    # eureka\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2461\u3001 \u6ce8\u518c\u4e2d\u5fc3")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image-20201204133124813",src:a(56923).Z,width:"535",height:"195"})),(0,r.kt)("h5",{id:"2133-eureka-\u81ea\u6211\u4fdd\u62a4\u673a\u5236\u9632\u6b62\u6389\u7ebf\u7684\u5fae\u670d\u52a1\u88ab\u610f\u5916\u5220\u9664"},"2.1.3.3 Eureka \u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff08\u9632\u6b62\u6389\u7ebf\u7684\u5fae\u670d\u52a1\u88ab\u610f\u5916\u5220\u9664\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"\u81ea\u6211\u4fdd\u62a4\u6a21\u5f0f\u662f\u4e00\u79cd\u5e94\u5bf9\u7f51\u7edc\u5f02\u5e38\u7684\u5b89\u5168\u4fdd\u62a4\u63aa\u65bd"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679cEurekaServer\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\u6ca1\u6709\u63a5\u6536\u5230\u67d0\u4e2a\u5fae\u670d\u52a1\u5b9e\u4f8b\u7684\u5fc3\u8df3\uff0cEurekaServer\u5c06\u4f1a\u6ce8\u9500\u8be5\u5b9e\u4f8b\uff08\u9ed8\u8ba490\u79d2\uff09"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4f46\u662f\u5f53\u7f51\u7edc\u5206\u533a\u6545\u969c\u53d1\u751f\u65f6\uff0c\u5fae\u670d\u52a1\u4e0eEureka Server\u4e4b\u95f4\u65e0\u6cd5\u6b63\u5e38\u901a\u4fe1\uff0c\u4ee5\u4e0a\u884c\u4e3a\u53ef\u80fd\u53d8\u5f97\u975e\u5e38\u5371\u9669\u4e86,\u56e0\u4e3a\u5fae\u670d\u52a1\u672c\u8eab\u5176\u5b9e\u662f\u5065\u5eb7\u7684\uff0c\u6b64\u65f6\u672c\u4e0d\u5e94\u8be5\u6ce8\u9500\u8fd9\u4e2a\u5fae\u670d\u52a1"),(0,r.kt)("li",{parentName:"ul"},"Eureka\u901a\u8fc7 ",(0,r.kt)("font",{color:"blue"},"\u81ea\u6211\u4fdd\u62a4\u6a21\u5f0f")," \u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"blue"},"\u5f53Eureka Server\u8282\u70b9\u5728\u77ed\u65f6\u95f4\u5185\u4e22\u5931\u8fc7\u591a\u5ba2\u6237\u7aef\u65f6\uff08\u53ef\u80fd\u53d1\u751f\u4e86\u7f51\u7edc\u5206\u533a\u6545\u969c\uff09\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8282\u70b9\u5c31\u4f1a\u8fdb\u5165\u81ea\u6211\u4fdd\u62a4\u6a21\u5f0f")),(0,r.kt)("li",{parentName:"ul"},"\u4e00\u65e6\u8fdb\u5165\u8be5\u6a21\u5f0f\uff0cEureka Server\u5c31\u4f1a\u4fdd\u62a4\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u7684\u4fe1\u606f,\u4e0d\u518d\u5220\u9664\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u7684\u6570\u636e\uff08\u4e5f\u5c31\u662f\u4e0d\u4f1a\u6ce8\u9500\u4efb\u4f55\u5fae\u670d\u52a1\uff09",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5f53\u7f51\u7edc\u6545\u969c\u6062\u590d\u540e\uff0c\u8be5Eureka Server\u8282\u70b9\u4f1a\u81ea\u52a8\u9000\u51fa\u81ea\u6211\u4fdd\u62a4\u6a21\u5f0f"))),(0,r.kt)("li",{parentName:"ul"},"\u5b83\u7684\u67b6\u6784\u54f2\u5b66\u662f ",(0,r.kt)("font",{color:"blue"},"\u5b81\u53ef\u540c\u65f6\u4fdd\u7559\u6240\u6709\u5fae\u670d\u52a1\uff08\u5065\u5eb7\u7684\u5fae\u670d\u52a1\u548c\u4e0d\u5065\u5eb7\u7684\u5fae\u670d\u52a1\u90fd\u4f1a\u4fdd\u7559\uff09\uff0c\u4e5f\u4e0d\u76f2\u76ee\u6ce8\u9500\u4efb\u4f55\u5065\u5eb7\u7684\u5fae\u670d\u52a1"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u81ea\u6211\u4fdd\u62a4\u6a21\u5f0f\uff0c\u53ef\u4ee5\u8ba9Eureka\u96c6\u7fa4\u66f4\u52a0\u7684\u5065\u58ee\u3001\u7a33\u5b9a"))))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728Spring Cloud\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"eureka.server.enable-self-preservation = false")," \u7981\u7528\u81ea\u6211\u4fdd\u62a4\u6a21\u5f0f"))),(0,r.kt)("h3",{id:"22-\u96c6\u7fa4\u7248eureka-\u642d\u5efa"},"2.2 \u201c\u96c6\u7fa4\u7248\u201dEureka \u642d\u5efa"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u5c06\u5404\u4e2aeureka-server \u4e92\u76f8\u6ce8\u518c\u5230\u5bf9\u65b9\u7684\u6ce8\u518c\u4e2d\u5fc3\uff08 ",(0,r.kt)("mark",null,"\u4ec5\u9700\u8981\u6dfb\u52a0\u5230service-url\u5373\u53ef!")," \uff09"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5373 server \u8282\u70b9\u7684 service-url \u5206\u522b\u4e3a\u5bf9\u65b9\u7684\u6ce8\u518c\u5730\u5740\uff0c\u4e14Client\u8282\u70b9\u7684service-url \u914d\u7f6e\u6240\u6709\u7684server \u8282\u70b9\u4fe1\u606f")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2460\u3001 \u6ce8\u518c\u4e2d\u5fc37001 \u7684yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 7001\nspring:\n  application:\n    name: cloud-eureka-server-7001\neureka:\n  instance:\n    hostname: eureka7001                   # eureka\u5b9e\u4f8b\u4e3b\u673a\u540d\n    ip-address: 172.24.230.136            # eureka\u5b9e\u4f8bip\n  client:\n    register-with-eureka: false           # \u662f\u5426\u6ce8\u518c\u5230eureka \u6ce8\u518c\u4e2d\u5fc3\n    fetch-registry: false                 # \u662f\u5426\u4eceeureka\u6ce8\u518c\u4e2d\u5fc3\u83b7\u53d6\u670d\u52a1\u6ce8\u518c\u4fe1\u606f\n    service-url:\n      defaultZone: http://eureka7002:7002/eureka/    # eureka\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\n\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2461\u3001 \u6ce8\u518c\u4e2d\u5fc37002 \u7684yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 7002\nspring:\n  application:\n    name: cloud-eureka-server-7002\neureka:\n  instance:\n    hostname: eureka7002                   # eureka\u5b9e\u4f8b\u4e3b\u673a\u540d\n    ip-address: 172.24.230.136            # eureka\u5b9e\u4f8bip\n  client:\n    register-with-eureka: false           # \u662f\u5426\u6ce8\u518c\u5230eureka \u6ce8\u518c\u4e2d\u5fc3\n    fetch-registry: false                 # \u662f\u5426\u4eceeureka\u6ce8\u518c\u4e2d\u5fc3\u83b7\u53d6\u670d\u52a1\u6ce8\u518c\u4fe1\u606f\n    # \u96c6\u7fa4server \u8282\u70b9\u76f8\u4e92\u6ce8\u518c\n    service-url:\n      defaultZone: http://eureka7001:7001/eureka    # eureka\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\n")),(0,r.kt)("h3",{id:"23-loadbalanced"},"2.3 @LoadBalanced"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"@LoadBalanced")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"blue"},"\u80fd\u5c06Eureka \u670d\u52a1\u7684\u5e94\u7528\u7a0b\u5e8f\u540d\u89e3\u6790\u4e3a \u6ce8\u518c\u5728Eureka Server \u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u91cc\u7684\u8bf7\u6c42URI [",(0,r.kt)("strong",null,"ip\uff1aport"),"] ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"\u4f7f\u7528\u65b9\u5f0f"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6ce8\u5165 RestTemplate \u5ba2\u6237\u7aef Bean  , \u5e76\u4e14\u5728Bean\u4e0a\u6807\u6ce8",(0,r.kt)("inlineCode",{parentName:"li"},"@LoadBalanced"))))))),(0,r.kt)("h4",{id:"231-\u6539\u9020eureka\u5ba2\u6237\u7aef\u4f7f\u7528loadbalanced"},"2.3.1 \u6539\u9020Eureka\u5ba2\u6237\u7aef\uff0c\u4f7f\u7528@LoadBalanced"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2460\u3001 \u6ce8\u5165RestTemplate \u65f6\u6807\u6ce8 @Loadbalanced")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Configuration\npublic class OrderConfig {\n    @Bean\n    @LoadBalanced\n    public RestTemplate restTemplate(){\n        RestTemplate restTemplate = new RestTemplate();\n        List<HttpMessageConverter<?>> list = restTemplate.getMessageConverters();\n        // \u66ff\u6362 StringHttpMessageConverter \u7684\u9ed8\u8ba4\u5b57\u7b26\u96c6\n        for (HttpMessageConverter<?> httpMessageConverter : list) {\n            if(httpMessageConverter instanceof StringHttpMessageConverter) {\n                ((StringHttpMessageConverter) httpMessageConverter).setDefaultCharset(StandardCharsets.UTF_8);\n                break;\n            }\n        }\n        return restTemplate;\n    }\n}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2461\u3001 \u4f7f\u7528RestTemplate\u65f6\uff0c\u7528\u670d\u52a1\u540d\u66ff\u6362\u6389 ip\u548c\u7aef\u53e3")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Slf4j\n@RestController\n@RequestMapping("/consumer")\npublic class OrderController {\n    @Resource\n    private RestTemplate restTemplate;\n\n    private static final String CLOUD_PAYMENT_SERVICE="CLOUD-PAYMENT-SERVICE";\n\n    @GetMapping("/getPayments")\n    public String getPayments(){\n        /**\n         * \u5c06localhost:8001 \u66ff\u6362\u4e3a \u670d\u52a1\u7684applicationName\n         */\n        // String result = restTemplate.getForObject("http://localhost:8001/payment/get", String.class);\n        String result = restTemplate.getForObject("http://"+CLOUD_PAYMENT_SERVICE+"/payment/get", String.class);\n        log.warn("getPayments:{}",result);\n        return result;\n    }\n}\n')),(0,r.kt)("h3",{id:"24-\u670d\u52a1\u53d1\u73b0\u4ee5\u53ca-enablediscoveryclient"},"2.4 \u670d\u52a1\u53d1\u73b0\u4ee5\u53ca @EnableDiscoveryClient"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5bf9\u4e8e\u6ce8\u518c\u8fdbeureka\u91cc\u9762\u7684\u5fae\u670d\u52a1\uff0c\u53ef\u4ee5\u901a\u8fc7\u670d\u52a1\u53d1\u73b0\u6765\u83b7\u5f97\u8be5\u670d\u52a1\u7684\u4fe1\u606f")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u64cd\u4f5c\u65b9\u5f0f")," \uff1a\u6ce8\u5165",(0,r.kt)("strong",null,"DiscoveryClient")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"DiscoveryClient \u5e38\u89c1\u65b9\u6cd5"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getServices()"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u6240\u6709\u6ce8\u518c\u7684\u670d\u52a1"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getInstances(String serviceId)"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u6bcf\u4e2a\u670d\u52a1\u4e0b\u9762\u6240\u6709\u7684 Eureka Instance\u5b9e\u4f8b"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@EnableDiscoveryClient"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u8ba9Eureka \u670d\u52a1\u5f00\u542f",(0,r.kt)("inlineCode",{parentName:"li"},"\u670d\u52a1\u53d1\u73b0"),"\u7684\u529f\u80fd"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"blue"},"\u8be5\u6ce8\u89e3\u4e5f\u80fd\u8ba9Eureka\u5ba2\u6237\u7aef \u6ce8\u518c\u5230Eureka Server \u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u4e2d"))))),(0,r.kt)("h2",{id:"3-consul"},"3. Consul"),(0,r.kt)("h3",{id:"31-consul-\u6982\u8ff0"},"3.1 Consul \u6982\u8ff0"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Consul \u662f\u5f00\u6e90\u7684",(0,r.kt)("font",{color:"red"},"\u5206\u5e03\u5f0f\u5f00\u6e90\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u7ba1\u7406\u7cfb\u7edf"),"\uff0c\u63d0\u4f9b\u4e86",(0,r.kt)("font",{color:"red"},"\u670d\u52a1\u6cbb\u7406\u3001\u914d\u7f6e\u4e2d\u5fc3\u3001\u63a7\u5236\u603b\u7ebf\u7b49\u529f\u80fd")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"Consul\u548cZookeeper\u4e00\u6837\uff0c\u5c5e\u4e8e AP")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},(0,r.kt)("strong",null,"SpringCloud Consul \u529f\u80fd\u7279\u70b9")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"\u670d\u52a1\u53d1\u73b0"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u63d0\u4f9bHTTP\u3001DNS\u3001gRPC \u7684\u53d1\u73b0\u65b9\u5f0f\u53d1\u73b0\u65b9\u5f0f",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"HTTP"),": 8500"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"gRPC"),": 8502"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"DNS"),": 8600"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"\u5065\u5eb7\u76d1\u6d4b"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u652f\u6301\u591a\u79cd\u534f\u8bae\uff0cHTTP\u3001TCP\u3001Docker\u3001Shell\u811a\u672c\u5b9a\u5236\u5316"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"KV\u5b58\u50a8")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"\u591a\u6570\u636e\u4e2d\u5fc3")," ",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Consul\u652f\u6301\u591a\u6570\u636e\u4e2d\u5fc3"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"\u53ef\u89c6\u5316Web\u754c\u9762")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u5b89\u88c5\u5e76\u542f\u52a8"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4ee5\u5f00\u53d1\u6a21\u5f0f\u542f\u52a8(\u8fdb\u5165console \u89e3\u538b\u5305\u76ee\u5f55)\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("mark",null,"consul agent -dev")))),(0,r.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\u53ef\u89c6\u5316 web\u754c\u9762",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"http://localhost:8500")))))),(0,r.kt)("h3",{id:"32-\u670d\u52a1\u6ce8\u518c"},"3.2 \u670d\u52a1\u6ce8\u518c"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"\u64cd\u4f5c\u6b65\u9aa4"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u5f15\u5165\u4f9d\u8d56 ",(0,r.kt)("inlineCode",{parentName:"li"},"spring-cloud-starter-consul-discovery")),(0,r.kt)("li",{parentName:"ol"},"\u914d\u7f6eapplication.yml",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"consul.port")," : consul \u7684\u7aef\u53e3\uff0chttp\u9ed8\u8ba48500"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"consul.host")," : consul \u7684host"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"consul.discovery.service-name")," : \u670d\u52a1\u540d"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"consul.discovery.instance-id")," : \u5b9e\u4f8bId"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("font",{color:"red"},"consul.discovery.prefer-ip-address")," : \u6ce8\u518c\u670d\u52a1\u5230\u65f6\u4f7f\u7528ip\u5730\u5740")))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2460\u3001 \u670d\u52a1application.yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 8003\nspring:\n  cloud:\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        prefer-ip-address: true\n        service-name: cloud-payment-service-consul\n        instance-id: ${spring.application.name}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u2461\u3001 consul \u7ba1\u63a7\u53f0")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image-20201204212956891",src:a(70441).Z,width:"1333",height:"395"})))}s.isMDXComponent=!0},81129:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/image-20201204131424739-e3c7cfc81b952b57abff475d0b3e60fe.png"},52168:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/image-20201204132228243-5558dffb578505c70190d7310a607b3f.png"},56923:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/image-20201204133124813-a0ebaf68026d3ae14c3e3dc02eb2bbcd.png"},97777:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/image-20201204135537951-0abff0797fec51f1d7653456adc852b2.png"},70441:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/image-20201204212956891-920d66e40e137894275a407de28473f3.png"}}]);