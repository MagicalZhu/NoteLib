"use strict";(self.webpackChunkhuakucha=self.webpackChunkhuakucha||[]).push([[3237],{12206:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var l=t(87462),a=(t(67294),t(3905));t(61839);const r={id:"MySQL\u53c2\u6570\u4e0e\u547d\u4ee4",title:"MySQL\u53c2\u6570\u4e0e\u547d\u4ee4"},o=void 0,s={unversionedId:"Mysql/MySQL\u53c2\u6570\u4e0e\u547d\u4ee4",id:"Mysql/MySQL\u53c2\u6570\u4e0e\u547d\u4ee4",title:"MySQL\u53c2\u6570\u4e0e\u547d\u4ee4",description:"\u5b57\u7b26\u96c6\u76f8\u5173",source:"@site/docs/Mysql/MySQL\u53c2\u6570\u4e0e\u8bed\u53e5.md",sourceDirName:"Mysql",slug:"/Mysql/MySQL\u53c2\u6570\u4e0e\u547d\u4ee4",permalink:"/docs/Mysql/MySQL\u53c2\u6570\u4e0e\u547d\u4ee4",draft:!1,editUrl:"https://github.com/MagicalZhu/NoteLib/tree/main/docs/Mysql/MySQL\u53c2\u6570\u4e0e\u8bed\u53e5.md",tags:[],version:"current",lastUpdatedBy:"YuLiang Zhu",lastUpdatedAt:1670289592,formattedLastUpdatedAt:"2022\u5e7412\u67086\u65e5",frontMatter:{id:"MySQL\u53c2\u6570\u4e0e\u547d\u4ee4",title:"MySQL\u53c2\u6570\u4e0e\u547d\u4ee4"},sidebar:"mysqlSideBar",previous:{title:"\u4e3b\u4ece\u590d\u5236",permalink:"/docs/Mysql/\u9ad8\u7ea7\u7279\u6027/\u4e3b\u4ece\u590d\u5236"}},i={},p=[{value:"\u5b57\u7b26\u96c6\u76f8\u5173",id:"\u5b57\u7b26\u96c6\u76f8\u5173",level:2},{value:"\u67e5\u770b\u5b57\u7b26\u96c6",id:"\u67e5\u770b\u5b57\u7b26\u96c6",level:3},{value:"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6(\u914d\u7f6e\u6587\u4ef6)",id:"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6\u914d\u7f6e\u6587\u4ef6",level:3},{value:"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6(SQL\u8bed\u53e5)",id:"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6sql\u8bed\u53e5",level:3},{value:"\u4fee\u6539\u5f53\u524d\u5e93\u8868\u7684\u5b57\u7b26\u96c6\u4e0e\u6392\u5e8f\u89c4\u5219",id:"\u4fee\u6539\u5f53\u524d\u5e93\u8868\u7684\u5b57\u7b26\u96c6\u4e0e\u6392\u5e8f\u89c4\u5219",level:3},{value:"\u76ee\u5f55\u7ed3\u6784\u6709\u5173",id:"\u76ee\u5f55\u7ed3\u6784\u6709\u5173",level:2},{value:"\u7528\u6237\u6743\u9650\u7ba1\u7406",id:"\u7528\u6237\u6743\u9650\u7ba1\u7406",level:2},{value:"\u7528\u6237",id:"\u7528\u6237",level:3},{value:"\u6743\u9650",id:"\u6743\u9650",level:3},{value:"\u89d2\u8272",id:"\u89d2\u8272",level:3}],k={toc:p};function c(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,l.Z)({},k,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u5b57\u7b26\u96c6\u76f8\u5173"},"\u5b57\u7b26\u96c6\u76f8\u5173"),(0,a.kt)("h3",{id:"\u67e5\u770b\u5b57\u7b26\u96c6"},"\u67e5\u770b\u5b57\u7b26\u96c6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"  -- \u67e5\u770b MySQL \u9ed8\u8ba4\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\n  show variables like 'character%';\n\n  -- \u67e5\u770b MySQL \u9ed8\u8ba4\u4f7f\u7528\u7684\u6392\u5e8f\u89c4\u5219\n  show variables like 'collation%';\n\n  -- \u67e5\u770b\u652f\u6301\u7684\u5b57\u7b26\u96c6\n  show charset; \n")),(0,a.kt)("h3",{id:"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6\u914d\u7f6e\u6587\u4ef6"},"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6(\u914d\u7f6e\u6587\u4ef6)"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u670d\u52a1\u5668\u91cd\u542f\u540e\u6709\u6548")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini",metastring:'title="/etc/my.conf"',title:'"/etc/my.conf"'},"[mysqld]\n# \u5b57\u7b26\u96c6\ncharacter_set_server=utf8\n\n# \u6392\u5e8f\u89c4\u5219\ncollation_server=utf8mb4_0900_ai_ci \n")),(0,a.kt)("h3",{id:"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6sql\u8bed\u53e5"},"\u8bbe\u7f6e\u670d\u52a1\u5668\u5b57\u7b26\u96c6(SQL\u8bed\u53e5)"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u670d\u52a1\u5668\u91cd\u542f\u540e\u5931\u6548")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"set character_set_server = {\u7f16\u7801}\n")),(0,a.kt)("h3",{id:"\u4fee\u6539\u5f53\u524d\u5e93\u8868\u7684\u5b57\u7b26\u96c6\u4e0e\u6392\u5e8f\u89c4\u5219"},"\u4fee\u6539\u5f53\u524d\u5e93\u8868\u7684\u5b57\u7b26\u96c6\u4e0e\u6392\u5e8f\u89c4\u5219"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u57fa\u672c\u683c\u5f0f: ",(0,a.kt)("inlineCode",{parentName:"p"},"character set '{\u7f16\u7801}' collate '{\u6392\u5e8f\u89c4\u5219}'")," ")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u4fee\u6539\u5df2\u7ecf\u521b\u5efa\u7684\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6\nalter database {\u6570\u636e\u5e93\u540d} character set '{\u7f16\u7801}' collate '{\u6392\u5e8f\u89c4\u5219}'\n\n-- \u4fee\u6539\u5df2\u7ecf\u521b\u5efa\u7684\u8868\u7684\u5b57\u7b26\u96c6\nalter table {\u6570\u636e\u8868\u540d} character set '{\u7f16\u7801}' collate '{\u6392\u5e8f\u89c4\u5219}'\n\n-- \u4fee\u6539\u5df2\u7ecf\u521b\u5efa\u7684\u8868\u7684\u67d0\u4e2a\u5217\u7684\u5b57\u7b26\u96c6\nalter table {\u6570\u636e\u8868\u540d} modify column {\u5217\u540d} character set '{\u7f16\u7801}' collate '{\u6392\u5e8f\u89c4\u5219}'\n\n-- \u4fee\u6539\u5df2\u7ecf\u521b\u5efa\u7684\u6570\u636e\u8868\u7684\u5b57\u7b26\u96c6,\u5e76\u4e14\u5df2\u6709\u6570\u636e\nalter table {\u6570\u636e\u8868\u540d} convert to character set '{\u7f16\u7801}'\n\n")),(0,a.kt)("h2",{id:"\u76ee\u5f55\u7ed3\u6784\u6709\u5173"},"\u76ee\u5f55\u7ed3\u6784\u6709\u5173"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"MySQL \u9ed8\u8ba4\u7684\u76ee\u5f55\u7ed3\u6784")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u67e5\u770b\u6570\u636e\u5e93\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84\nshow variables like 'datadir'\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5176\u4ed6\u76ee\u5f55")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u547d\u4ee4\u53ca\u914d\u7f6e\u6587\u4ef6: ",(0,a.kt)("inlineCode",{parentName:"p"},"/usr/share/mysql-8.0 \u6216 /usr/share/mysql"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"MySQL \u914d\u7f6e\u6587\u4ef6: ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/my.cnf"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u547d\u4ee4\u76ee\u5f55"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/usr/bin"),"  : \u5b58\u653e mysqladmin\u3001mysqlbinlog\u3001mysqldump \u7b49\u547d\u4ee4"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/usr/sbin")," : \u5b58\u653e mysqld \u7b49\u547d\u4ee4"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u9ed8\u8ba4\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84: ",(0,a.kt)("inlineCode",{parentName:"p"},"/var/log/mysqld.log")))),(0,a.kt)("h2",{id:"\u7528\u6237\u6743\u9650\u7ba1\u7406"},"\u7528\u6237\u6743\u9650\u7ba1\u7406"),(0,a.kt)("h3",{id:"\u7528\u6237"},"\u7528\u6237"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u7528\u6237\u7684\u57fa\u672c\u4fe1\u606f: ",(0,a.kt)("inlineCode",{parentName:"p"},"'{\u7528\u6237\u540d}'@'{\u4e3b\u673ahost}'")),(0,a.kt)("p",{parentName:"blockquote"},"\u6bd4\u5982: 'admin'@'localhost'")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"/*\n  \u521b\u5efa\u7528\u6237(\u5bc6\u7801\u4e3a\u53ef\u9009\u9879)\n  \u521b\u5efa\u7684\u7528\u6237\u9ed8\u8ba4\u53ea\u6709 usage \u6743\u9650\n*/\ncreate USER \u7528\u62371 [identified by '{\u5bc6\u78011}'], ... \u7528\u6237n [identified by '{\u5bc6\u7801n}']\n\n-- \u67e5\u770b\u7528\u6237(mysql.user)\nselect HOST,USER,PASSWORD from mysql.user\n\n--\u4fee\u6539\u7528\u6237\u540d\nrename USER '{\u65e7\u7528\u6237\u540d1}' TO '{\u65b0\u7528\u6237\u540d1}', ...,'{\u65e7\u7528\u6237\u540dn}' TO '{\u65b0\u7528\u6237\u540dn}'\n\n--\u6216\u8005\nupdate mysql.user set USER= '{\u65b0\u7528\u6237\u540d}' WHERE USER='{\u65e7\u7528\u6237\u540d}'\nFLUSH PRIVILEGES;\n\n--\u5220\u9664\u7528\u6237\ndrop USER \u7528\u62371[,...\u7528\u6237n]\nFLUSH PRIVILEGES\n\n--\u4fee\u6539\u5f53\u524d\u7528\u6237\u5bc6\u7801\nALTER USER USER() identified by '{\u5bc6\u7801}'\n\n-- \u4fee\u6539\u6307\u5b9a\u7528\u6237\u7684\u5bc6\u7801\nALTER USER \u7528\u62371 [identified by '{\u5bc6\u78011}'], ... \u7528\u6237n [identified by '{\u5bc6\u7801n}']\n\n")),(0,a.kt)("h3",{id:"\u6743\u9650"},"\u6743\u9650"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"--\u67e5\u770b\u6240\u6709\u7684\u6743\u9650\nshow privileges;\n\n-- \u4e3a\u6307\u5b9a\u7528\u6237\u5206\u914d\u6307\u5b9a\u7684\u6743\u9650\ngrant \u6743\u96501,...,\u6743\u9650n on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} to \u7528\u62371[,...\u7528\u6237n]\n\n-- \u4e3a\u6307\u5b9a\u7528\u6237\u5206\u914d\u6240\u6709\u7684\u6743\u9650\ngrant all privileges on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} to \u7528\u62371[,...\u7528\u6237n]\n\n-- \u67e5\u770b\u5f53\u524d\u7528\u6237\u6743\u9650\nshow grants\nshow grants for CURRENT_USER()\n\n-- \u67e5\u770b\u6307\u5b9a\u7528\u6237\u6743\u9650\nshow grants for \u7528\u6237\n\n-- \u5220\u9664/\u56de\u6536\u6307\u5b9a\u6743\u9650\nrevoke \u6743\u96501,...,\u6743\u9650n on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} from \u7528\u62371[,...\u7528\u6237n]\n\n-- \u5220\u9664/\u56de\u6536\u6240\u6709\u6743\u9650\nrevoke all privileges on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} from \u7528\u62371[,...\u7528\u6237n]\n\n")),(0,a.kt)("h3",{id:"\u89d2\u8272"},"\u89d2\u8272"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u89d2\u8272\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u4e3a\u591a\u4e2a\u6743\u9650\u7684\u96c6\u5408\u4f53,\u57fa\u672c\u683c\u5f0f: ",(0,a.kt)("inlineCode",{parentName:"p"},"'{\u89d2\u8272\u540d\u79f0}'@'{\u4e3b\u673aHost}'"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u521b\u5efa\u89d2\u8272\ncreate role \u89d2\u82721,...,\u89d2\u8272n\n\n-- \u5220\u9664\u89d2\u8272\ndrop role \u89d2\u82721,...,\u89d2\u8272n\n\n-- \u4e3a\u6307\u5b9a\u89d2\u8272\u6388\u4e88\u6307\u5b9a\u6743\u9650\ngrant \u6743\u96501,...,\u6743\u9650n on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} to \u89d2\u82721[,...\u89d2\u8272n]\n\n-- \u4e3a\u6307\u5b9a\u89d2\u8272\u6388\u4e88\u6240\u6709\u6743\u9650\ngrant all privileges on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} to \u89d2\u82721[,...\u89d2\u8272n]\n\n-- \u67e5\u770b\u89d2\u8272\u7684\u6743\u9650\nshow grants for \u89d2\u8272\n\n\n/**\n  \u7528\u6237\u4e0e\u89d2\u8272\n*/\n\n-- \u5220\u9664/\u56de\u6536\u89d2\u8272\u6307\u5b9a\u6743\u9650\nrevoke \u6743\u96501,...,\u6743\u9650n on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} from \u89d2\u82721[,...\u89d2\u8272n]\n\n-- \u5220\u9664/\u56de\u6536\u89d2\u8272\u6240\u6709\u6743\u9650\nrevoke all privileges on {\u6570\u636e\u5e93\u540d}.{\u6570\u636e\u8868\u540d} from \u89d2\u82721[,...\u89d2\u8272n]\n\n-- \u5c06\u89d2\u8272\u8d4b\u4e88\u6307\u5b9a\u7528\u6237\ngrant \u89d2\u82721,...,\u89d2\u8272n to \u7528\u62371[,...\u7528\u6237n]\n\n-- \u67e5\u770b\u5f53\u524d\u89d2\u8272\nselect CURRENT_ROLE();\n\n-- \u5220\u9664\u5f53\u524d\u7528\u6237\u6307\u5b9a\u89d2\u8272\nrevoke \u89d2\u82721,...,\u89d2\u8272n from \u7528\u62371[,...\u7528\u6237n]\n\n\n/**\n  \u6fc0\u6d3b\u89d2\u8272(\u65b9\u5f0f 1)\n    None: \u5220\u9664\u7528\u6237\u7684\u89d2\u8272(no roles)\n    all: \u5c06\u6240\u6709\u7684\u89d2\u8272\u8bbe\u7f6e\u7ed9\u7528\u6237\n    role: \u5c06\u6307\u5b9a\u7684\u89d2\u8272\u8bbe\u7f6e\u7ed9\u7528\u6237\n*/\nset default role { None | all| \u89d2\u82721[,...,\u89d2\u8272n] } TO \u7528\u62371[,...,\u7528\u6237n]\n\n")))}c.isMDXComponent=!0}}]);