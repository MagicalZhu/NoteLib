"use strict";(self.webpackChunkhuakucha=self.webpackChunkhuakucha||[]).push([[9623],{85946:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>k,frontMatter:()=>i,metadata:()=>o,toc:()=>u});var a=n(87462),l=(n(67294),n(3905));n(61839);const i={id:"Config",title:"\u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3-Config"},r=void 0,o={unversionedId:"SpringCloud/Netflix/Config",id:"SpringCloud/Netflix/Config",title:"\u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3-Config",description:"1.SpringCloud Config",source:"@site/docs/SpringCloud/Netflix/1.6\u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3-Config.md",sourceDirName:"SpringCloud/Netflix",slug:"/SpringCloud/Netflix/Config",permalink:"/docs/SpringCloud/Netflix/Config",draft:!1,editUrl:"https://github.com/MagicalZhu/NoteLib/tree/main/docs/SpringCloud/Netflix/1.6\u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3-Config.md",tags:[],version:"current",lastUpdatedBy:"YuLiang Zhu",lastUpdatedAt:1670289592,formattedLastUpdatedAt:"2022\u5e7412\u67086\u65e5",frontMatter:{id:"Config",title:"\u670d\u52a1\u914d\u7f6e\u4e2d\u5fc3-Config"},sidebar:"springCloudSideBar",previous:{title:"\u670d\u52a1\u7f51\u5173-GateWay",permalink:"/docs/SpringCloud/Netflix/GateWay"},next:{title:"\u6d88\u606f\u603b\u7ebf-Bus",permalink:"/docs/SpringCloud/Netflix/Bus"}},p={},u=[{value:"1.SpringCloud Config",id:"1springcloud-config",level:2},{value:"1.1 SpringCloud Config \u6982\u8ff0",id:"11-springcloud-config-\u6982\u8ff0",level:3},{value:"1.2 SpringCloud Config\u6574\u5408 Github",id:"12-springcloud-config\u6574\u5408-github",level:3},{value:"1.2.1 Config \u670d\u52a1\u7aef\u914d\u7f6e",id:"121-config-\u670d\u52a1\u7aef\u914d\u7f6e",level:4},{value:"1.2.1.1 \u4ee3\u7801\u5b9e\u73b0",id:"1211-\u4ee3\u7801\u5b9e\u73b0",level:5},{value:"1.2.2 Config\u5ba2\u6237\u7aef\u914d\u7f6e",id:"122-config\u5ba2\u6237\u7aef\u914d\u7f6e",level:4},{value:"1.2.2.1 Config\u4ee3\u7801\u903b\u8f91",id:"1221-config\u4ee3\u7801\u903b\u8f91",level:5},{value:"1.2.3 Config\u5ba2\u6237\u7aef\u4e4b\u52a8\u6001\u5237\u65b0 \u3010\u624b\u52a8\u5237\u65b0\u3011",id:"123-config\u5ba2\u6237\u7aef\u4e4b\u52a8\u6001\u5237\u65b0-\u624b\u52a8\u5237\u65b0",level:4}],m={toc:u};function k(e){let{components:t,...i}=e;return(0,l.kt)("wrapper",(0,a.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"1springcloud-config"},"1.SpringCloud Config"),(0,l.kt)("h3",{id:"11-springcloud-config-\u6982\u8ff0"},"1.1 SpringCloud Config \u6982\u8ff0"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5fae\u670d\u52a1\u67b6\u6784\u4e0b\u9762\u4e34\u7684\u914d\u7f6e\u95ee\u9898"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5fae\u670d\u52a1\u67b6\u6784\u610f\u5473\u7740\u5c06\u4e1a\u52a1\u7cfb\u7edf\u62c6\u5206\u6210\u5927\u91cf\u7684\u7ec6\u5c0f\u7684\u6a21\u5757\uff0c\u6bcf\u4e2a\u6a21\u5757\u90fd\u53ef\u4ee5\u72ec\u7acb\u90e8\u7f72\u542f\u52a8\uff0c\u5373\u9700\u8981\u4f9d\u8d56\u5927\u91cf\u7684\u670d\u52a1\u914d\u7f6e\u4fe1\u606f",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u56e0\u6b64\u9700\u8981\u4e00\u5957\u5b8c\u5584\u7684\u96c6\u4e2d\u5f0f\u3001\u52a8\u6001\u7684\u914d\u7f6e\u7ba1\u7406\u7ec4\u4ef6")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"SpringCloud Config\u7684\u4f5c\u7528"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u4e3a\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u5fae\u670d\u52a1\u63d0\u4f9b\u96c6\u4e2d\u5316\u7684\u5916\u90e8\u914d\u7f6e\u652f\u6301"),"\uff0c\u914d\u7f6e\u670d\u52a1\u5668\u4e3a\u5404\u4e2a\u4e0d\u540c\u5fae\u670d\u52a1\u5e94\u7528\u7684\u6240\u6709\u73af\u5883\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e2d\u5fc3\u5316\u7684\u5916\u90e8\u914d\u7f6e")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"SpringCloud Config \u600e\u4e48\u73a9\uff1f"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"SpringCloud Config\u5206\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"\u670d\u52a1\u7aef")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"\u5ba2\u6237\u7aef"),"\u4e24\u90e8\u5206"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u670d\u52a1\u7aef"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u670d\u52a1\u7aef\u4e5f\u79f0\u4e3a",(0,l.kt)("inlineCode",{parentName:"li"},"\u5206\u5e03\u5f0f\u914d\u7f6e\u4e2d\u5fc3")),(0,l.kt)("li",{parentName:"ul"},"\u5b83\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5fae\u670d\u52a1\u5e94\u7528\uff0c",(0,l.kt)("font",{color:"red"},"\u7528\u6765\u8fde\u63a5\u914d\u7f6e\u670d\u52a1\u5668\u5e76\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\uff0c\u52a0\u5bc6/\u89e3\u5bc6\u4fe1\u606f\u7b49\u8bbf\u95ee\u63a5\u53e3")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5ba2\u6237\u7aef"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef\u5219\u662f",(0,l.kt)("font",{color:"red"},"\u901a\u8fc7\u6307\u5b9a\u7684\u914d\u7f6e\u4e2d\u5fc3\u6765\u7ba1\u7406\u5e94\u7528\u8d44\u6e90\uff0c\u4ee5\u53ca\u4e0e\u4e1a\u52a1\u76f8\u5173\u7684\u914d\u7f6e\u5185\u5bb9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u542f\u52a8\u7684\u65f6\u5019\u4ece\u914d\u7f6e\u4e2d\u5fc3\u83b7\u53d6\u548c\u52a0\u8f7d\u914d\u7f6e\u4fe1\u606f\u914d\u7f6e\u670d\u52a1\u5668 , ",(0,l.kt)("inlineCode",{parentName:"li"},"\u9ed8\u8ba4\u91c7\u7528 git \u6765\u5b58\u50a8\u914d\u7f6e\u4fe1\u606f")))))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"SpringCloud \u53ef\u4ee5\u5e72\u561b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u96c6\u4e2d\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u540c\u73af\u5883\u4e0d\u540c\u914d\u7f6e\uff0c\u52a8\u6001\u5316\u7684\u914d\u7f6e\u66f4\u65b0\uff0c\u5206\u73af\u5883\u90e8\u7f72"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982 dev\u3001test\u3001prod\u3001beta\u3001release"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u8fd0\u884c\u671f\u95f4\u52a8\u6001\u8c03\u6574\u914d\u7f6e\uff0c\u4e0d\u518d\u9700\u8981\u5728\u6bcf\u4e2a\u670d\u52a1\u90e8\u7f72\u7684\u673a\u5668\u4e0a\u7f16\u5199\u914d\u7f6e\u6587\u4ef6\uff0c\u670d\u52a1\u4f1a\u5411\u914d\u7f6e\u4e2d\u5fc3\u7edf\u4e00\u62c9\u53d6\u914d\u7f6e\u81ea\u5df1\u7684\u4fe1\u606f")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u5f53\u914d\u7f6e\u53d1\u751f\u53d8\u52a8\u65f6\uff0c\u670d\u52a1\u4e0d\u9700\u8981\u91cd\u542f\u5373\u53ef\u611f\u77e5\u5230\u914d\u7f6e\u7684\u53d8\u5316\u5e76\u5e94\u7528\u65b0\u7684\u914d\u7f6e")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u5c06\u914d\u7f6e\u4fe1\u606f\u4ee5REST\u63a5\u53e3\u7684\u5f62\u5f0f\u66b4\u9732"))))),(0,l.kt)("h3",{id:"12-springcloud-config\u6574\u5408-github"},"1.2 SpringCloud Config\u6574\u5408 Github"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"SpringCloud Config ",(0,l.kt)("font",{color:"red"},"\u9ed8\u8ba4\u4f7f\u7528",(0,l.kt)("code",null,"Git"),"\u6765\u5b58\u50a8\u914d\u7f6e\u6587\u4ef6 , \u800c\u4e14\u4f7f\u7528\u7684\u662fhttp/https\u8bbf\u95ee\u7684\u5f62\u5f0f"))),(0,l.kt)("h4",{id:"121-config-\u670d\u52a1\u7aef\u914d\u7f6e"},"1.2.1 Config \u670d\u52a1\u7aef\u914d\u7f6e"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},(0,l.kt)("strong",null,"\u64cd\u4f5c\u6b65\u9aa4")),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u5728GitHub \u4e0a\u65b0\u5efa\u4e00\u4e2a Repository \u4ed3\u5e93 , \u5e76\u83b7\u53d6",(0,l.kt)("inlineCode",{parentName:"li"},"SSH\u534f\u8bae\u7684git\u5730\u5740")),(0,l.kt)("li",{parentName:"ol"},"\u65b0\u5efa\u7684Repository\u4ed3\u5e93 ",(0,l.kt)("inlineCode",{parentName:"li"},"clone")," \u5230\u672c\u5730"),(0,l.kt)("li",{parentName:"ol"},"\u5728\u672c\u5730\u7684  Repository\u4ed3\u5e93 \u4e2d\u65b0\u5efa \u5916\u90e8\u5316\u914d\u7f6e\u6587\u4ef6 application.yml",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5c06\u65b0\u5efa\u7684 YML \u6587\u4ef6\u63a8\u9001\u5230 GitHub"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f\u4fdd\u5b58\u683c\u5f0f\u5fc5\u987b\u662f",(0,l.kt)("strong",null,"UTF-8"))))),(0,l.kt)("li",{parentName:"ol"},"\u65b0\u5efaConfig\u914d\u7f6e\u4e2d\u5fc3\u6a21\u5757, \u5f15\u5165Config \u670d\u52a1\u7aef\u7684\u4f9d\u8d56",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u540c\u6837\u9700\u8981\u670d\u52a1\u7aef\u6ce8\u518c\u5230\u914d\u7f6e\u4e2d\u5fc3"))),(0,l.kt)("li",{parentName:"ol"},"\u4fee\u6539  Config \u914d\u7f6e\u4e2d\u5fc3  \u7684",(0,l.kt)("inlineCode",{parentName:"li"},"application.yml"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"server.port")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.server.git.url"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Github\u914d\u7f6e\u4e2d\u5fc3\u4ed3\u5e93 Http\u7684Git\u5730\u5740"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.server.git.search-paths"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u641c\u7d22\u76ee\u5f55"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.server.git.basedir"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Github \u8fdc\u7a0b\u4ed3\u5e93\u7684\u914d\u7f6e\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730 \u4fdd\u5b58\u7684\u4f4d\u7f6e"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"green"},"\u901a\u8fc7 Config Server \u8bfb\u53d6Github Repository \u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u65f6 ,  \u4f1a\u5c06\u914d\u7f6e\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.server.git.default-label"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u5206\u652f\u540d ","[Github \u76ee\u524d\u65b0\u5efa\u7684\u4ed3\u5e93\u9ed8\u8ba4\u5206\u652f\u540d\u4e3a ",(0,l.kt)("strong",{parentName:"li"},"main"),"]"))))),(0,l.kt)("li",{parentName:"ol"},"\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"li"},"@EnableConfigServer"),"\u5f00\u542fSpringCloud Config \u529f\u80fd"),(0,l.kt)("li",{parentName:"ol"},"\u542f\u52a8 Cloud\u7684\u914d\u7f6e\u4e2d\u5fc3\u6a21\u5757,  \u4eceGitHub \u83b7\u53d6\u914d\u7f6e\u5185\u5bb9",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"http:// Config\u670d\u52a1\u7aef\u7684IP: \u7aef\u53e3 /application-xxx.yml")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},(0,l.kt)("strong",null,"\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6\u683c\u5f0f")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5e38\u89c1\u6709\u4ee5\u4e0b\u7684\u4e09\u79cd\u683c\u5f0f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"/{name}-{profile}"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"http://localhsot:3344/application-dev.yml"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"/{name}/{profile}","[/{label}]"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"http://localhost:3344/application/dev/master"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"/{label}/{name}-{profile}"),"    \u2764\ufe0f"),(0,l.kt)("li",{parentName:"ul"},"http://config-33443344/master/application-dev.yml"))),(0,l.kt)("li",{parentName:"ul"},"\u683c\u5f0f\u8bf4\u660e",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"name")," :  \u914d\u7f6e\u6587\u4ef6\u540d"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"profile")," :  \u73af\u5883"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"label")," :  \u5728Github \u4e0a\u7684\u5206\u652f")))))),(0,l.kt)("h5",{id:"1211-\u4ee3\u7801\u5b9e\u73b0"},"1.2.1.1 \u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2460\u3001 \u5f15\u5165pom")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- \u4f7f\u7528 Consul --\x3e\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-starter-consul-discovery</artifactId>\n</dependency>\n\n\x3c!--SpringCloud Config-Server--\x3e\n<dependency>\n  <groupId>org.springframework.cloud</groupId>\n  <artifactId>spring-cloud-config-server</artifactId>\n</dependency>\n\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-web</artifactId>\n</dependency>\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n\x3c!-- \u5f00\u542f\u70ed\u90e8\u7f72 --\x3e\n<dependency>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-devtools</artifactId>\n  <scope>runtime</scope>\n  <optional>true</optional>\n</dependency>\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2461\u3001 \u4fee\u6539application.yml")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"server:\n  port: 3344\nspring:\n  application:\n    name: cloud-config-center-3344\n  cloud:\n    consul:\n      host: localhost\n      port: 8500\n      discovery:\n        service-name: cloud-config-center\n        instance-id: ${spring.application.name}\n   # config.server \u914d\u7f6e\uff1agit\u5730\u5740\uff0cgit\u4ed3\u5e93\u4e0b\u8f7d\u5230\u672c\u5730\u7684\u5730\u5740\uff0c\u9ed8\u8ba4\u7684\u5206\u652f\u540d\uff08main\uff09\n    config:\n      server:\n        git:\n          uri: https://github.com/MagicalZhu/config-repo.git\n          default-label: main\n          search-paths:\n            - config-repo\n          basedir: /Users/yoey/WorkSpace/Code/SpringCloudDemo/config-repo\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2462\u3001\u901a\u8fc7configServer \u8bbf\u95ee\u914d\u7f6e")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20201212134331485",src:n(49166).Z,width:"554",height:"217"})),(0,l.kt)("h4",{id:"122-config\u5ba2\u6237\u7aef\u914d\u7f6e"},"1.2.2 Config\u5ba2\u6237\u7aef\u914d\u7f6e"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},(0,l.kt)("strong",null,"bootstrap.yml")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"application.yml\u662f\u7528\u6237\u7ea7\u7684\u8d44\u6e90\u914d\u7f6e\u9879"),(0,l.kt)("li",{parentName:"ul"},"bootstrap.yml\u662f\u7cfb\u7edf\u7ea7\u7684\uff0c\u4f18\u5148\u7ea7\u66f4\u52a0\u9ad8"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},(0,l.kt)("strong",null,"Bootstrap Context \u548c\xa0Application Context")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Spring Cloud\u4f1a\u521b\u5efa\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"strong"},"Bootstrap Context"),"\uff0c\u4f5c\u4e3aSpring\u5e94\u7528\u7684",(0,l.kt)("inlineCode",{parentName:"strong"},"Application Context"),"\u7684\u7236\u4e0a\u4e0b\u6587"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"Bootstrap Context"),"\u8d1f\u8d23",(0,l.kt)("inlineCode",{parentName:"li"},"\u4ece\u5916\u90e8\u6e90\u52a0\u8f7d\u914d\u7f6e\u5c5e\u6027\u5e76\u89e3\u6790\u914d\u7f6e")),(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u4e24\u4e2a\u4e0a\u4e0b\u6587\u5171\u4eab\u4e00\u4e2a\u4ece\u5916\u90e8\u83b7\u53d6\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"Environment")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Bootstrap Context"),"\u5c5e\u6027\u6709\u9ad8\u4f18\u5148\u7ea7\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u4e0d\u4f1a\u88ab\u672c\u5730\u914d\u7f6e\u8986\u76d6"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Bootstrap context"),"\u548c",(0,l.kt)("inlineCode",{parentName:"li"},"Application Context"),"\u6709\u7740\u4e0d\u540c\u7684\u7ea6\u5b9a\uff0c\u6240\u4ee5\u65b0\u589e\u4e86\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"li"},"bootstrap.yml"),"\u6587\u4ef6",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4fdd\u8bc1",(0,l.kt)("inlineCode",{parentName:"li"},"Bootstrap Context"),"\u548c",(0,l.kt)("inlineCode",{parentName:"li"},"Application Context"),"\u914d\u7f6e\u7684\u5206\u79bb"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},(0,l.kt)("strong",null,"\u64cd\u4f5c\u6b65\u9aa4")),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u5f15\u5165config-client\u7684\u4f9d\u8d56 ( ",(0,l.kt)("inlineCode",{parentName:"li"},"spring-cloud-starter-config")," )"),(0,l.kt)("li",{parentName:"ol"},"\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"li"},"bootstrap.yml"),", \u6307\u5b9a\u4ece\u90a3\u4e2aSpringCloud Config \u670d\u52a1\u5668\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u4fe1\u606f",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.name"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"green"},"\u6307\u5b9a\u9700\u8981\u4eceGithub\u4e0a\u8bfb\u53d6\u7684\u8d44\u6e90\u540d\u79f0\uff0c\u6ce8\u610f\u6ca1\u6709yml\u540e\u7f00\u540d")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.profile"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\u7684\u73af\u5883"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f:  \u8be5\u914d\u7f6e\u503c\u51b3\u5b9a\u4f7f\u7528\u54ea\u4e00\u4e2aProfile \u914d\u7f6e\u6587\u4ef6")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.label"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u54ea\u4e2aGit\u5206\u652f"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.cloud.config.uri"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Config \u670d\u52a1\u7aef\u7684\u8bf7\u6c42\u5730\u5740,\u6bd4\u5982 http://locahost:3344")))))))),(0,l.kt)("h5",{id:"1221-config\u4ee3\u7801\u903b\u8f91"},"1.2.2.1 Config\u4ee3\u7801\u903b\u8f91"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2460\u3001 \u5728Github\u914d\u7f6e\u4e2d\u5fc3\u4ed3\u5e93\u4e2d\u7684main\u5206\u652f\u4e2d\u65b0\u52a0 applicationp-dev.yml")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20201212142518350",src:n(3504).Z,width:"795",height:"457"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2461\u3001 \u5728\u9879\u76ee\u4e2d\u5f15\u5165config\u5ba2\u6237\u7aef\u7684\u4f9d\u8d56")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n  \x3c!-- \u4f7f\u7528 Consul --\x3e\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-consul-discovery</artifactId>\n  </dependency>\n\n  \x3c!--SpringCloud Config-Server--\x3e\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-config</artifactId>\n  </dependency>\n\n  <dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n  </dependency>\n  <dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-actuator</artifactId>\n  </dependency>\n  \x3c!-- \u5f00\u542f\u70ed\u90e8\u7f72 --\x3e\n  <dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-devtools</artifactId>\n    <scope>runtime</scope>\n    <optional>true</optional>\n  </dependency>\n    </dependencies>\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2462\u3001 \u5728resource\u76ee\u5f55\u4e2d\u65b0\u52a0 ",(0,l.kt)("font",{color:"red"},"bootstrap.yml")," ")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"\u914d\u7f6econfig-server \u7684\u5730\u5740\u4ee5\u53ca\u914d\u7f6e\u4e2d\u5fc3\u7684git\u5730\u5740"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},"############################################\n#   application.yml  => \u7528\u6237\u7ea7\u7684\u8d44\u6e90\u914d\u7f6e\u9879\n#   bootstrap.yml    => \u7cfb\u7edf\u7ea7\u7684 ,\u4f18\u5148\u7ea7\u66f4\u52a0\u9ad8\n############################################\nspring:\n  cloud:\n    config:\n      label: main\n      name: application\n      profile: dev\n      uri: http://localhost:3344\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2463\u3001 \u542f\u52a8config \u5ba2\u6237\u7aef\u670d\u52a1\uff0c\u67e5\u770b\u63a7\u5236\u53f0")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u53ef\u4ee5\u770b\u5230\u542f\u52a8\u65f6\u901a\u8fc7\u914d\u7f6e\u4e2d\u5fc3(3344) \u53bb\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u83b7\u53d6\u5230\u540eSpringBoot\u6839\u636e\u8be5\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u7cfb\u7edf\u914d\u7f6e(\u6bd4\u5982web\u670d\u52a1\u7aef\u53e3 3355)")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20201212143007699",src:n(97380).Z,width:"1409",height:"262"})),(0,l.kt)("h4",{id:"123-config\u5ba2\u6237\u7aef\u4e4b\u52a8\u6001\u5237\u65b0-\u624b\u52a8\u5237\u65b0"},"1.2.3 Config\u5ba2\u6237\u7aef\u4e4b\u52a8\u6001\u5237\u65b0 \u3010\u624b\u52a8\u5237\u65b0\u3011"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5b58\u5728\u7684\u95ee\u9898"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4fee\u6539\u4e86Github\u4e0a\u914d\u7f6e\u4e2d\u5fc3\u57ce\u4ed3\u5e93\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6\u540e\t",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7config-server \u8bbf\u95ee\uff0c\u53ef\u4ee5\u8bbf\u95ee\u5230\u4fee\u6539\u540e\u7684\u6587\u4ef6"),(0,l.kt)("li",{parentName:"ul"},"\u8bbf\u95eeconfig-client\u65f6\uff0c\u83b7\u53d6\u5230\u7684\u6570\u636e\u8fd8\u662f\u8001\u7684"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5e38\u89c1\u7684\u6ce8\u89e3"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"@RefreshScope"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5237\u65b0\u533a\u57df\u6ce8\u89e3\uff0c\u914d\u7f6e\u5728 ",(0,l.kt)("strong",{parentName:"li"},"\u65b9\u6cd5\u3001\u7c7b\u4e0a")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u64cd\u4f5c\u6b65\u9aa4"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u5f15\u5165 ",(0,l.kt)("inlineCode",{parentName:"li"},"actuator")," \u7684\u4f9d\u8d56"),(0,l.kt)("li",{parentName:"ol"},"\u4fee\u6539 yml\u6587\u4ef6\uff0c\u66b4\u9732web\u7684\u76d1\u63a7\u7aef\u53e3",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"management.endpoints.web.exposure.include")))),(0,l.kt)("li",{parentName:"ol"},"\u5728\u9700\u8981\u5237\u65b0\u7684\u7c7b\u4e0a\u6807\u6ce8 ",(0,l.kt)("inlineCode",{parentName:"li"},"@RefreshScope"),"\u6ce8\u89e3"),(0,l.kt)("li",{parentName:"ol"},"\u8c03\u7528\u670d\u52a1\u5237\u65b0 api \u63a5\u53e3",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},'curl -X POST "http://localhost:3355/actuator/refresh"'))))))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2460\u3001\u5f15\u5165actuator\u4f9d\u8d56\u540e\uff0c\u914d\u7f6eapplication.yml")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yml"},'############################################\n#   application.yml  => \u7528\u6237\u7ea7\u7684\u8d44\u6e90\u914d\u7f6e\u9879\n#   bootstrap.yml    => \u7cfb\u7edf\u7ea7\u7684 ,\u4f18\u5148\u7ea7\u66f4\u52a0\u9ad8\n############################################\nspring:\n  cloud:\n    config:\n      label: main\n      name: application\n      profile: dev\n      uri: http://localhost:3344\nmanagement:\n  endpoints:\n    web:\n      base-path: /actuator\n      exposure:\n        include: "*"    #\u66b4\u9732web \u7684\u6240\u6709\u76d1\u63a7\u7aef\u70b9\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2461\u3001\u67e5\u770bactuator\u63d0\u4f9b\u7684\u7aef\u70b9\u670d\u52a1 ")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20201212154103346",src:n(624).Z,width:"725",height:"684"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2462\u3001 \u5728\u9700\u8981\u5237\u65b0\u7684\u7c7b\u4e0a\u6807\u6ce8 @RefreshScope \u6ce8\u89e3")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@RestController\n// \u5237\u65b0\n@RefreshScope\npublic class ConfigClientController {\n\n\n    @Value("${config.info}")\n    private String info;\n\n    @Value("${config.msg}")\n    private String msg;\n\n\n    @GetMapping("/getInfo")\n    public String getInfo(){\n        return info;\n    }\n\n    @GetMapping("/getMsg")\n    public String getInfo2(){\n        return msg;\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u2463\u3001 \u4fee\u6539Github\u4e0a\u914d\u7f6e\u6587\u4ef6\u540e\uff0c\u5411refresh \u7aef\u70b9\u53d1\u9001post \u8bf7\u6c42 ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'\u279c  SpringCloudDemo curl -X POST "http://localhost:3355/actuator/refresh"\n["config.client.version","config.info"]% \n')))}k.isMDXComponent=!0},49166:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20201212134331485-51adcf5a24f87ffaf18b04357595fc0b.png"},3504:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20201212142518350-7658de8e8c1f35456d76492b27470b71.png"},97380:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20201212143007699-39cd86670c1ea0dd6f9d73aff76e2e05.png"},624:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image-20201212154103346-7cb21774361c4a9aa6e26633f9301d4a.png"}}]);