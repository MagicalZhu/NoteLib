"use strict";(self.webpackChunkhuakucha=self.webpackChunkhuakucha||[]).push([[794],{46477:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>k,contentTitle:()=>p,default:()=>o,frontMatter:()=>i,metadata:()=>r,toc:()=>m});var n=a(87462),l=(a(67294),a(3905));a(61839);const i={id:"\u9501",title:"\u9501\u673a\u5236"},p=void 0,r={unversionedId:"Mysql/\u9ad8\u7ea7\u7279\u6027/\u9501",id:"Mysql/\u9ad8\u7ea7\u7279\u6027/\u9501",title:"\u9501\u673a\u5236",description:"\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u7531\u9501\u6765\u5b9e\u73b0",source:"@site/docs/Mysql/\u9ad8\u7ea7\u7279\u6027/\u9501.md",sourceDirName:"Mysql/\u9ad8\u7ea7\u7279\u6027",slug:"/Mysql/\u9ad8\u7ea7\u7279\u6027/\u9501",permalink:"/docs/Mysql/\u9ad8\u7ea7\u7279\u6027/\u9501",draft:!1,editUrl:"https://github.com/MagicalZhu/NoteLib/tree/main/docs/Mysql/\u9ad8\u7ea7\u7279\u6027/\u9501.md",tags:[],version:"current",lastUpdatedBy:"YuLiang Zhu",lastUpdatedAt:1670289592,formattedLastUpdatedAt:"2022\u5e7412\u67086\u65e5",frontMatter:{id:"\u9501",title:"\u9501\u673a\u5236"},sidebar:"mysqlSideBar",previous:{title:"Undo\u65e5\u5fd7",permalink:"/docs/Mysql/\u9ad8\u7ea7\u7279\u6027/Undo\u65e5\u5fd7"},next:{title:"\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236",permalink:"/docs/Mysql/\u9ad8\u7ea7\u7279\u6027/MVCC"}},k={},m=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u5e76\u53d1\u4e8b\u52a1\u8bbf\u95ee\u76f8\u540c\u8bb0\u5f55",id:"\u5e76\u53d1\u4e8b\u52a1\u8bbf\u95ee\u76f8\u540c\u8bb0\u5f55",level:2},{value:"\u8bfb-\u8bfb",id:"\u8bfb-\u8bfb",level:3},{value:"\u5199-\u5199",id:"\u5199-\u5199",level:3},{value:"\u8bfb-\u5199",id:"\u8bfb-\u5199",level:3},{value:"\u5e76\u53d1\u95ee\u9898\u89e3\u51b3",id:"\u5e76\u53d1\u95ee\u9898\u89e3\u51b3",level:3},{value:"\u9501\u7684\u4e0d\u540c\u89d2\u5ea6\u5206\u7c7b",id:"\u9501\u7684\u4e0d\u540c\u89d2\u5ea6\u5206\u7c7b",level:2},{value:"\u6570\u636e\u64cd\u4f5c\u7c7b\u578b\u5212\u5206",id:"\u6570\u636e\u64cd\u4f5c\u7c7b\u578b\u5212\u5206",level:3},{value:"\u8bfb\u9501\u3001\u5199\u9501",id:"\u8bfb\u9501\u5199\u9501",level:4},{value:"\u9501\u5b9a\u8bfb",id:"\u9501\u5b9a\u8bfb",level:4},{value:"\u5199\u64cd\u4f5c",id:"\u5199\u64cd\u4f5c",level:4},{value:"\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5212\u5206",id:"\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5212\u5206",level:3},{value:"\u8868\u9501 (Table Lock)",id:"\u8868\u9501-table-lock",level:4},{value:"\u8868\u7ea7\u7684 S \u9501\u548c X \u9501",id:"\u8868\u7ea7\u7684-s-\u9501\u548c-x-\u9501",level:5},{value:"\u610f\u5411\u9501(Intention Lock)",id:"\u610f\u5411\u9501intention-lock",level:5},{value:"\u81ea\u589e\u9501(AUTO-INC \u9501)",id:"\u81ea\u589e\u9501auto-inc-\u9501",level:5},{value:"\u5143\u6570\u636e\u9501(MDL\u9501)",id:"\u5143\u6570\u636e\u9501mdl\u9501",level:5},{value:"InnoDB \u7684\u884c\u7ea7\u9501",id:"innodb-\u7684\u884c\u7ea7\u9501",level:4},{value:"\u8bb0\u5f55\u9501(Record Lock)",id:"\u8bb0\u5f55\u9501record-lock",level:5},{value:"\u95f4\u9699\u9501(Gap Lock)",id:"\u95f4\u9699\u9501gap-lock",level:5},{value:"\u4e34\u952e\u9501(Next-Key Locks)",id:"\u4e34\u952e\u9501next-key-locks",level:5},{value:"\u63d2\u5165\u610f\u5411\u9501(Insert Intention Lock)",id:"\u63d2\u5165\u610f\u5411\u9501insert-intention-lock",level:5},{value:"\u9875\u9501",id:"\u9875\u9501",level:4},{value:"\u5bf9\u5f85\u9501\u7684\u6001\u5ea6\u5212\u5206",id:"\u5bf9\u5f85\u9501\u7684\u6001\u5ea6\u5212\u5206",level:3},{value:"\u60b2\u89c2\u9501(Pessimistic Lock)",id:"\u60b2\u89c2\u9501pessimistic-lock",level:4},{value:"\u4e50\u89c2\u9501(Optimistic Lock)",id:"\u4e50\u89c2\u9501optimistic-lock",level:4},{value:"\u7248\u672c\u53f7\u673a\u5236",id:"\u7248\u672c\u53f7\u673a\u5236",level:5},{value:"\u65f6\u95f4\u6233\u673a\u5236",id:"\u65f6\u95f4\u6233\u673a\u5236",level:5},{value:"\u52a0\u9501\u7684\u65b9\u5f0f",id:"\u52a0\u9501\u7684\u65b9\u5f0f",level:3},{value:"\u663e\u5f0f\u9501",id:"\u663e\u5f0f\u9501",level:4},{value:"\u9690\u5f0f\u9501",id:"\u9690\u5f0f\u9501",level:4},{value:"\u5168\u5c40\u9501",id:"\u5168\u5c40\u9501",level:3},{value:"\u6b7b\u9501",id:"\u6b7b\u9501",level:3},{value:"\u6982\u5ff5",id:"\u6982\u5ff5",level:4},{value:"\u4ea7\u751f\u6b7b\u9501\u7684\u5fc5\u8981\u6761\u4ef6",id:"\u4ea7\u751f\u6b7b\u9501\u7684\u5fc5\u8981\u6761\u4ef6",level:4},{value:"\u5904\u7406\u6b7b\u9501",id:"\u5904\u7406\u6b7b\u9501",level:4},{value:"\u907f\u514d\u6b7b\u9501",id:"\u907f\u514d\u6b7b\u9501",level:4},{value:"\u9501\u7ed3\u6784",id:"\u9501\u7ed3\u6784",level:2},{value:"\u6982\u89c8",id:"\u6982\u89c8",level:3},{value:"\u9501\u7ed3\u6784\u89e3\u6790",id:"\u9501\u7ed3\u6784\u89e3\u6790",level:3},{value:"\u9501\u7684\u76d1\u63a7",id:"\u9501\u7684\u76d1\u63a7",level:2},{value:"\u884c\u9501\u7ade\u4e89\u5206\u6790",id:"\u884c\u9501\u7ade\u4e89\u5206\u6790",level:3},{value:"\u5176\u4ed6\u76d1\u63a7\u65b9\u6cd5",id:"\u5176\u4ed6\u76d1\u63a7\u65b9\u6cd5",level:3}],N={toc:m};function o(e){let{components:t,...i}=e;return(0,l.kt)("wrapper",(0,n.Z)({},N,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u7531",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501"),"\u6765\u5b9e\u73b0")),(0,l.kt)("h2",{id:"\u6982\u8ff0"},"\u6982\u8ff0"),(0,l.kt)("p",null,"\u5728\u6570\u636e\u5e93\u4e2d,\u9664\u4f20\u7edf\u7684\u8ba1\u7b97\u8d44\u6e90(\u5982CPU\u3001RAM\u3001I/O\u7b49)\u7684\u4e89\u7528\u4ee5\u5916,",(0,l.kt)("inlineCode",{parentName:"p"},"\u6570\u636e\u4e5f\u662f\u4e00\u79cd\u4f9b\u8bb8\u591a\u7528\u6237\u5171\u4eab\u7684\u8d44\u6e90"),"\u3002",(0,l.kt)("strong",{parentName:"p"},"\u4e3a\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u9700\u8981\u5bf9\u5e76\u53d1\u64cd\u4f5c\u8fdb\u884c\u63a7\u5236"),", \u56e0\u6b64\u4ea7\u751f\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501"),"\u4e86, \u540c\u65f6",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u673a\u5236")," \u4e5f\u4e3a\u5b9e\u73b0 MySQL \u7684\u5404\u4e2a\u9694\u79bb\u7ea7\u522b\u63d0\u4f9b\u4e86\u4fdd\u8bc1\u3002 "),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u51b2\u7a81")," \u4e5f\u662f\u5f71\u54cd\u6570\u636e\u5e93",(0,l.kt)("inlineCode",{parentName:"p"},"\u5e76\u53d1\u8bbf\u95ee\u6027\u80fd"),"\u7684\u4e00\u4e2a\u91cd\u8981\u56e0\u7d20\u3002\u6240\u4ee5\u9501\u5bf9\u6570\u636e\u5e93\u800c\u8a00\u663e\u5f97\u5c24\u5176\u91cd\u8981\u3001\u590d\u6742"),(0,l.kt)("h2",{id:"\u5e76\u53d1\u4e8b\u52a1\u8bbf\u95ee\u76f8\u540c\u8bb0\u5f55"},"\u5e76\u53d1\u4e8b\u52a1\u8bbf\u95ee\u76f8\u540c\u8bb0\u5f55"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"MySQL \u4e2d,\u5e76\u53d1\u4e8b\u52a1\u8bbf\u95ee\u76f8\u540c\u8bb0\u5f55\u7684\u60c5\u51b5\u5927\u81f4\u53ef\u4ee5\u5212\u5206\u4e3a3\u79cd:")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u8bfb-\u8bfb"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u5199-\u5199"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u8bfb-\u5199\u3001\u5199-\u8bfb")))),(0,l.kt)("h3",{id:"\u8bfb-\u8bfb"},"\u8bfb-\u8bfb"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u5e76\u53d1\u4e8b\u52a1\u76f8\u7ee7\u8bfb\u53d6\u76f8\u540c\u7684\u8bb0\u5f55")),(0,l.kt)("li",{parentName:"ul"},"\u8bfb\u53d6\u64cd\u4f5c\u672c\u8eab\u4e0d\u4f1a\u5bf9\u8bb0\u5f55\u6709\u4efb\u4f55\u5f71\u54cd\uff0c\u5e76\u4e0d\u4f1a\u5f15\u8d77\u4ec0\u4e48\u95ee\u9898\uff0c\u6240\u4ee5\u5141\u8bb8\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\u3002")),(0,l.kt)("h3",{id:"\u5199-\u5199"},"\u5199-\u5199"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"\u5e76\u53d1\u4e8b\u52a1\u76f8\u7ee7\u5bf9\u76f8\u540c\u7684\u8bb0\u5f55\u505a\u51fa\u6539\u52a8"),", \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f",(0,l.kt)("inlineCode",{parentName:"p"},"\u810f\u5199")," \u7684\u95ee\u9898,\u4efb\u4f55\u4e00\u79cd\u9694\u79bb\u7ea7\u522b\u90fd\u4e0d\u5141\u8bb8\u8fd9\u79cd\u95ee\u9898\u7684\u53d1\u751f\u3002\u6240\u4ee5\u5728",(0,l.kt)("strong",{parentName:"p"},"\u591a\u4e2a\u672a\u63d0\u4ea4\u4e8b\u52a1\u76f8\u7ee7\u5bf9\u4e00\u6761\u8bb0\u5f55\u505a\u6539\u52a8\u65f6,\u9700\u8981\u8ba9\u5b83\u4eec ",(0,l.kt)("inlineCode",{parentName:"strong"},"\u6392\u961f\u6267\u884c"))," \uff0c\u8fd9\u4e2a",(0,l.kt)("strong",{parentName:"p"},"\u6392\u961f"),"\u7684\u8fc7\u7a0b\u5176\u5b9e\u662f\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501")," \u6765\u5b9e\u73b0\u7684"),(0,l.kt)("p",null,"\u9501\u5176\u5b9e\u662f\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"\u5185\u5b58\u4e2d\u7684\u7ed3\u6784"),", \u5728\u4e8b\u52a1\u6267\u884c\u524d\u672c\u6765\u662f\u6ca1\u6709\u9501\u7684, \u4e5f\u5c31\u662f\u8bf4",(0,l.kt)("strong",{parentName:"p"},"\u4e00\u5f00\u59cb\u662f\u6ca1\u6709\u9501\u7ed3\u6784 \u548c\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u7684"),", \u5982\u56fe\u6240\u793a:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220821151142864",src:a(608).Z,width:"368",height:"168"})),(0,l.kt)("br",null),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5f53\u4e00\u4e2a\u4e8b\u52a1\u60f3\u5bf9\u8fd9\u6761\u8bb0\u5f55\u505a\u6539\u52a8\u65f6,\u9996\u5148\u4f1a\u770b\u770b\u5185\u5b58\u4e2d\u6709\u6ca1\u6709\u4e0e\u8fd9\u6761\u8bb0\u5f55\u5173\u8054\u7684 ",(0,l.kt)("inlineCode",{parentName:"strong"},"\u9501\u7ed3\u6784")," "),", \u5f53\u6ca1\u6709\u7684\u65f6\u5019\u5c31\u4f1a\u5728\u5185\u5b58\u4e2d",(0,l.kt)("strong",{parentName:"p"},"\u751f\u6210\u4e00\u4e2a\u9501\u7ed3\u6784 \u4e0e\u4e4b\u5173\u8054"),"\u3002\u6bd4\u5982\uff0c\u4e8b\u52a1 T1 \u8981\u5bf9\u8fd9\u6761\u8bb0\u5f55\u505a\u6539\u52a8, \u5c31\u9700\u8981\u751f\u6210\u4e00\u4e2a\u9501\u7ed3\u6784\u4e0e\u4e4b\u5173\u8054"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"trx\u4fe1\u606f")," : \u8868\u793a\u9501\u7ed3\u6784\u548c\u54ea\u4e2a\u4e8b\u52a1\u5173\u8054"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"is_waiting")," \uff1a \u8868\u793a\u5f53\u524d\u4e8b\u52a1\u662f\u5426\u5728\u7b49\u5f85")),(0,l.kt)("p",null,"\u5f53\u4e8b\u52a1 T1 \u6539\u52a8\u8fd9\u6761\u8bb0\u5f55\u7684\u65f6\u5019,\u5c31\u4f1a\u751f\u6210\u4e00\u4e2a\u9501\u7ed3\u6784\u4e0e\u8be5\u8bb0\u5f55\u8fdb\u884c\u5173\u8054\u3002\u7531\u4e8e\u4e4b\u524d\u6ca1\u6709\u522b\u7684\u4e8b\u52a1\u4e3a\u8fd9\u4e2a\u8bb0\u5f55\u52a0\u9501,\u6240\u4ee5 ",(0,l.kt)("inlineCode",{parentName:"p"},"is_waiting = false")," ,\u6211\u4eec\u628a\u8fd9\u4e2a\u79f0\u4e4b\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"\u83b7\u53d6\u9501\u6210\u529f (\u52a0\u9501\u6210\u529f)"),",\u7136\u540e\u5c31\u53ef\u4ee5\u7ee7\u7eed\u64cd\u4f5c\u4e86"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220821151333266",src:a(27683).Z,width:"2728",height:"870"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u5728\u4e8b\u52a1 T1 \u63d0\u4ea4\u4e4b\u524d,\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1 T2 \u4e5f\u60f3\u5bf9\u8be5\u8bb0\u5f55\u8fdb\u884c\u6539\u52a8, \u90a3\u4e48 T2 \u5148\u53bb\u770b\u6709\u6ca1\u6709\u9501\u7ed3\u6784\u4e0e\u8fd9\u6761\u8bb0\u5f55\u5173\u8054\u3002\u53d1\u73b0 T1 \u5df2\u7ecf\u52a0\u9501\u4e86,\u90a3\u4e48 T2 \u6b64\u65f6",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e5f\u4f1a\u751f\u6210\u4e00\u4e2a\u9501\u7ed3\u6784\u4e0e\u8be5\u8bb0\u5f55\u5173\u8054"),", \u548c T1 \u4e0d\u540c\u7684\u662f,\u8fd9\u4e2a\u9501\u7ed3\u6784\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"is_waiting = true"),", ",(0,l.kt)("strong",{parentName:"p"},"\u8868\u793a\u9700\u8981\u7b49\u5f85"),"\u3002\u6211\u4eec\u79f0\u4e4b\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"\u83b7\u53d6\u9501\u5931\u8d25(\u52a0\u9501\u5931\u8d25)")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220821154603839",src:a(15376).Z,width:"2844",height:"1608"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u4e8b\u52a1 T1 \u63d0\u4ea4\u4e4b\u540e,\u4f1a",(0,l.kt)("inlineCode",{parentName:"p"},"\u91ca\u653e\u5b83\u751f\u6210\u7684\u9501\u7ed3\u6784"),", \u7136\u540e\u67e5\u770b\u8fd9\u4e2a\u8bb0\u5f55\u662f\u5426\u8fd8\u6709\u5176\u4ed6\u9501\u7ed3\u6784\u4e0e\u4e4b\u5173\u8054\u3002\u7ed3\u679c\u53d1\u73b0 T2 \u8fd8\u5728\u7b49\u5f85\u83b7\u53d6\u9501,\u6240\u4ee5\u5c31\u628a\u4e8b\u52a1 T2 \u9501\u7ed3\u6784\u7684 is_waiting \u4fee\u6539\u4e3a true, \u7136\u540e\u5c06\u4e8b\u52a1 T2 \u5bf9\u5e94\u7684\u7ebf\u7a0b\u5524\u9192,\u90a3\u4e48 T2 \u6b64\u65f6\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u9501\u4e86"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220821154956926",src:a(8665).Z,width:"2668",height:"874"})),(0,l.kt)("admonition",{title:"\u5c0f\u7ed3\u4e00\u4e0b",type:"tip"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u83b7\u53d6\u9501\u6210\u529f(\u52a0\u9501\u6210\u529f)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u5185\u5b58\u4e2d\u751f\u6210\u4e86\u5bf9\u5e94\u7684\u9501\u7ed3\u6784,\u800c\u4e14\u9501\u7ed3\u6784\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"is_wating = false"),", \u4e5f\u5c31\u662f",(0,l.kt)("strong",{parentName:"li"},"\u4e8b\u52a1\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c")),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u7136\u4e0d\u662f\u6240\u6709\u7684\u52a0\u9501\u90fd\u4f1a\u751f\u6210\u5bf9\u5e94\u7684\u9501\u7ed3\u6784, \u6709\u65f6\u5019\u4f1a\u6709",(0,l.kt)("inlineCode",{parentName:"li"},"\u52a0\u9690\u5f0f\u9501"),"\u7684\u60c5\u51b5,\u5b83\u4e0d\u4f1a\u751f\u6210\u5bf9\u5e94\u7684\u9501\u7ed3\u6784, \u4f46\u662f\u4ecd\u53ef\u4ee5\u8d77\u5230\u4fdd\u62a4\u8bb0\u5f55\u7684\u4f5c\u7528"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u83b7\u53d6\u9501\u5931\u8d25(\u52a0\u9501\u5931\u8d25)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u5185\u5b58\u4e2d\u751f\u6210\u4e86\u9501\u7ed3\u6784, \u4f46\u662f\u9501\u7ed3\u6784\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"is_waiting = true"),",\u4e5f\u5c31\u662f",(0,l.kt)("strong",{parentName:"li"},"\u4e8b\u52a1\u9700\u8981\u7b49\u5f85,\u4e0d\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u52a0\u9501"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u9700\u8981\u5728\u5185\u5b58\u4e2d\u751f\u6210\u5bf9\u5e94\u7684\u9501\u7ed3\u6784,\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u64cd\u4f5c,",(0,l.kt)("strong",{parentName:"li"},"\u4e0d\u5305\u62ec\u9690\u5f0f\u9501\u7684\u60c5\u51b5")))))),(0,l.kt)("h3",{id:"\u8bfb-\u5199"},"\u8bfb-\u5199"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e00\u4e2a\u4e8b\u52a1\u8fdb\u884c\u8bfb\u64cd\u4f5c, \u53e6\u5916\u7684\u4e8b\u52a1\u8fdb\u884c\u5199\u64cd\u4f5c"),", \u8fd9\u4e2a\u65f6\u5019\u4f1a\u51fa\u73b0\u810f\u8bfb\u3001\u4e0d\u53ef\u91cd\u590d\u8bfb\u3001\u5e7b\u8bfb\u7684\u73b0\u8c61\u3002\u4e0d\u540c\u6570\u636e\u5e93\u5382\u5546\u5bf9 SQL \u6807\u51c6\u7684\u652f\u6301\u5e76\u4e0d\u540c, \u6bd4\u5982 MySQL \u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"Repeatable Read")),(0,l.kt)("h3",{id:"\u5e76\u53d1\u95ee\u9898\u89e3\u51b3"},"\u5e76\u53d1\u95ee\u9898\u89e3\u51b3"),(0,l.kt)("p",null,"\u600e\u4e48\u89e3\u51b3 \u810f\u8bfb \u3001 \u4e0d\u53ef\u91cd\u590d\u8bfb \u3001 \u5e7b\u8bfb \u8fd9\u4e9b\u95ee\u9898\u5462?\u5176\u5b9e\u6709\u4e24\u79cd\u53ef\u9009\u7684\u89e3\u51b3\u65b9\u6848:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u8bfb\u64cd\u4f5c\u5229\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236 (MVCC)"),", \u5199\u64cd\u4f5c\u8fdb\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"\u52a0\u9501")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"MVCC \u5c31\u662f\u751f\u6210\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"li"},"ReadView"),"(\u53ef\u4ee5\u7b80\u5355\u7684\u7406\u89e3\u4e3a\u662f\u4e00\u4e2a",(0,l.kt)("strong",{parentName:"li"},"\u5386\u53f2\u5feb\u7167"),"),  \u901a\u8fc7 ReadView \u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\u7248\u672c(\u5386\u53f2\u7248\u672c\u7531 undo \u65e5\u5fd7\u6784\u5efa)"),(0,l.kt)("li",{parentName:"ul"},"\u67e5\u8be2\u8bed\u53e5\u53ea\u80fd",(0,l.kt)("inlineCode",{parentName:"li"},"\u8bfb"),"\u5230\u5728\u751f\u6210 ReadView \u4e4b\u524d",(0,l.kt)("inlineCode",{parentName:"li"},"\u5df2\u63d0\u4ea4\u4e8b\u52a1\u6240\u505a\u7684\u66f4\u6539"),", \u5728\u751f\u6210 ReadView \u4e4b\u524d",(0,l.kt)("strong",{parentName:"li"},"\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\u6216\u8005\u4e4b\u540e\u5f00\u542f\u7684\u4e8b\u52a1\u6240\u505a\u7684\u66f4\u6539\u662f\u770b\u4e0d\u5230\u7684")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u5199\u64cd\u4f5c")," \u80af\u5b9a\u9488\u5bf9\u7684\u662f",(0,l.kt)("inlineCode",{parentName:"li"},"\u6700\u65b0\u7248\u672c\u7684\u8bb0\u5f55"),", \u8bfb\u8bb0\u5f55\u7684\u5386\u53f2\u7248\u672c\u548c\u6700\u65b0\u7248\u672c\u4e0d\u51b2\u7a81,\u6240\u4ee5 \u91c7\u7528 MVCC \u65f6, ",(0,l.kt)("strong",{parentName:"li"},"\u8bfb\u5199\u64cd\u4f5c\u4e0d\u51b2\u7a81"))),(0,l.kt)("admonition",{parentName:"li",title:"\u8bf4\u660e",type:"info"},(0,l.kt)("p",{parentName:"admonition"},"\u666e\u901a\u7684\u67e5\u8be2\u8bed\u53e5\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"READ COMMITTED")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"REPEATABLE READ")," \u9694\u79bb\u7ea7\u522b\u4e0b\u4f1a",(0,l.kt)("strong",{parentName:"p"},"\u4f7f\u7528 MVCC \u8bfb\u53d6\u8bb0\u5f55")),(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728 ",(0,l.kt)("em",{parentName:"p"},"read committed")," \u9694\u79bb\u7ea7\u522b\u4e0b, \u4e00\u4e2a",(0,l.kt)("strong",{parentName:"p"},"\u4e8b\u52a1\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d"),"\u6bcf\u6b21\u6267\u884c ",(0,l.kt)("em",{parentName:"p"},"select")," \u64cd\u4f5c\u65f6\u90fd\u4f1a\u751f\u6210",(0,l.kt)("em",{parentName:"p"},"Read View"),", Read View \u672c\u8eab\u5c31\u4fdd\u8bc1\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e8b\u52a1\u4e0d\u53ef\u4ee5\u8bfb\u53d6\u5230\u672a\u63d0\u4ea4\u7684\u4e8b\u52a1\u6240\u505a\u7684\u66f4\u6539"),", \u4e5f\u5c31\u662f\u907f\u514d\u5f97\u4e86\u810f\u8bfb\u7684\u95ee\u9898")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728 ",(0,l.kt)("em",{parentName:"p"},"repeatable read")," \u9694\u79bb\u7ea7\u522b\u4e0b,\u4e00\u4e2a",(0,l.kt)("strong",{parentName:"p"},"\u4e8b\u52a1\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d"),"\u53ea\u6709",(0,l.kt)("inlineCode",{parentName:"p"},"\u7b2c\u4e00\u6b21\u6267\u884c select")," \u624d\u4f1a\u751f\u6210\u4e00\u4e2a ReadView, \u4e4b\u540e\u7684 select \u64cd\u4f5c\u90fd",(0,l.kt)("inlineCode",{parentName:"p"},"\u590d\u7528")," \u8fd9\u4e2a ReadView, \u4e5f\u5c31\u662f\u907f\u514d\u5f97\u4e86\u4e0d\u53ef\u91cd\u590d\u8bfb\u3001\u5e7b\u8bfb\u7684\u95ee\u9898"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u8bfb\u3001\u5199\u64cd\u4f5c"),"\u90fd\u91c7\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"\u52a0\u9501")," \u7684\u65b9\u5f0f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e1a\u52a1\u4e2d\u4e0d\u5141\u8bb8\u8bfb\u53d6\u8bb0\u5f55\u7684\u65e7\u7248\u672c,\u800c\u662f\u6bcf\u6b21\u90fd\u4f1a\u8bfb\u53d6\u8bb0\u5f55\u7684\u6700\u65b0\u7248\u672c\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982\u94f6\u884c\u5b58\u6b3e\u4e2d,\u6211\u4eec\u9700\u8981\u5148\u628a\u8d26\u6237\u7684\u4f59\u989d\u67e5\u8be2\u51fa\u6765,\u7136\u540e\u5c06\u5176\u52a0\u4e0a\u672c\u6b21\u5b58\u50a8\u7684\u91d1\u989d,\u6700\u540e\u518d\u5199\u5165\u5230\u6570\u636e\u5e93\u4e2d\u3002\u4ece\u67e5\u8be2\u4f59\u989d\u5f00\u59cb\u5c31\u5f00\u542f\u4e8b\u52a1\u4e86,\u6b64\u65f6\u4e0d\u60f3\u8ba9\u5176\u4ed6\u4e8b\u52a1\u8fdb\u884c\u5199\u64cd\u4f5c,\u53ea\u6709\u5f53\u91d1\u989d\u5b58\u5165\u5b8c\u6bd5,\u5373\u4e8b\u52a1\u63d0\u4ea4\u5b8c\u6210\u540e,\u5176\u4ed6\u4e8b\u52a1\u624d\u5141\u8bb8\u8bbf\u95ee\u8d26\u6237\u4f59\u989d,\u90a3\u4e48",(0,l.kt)("strong",{parentName:"li"},"\u5728\u8fdb\u884c\u8bfb\u64cd\u4f5c\u7684\u65f6\u5019\u4e5f\u9700\u8981\u52a0\u9501"))),(0,l.kt)("admonition",{parentName:"li",title:"\u8bf4\u660e",type:"info"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u810f\u8bfb\u662f\u56e0\u4e3a\u5f53\u524d\u4e8b\u52a1\u8bfb\u53d6\u4e86\u53e6\u4e00\u4e2a\u4e8b\u52a1\u6ca1\u6709\u63d0\u4ea4\u7684\u8bb0\u5f55,\u5982\u679c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5728\u5199\u8bb0\u5f55\u7684\u65f6\u5019\u5bf9\u8fd9\u4e2a\u8bb0\u5f55\u52a0\u9501,\u90a3\u4e48\u5f53\u524d\u4e8b\u52a1\u5c31\u65e0\u6cd5\u5728\u8bfb\u53d6\u8bb0\u5f55\u7684\u65f6\u5019\u83b7\u53d6\u5230\u9501\u4e86")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e0d\u53ef\u91cd\u590d\u8bfb\u662f\u56e0\u4e3a\u5f53\u524d\u4e8b\u52a1\u5148\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55,\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5bf9\u8fd9\u6761\u8bb0\u5f55\u8fdb\u884c\u4e86\u4fee\u6539\u5e76\u4e14\u63d0\u4ea4\u4e86\u3002\u5982\u679c\u5f53\u524d\u4e8b\u52a1\u8bfb\u53d6\u8bb0\u5f55\u7684\u65f6\u5019\u5148\u5bf9\u8be5\u8bb0\u5f55\u52a0\u9501,\u90a3\u4e48\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u5c31\u65e0\u6cd5\u4fee\u6539\u8be5\u8bb0\u5f55\u4e86")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5e7b\u8bfb\u662f\u56e0\u4e3a\u67d0\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u4e86\u7b26\u5408\u67d0\u4e9b\u641c\u7d22\u6761\u4ef6\u7684\u8bb0\u5f55,\u4e4b\u540e\u5176\u4ed6\u4e8b\u52a1\u53c8\u63d2\u5165\u4e86\u7b26\u5408\u76f8\u540c\u641c\u7d22\u6761\u4ef6\u7684\u8bb0\u5f55,\u5bfc\u81f4\u4e8b\u52a1\u6309\u76f8\u540c\u7684\u67e5\u8be2\u6761\u4ef6\u518d\u6b21\u67e5\u8be2\u7684\u65f6\u5019,\u591a\u4e86\u51e0\u6761\u8bb0\u5f55\u3002\u91c7\u7528\u52a0\u9501\u7684\u65b9\u5f0f\u907f\u514d\u5e7b\u8bfb\u6709\u70b9\u9ebb\u70e6,\u56e0\u4e3a\u5f53\u524d\u4e8b\u52a1\u7b2c\u4e00\u6b21\u8bfb\u53d6\u8bb0\u5f55\u7684\u65f6\u5019,\u4f60\u5e76\u4e0d\u77e5\u9053\u662f\u5426\u6709\u5176\u4ed6\u4e8b\u52a1\u4f1a\u63d2\u5165\u65b0\u7684\u8bb0\u5f55,\u5373\u4f7f\u6709\u4e5f\u4e0d\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u63d2\u5165,",(0,l.kt)("strong",{parentName:"p"},"\u4e5f\u5c31\u662f\u8bf4\u4e0d\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u52a0\u9501,\u4e5f\u4e0d\u77e5\u9053\u7ed9\u8c01\u52a0\u9501"))))))),(0,l.kt)("br",null),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6211\u4eec\u53d1\u73b0:")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"MVCC")," \u65b9\u5f0f\u7684\u8bdd, ",(0,l.kt)("inlineCode",{parentName:"li"},"\u8bfb\u5199"),"\u64cd\u4f5c\u5e76\u4e0d\u51b2\u7a81,\u6027\u80fd\u66f4\u597d"),(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"\u52a0\u9501")," \u65b9\u5f0f\u7684\u8bdd,",(0,l.kt)("inlineCode",{parentName:"li"},"\u8bfb\u5199"),"\u64cd\u4f5c\u5c31\u9700\u8981\u4f9d\u6b21\u6392\u961f,\u5f71\u54cd\u6027\u80fd")),(0,l.kt)("p",null,"\u4e00\u822c\u7684\u60c5\u51b5\u4e0b,\u6211\u4eec\u66f4\u613f\u610f\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"MVCC")," \u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u5e76\u53d1\u8bfb\u5199\u7684\u95ee\u9898,\u4f46\u662f\u6709\u65f6\u5019\u57fa\u4e8e\u7279\u6b8a\u7684\u4e1a\u52a1\u573a\u666f,\u5c31\u9700\u8981\u91c7\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"\u52a0\u9501"),"\u7684\u65b9\u5f0f\u5904\u7406\u5e76\u53d1\u8bfb\u5199\u7684\u95ee\u9898"),(0,l.kt)("h2",{id:"\u9501\u7684\u4e0d\u540c\u89d2\u5ea6\u5206\u7c7b"},"\u9501\u7684\u4e0d\u540c\u89d2\u5ea6\u5206\u7c7b"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220821230720208",src:a(81841).Z,width:"1738",height:"1088"})),(0,l.kt)("h3",{id:"\u6570\u636e\u64cd\u4f5c\u7c7b\u578b\u5212\u5206"},"\u6570\u636e\u64cd\u4f5c\u7c7b\u578b\u5212\u5206"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5bf9\u4e8e\u6570\u636e\u5e93\u4e2d\u5e76\u53d1\u4e8b\u52a1\u7684",(0,l.kt)("strong",{parentName:"p"},"\u8bfb-\u8bfb"),"\u4e0d\u4f1a\u5f15\u8d77\u5e76\u53d1\u95ee\u9898,\u4f46\u662f\u5bf9\u4e8e",(0,l.kt)("inlineCode",{parentName:"p"},"\u5199-\u5199\u3001\u8bfb-\u5199\u3001\u5199-\u8bfb")," \u5c31\u53ef\u80fd\u4f1a\u5f15\u8d77\u5e76\u53d1\u95ee\u9898,\u9700\u8981\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"MVCC")," \u6216\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"\u52a0\u9501")," \u7684\u65b9\u5f0f\u89e3\u51b3 ")),(0,l.kt)("h4",{id:"\u8bfb\u9501\u5199\u9501"},"\u8bfb\u9501\u3001\u5199\u9501"),(0,l.kt)("p",null,"\u5728\u4f7f\u7528\u52a0\u9501\u7684\u5904\u7406\u5e76\u53d1\u95ee\u9898\u7684\u65f6\u5019,\u5b58\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"\u8bfb\u4ee5\u53ca\u5199")," \u4e24\u79cd\u64cd\u4f5c, \u5e76\u4e14\u8fd9\u4e24\u4e2a\u64cd\u4f5c",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e0d\u80fd\u76f8\u4e92\u5f71\u54cd"),", \u6240\u4ee5 MySQL \u6839\u636e\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u8bbe\u8ba1\u4e86\u4e24\u79cd\u9501:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u8bfb\u9501")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u53eb\u505a",(0,l.kt)("inlineCode",{parentName:"li"},"\u5171\u4eab\u9501 (Share Lock)\u3001S \u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5728\u4e8b\u52a1\u8981\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55\u7684\u65f6\u5019,\u9700\u8981\u5148\u83b7\u53d6\u8fd9\u4e2a\u8bb0\u5f55\u7684 S \u9501")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u5199\u9501"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u53eb\u505a ",(0,l.kt)("inlineCode",{parentName:"li"},"\u6392\u5b83\u9501 (Exclusive Lock), X \u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5728\u4e8b\u52a1\u9700\u8981\u4fee\u6539\u4e00\u6761\u8bb0\u5f55\u7684\u65f6\u5019,\u9700\u8981\u5148\u83b7\u53d6\u8fd9\u4e2a\u8bb0\u5f55\u7684 X \u9501"))))),(0,l.kt)("p",null,"\u9700\u8981\u6ce8\u610f\u7684\u662f"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("mark",null,"S \u9501\u548c X \u9501\u65e2\u53ef\u4ee5\u52a0\u5728\u8868\u4e0a,\u4e5f\u53ef\u4ee5\u52a0\u5728\u6570\u636e\u884c\u4e0a(\u8fd9\u4e2a\u5c31\u662f\u6309\u7167",(0,l.kt)("strong",null,"\u9501\u7c92\u5ea6\u8fdb\u884c\u5212\u5206"),")")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("mark",null,"S \u9501\u4e4b\u95f4\u662f\u4e0d\u51b2\u7a81\u7684,X \u9501\u4e0e S \u9501\u6216\u8005 X \u9501\u4e4b\u95f4\u662f\u5426\u51b2\u7a81,\u9700\u8981\u770b\u662f\u9501\u7684\u7c92\u5ea6\u4ee5\u53ca\u9501\u4f4f\u7684\u662f\u5426\u662f\u540c\u4e00\u884c\u6570\u636e"))),(0,l.kt)("admonition",{title:"\u4e3e\u4e2a\u4f8b\u5b50\ud83c\udf30",type:"info"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u5047\u8bbe\u4e8b\u52a1 T1\u9996\u5148\u83b7\u53d6\u4e86\u4e00\u6761\u8bb0\u5f55\u7684 S \u9501,\u4e4b\u540e\u4e8b\u52a1 T2 \u4e5f\u9700\u8981\u8bbf\u95ee\u8fd9\u6761\u8bb0\u5f55:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e8b\u52a1 T2 \u662f",(0,l.kt)("strong",{parentName:"li"},"\u8bfb\u53d6\u6570\u636e"),", \u9700\u8981\u518d\u83b7\u53d6\u4e00\u6761\u8bb0\u5f55\u7684 S \u9501,\u90a3\u4e48\u4e8b\u52a1 T2 \u4e5f\u4f1a\u83b7\u53d6\u8fd9\u4e2a S \u9501,\u610f\u5473\u7740 \u4e8b\u52a1 T1\u3001T2 \u5728\u8fd9\u4e2a\u8bb0\u5f55\u4e0a",(0,l.kt)("inlineCode",{parentName:"li"},"\u540c\u65f6\u6301\u6709 S \u9501")),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e8b\u52a1 T2 \u662f",(0,l.kt)("strong",{parentName:"li"},"\u5199\u5165\u6570\u636e"),", \u9700\u8981\u83b7\u53d6\u8fd9\u6761\u8bb0\u5f55\u7684 X \u9501,\u90a3\u4e48\u8fd9\u4e2a",(0,l.kt)("strong",{parentName:"li"},"\u5199\u64cd\u4f5c\u4f1a\u88ab\u963b\u585e"),", \u76f4\u5230\u4e8b\u52a1 T1 \u91ca\u653e\u4e86\u8bfb\u64cd\u4f5c\u7684 S \u9501\u4e3a\u6b62"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u5047\u8bbe\u4e8b\u52a1 T1\u9996\u5148\u83b7\u53d6\u4e86\u4e00\u6761\u8bb0\u5f55\u7684 X \u9501,\u4e4b\u540e\u4e8b\u52a1 T2 \u4e5f\u9700\u8981\u8bbf\u95ee\u8fd9\u6761\u8bb0\u5f55:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u65e0\u8bba\u4ec0\u4e48\u64cd\u4f5c,",(0,l.kt)("strong",{parentName:"li"},"\u90fd\u4f1a\u88ab\u963b\u585e"),", \u76f4\u5230\u4e8b\u52a1 T1 \u91ca\u653e\u4e86\u5199\u64cd\u4f5c\u7684 X \u9501\u4e3a\u6b62"))))),(0,l.kt)("h4",{id:"\u9501\u5b9a\u8bfb"},"\u9501\u5b9a\u8bfb"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528",(0,l.kt)("strong",{parentName:"p"},"\u52a0\u9501"),"\u53ef\u4ee5\u5904\u7406",(0,l.kt)("strong",{parentName:"p"},"\u810f\u8bfb\u3001\u4e0d\u53ef\u91cd\u590d\u8bfb\u3001\u5e7b\u8bfb")," \u7684\u4e8b\u52a1\u5e76\u53d1\u95ee\u9898,\u5728\u4e0a\u9762\u6211\u4eec\u8bf4",(0,l.kt)("strong",{parentName:"p"},"\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55\u7684\u65f6\u5019,\u9700\u8981\u83b7\u53d6\u4e00\u4e2a S \u9501"),",\u8fd9\u4e2a\u5b9e\u9645\u4e0a\u662f\u4e0d\u4e25\u8c28\u7684,",(0,l.kt)("strong",{parentName:"p"},"\u6709\u65f6\u5019\u9700\u8981\u518d\u8bfb\u53d6\u6570\u636e\u7684\u65f6\u5019\u4e0d\u8ba9\u5176\u4ed6\u4e8b\u52a1\u8bfb\u53d6"),",\u6240\u4ee5 MySQL \u63d0\u4f9b\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"\u7ed9\u8bfb\u64cd\u4f5c\u52a0\u9501\u7684\u7981\u6b62\u5176\u4ed6\u4e8b\u52a1\u8bfb\u7684\u529f\u80fd"),", \u79f0\u4e4b\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u5b9a\u8bfb"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u83b7\u53d6 S \u9501\u7684\u9501\u5b9a\u8bfb")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT .... LOCK IN SHARE MODE\n-- \u57fa\u4e8e MySQL8.0 \u7684\u65b0\u8bed\u6cd5\nSELECT .... FOR SHARE\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u83b7\u53d6 X \u9501\u7684\u9501\u5b9a\u8bfb")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u67d0\u4e9b\u60c5\u51b5\u7684\u4e0b,\u6211\u4eec\u9700\u8981\u518d\u8bfb\u64cd\u4f5c\u7684\u65f6\u5019\u83b7\u53d6 X \u9501,\u8ba9\u540e\u9762\u7684\u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u4e00\u6837\u88ab\u963b\u585e")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT ... FOR UPDATE\n")))),(0,l.kt)("admonition",{title:"\ud83c\udf1fMySQL8.0 \u65b0\u7279\u6027",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"\u5047\u8bbe\u4e8b\u52a1 T1\u9501\u5b9a\u8bfb,\u90a3\u4e48\u4e8b\u52a1 T2 \u4f1a\u5904\u4e8e\u963b\u585e\u72b6\u6001,\u5f53\u662f T1 \u63d0\u4ea4\u4e8b\u52a1\u91ca\u653e X \u9501\u4e4b\u540e,T2 \u624d\u80fd\u8bfb\u53d6\u6570\u636e,\u5982\u679c T1 \u6267\u884c\u65f6\u95f4\u8fc7\u957f, \u5e76\u4e14\u963b\u585e\u7684\u4e8b\u52a1\u5c31\u4f1a\u8d85\u65f6")),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220828144713514",src:a(64862).Z,width:"2210",height:"568"})),(0,l.kt)("br",null),(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5728 5.7 \u7248\u672c\u4e4b\u524d, ",(0,l.kt)("em",{parentName:"p"},"SELECT \u2026 FOR UPDATE")," \u5982\u679c\u4e00\u76f4\u6ca1\u6709\u83b7\u53d6\u5230\u9501,\u4f1a\u5728\u6307\u5b9a\u7684\u53c2\u6570 ",(0,l.kt)("inlineCode",{parentName:"p"}," innodb_lock_wait_timeout")," \u79d2\u540e\u8d85\u65f6")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5728 ",(0,l.kt)("strong",{parentName:"p"},"8.0")," \u7248\u672c\u4e2d,\u652f\u6301\u5728",(0,l.kt)("em",{parentName:"p"},"SELECT \u2026 FOR UPDATE | SHARE")," \u540e\u9762\u52a0\u4e0a\u53c2\u6570",(0,l.kt)("inlineCode",{parentName:"p"},"NOWAIT\u3001SKIP LOCKED")," \u53c2\u6570\u6765",(0,l.kt)("strong",{parentName:"p"},"\u8df3\u8fc7\u9501\u7b49\u5f85\u6216\u8005\u8df3\u8fc7\u9501\u5b9a")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"NOWAIT")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5982\u679c\u67e5\u8be2\u7684\u884c\u5df2\u7ecf\u52a0\u9501,\u90a3\u4e48\u7acb\u5373\u62a5\u9519\u8fd4\u56de")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"SKIP LOCKED"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5982\u679c\u67e5\u8be2\u7684\u884c\u5df2\u7ecf\u52a0\u9501,\u90a3\u4e48\u8fd4\u56de,\u4f46\u662f\u8fd4\u56de\u7ed3\u679c\u4e2d\u4e0d\u5305\u542b\u88ab\u9501\u5b9a\u7684\u884c"))))))),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"1. NOWAIT")),(0,l.kt)("p",{parentName:"admonition"},"\u53ef\u4ee5\u770b\u5230,\u4e8b\u52a1 T1 \u5bf9\u8868\u4e2did=1 \u7684\u884c\u9501\u5b9a\u4e86,\u4e8b\u52a1 T2 \u83b7\u53d6\u6240\u6709\u6570\u636e\u7684\u65f6\u5019\u4f1a\u7acb\u5373\u62a5\u9519\u8fd4\u56de"),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220828150832894",src:a(76555).Z,width:"2860",height:"460"})),(0,l.kt)("br",null),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"2. SKIP LOCKED")),(0,l.kt)("p",{parentName:"admonition"},"\u53ef\u4ee5\u770b\u5230,\u4e8b\u52a1 T1 \u5bf9\u8868\u4e2did=1 \u7684\u884c\u9501\u5b9a\u4e86,\u4e8b\u52a1 T2 \u83b7\u53d6\u6240\u6709\u6570\u636e\u7684\u65f6\u5019,\u4e0d\u4f1a\u56e0\u4e3a\u8bfb\u64cd\u4f5c\u52a0\u4e86 X \u9501\u5c31\u963b\u585e\u4f4f,\u800c\u662f\u7acb\u5373\u8fd4\u56de\u7ed3\u679c(",(0,l.kt)("strong",{parentName:"p"},"\u5ffd\u7565\u9501\u5b9a\u7684\u884c"),")"),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220828151252910",src:a(14205).Z,width:"2046",height:"590"}))),(0,l.kt)("h4",{id:"\u5199\u64cd\u4f5c"},"\u5199\u64cd\u4f5c"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u65e5\u5e38\u5f00\u53d1\u4e2d\u7684\u5199\u64cd\u4f5c\u65e0\u975e\u662f: ",(0,l.kt)("em",{parentName:"p"},"DELETE\u3001UPDATE\u3001INSERT")," \u8fd9 3 \u79cd")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\tDELETE"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5bf9\u4e00\u6761\u8bb0\u5f55\u8fdb\u884c DELETE \u64cd\u4f5c\u5c31\u662f\u5728\u7d22\u5f15\u4e2d\u5b9a\u4f4d\u5230\u8fd9\u884c\u8bb0\u5f55\u7684\u4f4d\u7f6e, \u7136\u540e",(0,l.kt)("strong",{parentName:"li"},"\u83b7\u53d6\u8fd9\u884c\u8bb0\u5f55\u7684 X \u9501,\u518d\u6267\u884c delete mark(\u4fee\u6539\u884c\u8bb0\u5f55\u7684\u6807\u5fd7\u4f4d)\u64cd\u4f5c")),(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u53ef\u4ee5\u5c06\u5220\u9664\u64cd\u4f5c\u770b\u6210\u662f",(0,l.kt)("mark",null,"\u5bf9\u67d0\u884c\u8bb0\u5f55\u83b7\u53d6\u5176 X \u9501\u7684\u9501\u5b9a\u8bfb")," "))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"UPDATE"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u60c5\u51b5 1"),": \u6ca1\u6709\u4fee\u6539\u4e3b\u952e,\u4e14\u88ab\u66f4\u65b0\u7684\u5217\u6240\u5360\u7528\u7684\u5b58\u50a8\u7a7a\u95f4\u6ca1\u6709\u53d8\u5316",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5b9a\u4f4d\u8bb0\u5f55\u7684\u5728 B+Tree \u7684\u4f4d\u7f6e,\u7136\u540e",(0,l.kt)("strong",{parentName:"li"},"\u83b7\u53d6\u8fd9\u884c\u8bb0\u5f55\u7684X \u9501,\u6700\u540e\u518d\u539f\u8bb0\u5f55\u7684\u4f4d\u7f6e\u8fdb\u884c\u4fee\u6539\u64cd\u4f5c")),(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u53ef\u4ee5\u5c06\u5176\u770b\u6210\u662f",(0,l.kt)("mark",null,"\u5bf9\u67d0\u884c\u8bb0\u5f55\u83b7\u53d6\u5176 X \u9501\u7684\u9501\u5b9a\u8bfb")," "))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u60c5\u51b5 2:")," \u6ca1\u6709\u4fee\u6539\u4e3b\u952e\u503c,\u4f46\u662f\u66f4\u65b0\u7684\u5217\u6240\u5360\u7528\u7684\u5b58\u50a8\u7a7a\u95f4\u53d1\u751f\u4e86\u53d8\u5316",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f4d\u8bb0\u5f55\u7684\u5728 B+Tree \u7684\u4f4d\u7f6e,\u7136\u540e",(0,l.kt)("strong",{parentName:"li"},"\u83b7\u53d6\u8fd9\u884c\u8bb0\u5f55\u7684X \u9501,\u5c06\u8fd9\u6761\u8bb0\u5f55\u5f7b\u5e95\u5220\u9664(\u76f4\u63a5\u5c06\u8bb0\u5f55\u79fb\u5165\u5783\u573e\u94fe\u8868),\u6700\u540e\u63d2\u5165\u4e00\u6761\u65b0\u7684\u8bb0\u5f55")),(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u53ef\u4ee5\u5c06\u5176\u770b\u6210\u662f",(0,l.kt)("mark",null,"\u5bf9\u67d0\u884c\u8bb0\u5f55\u83b7\u53d6\u5176 X \u9501\u7684\u9501\u5b9a\u8bfb,\u7136\u540e\u65b0\u8bb0\u5f55\u7684\u63d2\u5165\u7531",(0,l.kt)("strong",null,"INSERT"),"\u64cd\u4f5c\u63d0\u4f9b",(0,l.kt)("strong",null,"\u9690\u5f0f\u9501"),"\u8fdb\u884c\u4fdd\u62a4")," "))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u60c5\u51b5 3:")," \u4fee\u6539\u4e86\u4e3b\u952e\u503c",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5bf9\u539f\u6765\u7684\u8bb0\u5f55\u8fdb\u884c",(0,l.kt)("inlineCode",{parentName:"li"},"DELETE"),"\u64cd\u4f5c,\u7136\u540e\u518d\u8fdb\u884c\u4e00\u6b21",(0,l.kt)("inlineCode",{parentName:"li"},"INSERT")," \u64cd\u4f5c,\u52a0\u9501\u64cd\u4f5c\u7531 insert\u3001delete \u7684\u89c4\u5219\u63a7\u5236"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u8fd9\u91cc\u53ea\u8fdb\u884c delete mark \u64cd\u4f5c,\u662f\u56e0\u4e3a\u5176\u4ed6\u4e8b\u52a1\u53ef\u80fd\u4e5f\u8981\u8bbf\u95ee\u8be5\u8bb0\u5f55")))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"INSERT"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u65b0\u63d2\u5165\u8bb0\u5f55\u7684\u64cd\u4f5c\u4e0d\u52a0\u9501,\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"li"},"\u9690\u5f0f\u9501"),"\u7684\u7ed3\u6784\u6765\u4fdd\u62a4\u8fd9\u6761\u65b0\u63d2\u5165\u7684\u8bb0\u5f55\u5728\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u524d\u4e0d\u88ab\u5176\u4ed6\u4e8b\u52a1\u8bbf\u95ee\u5230"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u4e00\u822c\u4e0d\u4f1a\u5728\u5185\u5b58\u4e2d\u751f\u6210\u5bf9\u5e94\u7684\u9501\u7ed3\u6784,\u5f53\u7136\u4e5f\u6709\u7279\u6b8a\u60c5\u51b5"))))),(0,l.kt)("admonition",{title:"\u6ce8\u610f",type:"caution"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},"\u6240\u8c13\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"\u5f7b\u5e95\u5220\u9664"),",\u5b9e\u9645\u4e0a\u5c31\u5c06\u8bb0\u5f55\u4ece\u6b63\u5e38\u7684\u94fe\u8868\u4e2d\u79fb\u9664,\u653e\u5165",(0,l.kt)("inlineCode",{parentName:"li"},"\u5783\u573e\u94fe\u8868"),"\u4e2d,\u8fd9\u4e2a\u64cd\u4f5c\u4e00\u822c\u7531",(0,l.kt)("inlineCode",{parentName:"li"},"purge \u7ebf\u7a0b")," \u5904\u7406"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"UPDATE"),"\u64cd\u4f5c\u4e2d\u66f4\u65b0\u5217\u7684\u503c",(0,l.kt)("inlineCode",{parentName:"li"},"\u5360\u7528\u7a7a\u95f4"),"\u53d1\u751f\u53d8\u5316,\u4f1a\u76f4\u63a5\u5c06\u8fd9\u6761\u8bb0\u5f55",(0,l.kt)("strong",{parentName:"li"},"\u5f7b\u5e95\u5220\u9664\u653e\u5165\u5783\u573e\u94fe\u8868"),",\u8fd9\u4e2a\u64cd\u4f5c\u4e0d\u662f\u7531",(0,l.kt)("em",{parentName:"li"},"purge \u7ebf\u7a0b"),"\u5904\u7406\u7684,\u800c\u662f\u7531",(0,l.kt)("inlineCode",{parentName:"li"},"\u7528\u6237\u7ebf\u7a0b\u76f4\u63a5\u5904\u7406\u7684"),",\u7136\u540e\u518d\u63d2\u5165\u65b0\u7684\u8bb0\u5f55"))),(0,l.kt)("h3",{id:"\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5212\u5206"},"\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5212\u5206"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u9501\u65e2\u53ef\u4ee5\u9488\u5bf9\u4e8e\u67d0\u6761\u8bb0\u5f55,\u4e5f\u53ef\u4ee5\u9488\u5bf9\u4e8e\u6574\u5f20\u8868\u3002"),(0,l.kt)("ul",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5982\u679c\u662f\u9488\u5bf9\u67d0\u884c\u8bb0\u5f55, \u90a3\u4e48\u5f71\u54cd\u7684\u53ea\u6709\u8fd9\u51e0\u6761\u8bb0\u5f55\u800c\u5df2,\u90a3\u4e48\u8fd9\u4e2a\u9501\u7684\u7c92\u5ea6\u5c31\u662f\u6bd4\u8f83\u7ec6\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5982\u679c\u9501\u662f\u9488\u5bf9\u6574\u5f20\u8868, \u90a3\u4e48\u5f71\u54cd\u7684\u5c31\u662f\u8fd9\u5f20\u8868\u91cc\u9762\u7684",(0,l.kt)("strong",{parentName:"p"},"\u6240\u6709\u8bb0\u5f55"),",\u90a3\u4e48\u8fd9\u4e2a\u9501\u7684\u7c92\u5ea6\u5c31\u5f88\u7c97")))),(0,l.kt)("p",null,"\u4e3a\u4e86\u5c3d\u53ef\u80fd\u7684\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u5e76\u53d1\u6027\u80fd,\u6bcf\u6b21\u9501\u5b9a\u7684\u8303\u56f4\u8d8a\u5c0f\u8d8a\u597d,\u7406\u8bba\u4e0a",(0,l.kt)("strong",{parentName:"p"},"\u6bcf\u6b21\u53ea\u9501\u5b9a\u5f53\u524d\u884c\u8bb0\u5f55\u53ef\u4ee5\u83b7\u53d6\u5230\u6700\u5927\u7684\u6700\u5927\u7684\u5e76\u53d1\u5ea6"),", \u6240\u4ee5\u6709",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u7c92\u5ea6")," \u7684\u6982\u5ff5,\u9501\u7c92\u5ea6\u53ef\u4ee5\u5927\u81f4\u5206\u4e3a: ",(0,l.kt)("inlineCode",{parentName:"p"},"\u8868\u9501 -> \u9875\u9501 -> \u884c\u9501")),(0,l.kt)("h4",{id:"\u8868\u9501-table-lock"},"\u8868\u9501 (Table Lock)"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u4f1a\u9501\u4f4f\u6574\u5f20\u8868, \u662f MySQL \u4e2d",(0,l.kt)("strong",{parentName:"p"},"\u6700\u57fa\u672c\u7684\u9501\u7b56\u7565, \u4e0d\u4f9d\u8d56\u4e8e\u5b58\u50a8\u5f15\u64ce"),",\u5e76\u4e14",(0,l.kt)("strong",{parentName:"p"},"\u9501\u7684\u5f00\u9500\u6700\u5c0f,\u7c92\u5ea6\u6700\u5927"),"\u3002\u4e14\u7531\u4e8e\u4f1a\u9501\u4f4f\u6574\u5f20\u8868,\u53ef\u4ee5\u5f88\u597d\u7684\u907f\u514d\u6b7b\u9501\u7684\u95ee\u9898, \u4f46\u662f\u95ee\u9898\u662f: ",(0,l.kt)("strong",{parentName:"p"},"\u5e76\u53d1\u6027\u80fd\u662f\u6700\u5dee\u7684,\u76f8\u5f53\u4e8e\u662f\u4e32\u884c\u7684"))),(0,l.kt)("h5",{id:"\u8868\u7ea7\u7684-s-\u9501\u548c-x-\u9501"},"\u8868\u7ea7\u7684 S \u9501\u548c X \u9501"),(0,l.kt)("blockquote",null,(0,l.kt)("ul",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u7ed9\u8868\u52a0\u4e86 S \u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u53ef\u4ee5\u83b7\u53d6\u8be5\u8868\u7684 S \u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u53ef\u4ee5\u83b7\u53d6\u8be5\u8868\u4e2d\u67d0\u4e9b\u8bb0\u5f55\u7684 S \u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u65e0\u6cd5\u83b7\u53d6\u8be5\u8868\u7684 X \u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u65e0\u6cd5\u83b7\u53d6\u8be5\u8868\u4e2d\u67d0\u4e9b\u8bb0\u5f55\u7684 X \u9501"))),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u7ed9\u8868\u52a0\u4e86 X \u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u65e0\u6cd5\u7ee7\u7eed\u83b7\u53d6\u8be5\u8868\u7684 S \u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u65e0\u6cd5\u7ee7\u7eed\u83b7\u53d6\u8be5\u8868\u4e2d\u67d0\u4e9b\u8bb0\u5f55\u7684 S \u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u65e0\u6cd5\u83b7\u53d6\u8be5\u8868\u7684 X \u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5176\u4ed6\u4e8b\u52a1\u65e0\u6cd5\u83b7\u53d6\u8be5\u8868\u4e2d\u67d0\u4e9b\u8bb0\u5f55\u7684 X \u9501"))))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5bf9\u67d0\u4e2a\u8868\u6267\u884c ",(0,l.kt)("em",{parentName:"p"},"SELECT\u3001INSERT\u3001DELETE\u3001UPDATE")," \u8bed\u53e5\u65f6, InnoDB \u5b58\u50a8\u5f15\u64ce\u662f ",(0,l.kt)("strong",{parentName:"p"},"\u4e0d\u4f1a\u4e3a\u8868\u6dfb\u52a0\u8868\u7ea7\u522b\u7684 S \u9501\u6216\u8005 X \u9501\u7684"),", \u4f46\u662f\u5bf9\u8868\u6267\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"ALTER TABLE\u3001DROP TABLE"),"\u8fd9\u7c7b ",(0,l.kt)("strong",{parentName:"p"},"DDL")," \u8bed\u53e5\u7684\u65f6\u5019, \u5176\u4ed6\u4e8b\u52a1\u5bf9\u8fd9\u4e2a\u8868\u53d1\u8d77 ",(0,l.kt)("em",{parentName:"p"},"select\u3001insert\u3001delete\u3001update")," \u7684\u8bed\u53e5\u4f1a\u88ab\u963b\u585e\u4f4f")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u540c\u6837\u7684,\u5728\u4e8b\u52a1\u4e2d\u5bf9\u67d0\u4e2a\u8868\u6267\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"SELECT\u3001INSERT\u3001DELETE\u3001UPDATE"),"\u7684\u65f6\u5019,\u5728\u5176\u4ed6\u4e8b\u52a1\u4e2d\u5bf9\u8be5\u8868\u6267\u884c ",(0,l.kt)("strong",{parentName:"p"},"DDL")," \u8bed\u53e5\u4e5f\u4f1a\u53d1\u751f\u963b\u585e")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e0a\u9762\u4e24\u4e2a\u7684\u8fc7\u7a0b\u662f\u901a\u8fc7\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"Server \u5c42")," \u4f7f\u7528\u4e00\u79cd ",(0,l.kt)("inlineCode",{parentName:"p"},"\u5143\u6570\u636e\u9501(Metadata Lock,\u7b80\u79f0 MDL)")," \u7684\u7ed3\u6784\u6765\u5b9e\u73b0\u7684")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u4e00\u822c\u60c5\u51b5\u4e0b\u4e5f\u4e0d\u4f1a\u4f7f\u7528 InnoDB \u63d0\u4f9b\u7684\u8868\u7ea7\u522b\u7684 S \u9501\u548c X \u9501"),", \u53ea\u6709\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u4e0b\u624d\u4f1a\u7528\u5230(\u6bd4\u5982\u7cfb\u7edf\u5d29\u6e83\u6062\u590d\u7684\u65f6\u5019),\u6bd4\u5982\u5728\u7cfb\u7edf\u53d8\u91cf ",(0,l.kt)("em",{parentName:"p"},"autocommit = 0, innodb_table_locks=1")," \u65f6,\u8981\u624b\u52a8\u83b7\u53d6\u8868 T \u7684 S \u9501\u6216\u8005 X \u9501,\u53ef\u4ee5\u6309\u4e0b\u9762\u7684\u65b9\u5f0f\u83b7\u53d6:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"-- InnoDB \u5b58\u50a8\u5f15\u64ce\u4f1a\u5bf9\u8868 T \u52a0\u4e0a\u8868\u7ea7\u522b\u7684 S \u9501\nLOCK TABLES \u8868\u540d READ\n\n-- InnoDB \u5b58\u50a8\u5f15\u64ce\u4f1a\u5bf9\u8868 T \u52a0\u4e0a\u8868\u7ea7\u522b\u7684 X \u9501\nLOCK TABLES \u8868\u540d WRITE\n\n# \u67e5\u770b\u54ea\u4e9b\u8868\u88ab\u9501\u4f4f\nshow open tables where in_use > 0\n\n# \u89e3\u9664\u8868\u7684 LOCk\nUNLOCK TABLES\n")))),(0,l.kt)("h5",{id:"\u610f\u5411\u9501intention-lock"},"\u610f\u5411\u9501(Intention Lock)"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u6211\u4eec\u63d0\u5230\u4e8b\u52a1\u53ef\u4ee5\u4e3a\u8868\u7684\u67d0\u4e9b\u8bb0\u5f55\u4e0a\u52a0 S \u9501\u548c X \u9501, \u5982\u679c\u5176\u4ed6\u4e8b\u52a1\u9700\u8981\u52a0\u4e0a\u8868\u7ea7\u9501,\u90a3\u4e48",(0,l.kt)("strong",{parentName:"p"},"InnoDB \u5b58\u50a8\u5f15\u64ce\u662f\u5982\u4f55\u786e\u5b9a\u8868\u4e2d\u662f\u5426\u5df2\u7ecf\u6709\u6570\u636e\u88ab\u9501\u4f4f\u4e86\u5462?")," \u80af\u5b9a\u4e0d\u80fd\u904d\u5386\u5427?\u6bd5\u7adf\u8868\u4e2d\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u5f88\u591a,\u8fd9\u65f6\u5019\u5c31\u9700\u8981\u610f\u5411\u9501,\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u6807\u5fd7\u4f4d")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"InnoDB")," \u63d0\u4f9b\u4e86\u4e24\u79cd",(0,l.kt)("inlineCode",{parentName:"p"},"\u610f\u5411\u9501"),",\u901a\u8fc7\u610f\u5411\u9501\u53ef\u4ee5\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"\u9700\u8981\u9501\u8868\u7684\u65f6\u5019"),", \u5f88\u5feb\u7684\u786e\u5b9a\u8868\u4e2d\u662f\u5426\u6709\u8bb0\u5f55\u5df2\u7ecf\u88ab\u9501\u4f4f"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u610f\u5411\u5171\u4eab\u9501(Intention Shared Lock,\u7b80\u79f0 IS\u9501)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u4e8b\u52a1\u51c6\u5907\u5728\u67d0\u6761\u8bb0\u5f55\u4e0a\u52a0\u4e0a S \u9501\u7684\u65f6\u5019,\u5148\u5728\u8868\u7ea7\u522b\u4e0a\u52a0\u4e0a IS \u9501")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u610f\u5411\u6392\u5b83\u9501(Intention Exclusive Lock,\u7b80\u79f0 IX \u9501)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u4e8b\u52a1\u51c6\u5907\u5728\u67d0\u6761\u8bb0\u5f55\u4e0a\u52a0\u4e0a X \u9501\u7684\u65f6\u5019,\u5148\u5728\u8868\u7ea7\u522b\u4e0a\u52a0\u4e0a IX \u9501"))))),(0,l.kt)("admonition",{title:"\u8bf4\u660e",type:"tip"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u5728\u52a0 IS \u9501\u7684\u65f6\u5019, \u4e0d\u4f1a\u5173\u5fc3\u8868\u4e0a\u9762\u662f\u5426\u6709 IX \u9501\u3002\u540c\u6837\u7684,\u5728\u52a0 IX \u9501\u7684\u65f6\u5019, \u4e0d\u4f1a\u5173\u5fc3\u8868\u4e0a\u9762\u662f\u5426\u6709 IS \u9501")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5373 ",(0,l.kt)("strong",{parentName:"p"},"IS \u9501\u3001 IX \u9501\u662f\u8868\u7ea7\u9501,\u5b83\u4eec\u7684\u5b58\u5728\u4ec5\u4ec5\u662f\u4e3a\u4e86\u786e\u5b9a\u8868\u4e2d\u7684\u8bb0\u5f55\u4e0a\u662f\u5426\u5b58\u5728 S \u9501 \u3001X \u9501, \u4ece\u800c\u907f\u514d\u7528\u904d\u5386\u7684\u65b9\u5f0f")," ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u610f\u5411\u9501\u4e4b\u95f4\u662f\u4e92\u76f8\u517c\u5bb9, \u5373 IS \u9501\u548c IX \u9501\u53ef\u4ee5\u540c\u65f6\u5b58\u5728"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c IX \u9501\u4e0d\u517c\u5bb9,\u90a3\u4e48\u5c31\u610f\u5473\u7740\u65e0\u6cd5\u540c\u65f6\u5bf9\u8868\u7684",(0,l.kt)("strong",{parentName:"li"},"\u4e0d\u540c\u8bb0\u5f55"),"\u8fdb\u884c\u4fee\u6539,\u90a3\u5c31\u76f8\u5f53\u4e8e\u53d8\u6210\u4e86\u8868\u9501"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u610f\u5411\u9501\u662f\u7531\u5b58\u50a8\u5f15\u64ce\u63a7\u5236\u7684, \u7528\u6237\u65e0\u6cd5\u624b\u52a8\u64cd\u4f5c\u610f\u5411\u9501"),"\u3002\u5728\u4e3a\u6570\u636e\u884c\u52a0S \u9501\u3001X \u9501\u4e4b\u524d,  InnoDB \u4f1a ",(0,l.kt)("strong",{parentName:"p"},"\u5148\u83b7\u53d6\u8be5\u6570\u636e\u884c\u6240\u5728\u6570\u636e\u8868\u7684\u610f\u5411\u9501 "))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u610f\u5411\u9501\u53ef\u4ee5\u534f\u8c03\u884c\u9501\u4e0e\u8868\u9501\u7684\u5173\u7cfb, \u652f\u6301\u591a\u7c92\u5ea6(\u8868\u9501\u4e0e\u884c\u9501\u540c\u65f6\u5b58\u5728)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5bf9",(0,l.kt)("inlineCode",{parentName:"strong"},"\u8868"),"\u52a0 S \u9501\u7684\u65f6\u5019 (LOCK TABLES T  READ)"),", \u9996\u5148\u68c0\u67e5\u8868\u662f\u5426\u6709 IX \u9501, \u6709\u7684\u8bdd\u5c31\u9700\u8981\u7b49 IX \u9501\u64a4\u9500\u540e\u518d\u4e3a\u8868\u52a0 S \u9501"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5bf9",(0,l.kt)("inlineCode",{parentName:"strong"},"\u8868"),"\u52a0 X \u9501\u7684\u65f6\u5019(LOCK TABLES T  WRITE)"),", \u9996\u5148\u68c0\u67e5\u8868\u662f\u5426\u6709 IX \u9501\u6216 IS \u9501, \u6709\u7684\u8bdd\u5c31\u9700\u8981\u7b49 IX \u9501\u6216 IS \u9501\u64a4\u9500\u540e\u518d\u4e3a\u8868\u52a0 X \u9501")))),(0,l.kt)("br",null),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"1. IS \u9501\u4e0e\u8868\u7684 S \u9501\u548c\u8868\u7684 X \u9501")),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220901231917790",src:a(68050).Z,width:"2522",height:"652"})),(0,l.kt)("br",null),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"2. IX \u9501\u4e0e\u8868\u7684 X \u9501\u548c\u8868\u7684 S \u9501")),(0,l.kt)("p",{parentName:"admonition"},"\u53ef\u4ee5\u770b\u51fa\u6765\u4e3a\u6709 IX \u9501\u7684\u8868\u52a0\u8868\u7ea7\u522b\u7684 X \u9501\u548c S \u9501\u90fd\u4f1a\u88ab\u963b\u585e\u4f4f,\u76f4\u5230 IX \u9501\u88ab\u64a4\u9500(\u8868\u8bb0\u5f55\u7684 X \u9501\u88ab\u91ca\u653e)"),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220901232330851",src:a(93874).Z,width:"2340",height:"604"}))),(0,l.kt)("h5",{id:"\u81ea\u589e\u9501auto-inc-\u9501"},"\u81ea\u589e\u9501(AUTO-INC \u9501)"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5f00\u53d1\u4e2d,\u53ef\u4ee5\u4e3a\u67d0\u4e2a\u5b57\u6bb5\u8bbe\u7f6e \u81ea\u589e\u5c5e\u6027(",(0,l.kt)("em",{parentName:"p"},"auto_increment"),"),\u4e4b\u540e\u63d2\u5165\u8bb0\u5f55\u7684\u65f6\u5019,\u5c31\u4f1a\u81ea\u52a8\u7684\u4e3a\u5176\u8d4b\u503c"),(0,l.kt)("pre",{parentName:"blockquote"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u6bd4\u5982\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u8868\nCREATE TABLE t (\n        id      INT NOT NULL AUTO_INCREMENT,\n    name            VARCHAR(100),\n    PRIMARY KEY(id)\n) ENGINE=InnoDB CHARSET=utf8;\n")),(0,l.kt)("p",{parentName:"blockquote"},"\u7531\u4e8e\u8fd9\u4e2a\u8868\u7684 id \u5b57\u6bb5\u58f0\u660e\u4e86 ",(0,l.kt)("em",{parentName:"p"},"AUTO_INCREMENT"),", \u610f\u5473\u7740\u5728\u4e66\u5199\u63d2\u5165\u8bed\u53e5\u65f6\u4e0d\u9700\u8981\u4e3a\u5176\u8d4b\u503c,SQL\u8bed\u53e5\u4fee\u6539 \u5982\u4e0b\u6240\u793a:"),(0,l.kt)("pre",{parentName:"blockquote"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO t (name) VALUES ('zhangsan'), ('lisi');\n"))),(0,l.kt)("p",null,"MySQL\u63d2\u5165\u6570\u636e\u6709\u4e09\u79cd\u6a21\u5f0f:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u7b80\u5355\u63d2\u5165 (simple inserts)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6700\u57fa\u672c\u7684\u63d2\u5165\u65b9\u5f0f, \u9884\u5148\u77e5\u9053\u9700\u8981\u63d2\u5165\u51e0\u6761\u6570\u636e"),(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982 ",(0,l.kt)("strong",{parentName:"li"},"INSERT...VALUES()")," "))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u6279\u91cf\u63d2\u5165 (bulk inserts)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e8b\u5148\u4e0d\u77e5\u9053\u9700\u8981\u63d2\u5165\u51e0\u6761\u6570\u636e\u4ee5\u53ca\u9700\u8981\u9012\u589e\u7684\u6570\u91cf"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"INSERT \u2026 SELECT\u3001LOAD DATA")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u6ce8\u610f:",(0,l.kt)("strong",null,"\u6279\u91cf\u63d2\u5165\u6a21\u5f0f\u4e0d\u5305\u62ec\u7eafINSERT"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u6df7\u5408\u63d2\u5165 (mixed-mode inserts)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6307\u5b9a\u90e8\u5206\u65b0\u884c\u7684\u81ea\u52a8\u9012\u589e\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982: ",(0,l.kt)("strong",{parentName:"li"},"INSERT INTO USER_INFO VALUES (1,'a'), (NULL, 'b'), (3,'c')"))))),(0,l.kt)("p",null,"\u5bf9\u5e94\u4e0a\u9762 3 \u79cd\u63d2\u5165\u6a21\u5f0f,MySQL \u7684\u53c2\u6570",(0,l.kt)("inlineCode",{parentName:"p"},"innodb_autoinc_lock_mode")," \u53ef\u4ee5\u8fdb\u884c\u63a7\u5236, \u5206\u522b\u5bf9\u5e94\u4e0e\u4e0d\u540c\u9501\u5b9a\u6a21\u5f0f"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"innodb_autoinc_lock_mode = 0  [\u4f20\u7edf\u9501\u5b9a\u6a21\u5f0f]"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u6b64\u9501\u5b9a\u6a21\u5f0f\u4e0b, ",(0,l.kt)("strong",{parentName:"li"},"\u6bcf\u4e00\u6761 insert \u8bed\u53e5\u90fd\u4f1a\u83b7\u5f97\u4e00\u4e2a\u7279\u6b8a\u7684\u8868\u7ea7 ",(0,l.kt)("inlineCode",{parentName:"strong"},"AUTO-INC \u9501"),"\uff0c\u7528\u4e8e\u63d2\u5165\u5177\u6709 AUTO_INCREMENT\u5217\u7684\u8868")),(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u79cd\u6a21\u5f0f\u4e0b, \u6bcf\u6b21\u6267\u884c insert \u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5f97\u5230\u4e00\u4e2a ",(0,l.kt)("strong",{parentName:"li"},"\u8868\u7ea7\u9501(AUTO-INC\u9501)"),", \u4f7f\u5f97\u8bed\u53e5\u4e2d\u751f\u6210\u7684 auto_increment \u662f\u9012\u589e\u7684, \u4e14\u5728binlog\u4e2d\u91cd\u653e\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4fdd\u8bc1 master\u4e0eslave\u4e2d\u6570\u636e\u7684 auto_increment \u662f\u76f8\u540c\u7684"),(0,l.kt)("li",{parentName:"ul"},"\u56e0\u4e3a\u662f\u8868\u7ea7\u9501, \u5f53\u5728\u540c\u4e00\u65f6\u95f4\u591a\u4e2a\u4e8b\u52a1\u4e2d\u6267\u884cinsert\u7684 \u65f6\u5019\uff0c\u5bf9\u4e8eAUTO-INC\u9501\u7684\u4e89\u593a\u4f1a ",(0,l.kt)("inlineCode",{parentName:"li"},"\u9650\u5236\u5e76\u53d1")," \u80fd\u529b"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"innodb_autoinc_lock_mode = 1 [\u8fde\u7eed\u9501\u5b9a\u6a21\u5f0f]"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728 MySQL 8.0 \u4e4b\u524d, \u8fde\u7eed\u9501\u5b9a\u6a21\u5f0f\u662f",(0,l.kt)("strong",{parentName:"li"},"\u9ed8\u8ba4"),"\u7684"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u8fd9\u4e2a\u6a21\u5f0f\u4e0b,  ",(0,l.kt)("strong",{parentName:"li"},"\u6279\u91cf\u63d2\u5165\u4f9d\u65e7\u4f7f\u7528 AUTO-INC \u8868\u7ea7\u9501\uff0c\u5e76\u4fdd\u6301\u5230\u8bed\u53e5\u7ed3\u675f"),", ",(0,l.kt)("strong",{parentName:"li"},"\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u8bed\u53e5\u53ef\u4ee5\u6301\u6709AUTO-INC\u9501")),(0,l.kt)("li",{parentName:"ul"},"\u4f46\u662f\u5bf9\u4e8e\u7b80\u5355\u7684\u63d2\u5165\u8bed\u53e5(\u9884\u5148\u77e5\u9053\u63d2\u5165\u7684\u884c\u6570), ",(0,l.kt)("strong",{parentName:"li"},"\u5219\u901a\u8fc7\u5728 Mutex (\u8f7b\u91cf\u9501) \u7684\u63a7\u5236\u4e0b\u83b7\u5f97\u6240\u9700\u6570\u91cf\u7684 \u81ea\u52a8\u9012\u589e\u503c\u6765\u907f\u514d\u8868\u7ea7AUTO-INC\u9501, "),"\u5b83",(0,l.kt)("inlineCode",{parentName:"li"},"\u53ea\u5728\u5206\u914d\u8fc7\u7a0b\u7684\u6301\u7eed\u65f6\u95f4\u5185\u4fdd\u6301\uff0c\u800c\u4e0d\u662f\u76f4\u5230\u8bed\u53e5\u5b8c\u6210")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"innodb_autoinc_lock_mode = 2 [\u4ea4\u9519\u9501\u5b9a\u6a21\u5f0f]"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4ece MySQL 8.0 \u5f00\u59cb\uff0c\u4ea4\u9519\u9501\u6a21\u5f0f\u662f",(0,l.kt)("strong",{parentName:"li"},"\u9ed8\u8ba4"),"\u8bbe\u7f6e"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u6b64\u9501\u5b9a\u6a21\u5f0f\u4e0b\uff0c",(0,l.kt)("strong",{parentName:"li"},"\u6240\u6709\u7684 INSERT \u8bed\u53e5\u90fd\u4e0d\u4f1a\u4f7f\u7528 AUTO_INC \u8868\u7ea7\u9501,\u81ea\u52a8\u9012\u589e\u503c\u4fdd\u8bc1\u5728\u6240\u6709\u5e76\u53d1\u6267\u884c\u7684\u6240\u6709\u7c7b\u578b\u7684 INSERT \u8bed\u53e5\u4e2d\u662f ",(0,l.kt)("inlineCode",{parentName:"strong"},"\u552f\u4e00")," \u4e14 ",(0,l.kt)("inlineCode",{parentName:"strong"},"\u5355\u8c03\u9012\u589e")," \u7684")),(0,l.kt)("li",{parentName:"ul"},"\u4f46\u7531\u4e8e\u591a\u4e2a\u8bed\u53e5\u53ef\u4ee5\u540c\u65f6\u751f\u6210\u81ea\u589e\u6570\u5b57 (\u5373",(0,l.kt)("strong",{parentName:"li"},"\u8de8\u8bed\u53e5\u4ea4\u53c9\u7f16\u53f7"),")\uff0c ",(0,l.kt)("strong",{parentName:"li"},"\u4e3a\u4efb\u4f55\u7ed9\u5b9a\u8bed\u53e5\u63d2\u5165\u7684\u884c\u751f\u6210\u7684\u503c\u53ef\u80fd\u4e0d\u662f\u8fde\u7eed\u7684"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5373\u6267\u884c\u7684\u662f\u7b80\u5355\u63d2\u5165\u6a21\u5f0f\u7684\u8bdd(\u63d2\u5165\u884c\u6570\u5df2\u77e5), \u90a3\u4e48\u63d2\u5165\u6570\u636e\u7684\u81ea\u589e\u5217\u662f\u8fde\u7eed\u7684,\u4f46\u5982\u679c\u662f\u6279\u91cf\u63d2\u5165\u6a21\u5f0f\u7684\u8bdd,\u63d2\u5165\u8bed\u53e5\u7684\u9012\u589e\u503c\u53ef\u80fd\u4e0d\u662f\u8fde\u7eed\u7684")))))),(0,l.kt)("admonition",{title:"\u8bf4\u660e",type:"caution"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},"AUTO_INC \u9501\u7684\u4f5c\u7528\u8303\u56f4\u662f",(0,l.kt)("inlineCode",{parentName:"li"},"\u5355\u6761\u6267\u884c\u8bed\u53e5"),", \u5728\u63d2\u5165\u8bed\u53e5\u6267\u884c\u5b8c\u6210\u4e4b\u540e\u5c31\u4f1a\u91ca\u653e\u6389\u8be5\u9501"),(0,l.kt)("li",{parentName:"ol"},"\u8f7b\u91cf\u7ea7 mutex \u9501\u7684\u4f5c\u7528\u8303\u56f4\u662f",(0,l.kt)("inlineCode",{parentName:"li"},"\u5728\u4e3a\u63d2\u5165\u8bed\u53e5\u83b7\u53d6\u81ea\u589e\u503c\u65f6")))),(0,l.kt)("h5",{id:"\u5143\u6570\u636e\u9501mdl\u9501"},"\u5143\u6570\u636e\u9501(MDL\u9501)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"MySQL5.5 \u5f15\u5165\u4e86",(0,l.kt)("em",{parentName:"p"},"meta data lock"),"\uff0c\u7b80\u79f0 ",(0,l.kt)("inlineCode",{parentName:"p"},"MDL \u9501"),", \u5c5e\u4e8e",(0,l.kt)("strong",{parentName:"p"},"\u8868\u9501\u8303\u7574"),"\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e0d\u9700\u8981\u663e\u5f0f\u4f7f\u7528"),",\u5728\u8bbf\u95ee\u4e00\u4e2a\u8868\u7684\u65f6\u5019\u4f1a MySQL \u4f1a\u81ea\u52a8\u52a0\u4e0a")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"MDL \u7684\u4f5c\u7528\u662f\u4fdd\u8bc1\u8bfb\u5199\u7684\u6b63\u786e\u6027")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982\uff0c\u5982\u679c\u4e00\u4e2a\u67e5\u8be2\u6b63\u5728\u904d\u5386\u4e00\u4e2a\u8868\u4e2d\u7684\u6570\u636e,\u800c\u6267\u884c\u671f\u95f4\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5bf9\u8fd9\u4e2a\u8868\u7ed3\u6784\u505a\u53d8\u66f4, \u589e\u52a0\u4e86\u4e00\u5217\uff0c\u90a3\u4e48\u67e5\u8be2\u4e8b\u52a1\u62ff\u5230\u7684\u7ed3\u679c\u8ddf\u8868\u7ed3\u6784\u5bf9\u4e0d\u4e0a,\u80af\u5b9a\u662f\u4e0d\u884c\u7684\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u56e0\u6b64, ",(0,l.kt)("strong",{parentName:"p"},"\u5f53\u5bf9\u4e00\u4e2a\u8868\u505a\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u52a0")," ",(0,l.kt)("inlineCode",{parentName:"p"},"MDL \u8bfb\u9501"),"; ",(0,l.kt)("strong",{parentName:"p"},"\u5f53\u8981\u5bf9\u8868\u505a\u7ed3\u6784\u53d8\u66f4\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u52a0")," ",(0,l.kt)("inlineCode",{parentName:"p"},"MDL \u5199\u9501")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"MDL \u8bfb\u9501\u4e4b\u95f4\u4e92\u4e0d\u6392\u65a5"),",\u6240\u4ee5\u53ef\u4ee5\u6709\u591a\u4e2a\u4e8b\u52a1\u5bf9\u4e00\u5f20\u8868\u7684\u6570\u636e\u8fdb\u884c CRUD "),(0,l.kt)("li",{parentName:"ul"},"MDL \u8bfb\u9501\u4e0e MDL\u5199\u9501\u3001MDL \u5199\u9501\u4e0e MDL \u5199\u9501\u4e4b\u95f4\u662f",(0,l.kt)("strong",{parentName:"li"},"\u4e92\u65a5\u7684")," ,\u7528\u4e8e\u4fdd\u8bc1\u53d8\u66f4\u8868\u7ed3\u6784\u64cd\u4f5c\u7684\u5b89\u5168\u6027"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"MDL \u9501\u89e3\u51b3\u4e86 DML \u548c DDL \u64cd\u4f5c\u7684\u4e00\u81f4\u6027\u95ee\u9898"))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220904133713987",src:a(66239).Z,width:"3832",height:"1178"})),(0,l.kt)("h4",{id:"innodb-\u7684\u884c\u7ea7\u9501"},"InnoDB \u7684\u884c\u7ea7\u9501"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u884c\u7ea7\u9501,\u4e5f\u53eb\u505a",(0,l.kt)("strong",{parentName:"li"},"\u8bb0\u5f55\u9501"),", \u4e5f\u5c31\u662f\u5728\u8bb0\u5f55\u4e0a\u52a0\u7684\u9501, MySQL \u670d\u52a1\u5668\u5c42\u6ca1\u6709\u5b9e\u73b0\u884c\u9501\u673a\u5236, ",(0,l.kt)("strong",{parentName:"li"},"\u884c\u9501\u7684\u5b9e\u73b0\u9700\u8981\u7531\u4e0d\u540c\u5b58\u50a8\u5f15\u64ce\u53bb\u5b9e\u73b0")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u884c\u7ea7\u9501\u7684\u4f18\u7f3a\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u4f18\u70b9"),": \u9501\u5b9a\u7c92\u5ea6\u5c0f,\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u5c0f,\u53ef\u4ee5\u5f88\u597d\u7684\u5b9e\u73b0\u9ad8\u5e76\u53d1 "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u7f3a\u70b9"),": \u6bcf\u884c\u8bb0\u5f55\u90fd\u9700\u8981",(0,l.kt)("strong",{parentName:"li"},"\u68c0\u67e5\u3001\u52a0\u9501\u3001\u89e3\u9501"),", \u4f1a\u5bfc\u81f4",(0,l.kt)("strong",{parentName:"li"},"\u9501\u7684\u5f00\u9500\u6bd4\u8f83\u5927")," , \u8fd8\u53ef\u80fd\u4f1a\u51fa\u73b0",(0,l.kt)("strong",{parentName:"li"},"\u6b7b\u9501"),"\u7684\u95ee\u9898"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"InnoDB \u76f8\u5bf9\u4e8e MyISAM \u6765\u8bf4,\u4e00\u65b9\u9762\u662f\u652f\u6301\u4e8b\u52a1,\u53e6\u4e00\u65b9\u9762\u5c31\u662f\u652f\u6301\u884c\u7ea7\u9501"))),(0,l.kt)("h5",{id:"\u8bb0\u5f55\u9501record-lock"},"\u8bb0\u5f55\u9501(Record Lock)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u8bb0\u5f55\u9501\u5c31\u662f\u4ec5\u4ec5\u628a\u4e00\u6761\u8bb0\u5f55\u9501\u4e0a, \u5bf9\u5176\u4ed6\u7684\u6570\u636e\u6ca1\u6709\u5f71\u54cd"),", \u4e5f\u53ef\u4ee5\u53eb\u505a",(0,l.kt)("inlineCode",{parentName:"li"},"LOCK_REC_NOT_GAP")),(0,l.kt)("li",{parentName:"ul"},"\u8bb0\u5f55\u9501\u4e5f\u5206\u4e3a ",(0,l.kt)("strong",{parentName:"li"},"S \u9501\u548c X \u9501"),", \u53ef\u4ee5\u79f0\u4e3a S \u578b\u8bb0\u5f55\u9501 \u548c X \u578b\u8bb0\u5f55\u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u4e00\u4e2a\u4e8b\u52a1\u83b7\u53d6\u4e86\u4e00\u6761\u8bb0\u5f55\u7684 S \u578b\u8bb0\u5f55\u9501\u540e, \u5176\u4ed6\u4e8b\u52a1\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u83b7\u53d6\u8be5\u8bb0\u5f55\u7684S\u578b\u8bb0\u5f55\u9501\uff0c\u4f46\u4e0d\u53ef\u4ee5\u7ee7\u7eed\u83b7\u53d6\u8be5\u8bb0\u5f55 X \u578b\u8bb0\u5f55\u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u4e00\u4e2a\u4e8b\u52a1\u83b7\u53d6\u4e86\u4e00\u6761\u8bb0\u5f55\u7684X\u578b\u8bb0\u5f55\u9501\u540e, \u5176\u4ed6\u4e8b\u52a1\u65e2\u4e0d\u53ef\u4ee5\u7ee7\u7eed\u83b7\u53d6\u8be5\u8bb0\u5f55\u7684S\u578b\u8bb0\u5f55\u9501, \u4e5f\u4e0d\u53ef\u4ee5\u7ee7\u7eed\u83b7\u53d6\u8be5\u8bb0\u5f55 X \u578b\u8bb0\u5f55\u9501"))))),(0,l.kt)("admonition",{title:"\u793a\u4f8b",type:"info"},(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"1. X \u578b\u8bb0\u5f55\u9501\u4e0e S \u578b\u8bb0\u5f55\u9501")),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220904143513400",src:a(96585).Z,width:"2950",height:"596"})),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"2. X \u578b\u8bb0\u5f55\u9501\u4e0e X \u578b\u8bb0\u5f55\u9501")),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220904143840668",src:a(10730).Z,width:"2746",height:"620"}))),(0,l.kt)("h5",{id:"\u95f4\u9699\u9501gap-lock"},"\u95f4\u9699\u9501(Gap Lock)"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"\u95f4\u9699\u9501\u7684\u63d0\u51fa\u4ec5\u4ec5\u662f\u4e3a\u4e86\u9632\u6b62\u63d2\u5165\u5e7b\u5f71\u8bb0\u5f55\u800c\u63d0\u51fa\u7684"))),(0,l.kt)("p",null,"MySQL \u7684",(0,l.kt)("inlineCode",{parentName:"p"},"Repeatable Read")," \u9694\u79bb\u7ea7\u522b\u4e0b\u53ef\u4ee5\u89e3\u51b3\u5e7b\u8bfb\u95ee\u9898,\u6709\u4e24\u79cd\u89e3\u51b3\u65b9\u6848:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"MVCC")),(0,l.kt)("li",{parentName:"ol"},"\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"li"},"\u52a0\u9501")," \u7684\u65b9\u5f0f")),(0,l.kt)("p",null,"\u4f46\u662f\u4f7f\u7528\u52a0\u9501\u7684\u65b9\u5f0f\u5982\u4f55\u5904\u7406\u6ca1\u6709\u63d2\u5165\u7684",(0,l.kt)("strong",{parentName:"p"},"\u5e7b\u5f71\u8bb0\u5f55"),"\u5462? \u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u6b64\u65f6\u5e76\u4e0d\u77e5\u9053\u4e0b\u9762\u9700\u8981\u63d2\u5165\u7684\u8bb0\u5f55\u7684\u662f\u54ea\u4e00\u4e2a, \u6240\u4ee5\u5c31",(0,l.kt)("strong",{parentName:"p"},"\u65e0\u6cd5\u4e3a\u5e7b\u5f71\u8bb0\u5f55\u52a0\u9501"),"\u3002 InnoDB \u4f7f\u7528\u4e86\u4e00\u79cd\u53eb ",(0,l.kt)("inlineCode",{parentName:"p"},"Gap Locks")," \u7684\u9501\uff0c\u5b98\u65b9\u7684\u7c7b\u578b\u540d\u79f0\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"LOCK_GAP"),", \u53ef\u4ee5\u7b80\u79f0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"GAP \u9501")),(0,l.kt)("mark",null,"\u95f4\u9699\u9501\u4e0d\u5141\u8bb8\u5728\u52a0\u9501\u8bb0\u5f55\u7684\u524d\u9762\u63d2\u5165\u65b0\u7684\u8bb0\u5f55, \u6240\u4ee5\u8bf4\u95f4\u9699\u9501\u5e76\u4e0d\u662f\u9488\u5bf9\u67d0\u6761\u8bb0\u5f55.\u800c\u662f\u4e00\u4e2a\u8303\u56f4"),(0,l.kt)("admonition",{title:"\u793a\u4f8b",type:"info"},(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"\u628aid\u503c\u4e3a8\u7684\u90a3\u6761 \u8bb0\u5f55\u52a0\u4e00\u4e2agap\u9501\u7684\u793a\u610f\u56fe\u5982\u4e0b:")),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220904142504872",src:a(14215).Z,width:"2770",height:"1172"})),(0,l.kt)("br",null),(0,l.kt)("p",{parentName:"admonition"},"\u56fe\u4e2d id \u503c\u4e3a8\u7684\u8bb0\u5f55\u52a0\u4e86 \u95f4\u9699\u9501\uff0c\u610f\u5473\u7740 ",(0,l.kt)("strong",{parentName:"p"},"\u4e0d\u5141\u8bb8\u522b\u7684\u4e8b\u52a1\u5728id\u503c\u4e3a8\u7684\u8bb0\u5f55\u524d\u8fb9\u7684\u95f4\u9699\u63d2\u5165\u65b0\u8bb0\u5f55"),", \u5176\u5b9e\u5c31\u662f id \u5217\u7684\u503c(3, 8)\u8fd9\u4e2a\u533a\u95f4\u7684\u65b0\u8bb0\u5f55\u662f\u4e0d\u5141\u8bb8\u7acb\u5373\u63d2\u5165\u7684"),(0,l.kt)("p",{parentName:"admonition"},"\u6bd4\u5982\uff0c\u6709\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u518d\u60f3\u63d2\u5165\u4e00\u6761 id=4 \u7684\u65b0\u8bb0\u5f55, \u5b83\u5b9a\u4f4d\u5230\u8be5\u6761\u65b0\u8bb0\u5f55\u7684\u4e0b\u4e00\u6761\u8bb0\u5f55\u7684id\u503c\u4e3a8\uff0c\u800c\u8fd9\u6761\u8bb0\u5f55\u4e0a\u53c8\u6709\u4e00\u4e2a \u95f4\u9699\u9501, \u6240\u4ee5\u5c31\u4f1a",(0,l.kt)("strong",{parentName:"p"},"\u963b\u585e\u63d2\u5165"),"\u64cd\u4f5c\uff0c\u76f4\u5230\u62e5\u6709\u8fd9\u4e2a\u95f4\u9699\u9501\u7684\u4e8b\u52a1\u63d0\u4ea4\u4e86\u4e4b\u540e, id \u5217\u7684\u503c\u5728\u533a\u95f4(3, 8)\u4e2d\u7684\u65b0\u8bb0\u5f55\u624d\u53ef\u4ee5\u88ab\u63d2\u5165"),(0,l.kt)("br",null),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"\u793a\u4f8b")),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220904150929225",src:a(48107).Z,width:"2786",height:"714"})),(0,l.kt)("br",null),(0,l.kt)("mark",null,"\u90a3\u4e48\u624b\u52a8\u9501\u5b9a\u7684\u503c\u5927\u4e8e\u8868\u4e2d\u7684\u6700\u5927\u8bb0\u5f55\u7684\u503c\u5462?\u6bd4\u5982\u8fd9\u91cc\u7684 20,\u90a3\u4e4820 \u540e\u9762\u7a7a\u95f4\u7684\u90fd\u63d2\u5165\u4e0d\u4e86,\u56e0\u4e3a\u7ed9\u6570\u636e\u9875\u4e2d\u7684 Supremum \u6700\u5927\u8bb0\u5f55\u52a0\u4e0a\u4e86\u95f4\u9699\u9501")," ",(0,l.kt)("br",null),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"\u95f4\u9699\u9501\u8fd8\u53ef\u80fd\u5bfc\u81f4\u6b7b\u9501"),",\u6bd4\u5982\u4e8b\u52a1 T1\u3001T2\u4e2d\u7684\u95f4\u9699\u9501\u90fd\u662f8, \u5bfc\u81f4(3,8) \u4e4b\u95f4\u4e0d\u5141\u8bb8\u63d2\u5165\u6570\u636e\u4e86,\u6240\u4ee5\u4e8b\u52a1 T1\u63d2\u5165 id=5 \u7684\u51fa\u73b0\u4e86\u963b\u585e,\u90a3\u4e48\u6b64\u65f6\u4e8b\u52a1 T2 \u518d\u63d2\u5165 id=7 \u7684\u5c31\u4f1a\u51fa\u73b0\u6b7b\u9501\u95ee\u9898, \u56e0\u4e3a T1\u7684id=5\u7684\u8bb0\u5f55\u5728\u7b49\u5f85 T2\u7684 id=7\u7684\u8bb0\u5f55\u91ca\u653e\u9501, T2\u7684id=7\u7684\u8bb0\u5f55\u5728\u7b49\u5f85 T1\u7684 id=5\u7684\u8bb0\u5f55\u91ca\u653e\u9501,\u5bfc\u81f4\u6b7b\u9501")),(0,l.kt)("h5",{id:"\u4e34\u952e\u9501next-key-locks"},"\u4e34\u952e\u9501(Next-Key Locks)"),(0,l.kt)("p",null,"\u6709\u65f6\u65e2\u9700\u8981",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u4f4f\u67d0\u6761\u8bb0\u5f55"),", \u4e5f\u9700\u8981\u963b\u6b62\u5176\u4ed6\u4e8b\u52a1\u5728\u67d0\u6761\u8bb0\u5f55\u524d\u9762\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"\u95f4\u9699\u4e2d\u63d2\u5165\u65b0\u7684\u8bb0\u5f55"),",\u6240\u4ee5 InnoDB \u63d0\u4f9b\u4e86\u4e00\u79cd",(0,l.kt)("inlineCode",{parentName:"p"},"Next-Key Locks"),",\u5b98\u65b9\u79f0\u4e4b\u4e3a: ",(0,l.kt)("inlineCode",{parentName:"p"},"LOCK_ORDINARY")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"next-key lock")," \u662f\u4e8b\u52a1\u7ea7\u522b\u4e3a",(0,l.kt)("em",{parentName:"p"},"repeatable read")," \u4e0b\u4f7f\u7528\u7684\u9501,",(0,l.kt)("inlineCode",{parentName:"p"},"InnoDB \u9ed8\u8ba4\u7684\u9501\u5c31\u662f next-key lock"),"\u3002 "),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"next-key lock")," \u672c\u8d28\u4e0a\u662f\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"\u8bb0\u5f55\u9501\u548c\u95f4\u9699\u9501 \u7684\u7ed3\u5408"),", \u56e0\u4e3a\u5b83",(0,l.kt)("strong",{parentName:"p"},"\u65e2\u53ef\u4ee5\u4fdd\u62a4\u672c\u6761\u8bb0\u5f55,\u4e5f\u53ef\u4ee5\u963b\u6b62\u5176\u4ed6\u4e8b\u52a1\u5728\u8be5\u8bb0\u5f55\u524d\u63d2\u5165\u65b0\u7684\u8bb0\u5f55")),(0,l.kt)("admonition",{title:"\u793a\u4f8b",type:"info"},(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("strong",{parentName:"p"},"\u53ef\u4ee5\u770b\u5230 Next-Key lock \u517c\u5177 \u8bb0\u5f55\u9501\u4e0e\u95f4\u9699\u9501\u7684\u529f\u80fd")),(0,l.kt)("p",{parentName:"admonition"},(0,l.kt)("img",{alt:"image-20220904155354125",src:a(35076).Z,width:"2990",height:"502"}))),(0,l.kt)("h5",{id:"\u63d2\u5165\u610f\u5411\u9501insert-intention-lock"},"\u63d2\u5165\u610f\u5411\u9501(Insert Intention Lock)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u4e00\u4e2a\u4e8b\u52a1\u5728\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u7684\u65f6\u5019,\u9700\u8981\u5224\u65ad\u63d2\u5165\u7684\u4f4d\u7f6e\u662f\u5426\u88ab\u5176\u4ed6\u4e8b\u52a1\u52a0\u4e86\u95f4\u9699\u9501(\u4e34\u952e\u9501\u4e5f\u5305\u542b\u95f4\u9699\u9501), \u5982\u679c\u6709\u7684\u8bdd,\u5219\u63d2\u5165\u64cd\u4f5c\u9700\u8981\u7b49\u5f85,\u76f4\u5230\u95f4\u9699\u9501\u7684\u4e8b\u52a1\u63d0\u4ea4"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"InnoDB\u4e2d",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e8b\u52a1\u5373\u4f7f\u5728\u7b49\u5f85\u4e2d,\u4e5f\u9700\u8981\u751f\u6210\u4e00\u4e2a\u9501\u7ed3\u6784"),"\u3002\u8fd9\u79cd\u9700\u8981\u5411\u67d0\u4e2a\u95f4\u9699\u4e2d\u63d2\u5165\u6570\u636e,\u4f46\u662f\u9501\u7ed3\u6784\u5904\u4e8e\u7b49\u5f85\u72b6\u6001,\u8fd9\u79cd\u7c7b\u578b\u7684\u9501\u5c31\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"\u63d2\u5165\u610f\u5411\u9501"),", \u5b98\u65b9\u79f0\u4e4b\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"LOCK_INSERT_INTENTION")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u63d2\u5165\u610f\u5411\u9501\u662f\u5728\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\u4e4b\u524d,\u7531 \u63d2\u5165\u64cd\u4f5c\u4ea7\u751f\u7684\u4e00\u79cd",(0,l.kt)("inlineCode",{parentName:"li"},"\u95f4\u9699\u9501"),", \u4e0d\u662f\u610f\u5411\u9501,\u5e76\u4e14\u662f\u5728 insert \u64cd\u4f5c\u4e2d\u4ea7\u751f"),(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u4e2a\u9501\u7528\u4e8e\u8868\u793a\u6709\u63d2\u5165\u7684\u610f\u56fe,\u5f53\u591a\u4e2a\u4e8b\u52a1\u5728\u540c\u4e00\u533a\u95f4\u63d2\u5165\u4e0d\u540c\u4f4d\u7f6e\u7684\u591a\u6761\u6570\u636e\u65f6, \u4e8b\u52a1\u4e4b\u95f4\u4e0d\u9700\u8981\u76f8\u4e92\u7b49\u5f85\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5047\u8bbe\u8868\u4e2d\u5df2\u7ecf\u5b58\u5728\u4e24\u6761\u8bb0\u5f55\u4e3a 4\u30017 \u7684\u8bb0\u5f55,\u6709\u4e24\u4e2a\u4e8b\u52a1 T1\u3001T2 \u5206\u522b\u60f3\u63d2\u5165 5\u30016 \u4e24\u6761\u8bb0\u5f55,\u90a3\u6bcf\u4e2a\u4e8b\u52a1\u5728\u83b7\u53d6\u63d2\u5165\u884c\u7684 X \u9501\u524d,\u90fd\u4f1a\u83b7\u53d6 (4,7) \u7684\u95f4\u9699\u9501,\u4f46\u7531\u4e8e\u4e24\u4e2a\u4e8b\u52a1\u64cd\u4f5c\u7684\u6570\u636e\u884c\u4e0d\u540c,\u6240\u4ee5 T1 \u548c T2 \u4e4b\u95f4\u4e0d\u4f1a\u51b2\u7a81(\u963b\u585e\u7b49\u5f85)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u63d2\u5165\u610f\u5411\u9501\u7684\u4e3b\u8981\u7279\u6027")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u63d2\u5165\u610f\u5411\u9501\u662f\u4e00\u79cd",(0,l.kt)("inlineCode",{parentName:"li"},"\u7279\u6b8a\u7684\u95f4\u9699\u9501"),",\u6240\u4ee5\u4e5f\u662f",(0,l.kt)("inlineCode",{parentName:"li"},"\u884c\u9501"),"\u3002\u53ef\u4ee5\u9501\u5b9a\u533a\u95f4\u5185\u7684\u90e8\u5206\u8bb0\u5f55"),(0,l.kt)("li",{parentName:"ul"},"\u63d2\u5165\u610f\u5411\u9501\u53ef\u4ee5\u5c06\u4e00\u4e2a\u610f\u5411\u9501\u5212\u5206\u51fa\u591a\u4e2a\u533a\u95f4"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u63d2\u5165\u610f\u5411\u9501\u4e4b\u95f4\u4e0d\u51b2\u7a81"),",\u6240\u4ee5\u5373\u4f7f\u591a\u4e2a\u4e8b\u52a1\u5728\u540c\u4e00\u533a\u95f4\u63d2\u5165\u591a\u4e2a\u8bb0\u5f55,\u53ea\u8981\u8bb0\u5f55\u672c\u8eab\u4e0d\u51b2\u7a81,\u90a3\u4e48\u591a\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u5c31\u4e0d\u4f1a\u51b2\u7a81\u7b49\u5f85")))),(0,l.kt)("h4",{id:"\u9875\u9501"},"\u9875\u9501"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u9875\u9501\u5c31\u662f\u5728",(0,l.kt)("inlineCode",{parentName:"strong"},"\u9875\u7684\u7c92\u5ea6"),"\u4e0a\u8fdb\u884c\u9501\u5b9a"),", \u9501\u5b9a\u7684\u6570\u636e\u8d44\u6e90\u6bd4\u884c\u9501\u8981\u591a\uff0c\u56e0\u4e3a\u4e00\u4e2a\u9875\u4e2d\u53ef\u4ee5\u6709\u591a\u4e2a\u884c\u8bb0\u5f55\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5f53\u4f7f\u7528\u9875\u9501\u7684\u65f6\u5019, \u4f1a\u51fa\u73b0\u6570\u636e\u6d6a\u8d39\u7684\u73b0\u8c61,\u4f46\u8fd9\u6837\u7684\u6d6a\u8d39\u6700\u591a\u4e5f\u5c31\u662f\u4e00\u4e2a\u9875\u4e0a\u7684\u6570\u636e\u884c\u3002 ",(0,l.kt)("strong",{parentName:"p"},"\u9875\u9501\u7684\u5f00\u9500 \u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff0c\u4f1a\u51fa\u73b0\u6b7b\u9501\u3002\u9501\u5b9a\u7c92\u5ea6\u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4,\u5e76\u53d1\u5ea6\u4e00\u822c\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u6bcf\u4e2a\u5c42\u7ea7\u7684\u9501\u6570\u91cf\u662f\u6709\u9650\u5236\u7684, \u56e0\u4e3a\u9501\u4f1a\u5360\u7528\u5185\u5b58\u7a7a\u95f4,\u9501\u7a7a\u95f4\u7684\u5927\u5c0f\u662f\u6709\u9650\u7684")," \u3002",(0,l.kt)("strong",{parentName:"p"},"\u5f53\u67d0\u4e2a\u5c42\u7ea7\u7684\u9501\u6570\u91cf \u8d85\u8fc7\u4e86\u8fd9\u4e2a\u5c42\u7ea7\u7684\u9608\u503c\u65f6"),", \u5c31\u4f1a\u8fdb\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u5347\u7ea7")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u9501\u5347\u7ea7\u5c31\u662f\u7528\u66f4\u5927\u7c92\u5ea6\u7684\u9501\u66ff\u4ee3\u591a\u4e2a\u66f4\u5c0f\u7c92\u5ea6\u7684\u9501")),(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982 InnoDB \u4e2d\u884c\u9501\u5347\u7ea7\u4e3a\u8868\u9501, \u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u5360\u7528\u7684\u9501\u7a7a\u95f4\u964d\u4f4e\u4e86,\u4f46\u540c\u65f6\u6570\u636e\u7684\u5e76\u53d1\u5ea6\u4e5f\u4e0b\u964d\u4e86\u3002")))),(0,l.kt)("h3",{id:"\u5bf9\u5f85\u9501\u7684\u6001\u5ea6\u5212\u5206"},"\u5bf9\u5f85\u9501\u7684\u6001\u5ea6\u5212\u5206"),(0,l.kt)("p",null,"\u5bf9\u5f85\u9501\u7684\u6001\u5ea6\u6765\u770b\u9501\u7684\u8bdd, \u53ef\u4ee5\u5c06\u9501\u5206\u6210",(0,l.kt)("strong",{parentName:"p"},"\u4e50\u89c2\u9501\u548c\u60b2\u89c2\u9501"),", \u9700\u8981\u6ce8\u610f\u7684\u662f: ",(0,l.kt)("strong",{parentName:"p"},"\u4e50\u89c2\u9501\u548c\u60b2\u89c2\u9501\u5e76\u4e0d\u662f\u9501\uff0c\u800c\u662f\u9501\u7684\u8bbe\u8ba1\u601d\u60f3 ")),(0,l.kt)("h4",{id:"\u60b2\u89c2\u9501pessimistic-lock"},"\u60b2\u89c2\u9501(Pessimistic Lock)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u60b2\u89c2\u9501\u5c31\u662f ",(0,l.kt)("strong",{parentName:"p"},"\u5bf9\u6570\u636e\u88ab\u5176\u4ed6\u4e8b\u52a1\u7684\u4fee\u6539\u6301\u4fdd\u5b88\u6001\u5ea6, \u4f1a\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"strong"},"\u6570\u636e\u5e93\u81ea\u8eab\u7684\u9501\u673a\u5236\u6765\u5b9e\u73b0"),",\u4ece\u800c\u4fdd\u8bc1\u6570\u636e\u64cd\u4f5c\u7684\u6392\u5b83\u6027"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u60b2\u89c2\u9501\u603b\u662f\u5047\u8bbe\u6700\u574f\u7684\u60c5\u51b5: \u6bcf\u6b21\u53bb\u62ff\u6570\u636e\u7684\u65f6\u5019\u90fd\u8ba4\u4e3a\u5176\u4ed6\u4e8b\u52a1\u4f1a\u4fee\u6539\uff0c\u6240\u4ee5\u6bcf\u6b21\u5728\u62ff\u6570\u636e\u7684\u65f6\u5019\u90fd\u4f1a\u4e0a\u9501\uff0c\u8fd9\u6837\u522b\u4eba\u60f3\u62ff\u8fd9\u4e2a\u6570\u636e\u5c31\u4f1a ",(0,l.kt)("inlineCode",{parentName:"p"},"\u963b\u585e")," \u76f4\u5230\u5b83\u62ff\u5230\u9501"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982\u884c\u9501\u3001\u8868\u9501\u7b49\u3001\u8bfb\u9501\u3001\u5199\u9501\u7b49, \u90fd\u662f\u5728\u505a\u64cd\u4f5c\u4e4b\u524d\u5148\u4e0a\u9501, \u5f53\u5176\u4ed6\u4e8b\u52a1\u60f3\u8981\u8bbf\u95ee\u6570\u636e\u65f6\uff0c\u90fd\u9700\u8981\u963b\u585e\u6302\u8d77"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u60b2\u89c2\u9501\u9002\u7528\u7684\u573a\u666f\u4e0d\u662f\u5f88\u591a,\u5b83\u5b58\u5728\u5f88\u591a\u4e0d\u8db3,\u56e0\u4e3a\u60b2\u89c2\u9501\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u90fd\u662f\u4f9d\u8d56\u4e8e\u6570\u636e\u5e93\u672c\u8eab\u7684\u9501\u673a\u5236\u5b9e\u73b0\u7684,\u8fd9\u4e2a\u4f1a\u5bf9\u6570\u636e\u5e93\u6027\u80fd\u9020\u6210\u5f71\u54cd,\u7279\u522b\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"\u957f\u4e8b\u52a1")))),(0,l.kt)("h4",{id:"\u4e50\u89c2\u9501optimistic-lock"},"\u4e50\u89c2\u9501(Optimistic Lock)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u4e50\u89c2\u9501\u8ba4\u4e3a\u5bf9\u540c\u4e00\u6570\u636e\u7684\u5e76\u53d1\u64cd\u4f5c\u4e0d\u4f1a\u603b\u53d1\u751f, \u4e0d\u7528\u6bcf\u6b21\u90fd\u5bf9\u6570\u636e\u4e0a\u9501, \u4f46\u662f\u5728\u66f4\u65b0\u7684\u65f6\u5019\u4f1a\u5224\u65ad\u4e00\u4e0b\u5728\u6b64\u671f\u95f4\u522b\u4eba\u6709\u6ca1\u6709\u53bb\u66f4\u65b0\u8fd9\u4e2a\u6570\u636e, \u4e5f\u5c31\u662f",(0,l.kt)("inlineCode",{parentName:"strong"},"\u4e0d\u91c7\u7528\u6570\u636e\u5e93\u81ea\u8eab\u7684\u9501\u673a\u5236"),"\uff0c\u800c\u662f\u901a\u8fc7\u7a0b\u5e8f\u6765\u5b9e\u73b0"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u7a0b\u5e8f\u4e0a\u53ef\u4ee5\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"li"},"\u7248\u672c\u53f7")," \u6216\u8005 ",(0,l.kt)("inlineCode",{parentName:"li"},"CAS\u673a\u5236")," \u5b9e\u73b0")))),(0,l.kt)("h5",{id:"\u7248\u672c\u53f7\u673a\u5236"},"\u7248\u672c\u53f7\u673a\u5236"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5728\u8868\u4e2d\u8bbe\u8ba1\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"li"},"\u7248\u672c\u5b57\u6bb5 Version")," "),(0,l.kt)("li",{parentName:"ul"},"\u7b2c\u4e00\u6b21\u8bfb\u7684\u65f6\u5019\u83b7\u53d6 version \u5b57\u6bb5\u7684\u53d6\u503c, \u7136\u540e\u5bf9\u6570\u636e\u8fdb\u884c\u66f4\u65b0\u6216\u5220\u9664\u64cd\u4f5c\u65f6,\u4f1a\u6267\u884c ",(0,l.kt)("em",{parentName:"li"},"update\u2026 set version=version+1 where version=\u7b2c\u4e00\u6b21\u8bfb\u53d6\u7684version"),"\u3002 \u5982\u679c\u5df2\u7ecf\u6709\u4e8b\u52a1\u5bf9\u8fd9\u6761\u6570\u636e\u8fdb\u884c\u4e86\u66f4\u6539, \u90a3\u4e48\u4fee\u6539\u5c31\u4e0d\u4f1a\u6210\u529f")),(0,l.kt)("h5",{id:"\u65f6\u95f4\u6233\u673a\u5236"},"\u65f6\u95f4\u6233\u673a\u5236"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u65f6\u95f4\u6233\u548c\u7248\u672c\u53f7\u673a\u5236\u4e00\u6837, ",(0,l.kt)("strong",{parentName:"li"},"\u4e5f\u662f\u5728\u66f4\u65b0\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u5c06\u5f53\u524d\u6570\u636e\u7684\u65f6\u95f4\u6233\u548c\u66f4\u65b0\u4e4b\u524d\u53d6\u5f97\u7684\u65f6\u95f4\u6233\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u4e24\u8005\u4e00\u81f4\u5219\u66f4\u65b0\u6210\u529f\uff0c\u5426\u5219\u5c31\u662f\u7248\u672c\u51b2\u7a81")),(0,l.kt)("li",{parentName:"ul"},"\u4e50\u89c2\u9501\u5c31\u662f\u5f00\u53d1\u4eba\u5458\u81ea\u5df1\u63a7\u5236\u6570\u636e\u5e76\u53d1\u64cd\u4f5c\u7684\u6743\u9650, \u57fa\u672c\u662f\u901a\u8fc7\u7ed9\u6570\u636e\u884c\u589e\u52a0\u4e00\u4e2a\u5b57\u6bb5(\u7248\u672c\u53f7\u6216\u8005\u65f6\u95f4\u6233),\u4ece\u800c\u8bc1\u660e\u5f53\u524d\u62ff\u5230\u7684\u6570\u636e\u662f\u5426\u6700\u65b0")),(0,l.kt)("admonition",{title:"\u4e24\u79cd\u9501\u7684\u9002\u7528\u573a\u666f",type:"info"},(0,l.kt)("p",{parentName:"admonition"},"\u4ece\u8fd9\u4e24\u79cd\u9501\u7684\u8bbe\u8ba1\u601d\u60f3\u4e2d\uff0c\u6211\u4eec\u603b\u7ed3\u4e00\u4e0b\u4e50\u89c2\u9501\u548c\u60b2\u89c2\u9501\u7684\u9002\u7528\u573a\u666f:"),(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u4e50\u89c2\u9501\u9002\u5408\u8bfb\u64cd\u4f5c\u591a")," \u7684\u573a\u666f, \u76f8\u5bf9\u6765\u8bf4\u5199\u7684\u64cd\u4f5c\u6bd4\u8f83\u5c11\u3002\u5b83\u7684\u4f18\u70b9\u5728\u4e8e\u7a0b\u5e8f\u5b9e\u73b0,\u4e0d\u5b58\u5728\u6b7b\u9501\u95ee\u9898\uff0c\u4e0d\u8fc7\u9002\u7528\u573a\u666f\u4e5f\u4f1a\u76f8\u5bf9\u4e50\u89c2\uff0c\u56e0\u4e3a\u5b83\u963b\u6b62\u4e0d\u4e86\u9664\u4e86\u7a0b\u5e8f\u4ee5\u5916\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u60b2\u89c2\u9501 \u9002\u5408 \u5199\u64cd\u4f5c\u591a")," \u7684\u573a\u666f,\u56e0\u4e3a\u5199\u7684\u64cd\u4f5c\u5177\u6709 ",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e92\u65a5\u6027"),"\u3002 \u91c7\u7528\u60b2\u89c2\u9501\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u5c42 \u9762\u963b\u6b62\u5176\u4ed6\u4e8b\u52a1\u5bf9\u8be5\u6570\u636e\u7684\u64cd\u4f5c\u6743\u9650\uff0c\u9632\u6b62\u8bfb-\u5199\u7684\u51b2\u7a81")))),(0,l.kt)("h3",{id:"\u52a0\u9501\u7684\u65b9\u5f0f"},"\u52a0\u9501\u7684\u65b9\u5f0f"),(0,l.kt)("h4",{id:"\u663e\u5f0f\u9501"},"\u663e\u5f0f\u9501"),(0,l.kt)("p",null,"\u901a\u8fc7\u7279\u5b9a\u7684\u8bed\u53e5\u8fdb\u884c\u52a0\u9501, \u6211\u4eec\u4e00\u822c\u79f0\u4e4b\u4e3a\u663e\u793a\u52a0\u9501\uff0c\u4f8b\u5982:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u663e\u5f0f\u52a0 S \u9501"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT  ... LOCK IN SHARE MODE\n# \u6216\u8005\nSELECT ... FOR SHARE\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u663e\u5f0f\u52a0 X \u9501"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT ... FOR UPDATE\n")))),(0,l.kt)("h4",{id:"\u9690\u5f0f\u9501"},"\u9690\u5f0f\u9501"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5728\u5185\u5b58\u4e2d\u751f\u6210\u5e76\u4e14\u7ef4\u62a4\u9501\u7ed3\u6784\u9700\u8981\u4e00\u5b9a\u7684\u6210\u672c,\u4e3a\u4e86\u8282\u7ea6\u6210\u672c,InnoDB \u4e2d\u4fbf\u6709\u4e86",(0,l.kt)("strong",{parentName:"p"},"\u9690\u5f0f\u9501")," \u7684\u6982\u5ff5")),(0,l.kt)("p",null,"\u4e00\u822c\u60c5\u51b5\u4e0b\u6267\u884c ",(0,l.kt)("em",{parentName:"p"},"INSERT")," \u8bed\u53e5\u4e0d\u9700\u8981\u518d\u5185\u5b58\u4e2d\u751f\u6210\u9501\u7ed3\u6784\u7684 (\u5982\u679c\u88ab\u63d2\u5165\u7684\u95f4\u9699\u88ab\u5176\u4ed6\u4e8b\u52a1\u52a0\u4e86 gap \u9501,\u90a3\u4e48 insert \u5c31\u4f1a\u88ab\u963b\u585e,\u52a0\u4e0a\u63d2\u5165\u610f\u5411\u9501), \u4f46\u662f\u8fd9\u53ef\u80fd\u5bfc\u81f4\u67d0\u4e9b\u95ee\u9898\u7684\u51fa\u73b0: \u6bd4\u5982\u4e00\u4e2a\u4e8b\u52a1\u9996\u5148\u63d2\u5165\u4e00\u6761\u8bb0\u5f55(\u6ca1\u6709\u9501\u7ed3\u6784),\u53e6\u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\u4e0b\u9762\u7684\u64cd\u4f5c:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u7acb\u5373\u4f7f\u7528 ",(0,l.kt)("em",{parentName:"li"},"select \u2026 for share")," \u83b7\u53d6\u8fd9\u6761\u8bb0\u5f55\u7684 S \u9501, \u5982\u679c\u5141\u8bb8\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u4f1a\u51fa\u73b0",(0,l.kt)("inlineCode",{parentName:"li"},"\u810f\u8bfb"),"\u7684\u95ee\u9898"),(0,l.kt)("li",{parentName:"ol"},"\u7acb\u5373\u4fee\u6539\u8fd9\u6761\u8bb0\u5f55, \u83b7\u53d6\u8fd9\u6761\u8bb0\u5f55\u7684 X \u9501,\u5982\u679c\u5141\u8bb8\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u4f1a\u51fa\u73b0",(0,l.kt)("inlineCode",{parentName:"li"},"\u810f\u5199"),"\u7684\u95ee\u9898")),(0,l.kt)("p",null,"\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e8b\u52a1 ID"),",\u5728",(0,l.kt)("strong",{parentName:"p"},"\u805a\u7c07\u7d22\u5f15 \u548c \u4e8c\u7ea7\u7d22\u5f15")," \u4e2d:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5bf9\u4e8e",(0,l.kt)("inlineCode",{parentName:"li"},"\u805a\u7c07\u7d22\u5f15\u7684\u8bb0\u5f55"),"\u6765\u8bf4: \u6709\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"li"},"ROW_TRX_ID")," \u9690\u85cf\u5217, ",(0,l.kt)("strong",{parentName:"li"},"\u8be5\u9690\u85cf\u5217\u8bb0\u5f55\u7740\u6700\u540e\u6539\u52a8\u8be5\u8bb0\u5f55\u7684 \u4e8b\u52a1 id")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5728\u5f53\u524d\u4e8b\u52a1 T1 \u4e2d\u65b0\u63d2\u5165\u4e00\u6761\u805a\u7c07\u7d22\u5f15\u8bb0\u5f55\u540e, \u8be5\u8bb0\u5f55\u7684 ",(0,l.kt)("em",{parentName:"li"},"ROW_TRX_ID")," \u9690\u85cf\u5217\u4ee3\u8868\u7684\u7684\u5c31\u662f",(0,l.kt)("strong",{parentName:"li"},"\u5f53\u524d\u4e8b\u52a1 T1 \u7684\u4e8b\u52a1id")),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5176\u4ed6\u4e8b\u52a1 T2 \u6b64\u65f6\u60f3\u5bf9\u8be5\u8bb0\u5f55\u6dfb\u52a0 S \u9501 \u6216\u8005 X \u9501\u65f6,\u9996\u5148\u4f1a\u770b\u4e00\u4e0b\u8be5\u8bb0\u5f55\u7684 ",(0,l.kt)("em",{parentName:"li"},"ROW_TRX_ID")," \u9690\u85cf\u5217\u4ee3\u8868\u7684\u4e8b\u52a1\u662f\u5426\u662f\u5f53\u524d\u7684\u6d3b\u8dc3\u4e8b\u52a1,\u5982\u679c\u662f\u7684\u8bdd:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9996\u5148\u5e2e\u52a9\u5f53\u524d\u4e8b\u52a1 T1 \u521b\u5efa\u4e00\u4e2a X\u9501(\u4e5f\u5c31\u662f\u4e3a\u5f53\u524d\u4e8b\u52a1 T1 \u521b\u5efa\u4e00\u4e2a\u9501\u7ed3\u6784\uff0c",(0,l.kt)("em",{parentName:"li"},"is_waiting=false"),")"),(0,l.kt)("li",{parentName:"ul"},"\u7136\u540e\u4e3a\u81ea\u5df1\u8fdb\u5165\u7b49\u5f85\u72b6\u6001(\u4e5f\u5c31\u662f\u4e3a\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u9501\u7ed3\u6784, ",(0,l.kt)("em",{parentName:"li"},"is_waiting=true"),")"))))),(0,l.kt)("li",{parentName:"ol"},"\u5bf9\u4e8e",(0,l.kt)("inlineCode",{parentName:"li"},"\u4e8c\u7ea7\u7d22\u5f15\u8bb0\u5f55"),"\u6765\u8bf4,\u672c\u8eab\u5e76\u6ca1\u6709",(0,l.kt)("inlineCode",{parentName:"li"},"ROW_TRX_ID"),"\u9690\u85cf\u5217\uff0c\u4f46\u662f\u5728\u4e8c\u7ea7\u7d22\u5f15\u7684\u6570\u636e\u9875\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"Page Header"),"\u4e0a\u6709\u4e00\u4e2a",(0,l.kt)("a",{parentName:"li",href:"InnoDB%E6%95%B0%E6%8D%AE%E9%A1%B5%E7%BB%93%E6%9E%84#page-header"},(0,l.kt)("inlineCode",{parentName:"a"},"PAGE_MAX_TRX_ID")),"\u5c5e\u6027\uff0c\u8be5\u5c5e\u6027\u4ee3\u8868\u5bf9\u8be5\u9875\u9762\u505a\u6539\u52a8\u7684\u6700\u5927\u7684",(0,l.kt)("inlineCode",{parentName:"li"},"\u4e8b\u52a1 ID"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c",(0,l.kt)("em",{parentName:"li"},"PAGE_MAX_TRX_ID")," \u503c",(0,l.kt)("strong",{parentName:"li"},"\u5c0f\u4e8e"),"\u5f53\u524d",(0,l.kt)("strong",{parentName:"li"},"\u6700\u5c0f\u7684\u6d3b\u8dc3\u4e8b\u52a1 ID"),",\u90a3\u4e48\u8bf4\u660e\u5bf9\u8be5\u9875\u9762\u4fee\u6539\u7684\u4e8b\u52a1\u90fd\u5df2\u7ecf\u63d0\u4ea4\u4e86"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c",(0,l.kt)("em",{parentName:"li"},"PAGE_MAX_TRX_ID")," \u503c",(0,l.kt)("strong",{parentName:"li"},"\u5927\u4e8e"),"\u5f53\u524d",(0,l.kt)("strong",{parentName:"li"},"\u6700\u5c0f\u7684\u6d3b\u8dc3\u4e8b\u52a1 ID"),",\u90a3\u4e48\u5c31\u901a\u8fc7\u56de\u8868\u64cd\u4f5c\u5b9a\u4f4d\u5230\u805a\u7c07\u7d22\u5f15\u8bb0\u5f55\u7684\u4f4d\u7f6e,\u7136\u540e\u6309\u805a\u7c07\u7d22\u5f15\u7684\u65b9\u5f0f\u6267\u884c")))),(0,l.kt)("p",null,"\u4e5f\u5c31\u662f\u8bf4: ",(0,l.kt)("strong",{parentName:"p"},"\u4e00\u4e2a\u4e8b\u52a1T1 \u5bf9\u65b0\u63d2\u5165\u7684\u8bb0\u5f55\u53ef\u4ee5\u4e0d\u663e\u5f0f\u7684\u52a0\u9501(\u4e0d\u751f\u6210\u9501\u7ed3\u6784), \u4f46\u662f\u7531\u4e8e\u4e8b\u52a1 ID \u7684\u5b58\u5728,\u76f8\u5f53\u4e8e\u52a0\u4e86\u4e00\u4e2a\u9690\u5f0f\u9501,\u7136\u540e\u522b\u7684\u4e8b\u52a1T2 \u5728\u5c1d\u8bd5\u5bf9\u8fd9\u4e2a\u8bb0\u5f55\u52a0 S \u9501\u6216\u8005 X \u9501\u7684\u65f6\u5019,\u4f1a\u5b9e\u73b0\u5e2e\u52a9\u4e8b\u52a1 T1 \u751f\u6210\u4e00\u4e2a\u9501\u7ed3\u6784,\u7136\u540e\u4e8b\u52a1 T2 \u8fdb\u5165\u9501\u7b49\u5f85\u7684\u72b6\u6001")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u9690\u5f0f\u9501\u8d77\u5230\u4e86 ",(0,l.kt)("inlineCode",{parentName:"li"},"\u5ef6\u8fdf\u751f\u6210\u9501")," \u7684\u529f\u80fd, \u53ea\u6709\u5728\u5176\u4ed6\u4e8b\u52a1\u4e0e\u5f53\u524d\u4e8b\u52a1\u51b2\u7a81\u7684\u65f6\u5019\u624d\u4f1a\u751f\u6210\u9501"),(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5c3d\u91cf\u7684\u907f\u514d\u5728\u63d2\u5165\u7684\u65f6\u5019\u751f\u6210\u5185\u5b58\u7684\u9501\u7ed3\u6784")),(0,l.kt)("admonition",{title:"\u9690\u5f0f\u9501\u7684\u903b\u8f91\u8fc7\u7a0b",type:"tip"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"InnoDB \u7684\u6bcf\u6761\u8bb0\u5f55\u4e2d\u90fd\u4e00\u4e2a\u9690\u542b\u7684 ",(0,l.kt)("em",{parentName:"p"},"ROW_TRX_ID")," \u5b57\u6bb5\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u5b58\u5728\u4e8e\u805a\u7c07\u7d22\u5f15\u7684B+Tree\u4e2d")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5728\u64cd\u4f5c\u4e00\u6761\u8bb0\u5f55\u524d,\u9996\u5148\u6839\u636e\u8bb0\u5f55\u4e2d\u7684 ",(0,l.kt)("em",{parentName:"p"},"ROW_TRX_ID")," \u68c0\u67e5\u8be5\u4e8b\u52a1\u662f\u5426\u662f\u6d3b\u52a8\u7684\u4e8b\u52a1(\u672a\u63d0\u4ea4\u6216\u56de\u6eda)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u662f\u6d3b\u52a8\u7684\u4e8b\u52a1\uff0c",(0,l.kt)("strong",{parentName:"li"},"\u9996\u5148\u5c06\u9690\u5f0f\u9501\u8f6c\u6362\u4e3a\u663e\u5f0f\u9501 (\u5c31\u662f\u4e3a\u8be5\u4e8b\u52a1\u6dfb\u52a0\u4e00\u4e2a\u9501)")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u68c0\u67e5\u662f\u5426\u6709\u9501\u51b2\u7a81")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u6709\u51b2\u7a81\u5c31\u521b\u5efa\u9501\uff0c\u5e76\u8bbe\u7f6e\u4e3awaiting\u72b6\u6001"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u6ca1\u6709\u51b2\u7a81\u4e0d\u52a0\u9501\uff0c\u8df3\u5230\u7b2c 5 \u6b65"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u7b49\u5f85\u52a0\u9501\u6210\u529f,\u88ab\u5524\u9192\u6216\u8005\u8d85\u65f6")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5199\u6570\u636e\uff0c\u5e76\u5c06\u81ea\u5df1\u7684\u4e8b\u52a1 ID\u5199\u5165 ",(0,l.kt)("em",{parentName:"p"},"ROW_TRX_ID")," \u5b57\u6bb5")))),(0,l.kt)("h3",{id:"\u5168\u5c40\u9501"},"\u5168\u5c40\u9501"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5168\u5c40\u9501\u5c31\u662f\u5bf9 ",(0,l.kt)("strong",{parentName:"p"},"\u6574\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u52a0\u9501 "))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5f53\u9700\u8981\u8ba9\u6574\u4e2a\u5e93\u5904\u4e8e",(0,l.kt)("strong",{parentName:"p"},"\u53ea\u8bfb\u72b6\u6001")," \u7684\u65f6\u5019,\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u547d\u4ee4, \u4e4b\u540e \u5176\u4ed6\u7ebf\u7a0b\u7684\u4ee5\u4e0b\u8bed\u53e5\u4f1a\u88ab\u963b\u585e"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"DML(\u6570\u636e\u7684\u589e\u5220\u6539)"),(0,l.kt)("li",{parentName:"ul"},"DDL(\u5305\u62ec\u5efa\u8868\u3001\u4fee\u6539\u8868\u7ed3 \u6784\u7b49)"),(0,l.kt)("li",{parentName:"ul"},"\u66f4\u65b0\u7c7b\u4e8b\u52a1\u7684\u63d0\u4ea4\u8bed\u53e5"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5168\u5c40\u9501\u7684\u5178\u578b\u4f7f\u7528\u573a\u666f\u662f: ",(0,l.kt)("inlineCode",{parentName:"p"}," \u5168\u5e93\u903b\u8f91\u5907\u4efd"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u5168\u5c40\u9501\u7684\u547d\u4ee4")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"  flush tables with read lock\n")))),(0,l.kt)("h3",{id:"\u6b7b\u9501"},"\u6b7b\u9501"),(0,l.kt)("h4",{id:"\u6982\u5ff5"},"\u6982\u5ff5"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u6b7b\u9501\u662f\u6307",(0,l.kt)("strong",{parentName:"li"},"\u4e24\u4e2a\u6216\u591a\u4e2a\u4e8b\u52a1\u5728\u540c\u4e00\u8d44\u6e90\u4e0a\u76f8\u4e92\u5360\u7528,\u5e76\u8bf7\u6c42\u9501\u5b9a\u5bf9\u65b9\u5360\u7528\u7684\u8d44\u6e90,\u4f46\u662f\u4e0d\u91ca\u653e\u672c\u8eab\u6301\u6709\u7684\u9501,\u4ece\u800c\u5bfc\u81f4\u6b7b\u9501"))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220904225008492",src:a(47905).Z,width:"2804",height:"882"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u4e0a\u56fe\u4e2d\uff0c\u4e8b\u52a11 \u5728\u7b49\u5f85\u4e8b\u52a12\u91ca\u653e id=2\u7684\u884c\u9501, \u800c\u4e8b\u52a12\u5728\u7b49\u5f85\u4e8b\u52a11\u91ca\u653eid=1\u7684\u884c\u9501\u3002 \u4e8b\u52a11\u548c\u4e8b\u52a12\u5728\u4e92 \u76f8\u7b49\u5f85\u5bf9\u65b9\u7684\u8d44\u6e90\u91ca\u653e\uff0c\u5c31\u662f\u8fdb\u5165\u4e86\u6b7b\u9501\u72b6\u6001"),(0,l.kt)("admonition",{title:"\u8f6c\u8d26\u793a\u4f8b",type:"info"},(0,l.kt)("pre",{parentName:"admonition"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"# \u4e8b\u52a1 1\nupdate account set balance = balance - 100 where name='A'  #\u6267\u884c\u987a\u5e8f 1\nupdate account set balance = balance + 100 where name='B'  #\u6267\u884c\u987a\u5e8f 3\n\n# \u4e8b\u52a1 2\nupdate account set balance = balance - 100 where name='B'  #\u6267\u884c\u987a\u5e8f 2\nupdate account set balance = balance + 100 where name='A'  #\u6267\u884c\u987a\u5e8f 4\n")),(0,l.kt)("p",{parentName:"admonition"},"\u4e0a\u8ff0\u7684\u793a\u4f8b\u4e2d,\u4e8b\u52a1 1 \u5148\u5bf9 ",(0,l.kt)("em",{parentName:"p"},"\u6267\u884c\u987a\u5e8f 1")," \u52a0\u4e86 X \u9501,\u7136\u540e\u4e8b\u52a1 2 \u5bf9 ",(0,l.kt)("em",{parentName:"p"},"\u6267\u884c\u987a\u5e8f 2")," \u52a0\u4e86 X \u9501,\u6b64\u65f6\u4e24\u4e2a\u4e8b\u52a1\u5206\u522b\u6301\u6709 A \u884c\u7684\u9501\u4e0e B \u884c\u7684 X \u9501\u3002"),(0,l.kt)("p",{parentName:"admonition"},"\u5f53\u4e8b\u52a1 1 \u5c1d\u8bd5\u83b7\u53d6 B \u884c\u7684\u9501\u5c31\u4f1a\u88ab\u963b\u585e\u7b49\u5f85,\u4e8b\u52a1 2 \u5c1d\u8bd5\u83b7\u53d6 A \u884c\u7684\u9501\u4e5f\u4f1a\u88ab\u963b\u585e\u7b49\u5f85,\u4e24\u4e2a\u4e8b\u52a1\u4e92\u76f8\u7b49\u5f85\u5bf9\u65b9\u91ca\u653e\u9501,\u4f46\u4e0d\u91ca\u653e\u672c\u8eab\u7684\u9501,\u8fd9\u5c31\u5bfc\u81f4\u4e86\u6b7b\u9501")),(0,l.kt)("h4",{id:"\u4ea7\u751f\u6b7b\u9501\u7684\u5fc5\u8981\u6761\u4ef6"},"\u4ea7\u751f\u6b7b\u9501\u7684\u5fc5\u8981\u6761\u4ef6"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u81f3\u5c11\u6709\u4e24\u4e2a\u4e8b\u52a1")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u6301\u6709\u9501\u5e76\u4e14\u5c1d\u8bd5\u83b7\u53d6\u65b0\u7684\u9501")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u9501\u53ea\u80fd\u88ab\u540c\u4e00\u4e2a\u4e8b\u52a1\u6301\u6709,\u6bd4\u5982 X \u9501")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u4e8b\u52a1\u4e4b\u95f4\u6301\u6709\u5bf9\u65b9\u9700\u8981\u7684\u9501,\u4f46\u662f\u4e0d\u91ca\u653e\u8be5\u9501"))),(0,l.kt)("admonition",{title:"\u6b7b\u9501\u5173\u952e",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"\u591a\u4e2a Session \u4f1a\u8bdd\u7684\u52a0\u9501\u987a\u5e8f\u4e0d\u4e00\u81f4")),(0,l.kt)("h4",{id:"\u5904\u7406\u6b7b\u9501"},"\u5904\u7406\u6b7b\u9501"),(0,l.kt)("p",null,"\u5f53\u51fa\u73b0\u6b7b\u9501\u540e, \u4e00\u822c\u6709 ",(0,l.kt)("strong",{parentName:"p"},"\u4e24\u79cd\u7b56\u7565 "),":"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u76f4\u63a5\u8fdb\u5165\u7b49\u5f85\u76f4\u5230\u8d85\u65f6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7\u53c2\u6570",(0,l.kt)("inlineCode",{parentName:"li"},"innodb_lock_wait_timeout"),"\u6765\u8bbe\u7f6e,  ",(0,l.kt)("strong",{parentName:"li"},"\u9ed8\u8ba4\u65f6\u95f4\u662f",(0,l.kt)("inlineCode",{parentName:"strong"},"50s"))),(0,l.kt)("li",{parentName:"ul"},"\u5373\u4e24\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u76f8\u4e92\u7b49\u5f85, \u5f53\u4e00\u4e2a\u4e8b\u52a1\u7684\u7b49\u5f85\u65f6\u95f4\u8d85\u8fc7\u8bbe\u7f6e\u7684\u9608\u503c,\u5c31\u4f1a",(0,l.kt)("em",{parentName:"li"},"\u56de\u6eda")," , \u53e6\u5916\u7684\u4e8b\u52a1\u7ee7\u7eed\u8fdb\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u79cd\u65b9\u5f0f\u867d\u7136\u662f\u7b80\u5355\u6709\u6548,\u4f46\u662f\u6027\u80fd\u5f88\u5dee"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("strong",{parentName:"li"},"\u4e3b\u52a8\u53d1\u8d77\u6b7b\u9501\u68c0\u6d4b, \u53d1\u73b0\u6b7b\u9501\u540e,InnoDB \u9009\u62e9 ",(0,l.kt)("em",{parentName:"strong"},"\u56de\u6edaUndo \u91cf\u6700\u5c0f\u7684\u4e8b\u52a1"),"\uff0c\u8ba9\u5176\u4ed6\u4e8b\u52a1\u5f97\u4ee5\u7ee7\u7eed\u6267\u884c"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7\u53c2\u6570 ",(0,l.kt)("inlineCode",{parentName:"li"},"innodb_deadlock_detect")," \u8bbe\u7f6e\u662f\u5426\u5f00\u542f\u8be5\u529f\u80fd , ",(0,l.kt)("strong",{parentName:"li"},"\u9ed8\u8ba4\u503c\u662f",(0,l.kt)("inlineCode",{parentName:"strong"},"ON "))),(0,l.kt)("li",{parentName:"ul"},"\u662f\u4e00\u79cd",(0,l.kt)("inlineCode",{parentName:"li"},"\u4e3b\u52a8\u7684\u6b7b\u9501\u68c0\u6d4b\u673a\u5236"),", \u8fd9\u9700\u8981\u6570\u636e\u5e93\u4fdd\u5b58",(0,l.kt)("inlineCode",{parentName:"li"},"\u9501\u7684\u4fe1\u606f\u94fe\u8868"),"\u548c",(0,l.kt)("inlineCode",{parentName:"li"},"\u4e8b\u52a1\u7b49\u5f85\u94fe\u8868")," \u4e24\u90e8\u5206\u4fe1\u606f"),(0,l.kt)("li",{parentName:"ul"},"\u4f46\u662f\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u9700\u8981\u68c0\u6d4b\u662f\u5426\u6709\u6b7b\u9501,\u4f1a\u5bf9 MySQL \u670d\u52a1\u5668\u9020\u6210\u538b\u529b")))),(0,l.kt)("h4",{id:"\u907f\u514d\u6b7b\u9501"},"\u907f\u514d\u6b7b\u9501"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5408\u7406\u8bbe\u8ba1\u7d22\u5f15,\u4f7f\u4e1a\u52a1 SQL \u5c3d\u53ef\u80fd\u901a\u8fc7\u7d22\u5f15\u5b9a\u4f4d\u66f4\u5c11\u7684\u884c,\u51cf\u5c11\u9501\u7684\u7ade\u4e89"),(0,l.kt)("li",{parentName:"ol"},"\u8c03\u6574\u4e1a\u52a1\u903b\u8f91\u7684 SQL \u6267\u884c\u987a\u5e8f,\u907f\u514d update/delete \u957f\u65f6\u95f4\u6301\u6709\u9501\u7684 SQL \u5728\u4e8b\u52a1\u524d\u9762"),(0,l.kt)("li",{parentName:"ol"},"\u907f\u514d\u957f\u4e8b\u52a1,\u5c3d\u53ef\u80fd\u5c06\u4e8b\u52a1\u62c6\u5206\u4e3a\u591a\u4e2a\u5c0f\u4e8b\u52a1\u3002\u5c0f\u4e8b\u52a1\u53ef\u4ee5\u7f29\u77ed\u9501\u5b9a\u7684\u65f6\u95f4,\u964d\u4f4e\u9501\u51b2\u7a81\u7684\u51e0\u7387"),(0,l.kt)("li",{parentName:"ol"},"\u5728\u5e76\u53d1\u6bd4\u8f83\u9ad8\u7684\u7cfb\u7edf\u4e2d,\u4e0d\u8981\u663e\u5f0f\u52a0\u9501"),(0,l.kt)("li",{parentName:"ol"},"\u5982\u679c\u4e1a\u52a1\u5141\u8bb8\u7684\u8bdd, \u53ef\u4ee5\u9002\u5f53\u7684\u964d\u4f4e\u9694\u79bb\u7ea7\u522b")),(0,l.kt)("h2",{id:"\u9501\u7ed3\u6784"},"\u9501\u7ed3\u6784"),(0,l.kt)("h3",{id:"\u6982\u89c8"},"\u6982\u89c8"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u6211\u4eec\u77e5\u9053,\u5bf9\u4e00\u6761\u8bb0\u5f55\u52a0\u9501\u7684\u672c\u8d28\u5c31\u662f",(0,l.kt)("strong",{parentName:"p"},"\u5728\u5185\u5b58\u4e2d\u751f\u6210\u4e00\u4e2a\u4e0e\u8be5\u8bb0\u5f55\u76f8\u5173\u8054\u7684\u9501\u7ed3\u6784 (\u9690\u5f0f\u9501\u9664\u5916)"),", \u4f46\u5982\u679c\u6211\u4eec\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u9700\u8981",(0,l.kt)("strong",{parentName:"p"},"\u5bf9\u591a\u4e2a\u8bb0\u5f55\u52a0\u9501\u7684\u8bdd"),", \u90a3\u4e48\u662f\u5426\u9700\u8981\u5728\u5185\u5b58\u4e2d\u751f\u6210\u591a\u4e2a\u9501\u7ed3\u6784\u5462?"),(0,l.kt)("p",{parentName:"blockquote"},"\u6bd4\u5982\u4e0b\u9762\u7684 SQL \u8bed\u53e5\u67e5\u8be2\u6240\u6709\u7684\u8bb0\u5f55\u65f6\u52a0\u4e0a\u4e86 S \u9501:"),(0,l.kt)("pre",{parentName:"blockquote"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"-- \u8fd9\u6761 SQL \u8bed\u53e5\u663e\u7136\u9700\u8981\u4e3a student_info \u8868\u4e2d\u7684\u6240\u6709\u8bb0\u5f55\u90fd\u52a0\u4e0a\u9501\nSELECT * FROM student_info lock in share mode;\n")),(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"\u7406\u8bba\u4e0a,\u6211\u4eec\u53ef\u4ee5\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u591a\u4e2a\u9501\u7ed3\u6784,\u5e76\u4e14\u6bcf\u4e3a\u4e00\u6761\u8bb0\u5f55\u52a0\u9501,\u90fd\u5728\u5185\u5b58\u4e2d\u751f\u6210\u4e00\u4e2a\u9501\u7ed3\u6784,\u8fd9\u79cd\u65b9\u5f0f \u201c\u770b\u8d77\u6765\u5f88\u7b80\u5355\u201d"),", \u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u4e8e\u5185\u5b58\u7684\u6d88\u8017\u8c8c\u4f3c\u6bd4\u8f83\u5927(\u96be\u9053\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u9700\u8981\u5bf9 1000 \u6761\u8bb0\u5f55\u52a0\u9501,\u5c31\u5728\u5185\u5b58\u4e2d\u751f\u6210 1000 \u4e2a\u9501\u7ed3\u6784?)")),(0,l.kt)("p",null,"InnoDB \u4e3a\u4e86",(0,l.kt)("strong",{parentName:"p"},"\u907f\u514d\u8fc7\u591a\u7684\u9501\u7ed3\u6784\u5bf9\u5185\u5b58\u7684\u6d88\u8017"),", \u4e8e\u662f\u5c06",(0,l.kt)("strong",{parentName:"p"},"\u540c\u65f6"),"\u6ee1\u8db3\u4e0b\u9762\u6761\u4ef6\u7684\u8bb0\u5f55,",(0,l.kt)("strong",{parentName:"p"},"\u653e\u5728\u540c\u4e00\u4e2a\u9501\u7ed3\u6784\u4e2d"),":"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u8fdb\u884c\u52a0\u9501\u64cd\u4f5c")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u88ab\u52a0\u9501\u7684\u8bb0\u5f55\u5728\u540c\u4e00\u4e2a\u6570\u636e\u9875\u4e2d")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u52a0\u9501\u7684\u7c7b\u578b\u662f\u4e00\u6837\u7684")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u7b49\u5f85\u72b6\u6001\u662f\u4e00\u6837\u7684"))),(0,l.kt)("h3",{id:"\u9501\u7ed3\u6784\u89e3\u6790"},"\u9501\u7ed3\u6784\u89e3\u6790"),(0,l.kt)("p",null,"InnoDB \u5b58\u50a8\u5f15\u64ce\u4e2d\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u7ed3\u6784"),"\u5982\u56fe\u6240\u793a:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220911123803183",src:a(98165).Z,width:"2584",height:"1826"})),(0,l.kt)("br",null),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u9501\u6240\u5728\u7684\u4e8b\u52a1\u4fe1\u606f")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u65e0\u8bba\u662f\u884c\u9501\u8fd8\u662f\u8868\u9501,\u4e00\u4e2a\u9501\u5c5e\u4e8e\u4e00\u4e2a\u4e8b\u52a1,\u90a3\u4e48\u8fd9\u90e8\u5206\u5c31\u8bb0\u5f55\u4e86\u8be5\u9501\u5bf9\u5e94\u7684\u4e8b\u52a1\u7684\u76f8\u5173\u4fe1\u606f")),(0,l.kt)("admonition",{parentName:"li",title:"\u62d3\u5c55\u77e5\u8bc6",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"\u8fd9\u4e2a\u9501\u6240\u5728\u7684\u4e8b\u52a1\u4fe1\u606f,\u4ece\u5185\u5b58\u7ed3\u6784\u4e0a\u8bf4,\u5c31\u53ea\u662f\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"\u6307\u9488"),",\u6240\u4ee5\u4e0d\u4f1a\u5360\u7528\u592a\u591a\u7684\u5185\u5b58\u7a7a\u95f4\u3002\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u53ef\u4ee5\u4ece\u5185\u5b58\u4e2d\u627e\u5230\u8be5\u4e8b\u52a1\u7684\u8be6\u7ec6\u4fe1\u606f(\u6bd4\u5982 \u4e8b\u52a1ID)\u3002",(0,l.kt)("strong",{parentName:"p"},"\u4e0b\u9762\u7684\u7d22\u5f15\u4fe1\u606f\u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u4e2a\u6307\u9488")))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u7d22\u5f15\u4fe1\u606f")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5bf9\u4e8e\u884c\u9501\u6765\u8bf4,\u9700\u8981\u8bb0\u5f55\u4e00\u4e0b\u8be5\u8bb0\u5f55\u5bf9\u5e94\u7684\u7d22\u5f15\u4fe1\u606f")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u8868\u9501 / \u884c\u9501\u4fe1\u606f")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8fd9\u90e8\u5206\u6839\u636e\u9501\u7684\u7c7b\u578b(\u8868\u9501\u8fd8\u662f\u884c\u9501),\u5b58\u50a8\u7684\u662f\u4e0d\u540c\u7684\u6570\u636e\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u5bf9\u8868\u9501\u6765\u8bf4,\u5b58\u50a8\u7684\u662f\u5bf9\u54ea\u4e2a\u8868\u8fdb\u884c\u52a0\u9501,\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u7684\u4fe1\u606f"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u5bf9\u4e8e\u884c\u9501\u6765\u8bf4,\u8bb0\u5f55\u4e86\u4e0b\u9762\u7684\u4e09\u90e8\u5206\u4fe1\u606f:")),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"Space ID")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8868\u7a7a\u95f4 ID"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"Page Number")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8bb0\u5f55\u6240\u5728\u7684\u9875\u53f7"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"n_bits")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u5bf9\u4e8e\u884c\u9501\u6765\u8bf4,\u4e00\u6761\u8bb0\u5f55\u5c31\u5bf9\u5e94\u4e00\u4e2a\u6bd4\u7279\u4f4d"),"\u3002\u7531\u4e8e\u4e00\u4e2a\u9875\u9762\u4e2d\u5305\u542b\u5f88\u591a\u8bb0\u5f55,\u6240\u4ee5\u7528\u4e0d\u540c\u7684\u6bd4\u7279\u4f4d\u6765\u533a\u5206\u5230\u5e95\u662f\u54ea\u4e00\u6761\u8bb0\u5f55\u52a0\u4e86\u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e3a\u6b64",(0,l.kt)("strong",{parentName:"p"},"\u884c\u9501\u4f1a\u5728\u5176\u9501\u7ed3\u6784\u7684\u5c3e\u90e8\u653e\u4e0a\u4e00\u5806\u6bd4\u7279\u4f4d,")," \u800c\u8fd9\u4e2a ",(0,l.kt)("em",{parentName:"p"},"n_bits")," \u5c5e\u6027\u4ee3\u8868\u4f7f\u7528\u4e86\u591a\u5c11\u6bd4\u7279\u4f4d,",(0,l.kt)("strong",{parentName:"p"},"\u662f\u4e00\u4e2a\u503c")),(0,l.kt)("admonition",{parentName:"li",title:"\u62d3\u5c55\u77e5\u8bc6",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"\u5e76\u4e0d\u662f\u6570\u636e\u9875\u4e2d\u6709\u591a\u5c11\u6761\u8bb0\u5f55,n_bits \u7684\u503c\u5c31\u662f\u591a\u5c11, \u4e00\u822c\u60c5\u51b5\u4e0b,",(0,l.kt)("strong",{parentName:"p"},"n_bits\u7684\u503c\u6bd4\u9875\u9762\u4e2d\u8bb0\u5f55\u6761\u6570\u591a\u4e00\u4e9b"),"\u3002\u4e3b\u8981\u662f\u4e3a\u4e86\u4e4b\u540e\u5728\u9875\u9762\u4e2d\u63d2\u5165\u4e86\u65b0\u8bb0\u5f55\u540e\u4e5f\u4e0d\u81f3\u4e8e\u91cd\u65b0\u5206\u914d\u9501\u7ed3\u6784"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"type_mode")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"32 bit\u5927\u5c0f"),",\u88ab\u5206\u6210\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"lock_mode")," \u3001 ",(0,l.kt)("inlineCode",{parentName:"p"},"lock_type")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"rec_lock_type")," \u4e09\u4e2a\u90e8\u5206:\u5982\u56fe\u6240\u793a"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{alt:"image-20220911142238964",src:a(14455).Z,width:"2708",height:"846"})))),(0,l.kt)("br",null),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"lock_mode [\u9501\u6a21\u5f0f]")," \u5360\u7528",(0,l.kt)("strong",{parentName:"p"},"\u4f4e 4 \u6bd4\u7279"),",\u53ef\u9009\u503c\u5982\u4e0b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LOCK_IS [\u5341\u8fdb\u5236\u7684 0]"),": \u8868\u793a\u5171\u4eab\u610f\u5411\u9501,\u5373 ",(0,l.kt)("em",{parentName:"li"},"IS \u9501")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LOCK_IX [\u5341\u8fdb\u5236\u7684 1]")," : \u8868\u793a\u5171\u4eab\u6392\u4ed6\u9501,\u5373 ",(0,l.kt)("em",{parentName:"li"},"IX \u9501")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LOCK_S [\u5341\u8fdb\u5236\u7684 2]")," : \u8868\u793a\u5171\u4eab\u9501, \u5373 ",(0,l.kt)("em",{parentName:"li"},"S \u9501")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LOCK_X [\u5341\u8fdb\u5236\u7684 3]")," : \u8868\u793a\u6392\u5b83\u9501, \u5373 ",(0,l.kt)("em",{parentName:"li"},"X \u9501")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LOCK_AUTO_INC [\u5341\u8fdb\u5236\u7684 4]")," : \u8868\u793a\u81ea\u589e\u9501,\u5373 ",(0,l.kt)("em",{parentName:"li"},"AUTO_INC\u9501")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"lock_type  [\u9501\u7c7b\u578b]")," \u5360\u7528",(0,l.kt)("strong",{parentName:"p"},"\u4e2d\u95f4 5~8 \u6bd4\u7279 (\u76ee\u524d\u53ea\u7528\u4e86 5~6\u6bd4\u7279)"),",\u53ef\u9009\u503c\u5982\u4e0b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"LOCK_TABLE [\u5341\u8fdb\u5236\u7684 16]")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u5360\u7528",(0,l.kt)("strong",{parentName:"li"},"\u7b2c 5 \u6bd4\u7279\u4f4d"),"\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u7b49\u4e8e",(0,l.kt)("inlineCode",{parentName:"li"},"1"),",\u8868\u793a",(0,l.kt)("strong",{parentName:"li"},"\u8868\u9501")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"LOCK_REC [\u5341\u8fdb\u5236\u7684 32]")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u5360\u7528",(0,l.kt)("strong",{parentName:"li"},"\u7b2c 6 \u6bd4\u7279\u4f4d"),"\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u7b49\u4e8e",(0,l.kt)("inlineCode",{parentName:"li"},"1"),",\u8868\u793a",(0,l.kt)("strong",{parentName:"li"},"\u884c\u9501")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"rec_lock_type [\u884c\u9501\u7684\u5177\u4f53\u7c7b\u578b]")," \u7528",(0,l.kt)("strong",{parentName:"p"},"\u5269\u4f59\u7684\u6bd4\u7279\u4f4d\u8868\u793a (\u53ea\u6709\u5728 lock_type=lock_rec \u7684\u65f6\u5019\u6709\u6548)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"%E9%94%81#%E4%B8%B4%E9%94%AE%E9%94%81next-key-locks"},"LOCK_ORDINARY [\u5341\u8fdb\u5236\u7684 0]")," : \u8868\u793a\u4e34\u952e\u9501(next-key lock)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"%E9%94%81#%E9%97%B4%E9%9A%99%E9%94%81gap-lock"},"LOCK_GAP [\u5341\u8fdb\u5236\u7684 512]")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u5360\u7528",(0,l.kt)("strong",{parentName:"li"},"\u7b2c 10 \u6bd4\u7279\u4f4d"),"\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u4e3a 1,\u8868\u793a\u95f4\u9699\u9501(gap \u9501)"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"%E9%94%81#%E8%AE%B0%E5%BD%95%E9%94%81record-lock"},"LOCK_REC_NOT_GAP [\u5341\u8fdb\u5236\u7684 1024]")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u5360\u7528",(0,l.kt)("strong",{parentName:"li"},"\u7b2c 11 \u6bd4\u7279\u4f4d"),"\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u4e3a 1,\u8868\u793a\u6b63\u5e38\u7684\u8bb0\u5f55\u9501"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"%E9%94%81#%E6%8F%92%E5%85%A5%E6%84%8F%E5%90%91%E9%94%81insert-intention-lock"},"LOCK_INSERT_INTENTION [\u5341\u8fdb\u5236\u7684 2048]")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u5360\u7528",(0,l.kt)("strong",{parentName:"li"},"\u7b2c 12 \u6bd4\u7279\u4f4d"),"\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u4e3a 1, \u8868\u793a\u63d2\u5165\u610f\u5411\u9501"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"LOCK_WAIT [\u5341\u8fdb\u5236\u7684 256]")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u5c31\u662f\u5360\u7528",(0,l.kt)("strong",{parentName:"li"},"\u7b2c 9 \u6bd4\u7279\u4f4d"),"\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u4e3a 1,\u90a3\u4e48\u9501\u7684",(0,l.kt)("em",{parentName:"li"},"is_waiting=true"),", \u5373\u5f53\u524d\u4e8b\u52a1\u6ca1\u6709\u83b7\u53d6\u5230\u9501,\u5904\u4e8e\u7b49\u5f85\u72b6\u6001"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u503c\u4e3a 0,\u90a3\u4e48\u9501\u7684",(0,l.kt)("em",{parentName:"li"},"is_waiting=false"),", \u5373\u5f53\u524d\u4e8b\u52a1\u83b7\u53d6\u5230\u4e86\u9501"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5176\u4ed6\u4fe1\u606f\u2026"))))))),(0,l.kt)("ol",{parentName:"li",start:5},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e00\u5806\u6bd4\u7279\u4f4d"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u662f\u884c\u9501,\u4f1a\u5728\u9501\u7ed3\u6784\u7684\u5c3e\u90e8\u52a0\u4e0a\u8fd9\u4e00\u5806\u6bd4\u7279\u4f4d,\u800c\u6bd4\u7279\u4f4d\u7684\u6570\u91cf\u7528 ",(0,l.kt)("em",{parentName:"li"},"n_bits")," \u8868\u793a"),(0,l.kt)("li",{parentName:"ul"},"\u6211\u4eec\u77e5\u9053,\u6570\u636e\u9875\u7684\u8bb0\u5f55\u4e2d\u6709\u4e00\u4e2a",(0,l.kt)("a",{parentName:"li",href:"InnoDB%E6%95%B0%E6%8D%AE%E9%A1%B5%E7%BB%93%E6%9E%84#heap_no"},"heap_no")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6700\u5c0f\u8bb0\u5f55 Infimum \u5bf9\u5e94\u7684 ",(0,l.kt)("em",{parentName:"li"},"heap_no=0"),", \u6700\u5927\u8bb0\u5f55 Supremum \u5bf9\u5e94\u7684 ",(0,l.kt)("em",{parentName:"li"},"heap_no=1"),",\u7136\u540e\u6bcf\u65b0\u589e\u4e00\u6761\u8bb0\u5f55,\u5bf9\u5e94\u7684 heap_no \u90fd\u4f1a\u9012\u589e\u52a0 1"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u9501\u7ed3\u6784\u6700\u540e\u4e00\u5806\u6bd4\u7279\u4f4d\u5c31\u5bf9\u5e94\u8fd9\u4e2a\u6570\u636e\u9875\u7684\u8bb0\u5f55,\u4e00\u4e2a\u6bd4\u7279\u4f4d\u5bf9\u5e94\u4e00\u4e2a\u8bb0\u5f55\u7684 heap_no"))))))))))),(0,l.kt)("h2",{id:"\u9501\u7684\u76d1\u63a7"},"\u9501\u7684\u76d1\u63a7"),(0,l.kt)("h3",{id:"\u884c\u9501\u7ade\u4e89\u5206\u6790"},"\u884c\u9501\u7ade\u4e89\u5206\u6790"),(0,l.kt)("p",null,"\u5173\u4e8eMySQL\u9501\u7684\u76d1\u63a7\uff0c\u6211\u4eec\u4e00\u822c\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5 ",(0,l.kt)("inlineCode",{parentName:"p"},"InnoDB_row_lock")," \u7b49\u72b6\u6001\u53d8\u91cf\u6765\u5206\u6790\u7cfb\u7edf\u4e0a\u7684\u884c\u9501\u7684\u4e89\u593a\u60c5\u51b5:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220911150924049",src:a(82313).Z,width:"726",height:"404"})),(0,l.kt)("br",null),(0,l.kt)("p",null,"\u5bf9\u5404\u4e2a\u72b6\u6001\u91cf\u7684\u8bf4\u660e\u5982\u4e0b:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"Innodb_row_lock_current_waits"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5f53\u524d\u6b63\u5728\u7b49\u5f85\u9501\u5b9a\u7684\u6570\u91cf"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"Innodb_row_lock_time"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u9501\u5b9a\u603b\u65f6\u95f4\u957f\u5ea6, \u5373 ",(0,l.kt)("strong",{parentName:"li"},"\u7b49\u5f85\u603b\u65f6\u957f")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"Innodb_row_lock_time_avg"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6bcf\u6b21\u7b49\u5f85\u6240\u82b1\u5e73\u5747\u65f6\u95f4, \u5373 ",(0,l.kt)("strong",{parentName:"li"},"\u7b49\u5f85\u5e73\u5747\u65f6\u957f")," "))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"Innodb_row_lock_time_max"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u7b49\u5f85\u6700\u5e38\u7684\u4e00\u6b21\u6240\u82b1\u7684\u65f6\u95f4")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"Innodb_row_lock_waits"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7cfb\u7edf\u542f\u52a8\u540e\u5230\u73b0\u5728\u603b\u5171\u7b49\u5f85\u7684\u6b21\u6570, \u5373 ",(0,l.kt)("strong",{parentName:"li"},"\u7b49\u5f85\u603b\u6b21\u6570"))))),(0,l.kt)("h3",{id:"\u5176\u4ed6\u76d1\u63a7\u65b9\u6cd5"},"\u5176\u4ed6\u76d1\u63a7\u65b9\u6cd5"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"MySQL\u628a\u4e8b\u52a1\u548c\u9501\u7684\u4fe1\u606f\u8bb0\u5f55\u5728\u4e86 ",(0,l.kt)("em",{parentName:"p"},"information_schema")," \u5e93\u4e2d\uff0c\u6d89\u53ca\u5230\u7684\u4e09\u5f20\u8868\u5206\u522b\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"INNODB_TRX")," \u3001 ",(0,l.kt)("strong",{parentName:"p"},"INNODB_LOCKS")," \u548c ",(0,l.kt)("strong",{parentName:"p"},"INNODB_LOCKS_WAITS")),(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("inlineCode",{parentName:"p"},"MySQL5.7 \u4e4b\u524d"),": \u53ef\u4ee5\u901a\u8fc7 ",(0,l.kt)("em",{parentName:"p"},"information_schema.INNODB_LOCKS")," \u67e5\u770b\u4e8b\u52a1\u7684\u9501\u60c5\u51b5\uff0c\u4f46\u53ea\u80fd\u770b\u5230\u963b\u585e\u4e8b\u52a1\u7684\u9501;\u5982\u679c\u4e8b\u52a1\u5e76\u672a\u88ab\u963b\u585e\uff0c\u5219\u5728\u8be5\u8868\u4e2d\u770b\u4e0d\u5230\u8be5\u4e8b\u52a1\u7684\u9501\u60c5\u51b5"),(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("inlineCode",{parentName:"p"},"MySQL8.0"),": \u5220\u9664\u4e86 information_schema.INNODB_LOCKS\uff0c\u6dfb\u52a0\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"performance_schema.data_locks")," ,\u53ef\u4ee5\u901a\u8fc7 performance_schema.data_lock s\u67e5\u770b\u4e8b\u52a1\u7684\u9501\u60c5\u51b5\u3002"),(0,l.kt)("p",{parentName:"blockquote"},"\u548cMySQL5.7\u53ca\u4e4b\u524d\u4e0d\u540c\uff0c",(0,l.kt)("strong",{parentName:"p"},"performance_schema.data_locks\u4e0d\u4f46\u53ef\u4ee5\u770b\u5230\u963b\u585e\u8be5\u4e8b\u52a1\u7684\u9501\uff0c\u8fd8\u53ef\u4ee5\u770b\u5230\u8be5\u4e8b\u52a1\u6240\u6301\u6709\u7684\u9501")),(0,l.kt)("p",{parentName:"blockquote"},"\u540c\u65f6: ",(0,l.kt)("strong",{parentName:"p"},"information_schema.INNODB_LOCK_WAITS\u4e5f\u88ab ",(0,l.kt)("inlineCode",{parentName:"strong"},"performance_schema.data_lock_waits")," \u6240\u4ee3\u66ff"))),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u67e5\u8be2\u6b63\u5728\u88ab\u9501\u963b\u585e\u7684sql\u8bed\u53e5")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM information_schema.INNODB_TRX\\G;\n\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u67e5\u8be2\u9501\u7b49\u5f85\u60c5\u51b5")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM performance_schema.data_lock_waits\\G;\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u67e5\u8be2\u9501\u7684\u60c5\u51b5")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * from performance_schema.data_locks\\G;\n")))))}o.isMDXComponent=!0},608:(e,t,a)=>{a.d(t,{Z:()=>n});const n="data:image/png;base64,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"},27683:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220821151333266-edf3d7ca0209544d7b09555dfd73b4da.png"},15376:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220821154603839-8149295e69ebbc178652ec7235dbdabf.png"},8665:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220821154956926-5f58506c6d3f2b80e09d585ebab24823.png"},81841:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220821230720208-31e09da935791851cddfe98e427f2d3c.png"},64862:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220828144713514-85fbfdb9fb4d0b8132650e264a8796da.png"},76555:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220828150832894-43f13ae30c1922990169cdbff620d4ba.png"},14205:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220828151252910-b1d9334fe8b05e6d41833323a0098e8d.png"},68050:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220901231917790-7dff26d0f948bfc21599e97e21252294.png"},93874:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220901232330851-b184bd746d01d5165cc3f0d83e8b1636.png"},66239:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220904133713987-1cf0a5c3dd5912426938905a889ecc6b.png"},14215:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220904142504872-e09c189ebe5257c507465606148300db.png"},96585:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220904143513400-491ad60e81b9effa8170fb07dc43adb3.png"},10730:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220904143840668-e7bddb6913031cae0611356cf84bf226.png"},48107:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220904150929225-001b6aa937541b3e2275cc34631c5296.png"},35076:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220904155354125-036a442b341113bf631d3aacdfa94a0d.png"},47905:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220904225008492-063c9f3b8ed128c4ace37c551e325c81.png"},98165:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220911123803183-54cc041bb7d943ae628e85a2d125cec0.png"},14455:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220911142238964-0b164eb473853cf31d5435fdfde592da.png"},82313:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-20220911150924049-ea06b7cd20f0730aae228deba337c6c8.png"}}]);