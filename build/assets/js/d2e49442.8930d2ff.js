"use strict";(self.webpackChunkhuakucha=self.webpackChunkhuakucha||[]).push([[8832],{58481:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>u});var a=t(87462),l=(t(67294),t(3905));t(61839);const i={id:"juc\u57fa\u7840",title:"\u5e76\u53d1\u5305\u57fa\u7840"},r=void 0,o={unversionedId:"\u5e76\u53d1\u7f16\u7a0b/juc\u57fa\u7840",id:"\u5e76\u53d1\u7f16\u7a0b/juc\u57fa\u7840",title:"\u5e76\u53d1\u5305\u57fa\u7840",description:"JUC\u57fa\u7840\u77e5\u8bc6\u6982\u8ff0",source:"@site/docs/\u5e76\u53d1\u7f16\u7a0b/1.1JUC\u57fa\u7840.md",sourceDirName:"\u5e76\u53d1\u7f16\u7a0b",slug:"/\u5e76\u53d1\u7f16\u7a0b/juc\u57fa\u7840",permalink:"/docs/\u5e76\u53d1\u7f16\u7a0b/juc\u57fa\u7840",draft:!1,editUrl:"https://github.com/MagicalZhu/NoteLib/tree/main/docs/\u5e76\u53d1\u7f16\u7a0b/1.1JUC\u57fa\u7840.md",tags:[],version:"current",lastUpdatedBy:"YuLiang Zhu",lastUpdatedAt:1670289592,formattedLastUpdatedAt:"2022\u5e7412\u67086\u65e5",frontMatter:{id:"juc\u57fa\u7840",title:"\u5e76\u53d1\u5305\u57fa\u7840"},sidebar:"basicSideBar",previous:{title:"\u5e76\u53d1\u7b14\u8bb0\u6982\u8ff0",permalink:"/docs/currency"},next:{title:"\u5e76\u53d1\u57fa\u7840",permalink:"/docs/category/\u5e76\u53d1\u57fa\u7840"}},p={},u=[{value:"JUC\u57fa\u7840\u77e5\u8bc6\u6982\u8ff0",id:"juc\u57fa\u7840\u77e5\u8bc6\u6982\u8ff0",level:2},{value:"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b",id:"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b",level:3},{value:"\u7ebf\u7a0b\u7684\u72b6\u6001",id:"\u7ebf\u7a0b\u7684\u72b6\u6001",level:3},{value:"\u7ebf\u7a0b\u72b6\u6001\u53d8\u8fc1",id:"\u7ebf\u7a0b\u72b6\u6001\u53d8\u8fc1",level:4},{value:"\u7ebf\u7a0b\u5c5e\u6027",id:"\u7ebf\u7a0b\u5c5e\u6027",level:3},{value:"\u7ebf\u7a0bID",id:"\u7ebf\u7a0bid",level:4},{value:"\u4e2d\u65ad\u7ebf\u7a0b",id:"\u4e2d\u65ad\u7ebf\u7a0b",level:4},{value:"\u672a\u6355\u83b7\u5f02\u5e38\u5904\u7406\u5668",id:"\u672a\u6355\u83b7\u5f02\u5e38\u5904\u7406\u5668",level:5},{value:"\u5173\u95ed\u505c\u6b62\u7ebf\u7a0b",id:"\u5173\u95ed\u505c\u6b62\u7ebf\u7a0b",level:3},{value:"\u2460. \u6ca1\u6709sleep\u3001wait\u65b9\u6cd5",id:"-\u6ca1\u6709sleepwait\u65b9\u6cd5",level:4},{value:"\u2461. \u5bf9\u8c03\u7528sleep\u65b9\u6cd5\u7684\u7ebf\u7a0b\u8fdb\u884c\u4e2d\u65ad",id:"-\u5bf9\u8c03\u7528sleep\u65b9\u6cd5\u7684\u7ebf\u7a0b\u8fdb\u884c\u4e2d\u65ad",level:4},{value:"\u505c\u6b62\u7ebf\u7a0b\u76f8\u5173\u51fd\u6570\u89e3\u6790",id:"\u505c\u6b62\u7ebf\u7a0b\u76f8\u5173\u51fd\u6570\u89e3\u6790",level:3},{value:"\u76d1\u89c6\u5668/\u9501/\u7ba1\u7a0b(monitor)",id:"\u76d1\u89c6\u5668\u9501\u7ba1\u7a0bmonitor",level:3},{value:"\u6761\u4ef6\u5bf9\u8c61",id:"\u6761\u4ef6\u5bf9\u8c61",level:3},{value:"\u7528\u6237\u7ebf\u7a0b\u3001\u5b88\u62a4\u7ebf\u7a0b",id:"\u7528\u6237\u7ebf\u7a0b\u5b88\u62a4\u7ebf\u7a0b",level:3},{value:"\u7ade\u6001\u6761\u4ef6",id:"\u7ade\u6001\u6761\u4ef6",level:3},{value:"Lock\u63a5\u53e3",id:"lock\u63a5\u53e3",level:2},{value:"synchronized \u5173\u952e\u5b57",id:"synchronized-\u5173\u952e\u5b57",level:3},{value:"synchronized \u552e\u7968\u6848\u4f8b",id:"synchronized-\u552e\u7968\u6848\u4f8b",level:4},{value:"Lock\u63a5\u53e3\u6982\u8ff0",id:"lock\u63a5\u53e3\u6982\u8ff0",level:3},{value:"Lock \u5e38\u89c1\u65b9\u6cd5",id:"lock-\u5e38\u89c1\u65b9\u6cd5",level:4},{value:"Lock VS Synchronized",id:"lock-vs-synchronized",level:4},{value:"Lock\u5b9e\u73b0\u552e\u7968",id:"lock\u5b9e\u73b0\u552e\u7968",level:4},{value:"\u7ebf\u7a0b\u95f4\u901a\u4fe1",id:"\u7ebf\u7a0b\u95f4\u901a\u4fe1",level:3},{value:"Synchronized\u65b9\u6848",id:"synchronized\u65b9\u6848",level:4},{value:"\u7b49\u5f85\u901a\u77e5\u673a\u5236",id:"\u7b49\u5f85\u901a\u77e5\u673a\u5236",level:5},{value:"\u865a\u5047\u5524\u9192\u7684\u95ee\u9898",id:"\u865a\u5047\u5524\u9192\u7684\u95ee\u9898",level:5},{value:"\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f",id:"\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f",level:5},{value:"Lock\u65b9\u6848",id:"lock\u65b9\u6848",level:4},{value:"\u7ebf\u7a0b\u95f4\u5b9a\u5236\u5316\u901a\u4fe1",id:"\u7ebf\u7a0b\u95f4\u5b9a\u5236\u5316\u901a\u4fe1",level:3},{value:"Thread\u7684\u5176\u4ed6\u65b9\u6cd5",id:"thread\u7684\u5176\u4ed6\u65b9\u6cd5",level:3},{value:"sleep()",id:"sleep",level:4},{value:"wait\u91ca\u653e\u9501",id:"wait\u91ca\u653e\u9501",level:5},{value:"sleep\u4e0d\u91ca\u653e\u9501",id:"sleep\u4e0d\u91ca\u653e\u9501",level:5},{value:"join()",id:"join",level:4},{value:"yield()",id:"yield",level:4},{value:"\u96c6\u5408\u7684\u7ebf\u7a0b\u5b89\u5168",id:"\u96c6\u5408\u7684\u7ebf\u7a0b\u5b89\u5168",level:2},{value:"\u4e0d\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b",id:"\u4e0d\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b",level:3},{value:"ArrayList",id:"arraylist",level:4},{value:"\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b",id:"\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b",level:3},{value:"Vector \u4e0d\u63a8\u8350",id:"vector-\u4e0d\u63a8\u8350",level:4},{value:"Collections\u5de5\u5177\u7c7b \u4e0d\u5e38\u7528",id:"collections\u5de5\u5177\u7c7b-\u4e0d\u5e38\u7528",level:4},{value:"\u591a\u7ebf\u7a0b\u9501",id:"\u591a\u7ebf\u7a0b\u9501",level:2},{value:"\u516b\u9501\u95ee\u9898\u6f14\u793aSynchronized",id:"\u516b\u9501\u95ee\u9898\u6f14\u793asynchronized",level:3},{value:"\u516b\u9501\u7684\u603b\u7ed3",id:"\u516b\u9501\u7684\u603b\u7ed3",level:4},{value:"\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501",id:"\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501",level:3},{value:"\u533a\u5206\u516c\u5e73\u9501\u4e0e\u975e\u516c\u5e73\u9501",id:"\u533a\u5206\u516c\u5e73\u9501\u4e0e\u975e\u516c\u5e73\u9501",level:4},{value:"\u975e\u516c\u5e73\u9501\u7684\u5904\u7406",id:"\u975e\u516c\u5e73\u9501\u7684\u5904\u7406",level:5},{value:"\u516c\u5e73\u9501\u7684\u5904\u7406",id:"\u516c\u5e73\u9501\u7684\u5904\u7406",level:5},{value:"\u4e24\u79cd\u9501\u6e90\u7801",id:"\u4e24\u79cd\u9501\u6e90\u7801",level:4},{value:"\u975e\u516c\u5e73\u9501",id:"\u975e\u516c\u5e73\u9501",level:5},{value:"\u516c\u5e73\u9501",id:"\u516c\u5e73\u9501",level:5},{value:"\u53ef\u91cd\u5165\u9501\u9012\u5f52\u9501",id:"\u53ef\u91cd\u5165\u9501\u9012\u5f52\u9501",level:3},{value:"\u6b7b\u9501",id:"\u6b7b\u9501",level:3},{value:"\u4ee3\u7801\u6f14\u793a\u6b7b\u9501",id:"\u4ee3\u7801\u6f14\u793a\u6b7b\u9501",level:4},{value:"Callable &amp; FutureTask",id:"callable--futuretask",level:2},{value:"JUC \u8f85\u52a9\u7c7b",id:"juc-\u8f85\u52a9\u7c7b",level:2},{value:"CountDownLatch",id:"countdownlatch",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:4},{value:"CyclicBarrier - \u540c\u6b65\u6805\u680f",id:"cyclicbarrier---\u540c\u6b65\u6805\u680f",level:3},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0",level:4},{value:"\u5206\u6b65\u8ba1\u7b97\u6570\u636e",id:"\u5206\u6b65\u8ba1\u7b97\u6570\u636e",level:4},{value:"Semaphore - \u63a7\u5236\u5e76\u53d1\u7ebf\u7a0b\u6570",id:"semaphore---\u63a7\u5236\u5e76\u53d1\u7ebf\u7a0b\u6570",level:3},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0-1",level:4},{value:"\u8bfb\u5199\u9501-ReentrantReadWriteLock",id:"\u8bfb\u5199\u9501-reentrantreadwritelock",level:2},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-1",level:3},{value:"\u9501\u964d\u7ea7\u4ee3\u7801\u793a\u4f8b",id:"\u9501\u964d\u7ea7\u4ee3\u7801\u793a\u4f8b",level:3},{value:"\u9501\u5347\u7ea7\u6d4b\u8bd5\uff1f",id:"\u9501\u5347\u7ea7\u6d4b\u8bd5",level:3},{value:"\u963b\u585e\u961f\u5217(BlockingQueue)",id:"\u963b\u585e\u961f\u5217blockingqueue",level:2},{value:"BlockingQueue \u6982\u8ff0",id:"blockingqueue-\u6982\u8ff0",level:3},{value:"\u5e38\u89c1\u7684 BlockingQueue\u7684\u5b9e\u73b0",id:"\u5e38\u89c1\u7684-blockingqueue\u7684\u5b9e\u73b0",level:3},{value:"ArrayBlockingQueue\uff08\u6709\u754c\uff09",id:"arrayblockingqueue\u6709\u754c",level:4},{value:"\u6e90\u7801\u5b9e\u73b0",id:"\u6e90\u7801\u5b9e\u73b0",level:5},{value:"\u4ee3\u7801\u6f14\u793a",id:"\u4ee3\u7801\u6f14\u793a",level:5},{value:"LinkedBlockingQueue\uff08\u65e0\u754c)",id:"linkedblockingqueue\u65e0\u754c",level:4},{value:"\u6e90\u7801\u5b9e\u73b0",id:"\u6e90\u7801\u5b9e\u73b0-1",level:5},{value:"PriorityBlockingQueue\uff08\u65e0\u754c\uff09",id:"priorityblockingqueue\u65e0\u754c",level:4},{value:"DelayQueue\uff08\u65e0\u754c\uff09",id:"delayqueue\u65e0\u754c",level:4},{value:"SynchronousQueue",id:"synchronousqueue",level:4},{value:"LinkedTransferQueue (\u65e0\u754c)",id:"linkedtransferqueue-\u65e0\u754c",level:4},{value:"LinkedBlockingDeque",id:"linkedblockingdeque",level:4},{value:"\u7ebf\u7a0b\u6c60(ThreadPool)",id:"\u7ebf\u7a0b\u6c60threadpool",level:2},{value:"\u7ebf\u7a0b\u6c60\u6982\u8ff0",id:"\u7ebf\u7a0b\u6c60\u6982\u8ff0",level:3},{value:"\u4ee3\u7801\u6f14\u793a",id:"\u4ee3\u7801\u6f14\u793a-1",level:3},{value:"newFixedThreadPool",id:"newfixedthreadpool",level:4},{value:"newSingleThreadExecutor",id:"newsinglethreadexecutor",level:4},{value:"newCachedThreadPool",id:"newcachedthreadpool",level:4},{value:"\u7ebf\u7a0b\u6c60\u5e95\u5c42\u5de5\u4f5c\u539f\u7406",id:"\u7ebf\u7a0b\u6c60\u5e95\u5c42\u5de5\u4f5c\u539f\u7406",level:3},{value:"\u7ebf\u7a0b\u6c60\u53c2\u6570\u8bf4\u660e",id:"\u7ebf\u7a0b\u6c60\u53c2\u6570\u8bf4\u660e",level:3},{value:"\u62d2\u7edd\u7b56\u7565 \ud83c\udf1f",id:"\u62d2\u7edd\u7b56\u7565-",level:4},{value:"\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60",id:"\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60",level:3},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0-2",level:4},{value:"Fork/Join \u5206\u652f\u5408\u5e76\u6846\u67b6",id:"forkjoin-\u5206\u652f\u5408\u5e76\u6846\u67b6",level:2},{value:"Fork\u3001Join\u65b9\u6cd5\u5b9e\u73b0\u539f\u7406",id:"forkjoin\u65b9\u6cd5\u5b9e\u73b0\u539f\u7406",level:3},{value:"Fork\u65b9\u6cd5",id:"fork\u65b9\u6cd5",level:4},{value:"Join\u65b9\u6cd5",id:"join\u65b9\u6cd5",level:4},{value:"Fork/Join \u6846\u67b6\u7684\u5f02\u5e38\u5904\u7406",id:"forkjoin-\u6846\u67b6\u7684\u5f02\u5e38\u5904\u7406",level:4},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0-3",level:4},{value:"CompletableFuture \u5f02\u6b65\u56de\u8c03",id:"completablefuture-\u5f02\u6b65\u56de\u8c03",level:2},{value:"CompletableFuture \u7b80\u4ecb",id:"completablefuture-\u7b80\u4ecb",level:3},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0-4",level:3},{value:"\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",id:"\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",level:4},{value:"\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",id:"\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",level:4},{value:"\u7ebf\u7a0b\u4f9d\u8d56",id:"\u7ebf\u7a0b\u4f9d\u8d56",level:4},{value:"\u6d88\u8d39\u5904\u7406\u7ed3\u679c",id:"\u6d88\u8d39\u5904\u7406\u7ed3\u679c",level:4},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406",level:4}],k={toc:u};function m(e){let{components:n,...i}=e;return(0,l.kt)("wrapper",(0,a.Z)({},k,i,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"juc\u57fa\u7840\u77e5\u8bc6\u6982\u8ff0"},"JUC\u57fa\u7840\u77e5\u8bc6\u6982\u8ff0"),(0,l.kt)("h3",{id:"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b"},"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4ec0\u4e48\u662fJUC\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"java.util.concurrent")," \u5de5\u5177\u5305\u7684\u7b80\u79f0\uff0c\u7528\u4e8e\u5904\u7406\u7ebf\u7a0b\u7684\u5de5\u5177\u5305"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u5e76\u884c\u4e0e\u5e76\u53d1")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u4e32\u884c(serial)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u6240\u6709\u4efb\u52a1\u90fd\u4e00\u4e00\u6309\u5148\u540e\u987a\u5e8f\u8fdb\u884c (\u4e00\u6b21\u53ea\u80fd\u53d6\u5f97\u4e00\u4e2a\u4efb\u52a1\uff0c\u5e76\u6267\u884c\u8fd9\u4e2a\u4efb\u52a1)")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u5e76\u884c(parallel)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u53ef\u4ee5\u540c\u65f6\u53d6\u5f97\u591a\u4e2a\u4efb\u52a1\uff0c\u5e76\u540c\u65f6\u53bb\u6267\u884c\u6240\u53d6\u5f97\u7684\u8fd9\u4e9b\u4efb\u52a1")),(0,l.kt)("li",{parentName:"ul"},"\u5e76\u884c\u7684\u6548\u7387\u4ece\u4ee3\u7801\u5c42\u6b21\u4e0a\u5f3a\u4f9d\u8d56\u4e8e\u591a\u8fdb\u7a0b/\u591a\u7ebf\u7a0b\u4ee3\u7801, \u4ece\u786c\u4ef6\u89d2\u5ea6\u4e0a \u5219\u4f9d\u8d56\u4e8e\u591a\u6838 CPU"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\u5e76\u53d1(concurrent)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u591a\u4e2a\u7a0b\u5e8f\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c\u7684\u73b0\u8c61"),", \u66f4\u7ec6\u5316\u7684\u662f",(0,l.kt)("strong",null,"\u591a\u8fdb\u7a0b\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c"),"\u6216\u8005",(0,l.kt)("strong",null,"\u591a\u6307\u4ee4\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f46\u5b9e\u9645\u4e0a\uff0c\u5bf9\u4e8e\u5355\u6838\u5fc3 CPU \u6765\u8bf4\uff0c\u540c\u4e00\u65f6\u523b \u53ea\u80fd\u8fd0\u884c\u4e00\u4e2a\u7ebf\u7a0b"),(0,l.kt)("li",{parentName:"ul"},"\u6240\u4ee5\uff0c\u8fd9\u91cc\u7684",(0,l.kt)("strong",{parentName:"li"},"\u540c\u65f6\u8fd0\u884c")," \u8868\u793a\u7684\u4e0d\u662f\u771f\u7684\u540c\u4e00\u65f6\u523b\u6709\u591a\u4e2a\u7ebf\u7a0b\u8fd0\u884c\u7684\u73b0\u8c61(",(0,l.kt)("strong",{parentName:"li"},"\u8fd9\u662f\u5e76\u884c\u7684\u6982\u5ff5"),"), \u800c\u662f\u63d0\u4f9b\u4e00\u79cd\u529f\u80fd\u8ba9\u7528\u6237\u770b\u6765\u591a\u4e2a\u7a0b\u5e8f\u540c\u65f6\u8fd0\u884c\u8d77\u6765\u4e86\uff0c\u4f46\u5b9e\u9645\u4e0a\u8fd9\u4e9b\u7a0b\u5e8f\u4e2d\u7684\u8fdb\u7a0b\u4e0d\u662f\u4e00\u76f4\u9738\u5360 CPU \u7684\uff0c\u800c\u662f",(0,l.kt)("strong",{parentName:"li"},"\u6267\u884c\u4e00\u4f1a\u505c\u4e00\u4f1a")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u8981\u89e3\u51b3\u5927\u5e76\u53d1\u95ee\u9898\uff0c\u901a\u5e38\u662f\u5c06\u5927\u4efb\u52a1\u5206\u89e3\u6210\u591a\u4e2a\u5c0f\u4efb\u52a1"),", \u7531\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8fdb\u7a0b\u7684\u8c03\u5ea6\u662f\u968f\u673a\u7684\uff0c\u6240\u4ee5\u5207\u5206\u6210\u591a\u4e2a\u5c0f\u4efb\u52a1\u540e\uff0c\u53ef\u80fd\u4f1a\u4ece\u4efb\u4e00\u5c0f\u4efb\u52a1\u5904\u6267\u884c,\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e00\u4e9b\u73b0\u8c61:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u4e00\u4e2a\u5c0f\u4efb\u52a1\u6267\u884c\u4e86\u591a\u6b21\uff0c\u8fd8\u6ca1\u5f00\u59cb\u4e0b\u4e2a\u4efb\u52a1\u7684\u60c5\u51b5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u8fd9\u65f6\u4e00\u822c\u4f1a\u91c7\u7528\u961f\u5217\u6216\u7c7b\u4f3c\u7684\u6570\u636e\u7ed3\u6784\u6765\u5b58\u653e\u5404\u4e2a\u5c0f\u4efb\u52a1\u7684\u6210\u679c")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u8fd8\u6ca1\u51c6\u5907\u597d\u7b2c\u4e00\u6b65\u5c31\u6267\u884c\u7b2c\u4e8c\u6b65\u7684\u53ef\u80fd"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u8fd9\u65f6\uff0c\u4e00\u822c\u91c7\u7528\u591a\u8def\u590d\u7528\u6216 \u5f02\u6b65\u7684\u65b9\u5f0f\uff0c\u6bd4\u5982\u53ea\u6709\u51c6\u5907\u597d\u4ea7\u751f\u4e86\u4e8b\u4ef6\u901a\u77e5\u624d\u6267\u884c\u67d0\u4e2a\u4efb\u52a1")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u591a\u8fdb\u7a0b/\u591a\u7ebf\u7a0b\u7684\u65b9\u5f0f\u5e76\u884c\u6267\u884c\u8fd9\u4e9b\u5c0f\u4efb\u52a1\u3002\u4e5f\u53ef\u4ee5\u5355\u8fdb\u7a0b/\u5355\u7ebf\u7a0b\u6267\u884c\u8fd9 \u4e9b\u5c0f\u4efb\u52a1\uff0c\u8fd9\u65f6\u5f88\u53ef\u80fd\u8981\u914d\u5408\u591a\u8def\u590d\u7528\u624d\u80fd\u8fbe\u5230\u8f83\u9ad8\u7684\u6548\u7387")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u603b\u7ed3"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5e76\u53d1\uff1a \u540c\u4e00\u65f6\u523b\u591a\u4e2a\u7ebf\u7a0b\u5728\u8bbf\u95ee\u540c\u4e00\u4e2a\u8d44\u6e90\uff0c\u591a\u4e2a\u7ebf\u7a0b\u5bf9\u4e00\u4e2a\u70b9 (\u6625\u8fd0\u62a2\u7968 \u7535\u5546\u79d2\u6740...)"),(0,l.kt)("li",{parentName:"ul"},"\u5e76\u884c: \u591a\u9879\u5de5\u4f5c\u4e00\u8d77\u6267\u884c\uff0c\u4e4b\u540e\u518d\u6c47\u603b"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u8fdb\u7a0b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7cfb\u7edf\u4e2d\u6b63\u5728\u8fd0\u884c\u7684\u6709\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002\u8fdb\u7a0b\u65f6\u4e00\u4e2a\u8d44\u6e90\u5206\u914d\u7684\u6700\u5c0f\u5355\u4f4d"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u7ebf\u7a0b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7cfb\u7edf\u5206\u914d\u5904\u7406\u5668\u65f6\u95f4\u8d44\u6e90\u7684\u57fa\u672c\u5355\u5143\uff0c\u6216\u8005\u8bf4\u8fdb\u7a0b\u5185\u72ec\u7acb\u6267\u884c\u7684\u4e00\u4e2a\u5355\u5143\u6267\u884c\u6d41"),(0,l.kt)("li",{parentName:"ul"},"CPU\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u914d\u65f6\u95f4\u7247(\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u6267\u884c\u65f6\u95f4),\u65f6\u95f4\u7247\u5341\u5206\u77ed(\u4e00\u822c\u662f\u51e0\u5341\u6beb\u79d2)\u3002CPU\u901a\u8fc7\u65f6\u95f4\u7247\u5206\u914d\u7b97\u6cd5\u5faa\u73af\u7684\u5904\u7406\u4efb\u52a1,\u5f53\u524d\u7ebf\u7a0b\u6267\u884c\u4e00\u4e2a\u65f6\u95f4\u7247\u540e\u5207\u6362\u5230\u4e0b\u4e00\u4e2a\u7ebf\u7a0b",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5207\u6362\u524d\u4f1a\u4fdd\u5b58\u4e0a\u4e00\u4e2a\u4efb\u52a1\u7684\u72b6\u6001,\u4ee5\u4fbf\u4e0b\u4e00\u6b21\u5207\u6362\u56de\u8fd9\u4e2a\u4efb\u52a1\u65f6,\u53ef\u4ee5\u518d\u52a0\u8f7d\u8fd9\u4e2a\u4efb\u52a1\u7684\u72b6\u6001 -> \u4e00\u6b21\u4fdd\u5b58\u5230\u52a0\u8f7d\u7684\u8fc7\u7a0b\u5c31\u662f\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362")))),(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b -> \u7a0b\u5e8f\u6267\u884c\u7684\u6700\u5c0f\u5355\u4f4d"),(0,l.kt)("li",{parentName:"ul"},"java\u4e2d\u6709\u4e24\u79cd\u521b\u5efa\u7ebf\u7a0b\u7684\u65b9\u5f0f: \u7ee7\u627fThread\u3001\u5b9e\u73b0Runnable\u63a5\u53e3",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ee7\u627fThread \u662f\u91cd\u5199run\u65b9\u6cd5\uff0c\u800c\u5b9e\u73b0Runnable\u4e5f\u662f\u5b9e\u73b0\u5176run\u65b9\u6cd5"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Thread \u672c\u8eab\u662f\u5b9e\u73b0\u4e86Runnable\u63a5\u53e3\u7684\uff0c\u6240\u4ee5\u5982\u679c\u81ea\u5b9a\u4e49\u7684Runnable\u63a5\u53e3\u5b9e\u73b0\u7c7b\u4f20\u5165Thread\u6784\u9020\u5668\uff0c\u5728start\u542f\u52a8\u7ebf\u7a0b\u65f6\u8c03\u7528run\u65b9\u6cd5\u65f6\uff0c\u4f1a\u8f6c\u5230Runnable\u7684\u5b9e\u73b0\u7c7b\u4e0a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'  // Thread \u6784\u9020\u5668\u4e2d\u4f20\u5165 Runnable \u5b9e\u73b0\u7c7b,\u542f\u52a8\u7ebf\u7a0b\u7684\u65f6\u5019\u4f1a\u8c03\u7528 target.run\n  public Thread(Runnable target) {\n    init(null, target, "Thread-" + nextThreadNum(), 0);\n  }\n')))))))),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'// \u901a\u8fc7Thread \u548c Runnable \u521b\u5efa\u7ebf\u7a0b\n\n// Thread\u7684\u65b9\u5f0f\npublic class createByThread extends Thread {\n    public createByThread(String name) {\n        super(name);\n    }\n\n    @Override\n    public void run() {\n        try {\n            System.out.println("\u5185\u90e8\u7ebf\u7a0b\u5f00\u59cb==>"+ThreadUtil.getThreadInfo());\n            TimeUnit.SECONDS.sleep(3);\n            System.out.println("\u5185\u90e8\u7ebf\u7a0b\u7ed3\u675f==>"+ThreadUtil.getThreadInfo());\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static void main(String[] args) {\n        System.out.println("\u4e3b\u7ebf\u5f00\u59cb:"+ ThreadUtil.getThreadInfo());\n        Thread t1 = new createByThread("ThreadA");\n        System.out.println(ThreadUtil.getThreadInfo2(t1));\n        System.out.println("\u542f\u52a8\u5b50\u7ebf\u7a0b");\n        t1.start();\n        System.out.println(ThreadUtil.getThreadInfo2(t1));\n        System.out.println("\u4e3b\u7ebf\u7ed3\u675f:"+ThreadUtil.getThreadInfo());\n    }\n}\n\n\n// Runnable\u7684\u65b9\u5f0f\npublic class Thread1 {\n\n    public static void main(String[] args) {\n        // \u901a\u8fc7Runnable\u7684\u65b9\u5f0f\u521b\u5efa\u7ebf\u7a0b\n        System.out.println("\u4e3b\u7ebf\u5f00\u59cb:"+ThreadUtil.getThreadInfo());\n        Thread t1 = new Thread(() -> {\n            try {\n                System.out.println("\u5185\u90e8\u7ebf\u7a0b\u5f00\u59cb==>"+ThreadUtil.getThreadInfo());\n                TimeUnit.SECONDS.sleep(3);\n                System.out.println("\u5185\u90e8\u7ebf\u7a0b\u7ed3\u675f==>"+ThreadUtil.getThreadInfo());\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, "ThreadA");\n        System.out.println(ThreadUtil.getThreadInfo2(t1));\n        System.out.println("\u542f\u52a8ThreadA\u7ebf\u7a0b");\n        t1.start();\n        System.out.println(ThreadUtil.getThreadInfo2(t1));\n        System.out.println("\u4e3b\u7ebf\u7ed3\u675f:"+ThreadUtil.getThreadInfo());\n    }\n}\n')))),(0,l.kt)("p",null,"  ",(0,l.kt)("strong",{parentName:"p"},"\u601d\u8003\uff1a\u5982\u679c\u65e2\u7ee7\u627fThread\uff0c\u53c8\u5b9e\u73b0Runnable\u7684run\u65b9\u6cd5\uff0c\u4f1a\u6267\u884c\u54ea\u4e2a\uff1f")),(0,l.kt)("p",null,"  \u53ef\u4ee5\u770b\u5230,\u6267\u884c\u4e86\u7ee7\u627fThread\u7684\u65b9\u5f0f\uff0c",(0,l.kt)("em",{parentName:"p"},"\u56e0\u4e3aThread \u7684\u5b50\u7c7b\u5c06\u7236\u7c7b\u8986\u5199\u4e86\uff0c\u6240\u4ee5Runnable\u4f20\u8fdb\u6765\u6ca1\u6709\u6548\u679c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Demo1 extends Thread {\n    @Override\n    public void run() {\n        //super.run();\n        System.out.println("\u7531\u7ee7\u627fThread\u65b9\u5f0f\u5b9e\u73b0");\n    }\n\n    public Demo1(Runnable target) {\n        super(target);\n    }\n\n    public static void main(String[] args) {\n        new Demo1(() -> {\n            System.out.println("runnable \u7684\u65b9\u5f0f");\n        }).start();\n    }\n}\n\n/*\n    \u7531\u7ee7\u627fThread\u65b9\u5f0f\u5b9e\u73b0\n*/\n')),(0,l.kt)("h3",{id:"\u7ebf\u7a0b\u7684\u72b6\u6001"},"\u7ebf\u7a0b\u7684\u72b6\u6001"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u7ebf\u7a0b\u7684\u72b6\u6001 -> \u901a\u8fc7 getState() \u83b7\u53d6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"Thread.State"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"NEW"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u65b0\u5efa\u72b6\u6001"),(0,l.kt)("li",{parentName:"ul"},"\u5f53new\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u8c61\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u8c03\u7528start\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u5c31\u5904\u4e8e\u65b0\u5efa\u72b6\u6001"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"RUNNABLE"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u53ef\u8fd0\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u4e00\u65e6\u8c03\u7528 Thread\u5bf9\u8c61\u7684start\u65b9\u6cd5\uff0c\u7ebf\u7a0b\u5c31\u5904\u4e8e runnable\u72b6\u6001"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5f53\u7136\uff0c\u53ef\u8fd0\u884c\u72b6\u6001\u7684\u7ebf\u7a0b\u53ef\u80fd\u6ca1\u6709\u6b63\u5728\u8fd0\u884c\uff0cjava\u6ca1\u6709\u4e3a\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u63d0\u4f9b\u5355\u72ec\u7684\u72b6\u6001,")," \u5373",(0,l.kt)("code",null,"\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u4e5f\u662f RUNNABLE \u72b6\u6001")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"BLOCKED"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u963b\u585e"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u5185\u90e8\u7684\u5bf9\u8c61\u9501(",(0,l.kt)("font",{color:"red"},"\u4e0d\u662fLOCK"),")\uff0c\u800c\u8fd9\u4e2a\u5bf9\u8c61\u7684\u9501\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u6709\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7ebf\u7a0b\u5c31\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u5176\u4ed6\u5bf9\u8c61\u91ca\u653e\u4e86\u9501\uff0c\u5e76\u4e14\u7ebf\u7a0b\u8c03\u5ea6\u5668\u5141\u8bb8\u8be5\u7ebf\u7a0b\u6301\u6709\u9501\u7684\u65f6\u5019\uff0c\u8be5\u7ebf\u7a0b\u624d\u4f1a\u53d8\u6210\u975e\u963b\u585e\u72b6\u6001\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"WAITING")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7b49\u5f85"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u7ebf\u7a0b\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b ",(0,l.kt)("inlineCode",{parentName:"li"},"\u901a\u77e5\u8c03\u5ea6\u5668")," \u51fa\u73b0\u4e00\u4e2a\u6761\u4ef6\u65f6\uff0c\u8fd9\u4e2a\u7ebf\u7a0b\u4f1a\u8fdb\u5165\u7b49\u5f85\u72b6\u6001"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"TIMED_WAITING")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8ba1\u65f6\u7b49\u5f85"),(0,l.kt)("li",{parentName:"ul"},"\u6709\u51e0\u4e2a\u65b9\u6cd5\u5e26\u6709\u8d85\u65f6\u53c2\u6570\uff0c\u8ba9\u7ebf\u7a0b\u8fdb\u5165\u8ba1\u65f6\u7b49\u5f85\u72b6\u6001"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"TERMINATED"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ec8\u6b62"),(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u4f1a\u56e0\u4e3a\u4ee5\u4e0b\u7684\u4e24\u4e2a\u539f\u56e0\u800c\u7ec8\u6b62",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"run\u65b9\u6cd5\u6b63\u5e38\u7ed3\u675f\u9000\u51fa"),(0,l.kt)("li",{parentName:"ul"},"\u56e0\u4e3a\u4e00\u4e2a\u6ca1\u6709\u6355\u83b7\u7684\u5f02\u5e38\u7ec8\u6b62\u4e86run\u65b9\u6cd5\uff0c\u4ece\u800c\u8ba9\u7ebf\u7a0b\u610f\u5916\u9000\u51fa"))))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e00\u822c\u5c06 ",(0,l.kt)("inlineCode",{parentName:"p"},"Blocked"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"Waiting"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"Timed_Waiting"),"\xa0\u7edf\u4e00\u79f0\u4e3a",(0,l.kt)("strong",{parentName:"p"},"\u963b\u585e\u72b6\u6001")))),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{alt:"alt",src:t(34117).Z,width:"774",height:"803"})))),(0,l.kt)("admonition",{title:"\u7ebf\u7a0b\u72b6\u6001\u7684\u53d8\u8fc1",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"  \u7ebf\u7a0b\u521b\u5efa\u4e4b\u540e\uff0c\u5904\u4e8e",(0,l.kt)("inlineCode",{parentName:"p"},"NEW")," \u7684\u72b6\u6001\uff0c\u7136\u540e\u8c03\u7528start()\u65b9\u6cd5\u5f00\u59cb\u8fd0\u884c\u3002\u5f53\u7ebf\u7a0b\u6267\u884cwait()\u65b9\u6cd5\u540e,\u7ebf\u7a0b\u4f1a\u8fdb\u5165",(0,l.kt)("inlineCode",{parentName:"p"},"WAITING"),"\u72b6\u6001\u3002\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\u7684\u7ebf\u7a0b\u9700\u8981\u901a\u8fc7\u5176\u4ed6\u7ebf\u7a0b\u7684\u901a\u77e5\u624d\u80fd\u591f\u8fd4\u56de\u5230\u8fd0\u884c\u72b6\u6001\uff0c\u800c",(0,l.kt)("inlineCode",{parentName:"p"},"TIME_WAITING")," \u72b6\u6001\u76f8\u5f53\u4e8e\u5728\u7b49\u5f85\u7684\u57fa\u7840\u4e0a\u52a0\u4e0a\u4e86\u8d85\u65f6\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8d85\u65f6\u65f6\u95f4\u5230\u8fbe\u540e\u5c31\u4f1a\u8fd4\u56de\u5230\u53ef\u8fd0\u884c\u72b6\u6001\u3002"),(0,l.kt)("p",{parentName:"admonition"},"  \u5728\u7ebf\u7a0b\u8c03\u7528Synchronized\u540c\u6b65\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u5982\u679c\u6ca1\u6709\u83b7\u53d6\u5230\u9501\uff0c\u5c31\u4f1a\u8fdb\u5165\u963b\u585e\u72b6\u6001",(0,l.kt)("inlineCode",{parentName:"p"},"BLOCKED")),"  ",(0,l.kt)("font",{color:"red"},"\u6ce8\u610f:\u963b\u585e\u72b6\u6001\u662f\u7ebf\u7a0b\u5728\u8fdb\u5165Synchronized \u4fee\u9970\u7684\u540c\u6b65\u65b9\u6cd5\u3001\u540c\u6b65\u4ee3\u7801\u5757\u7684\u65f6\u6ca1\u6709\u83b7\u53d6\u9501\u7684\u72b6\u6001\u3002\u800c\u8fdb\u5165lock\u6ca1\u6709\u83b7\u53d6\u9501\u7684\u662f\u7b49\u5f85\u72b6\u6001\u3002\u56e0\u4e3aLock\u7684\u9501\u662f\u4f9d\u8d56\u4e8eLockSupport\u7c7b")," "),(0,l.kt)("p",null,"  ",(0,l.kt)("strong",{parentName:"p"},"1.Synchronized\u540c\u6b65\u4ee3\u7801\u963b\u585e\uff0c\u9501\u72b6\u6001\u6f14\u793a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class Demo1 {\n    public synchronized void get() throws InterruptedException {\n        TimeUnit.SECONDS.sleep(100);\n    }\n\n    public static void main(String[] args) {\n        Demo1 demo1 = new Demo1();\n        new Thread(() -> {\n            try {\n                demo1.get();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }).start();\n\n        new Thread(() -> {\n            try {\n                demo1.get();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }).start();\n    }\n}\n")),(0,l.kt)("p",null,"  ",(0,l.kt)("img",{alt:"alt",src:t(44209).Z,width:"1430",height:"318"})),(0,l.kt)("p",null,"  ",(0,l.kt)("strong",{parentName:"p"},"2.Lock\u4ee3\u7801\u963b\u585e\uff0c\u9501\u72b6\u6001\u6f14\u793a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class Demo1 {\n    private static final ReentrantLock lock = new ReentrantLock();\n    public void get2() {\n        try {\n            lock.lock();\n            TimeUnit.SECONDS.sleep(100);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n    public static void main(String[] args) {\n        Demo1 demo1 = new Demo1();\n        new Thread(() -> {\n            try {\n                demo1.get2();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }).start();\n\n        new Thread(() -> {\n            try {\n                demo1.get2();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }).start();\n    }\n}\n\n")),(0,l.kt)("p",null,"  ",(0,l.kt)("img",{alt:"alt",src:t(5425).Z,width:"1976",height:"398"})),(0,l.kt)("h4",{id:"\u7ebf\u7a0b\u72b6\u6001\u53d8\u8fc1"},"\u7ebf\u7a0b\u72b6\u6001\u53d8\u8fc1"),(0,l.kt)("p",null,"  ",(0,l.kt)("img",{alt:"alt",src:t(52650).Z,width:"1252",height:"866"})),(0,l.kt)("p",null,"  ",(0,l.kt)("img",{alt:"alt",src:t(37207).Z,width:"789",height:"428"})),(0,l.kt)("h3",{id:"\u7ebf\u7a0b\u5c5e\u6027"},"\u7ebf\u7a0b\u5c5e\u6027"),(0,l.kt)("h4",{id:"\u7ebf\u7a0bid"},"\u7ebf\u7a0bID"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4ece ",(0,l.kt)("inlineCode",{parentName:"p"},"1")," \u5f00\u59cb\u8ba1\u6570\uff0c\u5e76\u4e14\u7531\u4e8e\u542f\u52a8java\u7a0b\u5e8f\u4f1a\u521b\u5efa\u591a\u4e2a\u7ebf\u7a0b\uff0c\u6240\u4ee5\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u7684\u7ebf\u7a0bID\u4e0d\u4e00\u5b9a\u662f2"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class ThreadIdDemo {\n    public static void main(String[] args) {\n        Thread thread = new Thread();\n        System.out.println(ThreadUtil.getThreadInfo());\n        System.out.println(ThreadUtil.getThreadInfo2(thread));\n    }\n}\n/*\n    {\u7ebf\u7a0b\u540d\u79f0: main,ID:1,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5}\n    {\u7ebf\u7a0b\u540d\u79f0: Thread-0,ID:11,\u72b6\u6001:NEW,\u4f18\u5148\u7ea7:5}\n*/\n")))),(0,l.kt)("h4",{id:"\u4e2d\u65ad\u7ebf\u7a0b"},"\u4e2d\u65ad\u7ebf\u7a0b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u4e2d\u65ad\u7ebf\u7a0b")," -> \u4e2d\u65ad\u72b6\u6001\u5c31\u662f\u7ebf\u7a0b\u7684\u4e00\u4e2a\u6807\u5fd7\u4f4d",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5f53run() \u65b9\u6cd5\u5904\u7406\u7ed3\u679c\u6216\u8005\u65b9\u6cd5\u4e2d\u6709\u6ca1\u6709\u5904\u7406\u7684\u5f02\u5e38\uff0c\u7ebf\u7a0b\u5c31\u4f1a\u7ec8\u6b62")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5f53\u5bf9\u67d0\u4e2a\u7ebf\u7a0b\u4f7f\u7528 interrupt() \u65b9\u6cd5\u65f6\uff0c\u4f1a\u5411\u7ebf\u7a0b",(0,l.kt)("strong",{parentName:"p"},"\u53d1\u9001\u4e2d\u65ad\u8bf7\u6c42"),"\uff0c\u6e05\u9664\u8fd9\u4e2a\u7ebf\u7a0b\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"\u4e2d\u65ad\u72b6\u6001"),", ",(0,l.kt)("strong",{parentName:"p"},"\u53ea\u662f\u53d1\u9001\u4e00\u4e2a\u901a\u77e5\u8bf7\u6c42\uff0c\u7ebf\u7a0b\u5e76\u4e0d\u4e00\u5b9a\u4f1a\u7acb\u5373\u54cd\u5e94")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u88ab\u4e2d\u65ad\u7684\u7ebf\u7a0b\u53ef\u4ee5\u51b3\u5b9a\u5982\u4f55\u54cd\u5e94\u4e2d\u65ad\uff0c\u6bd4\u5982\u4e0d\u7ec8\u6b62\u7a0b\u5e8f\uff0c\u7ee7\u7eed\u6267\u884c"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5e94\u8be5\u4e0d\u65f6\u7684\u68c0\u67e5\u8fd9\u4e2a\u6807\u5fd7\u6765\u5224\u65ad\u7ebf\u7a0b\u662f\u5426\u88ab\u4e2d\u65ad"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"while(!Thread.currentThread().isInterrupted()&& xxx) {\n  // do something \n}\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5bf9\u963b\u585e\u65b9\u6cd5(sleep\u3001await)\u8fdb\u884c\u4e2d\u65ad\u65f6\uff0c\u4f1a\u6e05\u9664\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001\uff0c\u5e76\u4e14\u629b\u51faInterruptedException\u5f02\u5e38\u5904\u7406\u4e2d\u65ad"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5982\u679c\u7ebf\u7a0b\u88ab\u963b\u585e\uff0c\u662f\u65e0\u6cd5\u68c0\u67e5\u4e2d\u65ad\u72b6\u6001 -> \u6240\u4ee5\u4e0d\u9700\u8981\u53bb\u68c0\u67e5\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f\uff1a\u5728\u4e2d\u65ad\u5f02\u5e38\u4e2d\uff0c\u4e0d\u8981\u4ec0\u4e48\u90fd\u4e0d\u505a"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u5728\u5f02\u5e38\u4e2d\u8f93\u51fa\u5f02\u5e38\u4fe1\u606f"),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u8bbe\u7f6e\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u652f\u6301\u54cd\u5e94\u4e2d\u65ad\u7684\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Object.wait()")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Thread.sleep()")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Thread.join()")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"BlockingQueue.take()")," \u3001",(0,l.kt)("inlineCode",{parentName:"li"},"BlockingQueue.put(E)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Lock.lockInterruptibly()"),"  -> \u83b7\u53d6\u4e00\u4e2a\u53ef\u4e2d\u65ad\u7684\u9501"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CountDownLatch.await()")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CyclicBarrier.await()")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Exchanger.exchange(V)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"nio.channels.InterruptibleChannel\u76f8\u5173\u65b9\u6cd5")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"nio.channels.Selectors\u76f8\u5173\u65b9\u6cd5"))))))),(0,l.kt)("h5",{id:"\u672a\u6355\u83b7\u5f02\u5e38\u5904\u7406\u5668"},"\u672a\u6355\u83b7\u5f02\u5e38\u5904\u7406\u5668"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u672a\u6355\u83b7\u5f02\u5e38\u7684\u5904\u7406\u5668"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u7531\u4e8erun\u65b9\u6cd5\u65e0\u6cd5\u629b\u51fa\u5f02\u5e38\uff0c\u4f46\u662f\u67d0\u4e9b\u65b9\u6cd5\u53ef\u80fd\u5bfc\u81f4\u7ebf\u7a0b\u7ec8\u6b62, \u5b9e\u9645\u4e0a\uff0c\u7ebf\u7a0b\u5728\u6b7b\u4ea1\u4e4b\u524d\uff0c\u4f1a\u5c06\u5f02\u5e38\u4f20\u9012\u7ed9 ",(0,l.kt)("strong",null,"\u5904\u7406\u672a\u6355\u83b7\u5f02\u5e38\u7684\u5904\u7406\u5668")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5904\u7406\u5668\u5fc5\u987b\u5b9e\u73b0 ",(0,l.kt)("inlineCode",{parentName:"li"},"Thread.UncaughtExceptionHandler"),"\u63a5\u53e3"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5982\u4f55\u4f7f\u7528\u5462\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Thread.setDefaultUncaughtExceptionHandler")," \u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u7684\u5904\u7406\u5668"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Thread.setUncaughtExceptionHandler")," \u4e3a\u67d0\u4e2a\u7ebf\u7a0b\u8bbe\u7f6e")))),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'class ExceptionHandler implements  Thread.UncaughtExceptionHandler {\n    @Override\n    public void uncaughtException(Thread t, Throwable e) {\n        System.out.println("\u7ebf\u7a0b\u53d1\u751f\u5f02\u5e38==>" + ThreadUtil.getThreadInfo2(t));\n        e.printStackTrace();\n    }\n}\npublic class exceptionThead {\n    public static void main(String[] args) {\n        System.out.println("\u4e3b\u7ebf\u5f00\u59cb:"+ThreadUtil.getThreadInfo());\n        Thread t1 = new Thread(() -> {\n            System.out.println("\u5185\u90e8\u7ebf\u7a0b\u5f00\u59cb==>"+ThreadUtil.getThreadInfo());\n            // \u8fd9\u4e2a\u5f02\u5e38\u662f\u975e\u68c0\u67e5\u5f02\u5e38\n            int a = 10/0;\n            System.out.println("\u5185\u90e8\u7ebf\u7a0b\u7ed3\u675f==>"+ThreadUtil.getThreadInfo());\n        }, "ThreadA");\n        System.out.println(ThreadUtil.getThreadInfo2(t1));\n        System.out.println("\u542f\u52a8ThreadA\u7ebf\u7a0b");\n        t1.setUncaughtExceptionHandler(new  ExceptionHandler());\n        t1.start();\n        System.out.println(ThreadUtil.getThreadInfo2(t1));\n        System.out.println("\u4e3b\u7ebf\u7ed3\u675f:"+ThreadUtil.getThreadInfo());\n    }\n}\n')))),(0,l.kt)("p",null,"  ",(0,l.kt)("img",{alt:"alt",src:t(54793).Z,width:"1642",height:"462"})),(0,l.kt)("h3",{id:"\u5173\u95ed\u505c\u6b62\u7ebf\u7a0b"},"\u5173\u95ed\u505c\u6b62\u7ebf\u7a0b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u9519\u8bef\u7684\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"stop\u3001suspend\u3001resume"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"stop \u5728\u4e2d\u65ad\u7ebf\u7a0b\u65f6\u4e0d\u80fd\u4fdd\u8bc1\u7ebf\u7a0b\u7684\u8d44\u6e90\u88ab\u6b63\u5e38\u7684\u91ca\u653e\uff0c\u6bd4\u5982\u8bf4\u5bfc\u81f4\u7ebf\u7a0b\u8fd0\u884c\u4e00\u822c\u7a81\u7136\u505c\u6b62"),(0,l.kt)("li",{parentName:"ul"},"suppend \u5728\u8c03\u7528\u540e\uff0c\u7ebf\u7a0b\u5e76\u4e0d\u4f1a\u91ca\u653e\u5360\u6709\u7684\u8d44\u6e90\uff08\u6bd4\u5982\u9501\uff09\uff0c\u800c\u662f\u5360\u6709\u7740\u8d44\u6e90\u8fdb\u5165\u7761\u7720\u72b6\u6001\uff0c\u8fd9\u6837\u5bb9\u6613\u5bfc\u81f4\u6b7b\u9501\u95ee\u9898"))),(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528volatile \u8bbe\u7f6eboolean\u6807\u8bb0\u4f4d",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u65e0\u6cd5\u5904\u7406\u963b\u585e\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u963b\u585e\u7684\u65f6\u5019\u65e0\u6cd5\u91cd\u65b0\u83b7\u53d6boolean\u6807\u8bb0\u4f4d\u7684\u503c\uff0c\u6240\u4ee5\u4e5f\u65e0\u6cd5\u4e2d\u65ad\u7ebf\u7a0b"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u6b63\u786e\u7684\u65b9\u5f0f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"interrupt")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u4e2d\u65ad\u7684\u6700\u4f73\u5b9e\u73b0\u65b9\u5f0f"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u4f18\u5148\u9009\u62e9: ",(0,l.kt)("inlineCode",{parentName:"li"},"\u4f20\u9012\u4e2d\u65ad"),", \u5373\u629b\u51fa\u4e2d\u65ad\u5f02\u5e38"),(0,l.kt)("li",{parentName:"ol"},"\u4e0d\u60f3\u6216\u8005\u65e0\u6cd5\u4f20\u9012: ",(0,l.kt)("inlineCode",{parentName:"li"},"\u6062\u590d\u4e2d\u65ad"),", \u5373",(0,l.kt)("font",{color:"red"},"\u5728\u5f02\u5e38\u5904\u7406\u4e2d\uff0c\u518d\u6b21\u8c03\u7528\u5f53\u524d\u7ebf\u7a0b\u7684interrupt\u65b9\u6cd5\uff0c\u91cd\u65b0\u8bbe\u7f6e\u4e2d\u65ad\u72b6\u6001")," "),(0,l.kt)("li",{parentName:"ol"},"\u4e0d\u5e94\u8be5",(0,l.kt)("inlineCode",{parentName:"li"},"\u5c4f\u853d\u4e2d\u65ad"))),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'Thread t1 = new Thread(() -> {\n  try {\n    bussinessMethod();\n  } catch (InterruptedException e) {\n    e.printStackTrace();\n  }\n  System.out.println("\u5904\u7406\u7ed3\u675f");\n});\nt1.start();\nTimeUnit.SECONDS.sleep(1);\nt1.interrupt();\n\n// \u65b9\u5f0f1:  \u4e1a\u52a1\u5904\u7406\u7684\u5f02\u5e38\u4e0d\u7528try-catch\uff0c\u800c\u662f\u4f20\u9012\u5f02\u5e38\u7ed9\u8c03\u7528\u65b9\npublic void bussinessMethod() throws InterruptedException{\n    Thread.sleep(3000);\n}\n\n// \u65b9\u5f0f2: \u65b9\u6cd5\u5185\u90e8\u6062\u590d\u4e2d\u65ad\u72b6\u6001\npublic void bussinessMethod2() {\n    try {\n      Thread.sleep(3000);\n    } catch(InterruptedException ex) {\n        Thread.currentThread.interrupt();\n        ex.printStackTrace();\n    }\n}\n')))),(0,l.kt)("h4",{id:"-\u6ca1\u6709sleepwait\u65b9\u6cd5"},"\u2460. \u6ca1\u6709sleep\u3001wait\u65b9\u6cd5"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"run\u65b9\u6cd5\u4e2d\u6ca1\u6709sleep\u3001wait\u7b49\u65b9\u6cd5\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 interrupt\u65b9\u6cd5\u8ba9\u901a\u77e5\u7ebf\u7a0b\u4e2d\u65ad\u505c\u6b62,",(0,l.kt)("inlineCode",{parentName:"p"},"\u4f46\u662f\u4ec5\u4ec5\u662f\u901a\u77e5"),"\uff0c\u5982\u679c\u9700\u8981\u505c\u6b62\uff0c\u8fd8\u5e94\u8be5\u4e0d\u65ad\u7684\u5224\u65ad\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class StopWithoutSleep {\n    public static void main(String[] args) throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            int num = 0;\n          long start = System.currentTimeMillis();\n            // \u6bcf\u6b21\u5faa\u73af\u7684\u65f6\u5019,\u90fd\u53bb\u5224\u65ad\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001\n            while(!Thread.currentThread().isInterrupted() && num <= Integer.MAX_VALUE / 2) {\n                if (num % 10000 == 0) {\n                    System.out.println(num+"\u662f10000\u7684\u500d\u6570");\n                }\n                num++;\n            }\n              long end = System.currentTimeMillis();\n              System.out.println("\u5904\u7406\u7ed3\u675f,\u8017\u65f6:"+(end - start) / 1000);\n        });\n        t1.start();\n        // \u4e3b\u7ebf\u7a0b\u7b49\u5f851s\n        TimeUnit.SECONDS.sleep(1);\n        // \u505c\u6b62t1\u7ebf\u7a0b\n        /**\n         * \u5982\u679c\u4e0d\u4f7f\u7528 interrupt,\u8f93\u51fa\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u662f: 1073740000\u662f10000\u7684\u500d\u6570\n         * \u4f7f\u7528 interrupt \u65b9\u6cd5\u7684\u8bdd,\u8f93\u51fa\u7684\u6700\u540e\u4e00\u4e2a\u6570\u636e\u662f: 445550000 \u662f10000\u7684\u500d\u6570\n         */\n        t1.interrupt();\n    }\n}\n')),(0,l.kt)("h4",{id:"-\u5bf9\u8c03\u7528sleep\u65b9\u6cd5\u7684\u7ebf\u7a0b\u8fdb\u884c\u4e2d\u65ad"},"\u2461. \u5bf9\u8c03\u7528sleep\u65b9\u6cd5\u7684\u7ebf\u7a0b\u8fdb\u884c\u4e2d\u65ad"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"run\u65b9\u6cd5\u4e2d\u5e26\u6709sleep\u3001wait\u7b49\u65b9\u6cd5\u65f6\uff0c\u4f7f\u7528interrupt\u65b9\u6cd5\u4e2d\u65ad\u65f6\u4f1a\u629b\u51fa\u5f02\u5e38\u5e76\u6e05\u9664\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001,\u6240\u4ee5\u4e0d\u9700\u8981\u4e5f\u65e0\u6cd5\u4e2d\u65ad\u72b6\u6001\uff08\u9664\u975e\u518d\u624b\u52a8\u7684\u8bbe\u7f6e\u4e2d\u65ad\u72b6\u6001\uff09")),(0,l.kt)("admonition",{title:"\u6ce8\u610f",type:"danger"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},"\u5bf9sleep()\u65b9\u6cd5\u8fdb\u884c\u4e2d\u65ad\uff0c\u9664\u4e86\u4f1a\u6e05\u9664\u4e2d\u65ad\u72b6\u6001,\u8fd8\u4f1a\u629b\u51fa\u4e00\u4e2a\u4e2d\u65ad\u5f02\u5e38, \u6240\u4ee5\u901a\u8fc7\u5728try-catch\u4e2d\u518d\u6b21\u8c03\u7528interrupt\u65b9\u6cd5\u91cd\u65b0\u8bbe\u7f6e\u4e2d\u65ad\u72b6\u6001"),(0,l.kt)("li",{parentName:"ol"},"\u4f46\u662f\u5982\u679c\u5c06sleep\u7684\u5f02\u5e38\u5904\u7406\u653e\u5728\u662f\u901a\u8fc7try-catch\uff0c\u7531\u4e8esleep\u65b9\u6cd5\u4f1a\u6e05\u9664\u4e2d\u65ad\u72b6\u6001\uff0c\u6240\u4ee5\u7ebf\u7a0b\u7684run\u65b9\u6cd5\u5e76\u4e0d\u77e5\u9053\u5185\u90e8\u5f02\u5e38\u4e86, \u5373 ",(0,l.kt)("strong",{parentName:"li"},"try-catch\u4e0d\u5e94\u8be5\u653e\u5728while \u5185\u90e8")))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class StopThreadWithSleep {\n    public static void main(String[] args) throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            try {\n                int num = 0;\n                while(num <= 300) {\n                    if (num % 100 == 0) {\n                        System.out.println(num+"\u662f100\u7684\u500d\u6570");\n                    }\n                    num++;\n                }\n                Thread.sleep(3000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println("\u5904\u7406\u7ed3\u675f");\n        });\n        t1.start();\n        // \u4e3b\u7ebf\u7a0b\u7b49\u5f851s\n        TimeUnit.SECONDS.sleep(1);\n        // t1\u7ebf\u7a0b\u5904\u4e8e\u4e2d\u65ad\u72b6\u6001\u65f6\u5bf9\u5b83\u8fdb\u884c\u4e2d\u65ad,\u4f1a\u629b\u51fa\u5f02\u5e38\n        t1.interrupt();\n    }\n}\n/*\n    0\u662f100\u7684\u500d\u6570\n  100\u662f100\u7684\u500d\u6570\n  200\u662f100\u7684\u500d\u6570\n  300\u662f100\u7684\u500d\u6570\n  java.lang.InterruptedException: sleep interrupted\n    at java.lang.Thread.sleep(Native Method)\n    at com.threadCode.StopThread.StopThreadWithSleep.lambda$main$0(StopThreadWithSleep.java:22)\n    at java.lang.Thread.run(Thread.java:748)\n  \u5904\u7406\u7ed3\u675f\n*/\n')),(0,l.kt)("h3",{id:"\u505c\u6b62\u7ebf\u7a0b\u76f8\u5173\u51fd\u6570\u89e3\u6790"},"\u505c\u6b62\u7ebf\u7a0b\u76f8\u5173\u51fd\u6570\u89e3\u6790"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"interrupt\u65b9\u6cd5")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5411\u7ebf\u7a0b\u53d1\u9001\u4e2d\u65ad\u8bf7\u6c42\uff0c\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001\u88ab\u8bbe\u7f6e\u4e3atrue"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u7ebf\u7a0b\u5904\u4e8e\u963b\u585e\u7684\u72b6\u6001\uff0c\u4e14\u963b\u585e\u65b9\u6cd5\u53ef\u4ee5\u88ab\u4e2d\u65ad\uff0c\u90a3\u4e48\u4f1a\u629b\u51fa\u4e2d\u65ad\u5f02\u5e38"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5224\u65ad\u7ebf\u7a0b\u662f\u5426\u88ab\u4e2d\u65ad\u7684\u76f8\u5173\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"static boolean interrupted()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6d4b\u8bd5\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u7ebf\u7a0b\u662f\u5426\u88ab\u4e2d\u65ad"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f\uff1a\u8be5\u65b9\u6cd5\u4f1a\u5c06\u5f53\u524d\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001\u8bbe\u7f6e\u4e3afalse")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"boolean isInterrupted()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6d4b\u8bd5\u6307\u5b9a\u7684\u7ebf\u7a0b\u662f\u5426\u88ab\u4e2d\u65ad\uff0c\u4f46\u662f\u4e0d\u4f1a\u8bbe\u7f6e\u7ebf\u7a0b\u7684\u4e2d\u65ad\u72b6\u6001"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"Thread.Interrupted()")," \u7684\u76ee\u7684\u5bf9\u8c61"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u76ee\u6807\u5bf9\u8c61\u662f\u5f53\u524d\u8fd0\u884c\u7684\u7ebf\u7a0b\uff0c\u4e0e\u8c03\u7528\u8be5\u65b9\u6cd5\u7684\u5b9e\u4f8b\u5bf9\u8c61\u65e0\u5173"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public static boolean interrupted() {\n  return currentThread().isInterrupted(true);\n}\n")))))),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class InterruptDemo {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            for( ; ; ) {\n\n            }\n        });\n        t1.start();\n        t1.interrupt();\n\n        // \u83b7\u53d6\u4e2d\u65ad\u6807\u5fd7\n        System.out.println("isInterrupt:" + t1.isInterrupted());\n\n        // \u83b7\u53d6\u4e2d\u65ad\u6807\u5fd7,\u5e76\u4e14\u91cd\u7f6e\u4e2d\u65ad\u72b6\u6001 -> \u4e0e\u8c03\u7528\u8be5\u65b9\u6cd5\u7684\u5b9e\u4f8b\u5bf9\u8c61\u65e0\u5173(\u5373\u8fd9\u91cc\u662f\u67e5\u770b\u4e3b\u7ebf\u7a0b\u662f\u5426\u88ab\u4e2d\u65ad)\n        System.out.println("isInterrupt:" + t1.interrupted());\n\n        // \u83b7\u53d6\u4e2d\u65ad\u6807\u5fd7,\u5e76\u4e14\u91cd\u7f6e\u4e2d\u65ad\u72b6\u6001 -> \u4e0e\u8c03\u7528\u8be5\u65b9\u6cd5\u7684\u5b9e\u4f8b\u5bf9\u8c61\u65e0\u5173(\u5373\u8fd9\u91cc\u662f\u67e5\u770b\u4e3b\u7ebf\u7a0b\u662f\u5426\u88ab\u4e2d\u65ad)\n        System.out.println("isInterrupt:" + Thread.interrupted());\n\n        // \u83b7\u53d6\u4e2d\u65ad\u6807\u5fd7\n        System.out.println("isInterrupt:" + t1.isInterrupted());\n    }\n}\n\n/*\n    isInterrupt:true\n  isInterrupt:false\n  isInterrupt:false\n  isInterrupt:true\n*/\n')))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5982\u4f55\u6df1\u5165\u63a2\u7a76jvm\u6e90\u7801\uff1f",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/openjdk-mirror/jdk7u-jdk"},"https://github.com/openjdk-mirror/jdk7u-jdk")," \u4e2d\u67e5\u8be2\u7c7b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/openjdk-mirror/jdk7u-hotspot/%E4%B8%AD%E5%AF%B9%E5%BA%94%E9%9C%80%E8%A6%81%E6%9F%A5%E7%9C%8B%E7%9A%84c++%E6%BA%90%E7%A0%81"},"https://github.com/openjdk-mirror/jdk7u-hotspot/\u4e2d\u5bf9\u5e94\u9700\u8981\u67e5\u770b\u7684c++\u6e90\u7801"))))),(0,l.kt)("h3",{id:"\u76d1\u89c6\u5668\u9501\u7ba1\u7a0bmonitor"},"\u76d1\u89c6\u5668/\u9501/\u7ba1\u7a0b(monitor)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u662f\u4e00\u79cd\u540c\u6b65\u7684\u673a\u5236\uff0c\u4fdd\u8bc1\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u88ab\u4fdd\u62a4\u7684\u6570\u636e\u6216\u8005\u4ee3\u7801(\u4e34\u754c\u533a)")," ,\u5373\u9501\u5185\u5b9a\u4e49\u7684\u64cd\u4f5c\u5728\u540c\u4e00\u65f6\u523b\u53ea\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528(\u7531\u7f16\u8bd1\u5668\u5b9e\u73b0)",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f46\u662f\u8fd9\u6837\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u8fdb\u7a0b\u4ee5\u8bbe\u8ba1\u7684\u987a\u5e8f\u6267\u884c"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"jvm\u4e2d\u7684\u540c\u6b65\u662f\u57fa\u4e8e\u8fdb\u5165\u548c\u9000\u51fa\u7ba1\u7a0b(monitor)\u5bf9\u8c61\u5b9e\u73b0\u7684")," ,\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u4f1a\u6709\u4e00\u4e2a\u7ba1\u7a0b (monitor)\u5bf9\u8c61\uff0c\u7ba1\u7a0b(monitor)\u4f1a\u968f\u7740 java \u5bf9\u8c61\u4e00\u540c\u521b\u5efa\u548c\u9500\u6bc1"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6267\u884c\u7ebf\u7a0b\u9996\u5148\u8981\u6301\u6709\u9501\u5bf9\u8c61\uff0c\u7136\u540e\u624d\u80fd\u6267\u884c\u65b9\u6cd5\uff0c\u5f53\u65b9\u6cd5\u5b8c\u6210\u4e4b\u540e\u4f1a\u91ca\u653e\u9501\uff0c\u65b9\u6cd5\u5728\u6267\u884c\u65f6\u5019\u4f1a\u6301\u6709\u9501\uff0c\u5176\u4ed6\u7ebf\u7a0b\u65e0\u6cd5\u518d\u83b7\u53d6\u540c\u4e00\u4e2a\u9501"))),(0,l.kt)("h3",{id:"\u6761\u4ef6\u5bf9\u8c61"},"\u6761\u4ef6\u5bf9\u8c61"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u8fdb\u5165\u4e34\u754c\u533a\u540e\u53d1\u73b0\u53ea\u6709\u6ee1\u8db3\u6761\u4ef6\u540e\u624d\u80fd\u6267\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528\u6761\u4ef6\u5bf9\u8c61",(0,l.kt)("font",{color:"red"},"\u7ba1\u7406\u5df2\u7ecf\u83b7\u5f97\u4e00\u4e2a\u9501\u4f46\u662f\u4e0d\u80fd\u5de5\u4f5c\u7684\u7ebf\u7a0b"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Lock.newCondition().await()"),(0,l.kt)("li",{parentName:"ul"},"Lock.newCondition().signal()"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"lock.getWaitQueueLength(Condition con)")," \u53ef\u4ee5\u83b7\u67d0\u4e2a\u6761\u4ef6\u5bf9\u8c61\u4e2d\u7684\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u6570\u91cf")))),(0,l.kt)("h3",{id:"\u7528\u6237\u7ebf\u7a0b\u5b88\u62a4\u7ebf\u7a0b"},"\u7528\u6237\u7ebf\u7a0b\u3001\u5b88\u62a4\u7ebf\u7a0b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7528\u6237\u7ebf\u7a0b:\u5e73\u65f6\u7528\u5230\u7684\u666e\u901a\u7ebf\u7a0b,\u662f\u81ea\u5b9a\u4e49\u7ebf\u7a0b"),(0,l.kt)("li",{parentName:"ul"},"\u5b88\u62a4\u7ebf\u7a0b:\u8fd0\u884c\u5728\u540e\u53f0,\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7ebf\u7a0b,\u6bd4\u5982\u5783\u573e\u56de\u6536",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5f53\u4e3b\u7ebf\u7a0b\u7ed3\u675f\u540e,\u7528\u6237\u7ebf\u7a0b\u8fd8\u5728\u8fd0\u884c,JVM \u5b58\u6d3b "),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u6ca1\u6709\u7528\u6237\u7ebf\u7a0b,\u90fd\u662f\u5b88\u62a4\u7ebf\u7a0b,JVM \u7ed3\u675f (\u4e0d\u4f1a\u7acb\u5373\u7ed3\u675f)")))),(0,l.kt)("h3",{id:"\u7ade\u6001\u6761\u4ef6"},"\u7ade\u6001\u6761\u4ef6"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5982\u679c\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684\u7ebf\u7a0b\u9700\u8981\u5171\u4eab\u7684\u5bf9\u540c\u4e00\u4e2a\u6570\u636e\u8fdb\u884c\u5b58\u53d6\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u4e4b\u95f4\u76f8\u4e92\u8986\u76d6 -> \u8fd9\u79cd\u6570\u636e\u662f\u5426\u6b63\u786e\u53d6\u51b3\u4e8e\u7ebf\u7a0b\u64cd\u4f5c\u6570\u636e\u7684\u987a\u5e8f\u5c31\u662f \u201c\u7ade\u6001\u6761\u4ef6\u201d")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"// \u4f2a\u4ee3\u7801 \u591a\u7ebf\u7a0b\u5411\u8d26\u6237\u5b58\u6b3e\n\naccount +=amount\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u591a\u7ebf\u7a0b\u64cd\u4f5c\u6570\u636e\uff0c\u7ebf\u7a0bA\u5c06\u8d26\u6237\u4f59\u989d\u8bbe\u7f6e\u4e3a5500\uff0cB\u5c06\u8d26\u6237\u4f59\u989d\u8bbe\u7f6e\u4e3a5900\uff0cB\u5148\u5c06\u6570\u636e\u63d0\u4ea4\uff0cA\u540e\u63d0\u4ea4\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7531\u4e8e account +=amout\u4e0d\u662f\u539f\u5b50\u64cd\u4f5c\uff0c\u5177\u4f53\u64cd\u4f5c\u6709\u4e09\u6b65",(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u5c06account\u52a0\u8f7d\u5230\u7ebf\u7a0b\u7684\u5bc4\u5b58\u5668\u4e2d"),(0,l.kt)("li",{parentName:"ol"},"\u589e\u52a0 amout"),(0,l.kt)("li",{parentName:"ol"},"\u5c06\u7ed3\u679c\u66f4\u65b0\u5230account"))),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u7ebf\u7a0b\u6267\u884c\u5230\u67d0\u4e00\u6b65\u540e\uff0c\u5b83\u7684\u8fd0\u884c\u6743\u88ab\u62a2\u5360\uff0c\u7136\u540e\u5176\u4ed6\u7ebf\u7a0b\u64cd\u4f5c\u65f6\uff0c\u6570\u636e\u8fd8\u662f\u65e7\u7684\uff0c\u6700\u540e\u63d0\u4ea4\u65f6\u5c31\u4f1a\u5c06\u539f\u6570\u636e\u8986\u76d6")))),(0,l.kt)("h2",{id:"lock\u63a5\u53e3"},"Lock\u63a5\u53e3"),(0,l.kt)("h3",{id:"synchronized-\u5173\u952e\u5b57"},"synchronized \u5173\u952e\u5b57"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u540c\u6b65\u9501\u3001\u5185\u7f6e\u9501\u3001\u76d1\u89c6\u5668\u9501"),"\uff0c\u7ebf\u7a0b\u5728\u8fdb\u5165\u540c\u6b65\u65b9\u6cd5\u65f6\u81ea\u52a8\u83b7\u5f97\u9501\uff0c\u5e76\u4e14\u5728\u9000\u51fa\u540c\u6b65\u65b9\u6cd5\u65f6\u81ea\u52a8\u91ca\u653e\u9501"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5185\u7f6e\u9501\u662f\u4e00\u79cd\u4e92\u65a5\u9501\uff0c\u5373\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u6301\u6709\u8be5\u9501\u3002"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u539f\u5b50\u6027: \u7531\u4e8e\u6bcf\u6b21\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u6267\u884c\u5185\u7f6e\u9501\u4fdd\u62a4\u7684\u4ee3\u7801\uff0c\u6240\u4ee5\u5185\u7f6e\u9501\u4fdd\u62a4\u7684\u4ee3\u7801\u4f1a\u4ee5\u539f\u5b50\u7684\u65b9\u5f0f\u6267\u884c\uff0c\u591a\u7ebf\u7a0b\u6267\u884c\u4ee3\u7801\u4e92\u76f8\u4e0d\u5e72\u6270")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5185\u5b58\u53ef\u89c1\u6027: \u591a\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\uff0c\u5e76\u4e14\u8fd9\u4e9b\u8bfb\u5199\u64cd\u4f5c\u4f7f\u7528\u7684\u662f\u540c\u4e00\u628a\u9501(\u4fdd\u8bc1\u4e92\u65a5)\uff0c\u90a3\u4e48\u7ebf\u7a0b\u4e4b\u95f4\u7684\u64cd\u4f5c\u662f\u53ef\u89c1\u7684"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0bB\u6267\u884c\u9501\u4fdd\u62a4\u7684\u540c\u6b65\u4ee3\u7801\u65f6\uff0c\u53ef\u4ee5\u770b\u5230\u7ebf\u7a0bA\u4e4b\u524d\u5728\u540c\u4e00\u4e2a\u540c\u6b65\u65b9\u6cd5\u4e2d\u7684\u64cd\u4f5c\u7ed3\u679c"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f: synchronized \u4e2d\u7684\u4ee3\u7801\u4e0d\u4f1a\u56e0\u4e3aCPU\u65f6\u95f4\u5230\u4e86\u5c31\u91ca\u653e\u9501\uff0c\u800c\u662f\u7ee7\u7eed\u6267\u884c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"synchronized\u4fee\u9970\u7684\u5bf9\u8c61\u6709\u4ee5\u4e0b\u51e0\u79cd"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("mark",null,"\u4ee3\u7801\u5757 [\u540c\u6b65\u65b9\u6cd5\u5757]"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5176\u4f5c\u7528\u7684\u8303\u56f4\u662f\u5927\u62ec\u53f7{} \u62ec\u8d77\u6765\u7684\u4ee3\u7801, ",(0,l.kt)("strong",{parentName:"li"},"\u4f5c\u7528\u7684\u5bf9\u8c61\u662f\u8c03\u7528\u8fd9\u4e2a\u4ee3\u7801\u5757\u7684\u5bf9\u8c61")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u9501\u662f Synchronized \u62ec\u53f7\u4e2d\u914d\u7f6e\u7684\u5bf9\u8c61"))),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"// \u5f53\u5728\u67d0\u4e2a\u7ebf\u7a0b\u4e2d\u6267\u884c\u8fd9\u6bb5\u4ee3\u7801\u5757\uff0c\u8be5\u7ebf\u7a0b\u4f1a\u83b7\u53d6\u5bf9\u8c61synObject\u7684\u9501\uff0c\u4ece\u800c\u4f7f\u5f97\u5176\u4ed6\u7ebf\u7a0b\u65e0\u6cd5\u540c\u65f6\u8bbf\u95ee\u8be5\u4ee3\u7801\u5757\n// synObject\u53ef\u4ee5\u662fthis\uff0c\u4ee3\u8868\u83b7\u53d6\u5f53\u524d\u5bf9\u8c61\u7684\u9501\uff0c\u4e5f\u53ef\u4ee5\u662f\u7c7b\u4e2d\u7684\u4e00\u4e2a\u5c5e\u6027\uff0c\u4ee3\u8868\u83b7\u53d6\u8be5\u5c5e\u6027\u7684\u9501\nsynchronized(synObject) {\n         \n}\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("mark",null,"\u666e\u901a\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u88ab\u4fee\u9970\u7684\u65b9\u6cd5\u79f0\u4e3a\u540c\u6b65\u65b9\u6cd5\uff0c\u5176\u4f5c\u7528\u7684\u8303\u56f4\u662f\u6574\u4e2a\u65b9\u6cd5, ",(0,l.kt)("em",{parentName:"p"},"\u4f5c\u7528\u7684\u5bf9\u8c61\u662f\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u7684\u5bf9\u8c61"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u9501\u662f\u5f53\u524d\u8c03\u7528\u8be5\u65b9\u6cd5\u7684\u5b9e\u4f8b\u5bf9\u8c61"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public synchronized void method() {\n  // .... \n}\n"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("mark",null,"\u9759\u6001\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f5c\u7528\u7684\u8303\u56f4\u662f\u6574\u4e2a\u9759\u6001\u65b9\u6cd5,",(0,l.kt)("font",{color:"red"},"\u4f5c\u7528\u7684\u5bf9\u8c61\u662f ",(0,l.kt)("inlineCode",{parentName:"li"},"\u8fd9\u4e2a\u7c7b\u7684\u6240\u6709\u5bf9\u8c61"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u9501\u662f\u5f53\u7c7b\u7684Class\u5bf9\u8c61")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u591a\u7ebf\u7a0b\u7f16\u5199\u4e00\u822c\u6b65\u9aa4"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u521b\u5efa\u8d44\u6e90\u7c7b\u6ca1\u5728\u8d44\u6e90\u7c7b\u4e2d\u521b\u5efa\u5c5e\u6027\u548c\u64cd\u4f5c\u65b9\u6cd5"),(0,l.kt)("li",{parentName:"ol"},"\u5728\u8d44\u6e90\u7c7b\u7684\u64cd\u4f5c\u65b9\u6cd5\u4e2d\u8fdb\u884c\u4ee5\u4e0b\u6b65\u9aa4",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5224\u65ad"),(0,l.kt)("li",{parentName:"ul"},"\u6267\u884c\u4efb\u52a1"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u77e5"))),(0,l.kt)("li",{parentName:"ol"},"\u521b\u5efa\u591a\u4e2a\u7ebf\u7a0b\uff0c\u8c03\u7528\u8d44\u6e90\u7c7b\u7684\u64cd\u4f5c\u65b9\u6cd5"),(0,l.kt)("li",{parentName:"ol"},"\u9632\u6b62\u865a\u5047\u5524\u9192\u7684\u95ee\u9898, \u6bd4\u5982\u5c06\u6761\u4ef6\u653e\u5728while \u5faa\u73af\u4e2d,\u5373wait\u65b9\u6cd5\u8fd4\u56de\u540e,\u8fd8\u4f1a\u518d\u6b21\u8fdb\u884c\u6761\u4ef6\u5224\u65ad")))),(0,l.kt)("h4",{id:"synchronized-\u552e\u7968\u6848\u4f8b"},"synchronized \u552e\u7968\u6848\u4f8b"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"3\u4e2a\u552e\u7968\u5458\uff0c\u4e00\u5171\u5356\u51fa30\u5f20\u7968 -> 3\u4e2a\u7ebf\u7a0b\u5904\u740630\u4e2a\u6570\u636e")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'class Ticket {\n    private int ticketNum = 10;\n        // synchronized \u4fee\u9970\u7684\u540c\u6b65\u65b9\u6cd5\uff0c\u9501\u662f\u8c03\u7528\u7684\u5bf9\u8c61\n    public synchronized void sell() {\n        if (this.ticketNum > 0) {\n            System.out.println(Thread.currentThread().getName()+"\u5356\u51fa:"+ (this.ticketNum--)+"\u5269\u4f59:"+this.ticketNum);\n        }\n    }\n}\n\npublic class TicketSell {\n    public static void main(String[] args) {\n        Ticket ticket = new Ticket();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                ticket.sell();\n            }\n        },"\u552e\u7968\u54581").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                ticket.sell();\n            }\n        },"\u552e\u7968\u54582").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                ticket.sell();\n            }\n        },"\u552e\u7968\u54583").start();\n    }\n}\n')),(0,l.kt)("h3",{id:"lock\u63a5\u53e3\u6982\u8ff0"},"Lock\u63a5\u53e3\u6982\u8ff0"),(0,l.kt)("admonition",{title:"\u4e3a\u4ec0\u4e48\u8981\u6709Lock?",type:"danger"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e00\u4e2a\u4ee3\u7801\u5757\u88ab ",(0,l.kt)("inlineCode",{parentName:"li"},"synchronized")," \u4fee\u9970\u4e86\uff0c\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u4e86\u5bf9\u5e94\u7684\u9501\uff0c\u5e76\u6267\u884c\u8be5\u4ee3\u7801\u5757\u65f6\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4fbf\u53ea\u80fd\u4e00\u76f4\u7b49\u5f85\uff0c\u7b49\u5f85\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u91ca\u653e\u9501\uff0c\u800c\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u91ca\u653e\u9501\u53ea\u4f1a\u6709\u4e24\u79cd\u60c5\u51b5",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u6267\u884c\u5b8c\u4e86\u8be5\u4ee3\u7801\u5757\uff0c\u7136\u540e\u7ebf\u7a0b\u91ca\u653e\u9501"),(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6267\u884c\u53d1\u751f\u5f02\u5e38\uff0c\u6b64\u65f6 JVM \u4f1a\u8ba9\u7ebf\u7a0b\u81ea\u52a8\u91ca\u653e\u9501"))),(0,l.kt)("li",{parentName:"ul"},"\u90a3\u4e48\u5982\u679c\u8fd9\u4e2a\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u7531\u4e8e\u8981\u7b49\u5f85 IO \u6216\u8005\u5176\u4ed6\u539f\u56e0(\u6bd4\u5982\u8c03\u7528 sleep \u65b9\u6cd5)\u88ab\u963b\u585e\u4e86\uff0c\u4f46\u662f\u53c8\u6ca1\u6709\u91ca\u653e\u9501\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4fbf\u53ea\u80fd\u7b49\u5f85",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u56e0\u6b64\u5c31\u9700\u8981\u6709\u4e00\u79cd\u673a\u5236\u53ef\u4ee5\u4e0d\u8ba9\u7b49\u5f85\u7684\u7ebf\u7a0b\u4e00\u76f4\u65e0\u671f\u9650\u5730\u7b49\u5f85\u4e0b\u53bb(\u6bd4\u5982\u53ea\u7b49\u5f85\u4e00\u5b9a\u7684\u65f6\u95f4\u6216\u8005\u80fd\u591f\u54cd\u5e94\u4e2d\u65ad)\uff0c\u901a\u8fc7 Lock \u5c31\u53ef\u4ee5\u529e\u5230"))))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u4ec0\u4e48\u662fLock\uff1f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Lock \u9501\u5b9e\u73b0\u63d0\u4f9b\u4e86\u6bd4\u4f7f\u7528\u540c\u6b65\u65b9\u6cd5\u548c\u8bed\u53e5\u53ef\u4ee5\u83b7\u5f97\u7684\u66f4\u5e7f\u6cdb\u7684\u9501\u64cd\u4f5c\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5b83\u4eec\u5141\u8bb8\u66f4\u7075\u6d3b\u7684\u7ed3\u6784\uff0c\u80fd\u5177\u6709\u975e\u5e38\u4e0d\u540c\u7684\u5c5e\u6027\uff0c\u5e76\u4e14\u53ef\u80fd\u652f\u6301\u591a\u4e2a\u5173\u8054\u7684\u6761\u4ef6\u5bf9\u8c61")))))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public interface Lock {\n  void lock();\n  void lockInterruptibly() throws InterruptedException;\n  boolean tryLock();\n  boolean tryLock(long time, TimeUnit unit) throws InterruptedException; \n  void unlock();\n  Condition newCondition();\n}\n")),(0,l.kt)("h4",{id:"lock-\u5e38\u89c1\u65b9\u6cd5"},"Lock \u5e38\u89c1\u65b9\u6cd5"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"tryLock(long timeout, TimeUnit unit)")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u83b7\u53d6\u4e86\u9501\u5b9a\u7acb\u5373\u8fd4\u56detrue\uff0c\u5982\u679c\u522b\u7684\u7ebf\u7a0b\u6b63\u6301\u6709\u9501\uff0c\u4f1a\u7b49\u5f85\u53c2\u6570\u7ed9\u5b9a\u7684\u65f6\u95f4\uff0c\u5728\u7b49\u5f85\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u83b7\u53d6\u4e86\u9501\u5b9a\uff0c\u5c31\u8fd4\u56detrue\uff0c\u5982\u679c\u7b49\u5f85\u8d85\u65f6\uff0c\u8fd4\u56defalse"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5728\u7b49\u5f85\u83b7\u53d6\u9501\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7ebf\u7a0b\u88ab\u4e2d\u65ad\uff0c\u4f1a\u629b\u51fa ",(0,l.kt)("inlineCode",{parentName:"li"},"InterruptedException")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"lock()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7528\u6765\u83b7\u53d6\u9501\u5bf9\u8c61",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u83b7\u53d6\u4e86\u9501\u7acb\u5373\u8fd4\u56de"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u9501\u88ab\u522b\u7684\u7ebf\u7a0b\u6301\u6709\uff0c\u90a3\u5f53\u524d\u7ebf\u7a0b\u4f1a\u4e00\u76f4\u5904\u4e8e\u4f11\u7720\u72b6\u6001\uff0c\u76f4\u5230\u83b7\u53d6\u9501"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"lock\u65b9\u6cd5\u4e0d\u80fd\u88ab\u4e2d\u65ad")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"unlock()")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"newCondition()")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u4e0e\u9501\u5bf9\u8c61\u5173\u8054\u7684\u6761\u4ef6\u5bf9\u8c61\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"li"},"Conition")," \u6761\u4ef6\u5bf9\u8c61"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f\uff1a\u4e00\u4e2a\u9501",(0,l.kt)("code",null,"\u53ef\u4ee5\u6709\u591a\u4e2a"),"\u4e0e\u4e4b\u5173\u8054\u7684\u6761\u4ef6\u5bf9\u8c61"))))),(0,l.kt)("h4",{id:"lock-vs-synchronized"},"Lock VS Synchronized"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lock\u4e0d\u662fjava \u8bed\u8a00\u5185\u7f6e\u7684\uff0csynchronized \u662f Java \u8bed\u8a00\u7684\u5173\u952e\u5b57\uff0c\u662f\u5185\u7f6e\u7279\u6027"),(0,l.kt)("li",{parentName:"ul"},"Lock \u662f\u4e00\u4e2a\u7c7b\uff0c\u901a\u8fc7\u8fd9\u4e2a\u7c7b\u53ef\u4ee5\u5b9e\u73b0\u540c\u6b65\u8bbf\u95ee"),(0,l.kt)("li",{parentName:"ul"},"Lock \u548c synchronized \u6709\u4e00\u70b9\u975e\u5e38\u5927\u7684\u4e0d\u540c",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u91c7\u7528 Synchronized \u4e0d\u9700\u8981\u624b\u52a8\u91ca\u653e\u9501\uff0c\u5f53 synchronized \u65b9\u6cd5\u6216\u8005 synchronized \u4ee3\u7801\u5757\u6267\u884c\u5b8c\u4e4b\u540e\uff0c \u7cfb\u7edf\u4f1a\u81ea\u52a8\u8ba9\u7ebf\u7a0b\u91ca\u653e\u5bf9\u9501\u7684\u5360\u7528")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"Lock \u5219\u5fc5\u987b\u8981\u7528\u6237\u53bb\u624b\u52a8\u91ca\u653e\u9501\uff0c\u5982\u679c\u6ca1\u6709\u4e3b\u52a8\u901a\u8fc7",(0,l.kt)("code",null,"unlock"),"\u91ca\u653e\u9501\uff0c\u5c31\u6709\u53ef\u80fd\u5bfc\u81f4\u51fa\u73b0\u6b7b\u9501\u73b0\u8c61")))),(0,l.kt)("li",{parentName:"ul"},"Lock \u53ef\u4ee5\u8ba9",(0,l.kt)("strong",{parentName:"li"},"\u963b\u585e\u7b49\u5f85\u9501"),"\u7684\u7ebf\u7a0b\u4e2d\u65ad(\u53ef\u4e2d\u65ad\u9501)\uff0c\u800csynchronized\u4e0d\u884c\uff08\u975e\u53ef\u4e2d\u65ad\u9501\uff09",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u4f7f\u7528synchronized \u65f6\uff0c\u7b49\u5f85\u7684\u7ebf\u7a0b\u4f1a\u4e00\u76f4\u7b49\u5f85\u4e0b\u53bb\uff0c\u65e0\u6cd5\u54cd\u5e94\u4e2d\u65ad(\u9664\u975e\u83b7\u53d6\u4e86\u9501)")))),(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7Lock\u53ef\u4ee5\u77e5\u9053\u6709\u6ca1\u6709\u6210\u529f\u83b7\u53d6\u9501\uff0c\u800csynchronized\u4e0d\u884c"),(0,l.kt)("li",{parentName:"ul"},"Lock\u53ef\u4ee5\u63d0\u9ad8\u591a\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u8bfb\u64cd\u4f5c\u7684\u6548\u7387")),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u91c7\u7528 Lock\uff0c\u5fc5\u987b\u4e3b\u52a8\u53bb\u91ca\u653e\u9501\uff0c\u5e76\u4e14\u5728\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u4e0d\u4f1a\u81ea\u52a8\u91ca\u653e\u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u56e0\u6b64\u4e00\u822c\u6765\u8bf4\uff0c\u4f7f\u7528 Lock \u5fc5\u987b\u5728 try-catch{}\u5757\u4e2d\u8fdb\u884c\uff0c\u5e76\u4e14\u5c06\u91ca\u653e\u9501\u7684\u64cd\u4f5c\u653e\u5728 finally \u5757\u4e2d\u8fdb\u884c\uff0c\u4ee5\u4fdd\u8bc1\u9501\u4e00\u5b9a\u88ab\u88ab\u91ca\u653e\uff0c\u9632\u6b62\u6b7b\u9501\u7684\u53d1\u751f"))),(0,l.kt)("li",{parentName:"ul"},"\u901a\u5e38\u4f7f\u7528 Lock \u6765\u8fdb\u884c\u540c\u6b65\u7684\u8bdd\uff0c\u662f\u4ee5\u4e0b\u9762\u8fd9\u79cd\u5f62\u5f0f\u53bb\u4f7f\u7528\u7684")),(0,l.kt)("pre",{parentName:"admonition"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"Lock lock = xxxx\uff1b  \nlock.lock(); // \u83b7\u53d6\u9501\ntry{\n    //\u5904\u7406\u4efb\u52a1\n}catch(Exception ex){ \n    // \u5f02\u5e38\u7684\u5904\u7406\n}finally{\n     lock.unlock(); //\u91ca\u653e\u9501\n}\n"))),(0,l.kt)("h4",{id:"lock\u5b9e\u73b0\u552e\u7968"},"Lock\u5b9e\u73b0\u552e\u7968"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'class Ticket {\n    private int ticketNum = 10;\n    // \u521b\u5efa\u4e00\u4e2aLock\u9501\u5bf9\u8c61\uff08\u8fd9\u91cc\u662f\u53ef\u91cd\u5165\u9501\uff09\n    private final ReentrantLock lock = new ReentrantLock();\n\n    public  void sell() {\n        lock.lock();\n        try\n        {\n            if (this.ticketNum > 0) {\n                System.out.println(Thread.currentThread().getName()+"\u5356\u51fa:"+ (this.ticketNum--)+"\u5269\u4f59:"+this.ticketNum);\n            }\n        }finally {\n            lock.unlock();\n        }\n    }\n}\npublic class LockDemo {\n    private int num = 30;\n    public static void main(String[] args) {\n        Ticket ticket = new Ticket();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                ticket.sell();\n            }\n        },"\u552e\u7968\u54581").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                ticket.sell();\n            }\n        },"\u552e\u7968\u54582").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                ticket.sell();\n            }\n        },"\u552e\u7968\u54583").start();\n    }\n}\n\n')),(0,l.kt)("h3",{id:"\u7ebf\u7a0b\u95f4\u901a\u4fe1"},"\u7ebf\u7a0b\u95f4\u901a\u4fe1"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u6848\u4f8b\uff1a \u6709\u4e24\u4e2a\u7ebf\u7a0b\uff0c\u5bf9\u4e00\u4e2a\u521d\u59cb\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\uff0cA\u7ebf\u7a0b\u5bf9\u521d\u59cb\u503c+1\uff0cB\u7ebf\u7a0b\u5bf9\u521d\u59cb\u503c-1")),(0,l.kt)("h4",{id:"synchronized\u65b9\u6848"},"Synchronized\u65b9\u6848"),(0,l.kt)("h5",{id:"\u7b49\u5f85\u901a\u77e5\u673a\u5236"},"\u7b49\u5f85\u901a\u77e5\u673a\u5236"),(0,l.kt)("admonition",{title:"\u7b49\u5f85\u901a\u77e5\u673a\u5236\u6982\u8ff0",type:"caution"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u4ec0\u4e48\u662f\u7b49\u5f85/\u901a\u77e5\u673a\u5236?")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0bA\u8c03\u7528\u4e86\u5bf9\u8c61Obj\u7684 wait() \u65b9\u6cd5\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\uff0c\u800c\u53e6\u4e00\u4e2a\u7ebf\u7a0bB\u8c03\u7528\u4e86\u5bf9\u8c61Obj\u7684notify()/notifyAll()\u65b9\u6cd5\uff0c\u7ebf\u7a0bA\u6536\u5230\u901a\u77e5\u540e\u518d\u4ece\u5bf9\u8c61Obj\u7684wait()\u65b9\u6cd5\u8fd4\u56de\uff0c\u7136\u540e\u6267\u884c\u540e\u7eed\u7684\u64cd\u4f5c -> ",(0,l.kt)("font",{color:"red"},"\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2a\u5185\u90e8\u9501\uff0c\u5e76\u4e14\u8fd9\u4e2a\u5185\u90e8\u9501\u6709\u4e00\u4e2a\u5185\u90e8\u6761\u4ef6!"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9501\u7ba1\u7406\u5c1d\u8bd5\u8fdb\u5165Synchronized\u65b9\u6cd5\u7684\u7ebf\u7a0b\uff0c\u800c\u9501\u7684\u5185\u90e8\u6761\u4ef6\u5bf9\u8c61\u53ef\u4ee5\u7ba1\u7406\u8c03\u7528\u4e86await\u65b9\u6cd5\u7684\u7ebf\u7a0b"))),(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0bA\u548c\u7ebf\u7a0bB\u4e4b\u95f4\u901a\u8fc7\u5bf9\u8c61Obj\u6765\u5b8c\u6210\u4ea4\u4e92"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u7b49\u5f85/\u901a\u77e5\u7684\u76f8\u5173\u65b9\u6cd5\u90fd\u88ab\u5b9a\u4e49\u5728",(0,l.kt)("code",null,"java.lang.Object"),"\xa0\u4e0a\uff0c\u4e14\u90fd\u662f ",(0,l.kt)("code",null,"native"),"\u65b9\u6cd5<")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u7b49\u5f85\u901a\u77e5\u76f8\u5173\u7684\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"notify()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u968f\u673a\u5524\u9192 ",(0,l.kt)("strong",{parentName:"li"},"\u4e00\u4e2a"),"\u6b63\u5728\u5bf9\u8c61\u7684\u7b49\u5f85\u7684\u7ebf\u7a0b\uff0c\u4f7f\u8be5\u7ebf\u7a0b\u4ecewait()\u65b9\u6cd5\u8fd4\u56de,",(0,l.kt)("strong",{parentName:"li"},"\u8fd4\u56de\u7684\u524d\u63d0\u662f\u8be5\u7ebf\u7a0b\u83b7\u53d6\u5230\u4e86\u5bf9\u8c61\u7684\u9501")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"notifyAll()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5524\u9192 ",(0,l.kt)("font",{color:"red"},(0,l.kt)("strong",{parentName:"li"},"\u6240\u6709"))," \u6b63\u5728\u7b49\u5f85\u8fd9\u4e2a\u5bf9\u8c61\u7684monitor\u7684\u7ebf\u7a0b"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"wait([time],[timeUint])")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8c03\u7528\u8be5\u65b9\u6cd5\u7684\u7ebf\u7a0b\u7684 \u7ebf\u7a0b\u72b6\u6001\u4ece RUNNING -> WAITING\uff0c\u8ba9\u5f53\u524d\u7ebf\u7a0b\u963b\u585e,\u5e76\u5c06\u8be5\u7ebf\u7a0b\u653e\u5728\u6761\u4ef6\u5bf9\u8c61\u7684\u7b49\u5f85\u961f\u5217\u4e0a\u3002\u53ea\u6709\u7b49\u5f85\u53e6\u5916\u7684\u7ebf\u7a0b\u901a\u77e5\u6216\u8005\u4e2d\u65ad\u624d\u4f1a\u8fd4\u56de\u3002"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f:wait() \u65b9\u6cd5\u8ba9\u7ebf\u7a0b\u5728\u54ea\u91cc\u7b49\u5f85\uff0c\u88abnotify\u5524\u9192\u7b49\u5230monitor\u540e\uff0c\u5c31\u4f1a\u5728\u7b49\u5f85\u7684\u5730\u65b9\u7ee7\u7eed\u6267\u884c\u4e0b\u53bb")))))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528wait()\u3001notify()\u3001notifyAll()\u65f6\u5fc5\u987b\u5148\u62e5\u6709\u9501, \u5373\u653e\u5728\u540c\u6b65\u65b9\u6cd5/\u4ee3\u7801\u5757\u4e2d")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"notify()\u548cnotifyAll()\u65b9\u6cd5\u8c03\u7528\u540e,\u7b49\u5f85\u7ebf\u7a0b\u4e5f\u4e0d\u4f1a\u4ecewait()\u65b9\u6cd5\u8fd4\u56de\uff0c",(0,l.kt)("strong",null,"\u9700\u8981\u7b49\u8c03\u7528notify\u65b9\u6cd5\u7684\u7ebf\u7a0b\u91ca\u653e\u9501")," ,\u7b49\u5f85\u7ebf\u7a0b\u624d\u6709\u673a\u4f1a\u4ecewait()\u65b9\u6cd5\u8fd4\u56de ")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u6ce8\u610f: \u7b49\u5f85\u901a\u77e5\u673a\u5236\u4f9d\u8d56\u4e8e\u540c\u6b65\u673a\u5236 -> \u76ee\u7684\u5c31\u662fwait()\u65b9\u6cd5\u8fd4\u56de\u540e,\u7ebf\u7a0b\u80fd\u5728\u8c03\u7528wait()\u7684\u5730\u65b9\u7ee7\u7eed\u5f80\u4e0b\u8d70")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u4e0d\u8981\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Thread.wait()"),"\uff0c\u5f53Thread\u6267\u884c\u5b8c\u540e\u4f1a\u81ea\u52a8\u7684\u5524\u9192\u7b49\u5f85\u7684\u7ebf\u7a0b")))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u7b49\u5f85\u901a\u77e5\u7684\u6d41\u7a0b\u56fe")),(0,l.kt)("blockquote",null,(0,l.kt)("ol",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u7ebf\u7a0bB\u9996\u5148\u83b7\u53d6\u5230\u4e86\u5bf9\u8c61\u7684\u9501,\u7136\u540e\u8c03\u7528\u5bf9\u8c61\u7684wait()\u65b9\u6cd5,\u4ece\u800c\u653e\u5f03\u4e86\u9501\u5e76\u4e14\u8fdb\u5165\u5bf9\u8c61\u7684\u7b49\u5f85\u961f\u5217WaitQueue\u4e2d,\u5e76\u4e14\u8fdb\u5165 ",(0,l.kt)("inlineCode",{parentName:"p"},"WAITING")," \u72b6\u6001")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u7531\u4e8e\u7ebf\u7a0bB\u91ca\u653e\u4e86\u5bf9\u8c61\u7684\u9501,\u7ebf\u7a0bA\u7d27\u63a5\u7740\u83b7\u53d6\u4e86\u5bf9\u8c61\u7684\u9501,\u5e76\u4e14\u8c03\u7528\u5bf9\u8c61\u7684 notify()\u65b9\u6cd5,\u5c06\u7ebf\u7a0bB\u4ece\u7b49\u5f85\u961f\u5217\u8fc1\u79fb\u81f3\u540c\u6b65\u961f\u5217\u4e2d,\u6b64\u65f6\u7ebf\u7a0bB\u5904\u4e8e",(0,l.kt)("inlineCode",{parentName:"p"},"BLOCKED"),"\u963b\u585e\u72b6\u6001")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u7ebf\u7a0bA\u91ca\u653e\u4e86\u9501,\u7136\u540e\u7ebf\u7a0bB\u83b7\u53d6\u4e86\u9501\u5e76\u4e14\u4ece\u963b\u585e\u7684wait()\u65b9\u6cd5\u8fd4\u56de,\u5e76\u7ee7\u7eed\u6267\u884c\u4e0b\u9762\u7684\u6b65\u9aa4")))),(0,l.kt)("p",null,"  ",(0,l.kt)("img",{alt:"alt",src:t(27579).Z,width:"1006",height:"641"})),(0,l.kt)("hr",null),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e24\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u901a\u4fe1")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'class  Share {\n    /**\n     * \u516c\u5171\u8d44\u6e90\n     */\n    private int num = 0;\n\n    public synchronized void add() throws InterruptedException {\n        // \u5224\u65ad\u662f\u5426\u6ee1\u8db3\u6267\u884c\u6761\u4ef6\n        if (num !=0) {\n            // \u4e0d\u6ee1\u8db3\u6761\u4ef6,\u8c03\u7528Object\u5bf9\u8c61\u7684wait()\u8fdb\u884c\u7b49\u5f85\uff0c\u540c\u65f6\u91ca\u653e\u9501(\u540c\u6b65\u65b9\u6cd5\u7684\u9501\u5bf9\u8c61\u5c31\u662f\u8c03\u7528\u65b9\u6cd5\u7684\u5bf9\u8c61\u5b9e\u4f8b -> share\u5bf9\u8c61\u5b9e\u4f8b)\n            this.wait();\n        }\n        // \u6ee1\u8db3\u6761\u4ef6,\u6267\u884c\u5904\u7406\u4efb\u52a1\n        System.out.println("["+Thread.currentThread().getName() + "] \u5f53\u524dNum:"+(num++) + "\u53d8\u66f4\u540e:"+num);\n        this.notifyAll();\n    }\n    public synchronized void min() throws InterruptedException {\n        // \u5224\u65ad\u662f\u5426\u6ee1\u8db3\u6267\u884c\u6761\u4ef6\n        if (num !=1) {\n            // \u4e0d\u6ee1\u8db3\u6761\u4ef6,\u8c03\u7528Object\u5bf9\u8c61\u7684wait()\u8fdb\u884c\u7b49\u5f85\uff0c\u540c\u65f6\u91ca\u653e\u9501(\u540c\u6b65\u65b9\u6cd5\u7684\u9501\u5bf9\u8c61\u5c31\u662f\u8c03\u7528\u65b9\u6cd5\u7684\u5bf9\u8c61\u5b9e\u4f8b -> share\u5bf9\u8c61\u5b9e\u4f8b)\n            this.wait();\n        }\n        // \u6ee1\u8db3\u6761\u4ef6,\u6267\u884c\u5904\u7406\u4efb\u52a1\n        System.out.println("["+Thread.currentThread().getName() + "] \u5f53\u524dNum:"+(num--) + "\u53d8\u66f4\u540e:"+num);\n        this.notifyAll();\n    }\n}\npublic class ThreadDemo {\n    public static void main(String[] args) {\n        Share share = new Share();\n        for (int i = 0; i < 500; i++) {\n            new Thread(() -> {\n                try {\n                    share.add();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            },"\u7ebf\u7a0bA"+i).start();\n            new Thread(() -> {\n                try {\n                    share.min();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            },"\u7ebf\u7a0bB"+i).start();\n        }\n\n    }\n}\n\n')),(0,l.kt)("h5",{id:"\u865a\u5047\u5524\u9192\u7684\u95ee\u9898"},"\u865a\u5047\u5524\u9192\u7684\u95ee\u9898"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u6267\u884c\u4e0a\u8ff0\u7684\u4ee3\u7801\uff0c\u53ef\u80fd\u5076\u53d1\u7684\u51fa\u73b0\u4e0b\u56fe\u4e2d\u7684\u95ee\u9898\uff0c\u51fa\u73b0\u7684\u539f\u56e0\u4e3b\u8981\u662f\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"wait()\u65b9\u6cd5\u662f\u963b\u585e\u7684\uff0c\u5728\u54ea\u91cc\u91ca\u653e\u9501\u7b49\u5f85\uff0c\u88ab\u901a\u77e5\u5524\u9192\u540e\u5c31\u4f1a\u5728\u54ea\u91cc\u8fd4\u56de\u5e76\u7ee7\u7eed\u6267\u884c")),(0,l.kt)("ul",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982num=1\u65f6,\u7ebf\u7a0bB397\u8c03\u7528min()\u65b9\u6cd5if\u8bed\u53e5\u4e2d\u7684wait()\u65b9\u6cd5\u540e\u963b\u585e,\u4e8e\u662f\u7ebf\u7a0bB397\u5728\u6b64\u5904\u7b49\u5f85\u5e76\u91ca\u653e\u9501\u5bf9\u8c61"),(0,l.kt)("li",{parentName:"ul"},"\u7136\u540e\u7531\u7ebf\u7a0bB400\u62ff\u5230\u4e86\u9501\u5bf9\u8c61,\u5e76\u4e14\u7531\u4e8enum=1,\u6267\u884c\u4e86min()\u65b9\u6cd5,\u5c06num\u8bbe\u7f6e\u4e3a0,\u5e76\u4e14\u6267\u884cnotifyAll()\u65b9\u6cd5\u540e,\u91ca\u653e\u9501\u5e76\u4e14\u901a\u77e5\u540c\u6b65\u961f\u5217\u4e2d\u6240\u6709\u7b49\u5f85\u7684\u7ebf\u7a0b"),(0,l.kt)("li",{parentName:"ul"},"\u7136\u540e\u7ebf\u7a0bB397\u62ff\u5230\u4e86\u9501\u5bf9\u8c61,\u4e8e\u662fwait()\u65b9\u6cd5\u8fd4\u56de,\u5e76\u5f00\u59cb\u6267\u884c\u4e0b\u9762\u7684\u6d41\u7a0b -> \u5c06num\u51cf1,\u4e8e\u662fnum\u53d8\u6210\u4e86 -1"))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(41310).Z,width:"306",height:"133"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u865a\u5047\u5524\u9192\u7684\u4e00\u822c\u5904\u7406\u65b9\u5f0f")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5c06\u5224\u65ad\u653e\u5728while() {} \u5faa\u73af\u4e2d,\u8fd9\u6837\u5f53 this.wait()\u65b9\u6cd5\u8fd4\u56de\u540e,\u8fd8\u4f1a\u518d\u6b21\u5224\u65ad\u662f\u5426\u6ee1\u8db3while\u6761\u4ef6")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'// \u4ee5min()\u65b9\u6cd5\u4e3a\u4f8b\u5b50\n// \u4fee\u6539\u524d:\npublic synchronized void min() throws InterruptedException {\n  if (num !=1) {\n    this.wait();\n  }\n  System.out.println("["+Thread.currentThread().getName() + "] \u5f53\u524dNum:"+(num--) + "\u53d8\u66f4\u540e:"+num);\n  this.notifyAll();\n}\n\n  \n// \u4fee\u6539\u540e\npublic synchronized void min() throws InterruptedException {\n  while (num !=1) {\n    this.wait();\n  }\n  System.out.println("["+Thread.currentThread().getName() + "] \u5f53\u524dNum:"+(num--) + "\u53d8\u66f4\u540e:"+num);\n  this.notifyAll();\n}\n\n')),(0,l.kt)("h5",{id:"\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f"},"\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(22758).Z,width:"892",height:"607"})),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * <b>\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u6a21\u5f0f(\u4ec5\u4f7f\u7528wait \u548c notify)</b>\n * @author <a href="mailto:zhuyuliangm@gmail.com">zyl</a>\n */\npublic class ProducerAndConsumer {\n    public static void main(String[] args) throws InterruptedException {\n        Storage store = new Storage(10);\n\n        Thread producer = new Thread(() -> {\n            for (int i = 0; i < 20; i++) {\n                try {\n                    store.put("data"+i);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },"producer");\n\n        Thread consumer = new Thread(() -> {\n            for (int i = 0; i < 20; i++) {\n                try {\n                    store.take();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },"consumer");\n        producer.start();\n        // \u8ba9\u751f\u4ea7\u8005\u5148\u751f\u4ea7\u6570\u636e\n        TimeUnit.SECONDS.sleep(1);\n        consumer.start();\n    }\n    /**\n     * \u5b9a\u4e49\u4e00\u4e2a\u963b\u585e\u961f\u5217\n     */\n    static class Storage {\n        private int maxSize;\n        private LinkedList<String> store;\n        public Storage(int maxSize) {\n            this.maxSize = maxSize;\n            this.store = new LinkedList<>();\n        }\n\n        /**\n         * \u540c\u6b65\u65b9\u6cd5\u7684monitor\u662f\u5f53\u524d\u5bf9\u8c61\u5b9e\u4f8b\n         * \u5982\u679c\u88ab\u4e2d\u65ad\u5219\u629b\u51fa\u5f02\u5e38\n         */\n        public synchronized void put(String data) throws InterruptedException {\n            System.out.println(ThreadUtil.getThreadInfo() + "\u5c1d\u8bd5\u653e\u5165\u6570\u636e["+data+"]...");\n            while(store.size() == maxSize) {\n                System.out.println(ThreadUtil.getThreadInfo() + "\u5b58\u50a8\u6ee1\u4e86...");\n                wait();\n            }\n            System.out.println(ThreadUtil.getThreadInfo() + "\u5b58\u50a8\u6709\u5269\u4f59\u7a7a\u95f4...");\n            store.add(data);\n            // \u901a\u77e5\u6d88\u8d39\u8005\u6d88\u8d39\n            notify();\n        }\n        public synchronized void take() throws InterruptedException {\n            System.out.println(ThreadUtil.getThreadInfo() + "\u5c1d\u8bd5\u53d6\u51fa\u6570\u636e...");\n            while(store.size() == 0) {\n                System.out.println(ThreadUtil.getThreadInfo() + "\u5b58\u50a8\u7a7a\u4e86...");\n                wait();\n            }\n            System.out.println(ThreadUtil.getThreadInfo() + "\u5b58\u50a8\u6709\u6570\u636e\u4e86,\u540c\u65f6\u53d6\u51fa\u6570\u636e:"+store.poll());\n            // \u901a\u77e5\u751f\u4ea7\u8005\u751f\u4ea7\u6570\u636e\n            notify();\n        }\n    }\n}\n')),(0,l.kt)("h4",{id:"lock\u65b9\u6848"},"Lock\u65b9\u6848"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Lock\u63a5\u53e3\u7684 newContition()\u65b9\u6cd5\u8fd4\u56de Condition \u5bf9\u8c61\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"Condition\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u7b49\u5f85/\u901a\u77e5\u6a21\u5f0f"),",\u800c\u4e14\u53ef\u4ee5\u8fdb\u884c\u9009\u62e9\u6027\u7684\u901a\u77e5,Condition\u5e38\u7528\u7684\u65b9\u6cd5",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"await()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u5f53\u524d\u7ebf\u7a0b\u7b49\u5f85\u5e76\u5c06\u7ebf\u7a0b\u653e\u5728Condition\u5bf9\u8c61\u7684\u7b49\u5f85\u961f\u5217\u4e2d,\u540c\u65f6\u4f1a\u91ca\u653e\u9501,\u5f53\u5176\u4ed6\u7ebf\u7a0b\u8c03\u7528 signal()\u65f6,\u7ebf\u7a0b\u4f1a\u91cd\u65b0\u83b7\u5f97\u9501,\u5e76\u7ee7\u7eed\u6267\u884c"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"signal()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4ece\u6761\u4ef6\u7684\u7b49\u5f85\u961f\u5217\u4e2d\u968f\u673a\u5524\u9192\u4e00\u4e2a\u7b49\u5f85\u7684\u7ebf\u7a0b"))))),(0,l.kt)("li",{parentName:"ul"},"\u6ce8\u610f",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u8c03\u7528 Condition \u7684 await()/signal()\u65b9\u6cd5\u524d\uff0c\u4e5f\u9700\u8981\u7ebf\u7a0b\u6301\u6709\u76f8\u5173\u7684Lock \u9501"),(0,l.kt)("li",{parentName:"ul"},"\u8c03\u7528 await()\u540e\u7ebf\u7a0b\u4f1a\u91ca\u653e\u8fd9\u4e2a\u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5728singal()\u8c03\u7528\u540e\u4f1a\u4ece\u5f53\u524d Condition \u5bf9\u8c61\u7684\u7b49\u5f85\u961f\u5217\u4e2d\uff0c\u5524\u9192\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5524\u9192\u7684\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u5f97\u9501\uff0c\u4e00\u65e6\u83b7\u5f97\u9501\u6210\u529f\u5c31\u7ee7\u7eed\u6267\u884c\u3002")))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'class Shared {\n    private int num = 0;\n    // \u58f0\u660e\u9501\u5bf9\u8c61\n    private Lock lock = new ReentrantLock();\n    // \u58f0\u660e\u6761\u4ef6\n    private Condition condition = lock.newCondition();\n\n    public void add() throws InterruptedException {\n        lock.lock();\n        try {\n            // \u5224\u65ad\n            while (num !=0) {\n                condition.await();\n            }\n            System.out.println("["+Thread.currentThread().getName() + "] \u5f53\u524dNum:"+(num++) + "\u53d8\u66f4\u540e:"+num);\n            condition.signalAll();\n        }finally {\n            lock.unlock();\n        }\n    }\n    public void min() throws InterruptedException {\n        lock.lock();\n        try {\n            // \u5224\u65ad,\u4f7f\u7528while \u9632\u6b62\u865a\u5047\u5524\u9192\n            while (num !=1) {\n                condition.await();\n            }\n            // \u6ee1\u8db3\u6761\u4ef6\u6267\u884c\n            System.out.println("["+Thread.currentThread().getName() + "] \u5f53\u524dNum:"+(num--) + "\u53d8\u66f4\u540e:"+num);\n            // \u901a\u77e5\u5176\u4ed6\u7684\u7ebf\u7a0b\n            condition.signalAll();\n        }finally {\n            lock.unlock();\n        }\n    }\n}\npublic class LockDemo {\n    public static void main(String[] args) {\n        Shared share = new Shared();\n        for (int i = 0; i < 500; i++) {\n            new Thread(() -> {\n                try {\n                    share.add();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            },"\u7ebf\u7a0bA"+i).start();\n            new Thread(() -> {\n                try {\n                    share.min();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            },"\u7ebf\u7a0bB"+i).start();\n        }\n    }\n}\n\n')),(0,l.kt)("h3",{id:"\u7ebf\u7a0b\u95f4\u5b9a\u5236\u5316\u901a\u4fe1"},"\u7ebf\u7a0b\u95f4\u5b9a\u5236\u5316\u901a\u4fe1"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u6848\u4f8b\uff1a\u5b9e\u73b0 A\u7ebf\u7a0b\u6253\u53705\u6b21A\uff0cB \u7ebf\u7a0b\u6253\u537010\u6b21B\uff0cC\u7ebf\u7a0b\u6253\u537015\u6b21C,\u6309\u7167 \u6b64\u987a\u5e8f\u5faa\u73af 10 \u8f6e -> \u5524\u9192\u6307\u5b9a\u7684\u7ebf\u7a0b")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5b9e\u73b0\u601d\u8def: A\u6267\u884c\u5b8c\u540e,\u901a\u77e5B\u7ebf\u7a0b,B\u6267\u884c\u5b8c\u540e\u901a\u77e5C\u7ebf\u7a0b -> \u521b\u5efa\u591a\u4e2aCondition\u4e0eA,B,C\u8fdb\u884c\u7ed1\u5b9a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * \u9700\u6c42: A\u8f93\u51fa\u4e94\u6b21,B\u8f93\u51fa10\u6b21,C\u8f93\u51fa15\u6b21\n *\n * @author <a href="mailto:zhuyuliangm@gmail.com">zyl</a>\n */\n\nclass customShared {\n    private int num = 0;\n    // \u58f0\u660e\u4e00\u4e2a\u9501\u5bf9\u8c61\n    private Lock lock  = new ReentrantLock();\n\n    // \u521b\u5efa\u4e00\u4e2aA\u7684\u6761\u4ef6\n    private Condition conditionA = lock.newCondition();\n    // \u521b\u5efa\u4e00\u4e2aB\u7684\u6761\u4ef6\n    private Condition conditionB = lock.newCondition();\n    // \u521b\u5efa\u4e00\u4e2aC\u7684\u6761\u4ef6\n    private Condition conditionC = lock.newCondition();\n\n    public void printA () throws InterruptedException {\n        lock.lock();\n        try {\n            // \u5224\u65ad\u6761\u4ef6 -> num=0 \u7684\u65f6\u5019,\u8f93\u51faA\n            while (num != 0) {\n                conditionA.await();\n            }\n            for (int i = 1; i <= 5; i++) {\n                System.out.printf("\u7ebf\u7a0b[%s]---\x3eA[%d]\\r\\n",Thread.currentThread().getName(),i);\n            }\n           num = 1;\n            // \u5524\u9192B\n            conditionB.signal();\n        }finally {\n            lock.unlock();\n        }\n    }\n    public void printB () throws InterruptedException {\n        lock.lock();\n        try {\n            // \u5224\u65ad\u6761\u4ef6 -> num=1 \u7684\u65f6\u5019,\u8f93\u51faB\n            while (num != 1) {\n                conditionB.await();\n            }\n            for (int i = 1; i <= 10; i++) {\n                System.out.printf("\u7ebf\u7a0b[%s]---\x3eB[%d]\\r\\n",Thread.currentThread().getName(),i);\n            }\n            num = 2;\n            // \u5524\u9192C\n            conditionC.signal();\n        }finally {\n            lock.unlock();\n        }\n    }\n    public void printC () throws InterruptedException {\n        lock.lock();\n        try {\n            // \u5224\u65ad\u6761\u4ef6 -> num=2 \u7684\u65f6\u5019,\u8f93\u51faC\n            while (num != 2) {\n                conditionC.await();\n            }\n            for (int i = 1; i <= 15; i++) {\n                System.out.printf("\u7ebf\u7a0b[%s]---\x3eC[%d]\\r\\n",Thread.currentThread().getName(),i);\n            }\n            System.out.println("------------------");\n            num = 0;\n            // \u5524\u9192C\n            conditionA.signal();\n        }finally {\n            lock.unlock();\n        }\n    }\n}\n\npublic class CustomLockDemo {\n    public static void main(String[] args) {\n        customShared shared = new customShared();\n        new Thread(() -> {\n            try {\n                for (int i = 1; i <= 10; i++) {\n                    shared.printA();\n                }\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        },"TheadA").start();\n        new Thread(() -> {\n            try {\n                for (int i = 1; i <= 10; i++) {\n                    shared.printB();\n                }\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, "ThreadB").start();\n        new Thread(() -> {\n            try {\n                for (int i = 1; i <= 10; i++) {\n                    shared.printC();\n                }\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        },"ThreadC").start();\n    }\n}\n\n')),(0,l.kt)("h3",{id:"thread\u7684\u5176\u4ed6\u65b9\u6cd5"},"Thread\u7684\u5176\u4ed6\u65b9\u6cd5"),(0,l.kt)("h4",{id:"sleep"},"sleep()"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7279\u70b9",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8ba9\u5f53\u524d\u7ebf\u7a0b\u5728\u9884\u671f\u65f6\u95f4\u8fd0\u884c\uff0c\u5176\u4ed6\u65f6\u95f4\u4e0d\u5360\u7528 CPU\u8d44\u6e90"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"sleep\u65b9\u6cd5\u4e0d\u91ca\u653e\u9501\uff0c\u5305\u62ec synchronized \u548c lock")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"sleep\u65b9\u6cd5\u53ef\u4ee5\u88ab\u4e2d\u65ad\uff0c\u4f1a\u629b\u51fa\u4e2d\u65ad\u5f02\u5e38\u5e76\u4e14\u6e05\u9664\u4e2d\u65ad\u72b6\u6001"))))),(0,l.kt)("admonition",{title:"wait \u548c sleep \u7684\u533a\u522b?",type:"caution"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u533a\u522b1",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"sleep \u662fThread \u7684\u9759\u6001\u65b9\u6cd5"),(0,l.kt)("li",{parentName:"ul"},"wait \u662fObject\u7684\u65b9\u6cd5\uff0c\u4efb\u4f55\u5bf9\u8c61\u5b9e\u4f8b\u90fd\u53ef\u4ee5\u8c03\u7528"))),(0,l.kt)("li",{parentName:"ul"},"\u533a\u522b2",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"sleep \u4e0d\u4f1a\u91ca\u653e\u9501,\u4f46\u662f\u4f1a\u8ba9\u51faCPU\u6267\u884c\u6743"),(0,l.kt)("li",{parentName:"ul"},"wait \u4f1a\u91ca\u653e\u9501\uff0c\u4f46\u662f\u8c03\u7528\u5b83\u7684\u524d\u63d0\u662f",(0,l.kt)("font",{color:"red"},"\u5f53\u524d\u7ebf\u7a0b\u5360\u6709\u9501(\u5373\u4ee3\u7801\u9700\u8981\u5728synchronized\u4e2d)")))),(0,l.kt)("li",{parentName:"ul"},"wait \u548c sleep \u90fd\u53ef\u4ee5\u88ab ",(0,l.kt)("font",{color:"red"},"interrupted()"),"\u4e2d\u65ad  "))),(0,l.kt)("h5",{id:"wait\u91ca\u653e\u9501"},"wait\u91ca\u653e\u9501"),(0,l.kt)("p",null,"\u901a\u8fc7\u8fd0\u884c\u7ed3\u679c\u53ef\u4ee5\u770b\u5230\uff0c\u5f53Thread1\u8c03\u7528wait\u65b9\u6cd5\u540e\uff0cThread2\u5c31\u6267\u884c\u4e86\uff0c\u8d70\u51fa\u540c\u6b65\u4ee3\u7801\u5757\u5e76\u4e14\u4e5f\u91ca\u653e\u4e86\u9501\uff0c\u7136\u540eThread1\u83b7\u53d6\u5230\u4e86\u9501\uff0c\u5e76\u4e14\u6267\u884c\u4e0b\u4e00\u6b65"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class WaitDemo2 {\n    // \u521b\u5efa\u9501\u5bf9\u8c61\n    private static final Object lock = new Object();\n\n    public static void main(String[] args) throws InterruptedException {\n        Thread thread1 = new Thread(() -> {\n           synchronized (lock) {\n               try {\n                   System.out.println(ThreadUtil.getThreadInfo() + "\\t\u83b7\u53d6\u5230\u4e86monitor\u9501["+ LocalDateTime.now().toLocalTime() +"]" );\n                   lock.wait(5000);\n                   System.out.println(ThreadUtil.getThreadInfo() + "\\t\u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757["+ LocalDateTime.now().toLocalTime() +"]" );\n               } catch (InterruptedException e) {\n                   e.printStackTrace();\n               }\n           }\n        },"Thread1");\n\n        Thread thread2 = new Thread(() -> {\n            synchronized (lock) {\n                try {\n                    System.out.println(ThreadUtil.getThreadInfo() + "\\t\u83b7\u53d6\u5230\u4e86monitor\u9501["+ LocalDateTime.now().toLocalTime() +"]" );\n                    System.out.println(ThreadUtil.getThreadInfo() + "\\t\u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757["+ LocalDateTime.now().toLocalTime() +"]" );\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },"Thread2");\n        thread1.start();\n        TimeUnit.SECONDS.sleep(1);\n        thread2.start();\n    }\n}\n\n/*\n    {\u7ebf\u7a0b\u540d\u79f0: Thread1,ID:11,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5} \u83b7\u53d6\u5230\u4e86monitor\u9501[16:26:47.242]\n  {\u7ebf\u7a0b\u540d\u79f0: Thread2,ID:12,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5}   \u83b7\u53d6\u5230\u4e86monitor\u9501[16:26:48.216]\n  {\u7ebf\u7a0b\u540d\u79f0: Thread2,ID:12,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5}   \u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757[16:26:48.228]\n  {\u7ebf\u7a0b\u540d\u79f0: Thread1,ID:11,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5}   \u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757[16:26:52.248]\n*/\n')),(0,l.kt)("h5",{id:"sleep\u4e0d\u91ca\u653e\u9501"},"sleep\u4e0d\u91ca\u653e\u9501"),(0,l.kt)("p",null,"\u901a\u8fc7\u8fd0\u884c\u7ed3\u679c\u53ef\u4ee5\u770b\u5230\uff0c\u5f53Thread1\u8c03\u7528sleep\u65b9\u6cd5\u4e4b\u540e\uff0c\u5e76\u4e0d\u4f1a\u91ca\u653e\u9501\uff0c\u53ea\u6709\u7b49sleep\u65f6\u95f4\u5230\u4e86\u4e4b\u540e\uff0c\u624d\u4f1a\u7ee7\u7eed\u5f80\u4e0b\u8d70"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class WaitDemo2 {\n    // \u521b\u5efa\u9501\u5bf9\u8c61\n    private static final Object lock = new Object();\n\n    public static void main(String[] args) throws InterruptedException {\n        Thread thread1 = new Thread(() -> {\n           synchronized (lock) {\n               try {\n                   System.out.println(ThreadUtil.getThreadInfo() + "\\t\u83b7\u53d6\u5230\u4e86monitor\u9501["+ LocalDateTime.now().toLocalTime() +"]" );\n                   TimeUnit.SECONDS.sleep(5);\n                   System.out.println(ThreadUtil.getThreadInfo() + "\\t\u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757["+ LocalDateTime.now().toLocalTime() +"]" );\n               } catch (InterruptedException e) {\n                   e.printStackTrace();\n               }\n           }\n        },"Thread1");\n\n        Thread thread2 = new Thread(() -> {\n            synchronized (lock) {\n                try {\n                    System.out.println(ThreadUtil.getThreadInfo() + "\\t\u83b7\u53d6\u5230\u4e86monitor\u9501["+ LocalDateTime.now().toLocalTime() +"]" );\n                    TimeUnit.SECONDS.sleep(2);\n                    System.out.println(ThreadUtil.getThreadInfo() + "\\t\u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757["+ LocalDateTime.now().toLocalTime() +"]" );\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },"Thread2");\n        thread1.start();\n        TimeUnit.SECONDS.sleep(1);\n        thread2.start();\n    }\n}\n\n/*\n    {\u7ebf\u7a0b\u540d\u79f0: Thread1,ID:11,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5} \u83b7\u53d6\u5230\u4e86monitor\u9501[16:31:07.256]\n  {\u7ebf\u7a0b\u540d\u79f0: Thread1,ID:11,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5}   \u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757[16:31:12.258]\n  {\u7ebf\u7a0b\u540d\u79f0: Thread2,ID:12,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5}   \u83b7\u53d6\u5230\u4e86monitor\u9501[16:31:12.259]\n  {\u7ebf\u7a0b\u540d\u79f0: Thread2,ID:12,\u72b6\u6001:RUNNABLE,\u4f18\u5148\u7ea7:5}   \u9000\u51fa\u4e86\u540c\u6b65\u4ee3\u7801\u5757[16:31:14.260]\n*/\n')),(0,l.kt)("h4",{id:"join"},"join()"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7b49\u52a0\u5165\u7684\u7ebf\u7a0b\u6267\u884c\u5b8c\u540e\u518d\u6267\u884c"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"join\u671f\u95f4\uff0c\u4e3b\u7ebf\u7a0b\u5904\u4e8eWAITING\u7684\u7ebf\u7a0b\u72b6\u6001"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class joinDemo {\n    public static void main(String[] args) throws InterruptedException {\n        Thread thread1 = new Thread(() -> {\n            System.out.println(ThreadUtil.getThreadInfo() + "\u5f00\u59cb...");\n            try {\n                TimeUnit.SECONDS.sleep(3);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(ThreadUtil.getThreadInfo() + "\u7ed3\u675f...");\n        });\n\n        Thread thread2 = new Thread(() -> {\n            System.out.println(ThreadUtil.getThreadInfo() + "\u5f00\u59cb...");\n            try {\n                TimeUnit.SECONDS.sleep(3);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(ThreadUtil.getThreadInfo() + "\u7ed3\u675f...");\n        });\n        thread1.start();\n        thread2.start();\n        TimeUnit.SECONDS.sleep(1);\n        System.out.println(ThreadUtil.getThreadInfo() + "\u7ebf\u7a0b1,\u7ebf\u7a0b2\u52a0\u5165\u4e3b\u7ebf\u7a0b...");\n        thread1.join();\n        thread2.join();\n        System.out.println(ThreadUtil.getThreadInfo() + "\u7ebf\u7a0b1,\u7ebf\u7a0b2\u6267\u884c\u7ed3\u675f\u540e,\u4e3b\u7ebf\u7a0b\u7ee7\u7eed...");\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(30634).Z,width:"987",height:"155"})),(0,l.kt)("h4",{id:"yield"},"yield()"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u91ca\u653e\u7ebf\u7a0b\u7684CPU\u65f6\u95f4\u7247(\u8d44\u6e90)\uff0c\u4f46\u662f\u4e0d\u91ca\u672c\u8eab\u653e\u9501\u4e14\u4e0d\u4f1a\u5904\u4e8e\u963b\u585e\uff0c\u6b64\u65f6\u7684\u7ebf\u7a0b\u72b6\u6001\u4f9d\u65e7\u662f RUNNABLE")),(0,l.kt)("h2",{id:"\u96c6\u5408\u7684\u7ebf\u7a0b\u5b89\u5168"},"\u96c6\u5408\u7684\u7ebf\u7a0b\u5b89\u5168"),(0,l.kt)("h3",{id:"\u4e0d\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b"},"\u4e0d\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b"),(0,l.kt)("h4",{id:"arraylist"},"ArrayList"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * <b>List\u96c6\u5408\u7ebf\u7a0b\u4e0d\u5b89\u5168\u6f14\u793a</b>\n *\n * @author <a href=\"mailto:zhuyuliangm@gmail.com\">zyl</a>\n */\npublic class ThreadDemo1 {\n    public static void main(String[] args) {\n        // \u521b\u5efaArrayList \u96c6\u5408\n        List<String> names = new ArrayList<>();\n\n        // \u521b\u5efa10\u4e2a\u7ebf\u7a0b\u53bb\u64cd\u4f5c\u96c6\u5408ArrayList\n        for (int i = 0; i < 10; i++) {\n            new Thread(() -> {\n                names.add(UUID.randomUUID().toString().substring(0,8));\n                System.out.println(names);\n            },String.valueOf('i')).start();\n        }\n\n    }\n}\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u591a\u7ebf\u7a0b\u4e0bArrayList \u5f02\u5e38 -> \u5e76\u53d1\u4fee\u6539\u5f02\u5e38")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(96748).Z,width:"900",height:"361"})),(0,l.kt)("h3",{id:"\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b"},"\u5b89\u5168\u7684\u96c6\u5408\u7ebf\u7a0b"),(0,l.kt)("h4",{id:"vector-\u4e0d\u63a8\u8350"},"Vector ","[\u4e0d\u63a8\u8350]"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Vector \u662f",(0,l.kt)("inlineCode",{parentName:"p"},"\u77e2\u91cf\u961f\u5217"),", \u4eceJDK1.0 \u7248\u672c\u5f15\u5165, \u7ee7\u627f\u4e8e",(0,l.kt)("inlineCode",{parentName:"p"},"AbstractList"),", \u5b9e\u73b0\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"List\u3001RandomAccess\u3001Cloneable")," \u63a5\u53e3")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5b83\u662f\u4e00\u4e2a\u961f\u5217,\u652f\u6301 ",(0,l.kt)("inlineCode",{parentName:"p"},"\u6dfb\u52a0\u3001\u5220\u9664\u3001\u4fee\u6539\u3001\u904d\u5386\u7b49\u529f\u80fd")," ,\u7531\u4e8e\u8fd8\u5b9e\u73b0\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"RandomAccess")," \u63a5\u53e3,\u6240\u4ee5\u8fd8\u5177\u6709",(0,l.kt)("inlineCode",{parentName:"p"},"\u968f\u673a\u8bbf\u95ee\u7684\u529f\u80fd"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u548c ArrayList \u4e0d\u540c\u7684\u662f\uff0cVector\u4e2d\u7684\u64cd\u4f5c\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u5b83\u7684add()\u65b9\u6cd5 \u662f\u540c\u6b65\u65b9\u6cd5"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * <b>\u4f7f\u7528Vector</b>\n *\n * @author <a href=\"mailto:zhuyuliangm@gmail.com\">zyl</a>\n */\npublic class ThreadDemo2 {\n    public static void main(String[] args) {\n        // \u521b\u5efa\u4e00\u4e2aVector \u96c6\u5408\n        List<String> names = new Vector<>();\n\n        // \u521b\u5efa30\u4e2a\u7ebf\u7a0b\u64cd\u4f5c\u96c6\u5408\n        for (int i = 0; i < 30; i++) {\n            new Thread(() -> {\n                names.add(UUID.randomUUID().toString().substring(0,8));\n                System.out.println(names);\n            },String.valueOf('i')).start();\n        }\n    }\n}\n")),(0,l.kt)("h4",{id:"collections\u5de5\u5177\u7c7b-\u4e0d\u5e38\u7528"},"Collections\u5de5\u5177\u7c7b ","[\u4e0d\u5e38\u7528]"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Collections.synchronizedList(List<T> list)"),": \u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u96c6\u5408",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u8fd4\u56de\u7684\u96c6\u5408\u7ee7\u627f\u81ea SynchronizedCollection\uff0c\u5e76\u4e14\u96c6\u5408\u7684\u5927\u90e8\u5206\u65b9\u6cd5\u4f7f\u7528 Synchronized\u8fdb\u884c\u4e86\u5904\u7406"))))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * <b>\u4f7f\u7528Collections \u5de5\u5177\u7c7b\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u96c6\u5408</b>\n *\n * @author <a href=\"mailto:zhuyuliangm@gmail.com\">zyl</a>\n */\npublic class ThreadDemo3 {\n    public static void main(String[] args) {\n        // \u901a\u8fc7 Collections.synchronizedList \u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u96c6\u5408\n        List<String> names = Collections.synchronizedList(new ArrayList<>());\n\n        // \u521b\u5efa30\u4e2a\u7ebf\u7a0b\u64cd\u4f5c\u96c6\u5408\n        for (int i = 0; i < 30; i++) {\n            new Thread(() -> {\n                names.add(UUID.randomUUID().toString().substring(0,8));\n                System.out.println(names);\n            },String.valueOf('i')).start();\n        }\n    }\n}\n")),(0,l.kt)("h2",{id:"\u591a\u7ebf\u7a0b\u9501"},"\u591a\u7ebf\u7a0b\u9501"),(0,l.kt)("h3",{id:"\u516b\u9501\u95ee\u9898\u6f14\u793asynchronized"},"\u516b\u9501\u95ee\u9898\u6f14\u793a","[Synchronized]"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u521b\u5efa\u4e00\u4e2aPhone\u5bf9\u8c61\uff0c\u5305\u542b\u4e24\u4e2a\u540c\u6b65\u65b9\u6cd5 -> SendSMS\u3001SendEmail\uff0c\u8fd8\u6709\u4e00\u4e2a\u975e\u540c\u6b65\u65b9\u6cd5 getHello")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public synchronized void sendSMS () {\n        System.out.println("[Send SMS]");\n    }\n    public synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n\n}\n')),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u95ee\u98981: \u6807\u51c6\u64cd\u4f5c\uff0c\u5148\u6253\u5370\u8c01? -> ",(0,l.kt)("font",{color:"red"},"\u6309\u987a\u5e8f\u6253\u5370")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public synchronized void sendSMS () throws InterruptedException {\n        System.out.println("[Send SMS]");\n    }\n    public synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n    public static  void one () throws InterruptedException {\n        Phone phone = new Phone();\n        new Thread(() -> {\n            try {\n                phone.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone.sendEmail();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }\n    public static void main(String[] args) throws InterruptedException {\n        one ();\n    }\n}\n\n/*\n    [Send SMS]\n    [Send Email]\n*/\n')),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"\u505c 4 \u79d2\u5728\u77ed\u4fe1\u65b9\u6cd5\u5185\uff0c\u5148\u6253\u5370\u77ed\u4fe1\u8fd8\u662f\u90ae\u4ef6 -> ",(0,l.kt)("font",{color:"red"},"\u6309\u987a\u5e8f\u6253\u5370")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public synchronized void sendSMS () throws InterruptedException {\n        TimeUnit.SECONDS.sleep(4);\n        System.out.println("[Send SMS]");\n    }\n    public synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n\n    public static  void two () throws InterruptedException {\n        Phone phone = new Phone();\n        new Thread(() -> {\n            try {\n                phone.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone.sendEmail();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }   \n    public static void main(String[] args) throws InterruptedException {\n        three ();\n    }\n}\n\n/*\n  //\u963b\u585e4\u79d2\u540e\n    [Send SMS]\n    [Send Email]\n*/\n')),(0,l.kt)("ol",{start:3},(0,l.kt)("li",{parentName:"ol"},"\u505c4\u79d2\u5728\u77ed\u4fe1\u65b9\u6cd5\u5185,\u5148\u8c03\u7528\u666e\u901a\u7684 getHello \u65b9\u6cd5\uff0c\u662f\u5148\u6253\u77ed\u4fe1\u8fd8\u662f hello -> ",(0,l.kt)("font",{color:"red"},"\u5148\u6253\u5370hello")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public synchronized void sendSMS () throws InterruptedException {\n        TimeUnit.SECONDS.sleep(4);\n        System.out.println("[Send SMS]");\n    }\n    public synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n\n    public static  void three () throws InterruptedException {\n        Phone phone = new Phone();\n        new Thread(() -> {\n            try {\n                phone.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone.getHello();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }\n    public static void main(String[] args) throws InterruptedException {\n        three ();\n    }\n}\n\n/*\n[getHello]\n// \u963b\u585e4\u79d2\u540e\n[Send SMS]\n*/\n')),(0,l.kt)("ol",{start:4},(0,l.kt)("li",{parentName:"ol"},"\u73b0\u5728\u6709\u4e24\u90e8\u624b\u673a\uff0c\u505c4\u79d2\u5728\u77ed\u4fe1\u65b9\u6cd5\u5185,\u5148\u6253\u5370\u77ed\u4fe1\u8fd8\u662f\u90ae\u4ef6 -> ",(0,l.kt)("font",{color:"red"},"\u5148\u6253\u5370Email\u518d\u6253\u5370SMS")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public synchronized void sendSMS () throws InterruptedException {\n        TimeUnit.SECONDS.sleep(4);\n        System.out.println("[Send SMS]");\n    }\n    public synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n    public static  void four () throws InterruptedException {\n        Phone phone1 = new Phone();\n        Phone phone2 = new Phone();\n        new Thread(() -> {\n            try {\n                phone1.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone2.sendEmail();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }\n    public static void main(String[] args) throws InterruptedException {\n        four();\n    }\n}\n/*\n[Send Email]\n// \u963b\u585e4\u79d2\u540e\n[Send SMS]\n*/\n')),(0,l.kt)("ol",{start:5},(0,l.kt)("li",{parentName:"ol"},"\u5c06Email \u548cSMS \u6539\u4e3a\u9759\u6001\u540c\u6b65\u65b9\u6cd5\uff0c1 \u90e8\u624b\u673a\uff0c\u5148\u6253\u5370\u77ed\u4fe1\u8fd8\u662f\u90ae\u4ef6 -> ",(0,l.kt)("font",{color:"red"},"\u6309\u987a\u5e8f\u6253\u5370")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public static  synchronized void sendSMS () throws InterruptedException {\n         TimeUnit.SECONDS.sleep(4);\n        System.out.println("[Send SMS]");\n    }\n    public static synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n    public static  void five () throws InterruptedException {\n      Phone phone = new Phone();\n        new Thread(() -> {\n            try {\n                phone.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone.sendEmail();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }\n    public static void main(String[] args) throws InterruptedException {\n        five();\n    }\n}\n\n/*\n// \u963b\u585e4\u79d2\u540e\n[Send SMS]\n[Send Email]\n*/\n')),(0,l.kt)("ol",{start:6},(0,l.kt)("li",{parentName:"ol"},"\u5c06Email \u548cSMS \u6539\u4e3a\u9759\u6001\u540c\u6b65\u65b9\u6cd5\uff0c2 \u90e8\u624b\u673a\uff0c\u5148\u6253\u5370\u77ed\u4fe1\u8fd8\u662f\u90ae\u4ef6 -> ",(0,l.kt)("font",{color:"red"},"\u6309\u987a\u5e8f\u6253\u5370")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public static  synchronized void sendSMS () throws InterruptedException {\n         TimeUnit.SECONDS.sleep(4);\n        System.out.println("[Send SMS]");\n    }\n    public static synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n    public static  void five () throws InterruptedException {\n      Phone phone1 = new Phone();\n      Phone phone2 = new Phone();\n        new Thread(() -> {\n            try {\n                phone1.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone2.sendEmail();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }\n    public static void main(String[] args) throws InterruptedException {\n        five();\n    }\n}\n\n/*\n// \u963b\u585e4\u79d2\u540e\n[Send SMS]\n[Send Email]\n*/\n')),(0,l.kt)("ol",{start:7},(0,l.kt)("li",{parentName:"ol"},"\u5c06SMS\u8bbe\u7f6e\u4e3a\u9759\u6001\u540c\u6b65\u65b9\u6cd5\uff0cEmail \u8bbe\u7f6e\u4e3a\u666e\u901a\u540c\u6b65\u65b9\u6cd5\uff0c1\u90e8\u624b\u673a\uff0c \u5148\u6253\u5370\u77ed\u4fe1\u8fd8\u662f\u90ae\u4ef6 -> ",(0,l.kt)("font",{color:"red"},"\u5148\u6253\u5370Email\uff0c\u518d\u6253\u5370SMS")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public static  synchronized void sendSMS () throws InterruptedException {\n        TimeUnit.SECONDS.sleep(4);\n        System.out.println("[Send SMS]");\n    }\n    public synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n\n    public static  void seven () throws InterruptedException {\n        Phone phone = new Phone();\n        new Thread(() -> {\n            try {\n                phone.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone.sendEmail();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }\n    public static void main(String[] args) throws InterruptedException {\n        seven();\n    }\n}\n\n/*\n[Send Email]\n// \u963b\u585e4\u79d2\u540e\n[Send SMS]\n*/\n')),(0,l.kt)("ol",{start:8},(0,l.kt)("li",{parentName:"ol"},"\u5c06SMS\u8bbe\u7f6e\u4e3a\u9759\u6001\u540c\u6b65\u65b9\u6cd5\uff0cEmail \u8bbe\u7f6e\u4e3a\u666e\u901a\u540c\u6b65\u65b9\u6cd5\uff0c2\u90e8\u624b\u673a\uff0c \u5148\u6253\u5370\u77ed\u4fe1\u8fd8\u662f\u90ae\u4ef6 -> ",(0,l.kt)("font",{color:"red"},"\u5148\u6253\u5370Email\uff0c\u518d\u6253\u5370SMS")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class Phone {\n    public static  synchronized void sendSMS () throws InterruptedException {\n        TimeUnit.SECONDS.sleep(4);\n        System.out.println("[Send SMS]");\n    }\n    public synchronized void sendEmail () {\n        System.out.println("[Send Email]");\n    }\n    public void getHello() {\n        System.out.println("[getHello]");\n    }\n\n    public static  void seven () throws InterruptedException {\n        Phone phone1 = new Phone();\n        Phone phone2 = new Phone();\n        new Thread(() -> {\n            try {\n                phone1.sendSMS();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "A").start();\n        TimeUnit.MILLISECONDS.sleep(100);\n        new Thread(() -> {\n            try {\n                phone2.sendEmail();\n            }catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        }, "B").start();\n    }\n    public static void main(String[] args) throws InterruptedException {\n        seven();\n    }\n}\n\n/*\n[Send Email]\n// \u963b\u585e4\u79d2\u540e\n[Send SMS]\n*/\n')),(0,l.kt)("h4",{id:"\u516b\u9501\u7684\u603b\u7ed3"},"\u516b\u9501\u7684\u603b\u7ed3"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5bf9\u4e8e\u666e\u901a\u540c\u6b65\u65b9\u6cd5\uff0c\u9501\u662f\u5f53\u524d\u5b9e\u4f8b\u5bf9\u8c61"),(0,l.kt)("p",{parentName:"blockquote"},"\u5bf9\u4e8e\u9759\u6001\u540c\u6b65\u65b9\u6cd5\uff0c\u9501\u662f\u5f53\u524d\u7c7b\u7684 Class \u5bf9\u8c61"),(0,l.kt)("p",{parentName:"blockquote"},"\u5bf9\u4e8e\u540c\u6b65\u65b9\u6cd5\u5757\uff0c\u9501\u662f Synchonized \u62ec\u53f7\u91cc\u914d\u7f6e\u7684\u5bf9\u8c61")),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},"\u4e00\u4e2a\u5bf9\u8c61\u91cc\u9762\u5982\u679c\u6709\u591a\u4e2a synchronized \u65b9\u6cd5\uff0c\u67d0\u4e00\u4e2a\u65f6\u523b\u5185\uff0c\u53ea\u8981\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u8c03\u7528\u5176\u4e2d\u7684 \u4e00\u4e2a synchronized \u65b9\u6cd5\u4e86\uff0c \u5176\u5b83\u7684\u7ebf\u7a0b\u90fd\u53ea\u80fd\u7b49\u5f85",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5373\u67d0\u4e00\u4e2a\u65f6\u523b\u5185\uff0c\u53ea\u80fd\u6709\u552f\u4e00\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u8bbf\u95ee\u8fd9\u4e9b synchronized \u65b9\u6cd5"))),(0,l.kt)("li",{parentName:"ol"},"\u5982\u679c\u9501\u7684\u662f\u5f53\u524d\u5bf9\u8c61this\uff0c\u88ab\u9501\u5b9a\u540e\uff0c\u5176\u5b83\u7684\u7ebf\u7a0b\u90fd\u4e0d\u80fd\u8fdb\u5165\u5230\u5f53\u524d\u5bf9\u8c61\u7684\u5176\u5b83\u7684 synchronized \u65b9\u6cd5"),(0,l.kt)("li",{parentName:"ol"},"\u666e\u901a\u65b9\u6cd5\u548c\u540c\u6b65\u9501\u65e0\u5173"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("font",{color:"red"},"java \u4e2d\u7684\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u9501")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u8bd5\u56fe\u8bbf\u95ee\u540c\u6b65\u4ee3\u7801\u5757\u65f6\uff0c\u5b83\u9996\u5148\u5fc5\u987b\u5f97\u5230\u9501\uff0c\u9000\u51fa\u6216\u629b\u51fa\u5f02\u5e38\u65f6\u5fc5\u987b\u91ca\u653e\u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5373\u5982\u679c\u4e00\u4e2a\u5b9e\u4f8b\u5bf9\u8c61\u7684\u975e\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u83b7\u53d6\u9501\u540e\uff0c\u8be5\u5b9e\u4f8b\u5bf9\u8c61\u7684\u5176\u4ed6\u975e\u9759\u6001\u540c\u6b65\u65b9\u5fc5\u987b\u7b49\u5f85\u83b7\u53d6\u9501\u7684\u65b9\u6cd5\u91ca\u653e\u9501\u540e\u624d\u80fd\u83b7\u53d6\u9501\uff0c\u4f46\u662f\u522b\u7684\u5b9e\u4f8b\u5bf9\u8c61\u7684\u975e\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u56e0\u4e3a\u8ddf\u8be5\u5b9e\u4f8b\u5bf9\u8c61\u7684\u975e\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u7528\u7684\u662f\u4e0d\u540c\u7684\u9501\uff0c \u6240\u4ee5\u4e0d\u9700\u8981\u7b49\u5f85\u8be5\u5b9e\u4f8b\u5bf9\u8c61\u5df2\u83b7\u53d6\u9501\u7684\u975e\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u91ca\u653e\u9501\u5c31\u53ef\u4ee5\u83b7\u53d6\u4ed6\u4eec\u81ea\u5df1\u7684\u9501\u3002 "))),(0,l.kt)("li",{parentName:"ul"},"\u6240\u6709\u7684\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u7528\u7684\u4e5f\u662f\u540c\u4e00\u628a\u9501\u2014\u2014\u7c7b\u5bf9\u8c61\u672c\u8eab"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u548c\u975e\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u7684\u4e24\u628a\u9501\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u5bf9\u8c61 \uff0c\u6240\u4ee5\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u4e0e\u975e\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u4e4b\u95f4\u662f\u4e0d\u4f1a\u6709\u7ade\u6001\u6761\u4ef6\u7684"),"- \u4f46\u662f\u4e00\u65e6\u4e00\u4e2a\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u83b7\u53d6\u9501\u540e\uff0c\u5176\u4ed6\u7684\u9759\u6001\u540c\u6b65\u65b9\u6cd5\u90fd\u5fc5\u987b\u7b49\u5f85\u8be5\u65b9\u6cd5\u91ca\u653e\u9501\u540e\u624d\u80fd\u83b7\u53d6\u9501\uff0c\u800c\u4e0d\u7ba1\u662f\u5426\u540c\u4e00\u4e2a\u5b9e\u4f8b\u5bf9\u8c61\u7684\u9759\u6001\u540c\u6b65\u65b9\u6cd5\uff0c\u53ea\u8981\u5b83\u4eec\u540c\u4e00\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u5bf9\u8c61!")),(0,l.kt)("h3",{id:"\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501"},"\u516c\u5e73\u9501\u548c\u975e\u516c\u5e73\u9501"),(0,l.kt)("admonition",{title:"\u516c\u5e73\u9501\u4e0e\u975e\u516c\u5e73\u9501",type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"\u516c\u5e73\u9501: \u591a\u4e2a\u7ebf\u7a0b\u6309\u7167\u7533\u8bf7\u9501\u7684\u987a\u5e8f\u53bb\u83b7\u5f97\u9501\uff0c\u7ebf\u7a0b\u4f1a\u76f4\u63a5\u8fdb\u5165\u7b49\u5f85\u961f\u5217\u53bb\u6392\u961f\uff0c\u53ea\u6709\u7b49\u5f85\u961f\u5217\u91cc\u7684\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u83b7\u53d6\u5230\u9501"),(0,l.kt)("p",{parentName:"admonition"},"\u975e\u516c\u5e73\u9501: \u591a\u4e2a\u7ebf\u7a0b\u53bb\u83b7\u53d6\u9501\u7684\u65f6\u5019\uff0c\u4f1a\u76f4\u63a5\u53bb\u5c1d\u8bd5\u83b7\u53d6\uff0c\u83b7\u53d6\u4e0d\u5230\uff0c\u518d\u53bb\u8fdb\u5165\u7b49\u5f85\u961f\u5217\uff0c\u5982\u679c\u80fd\u83b7\u53d6\u5230\uff0c\u5c31\u76f4\u63a5\u83b7\u53d6\u5230\u9501")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u53ef\u91cd\u5165\u9501 ReentrantLock\u7684\u6784\u9020\u51fd\u6570: ",(0,l.kt)("inlineCode",{parentName:"p"},"ReentrantLock(boolean fair)")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"fair"),":\u662f\u5426\u662f\u516c\u5e73\u9501,\u9ed8\u8ba4\u662f\u975e\u516c\u5e73\u9501"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u4e24\u79cd\u9501\u7684\u4f18\u7f3a\u70b9:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u975e\u516c\u5e73\u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f18\u70b9\uff1a\u6267\u884c\u6548\u7387\u9ad8,\u53ef\u4ee5\u51cf\u5c11CPU\u5524\u9192\u7ebf\u7a0b\u7684\u5f00\u9500\uff0c\u6574\u4f53\u7684\u541e\u5410\u6548\u7387\u4f1a\u9ad8\u70b9\uff0cCPU\u4e5f\u4e0d\u5fc5\u53d6\u5524\u9192\u6240\u6709\u7ebf\u7a0b\uff0c\u4f1a\u51cf\u5c11\u5524\u8d77\u7ebf\u7a0b\u7684\u6570\u91cf"),(0,l.kt)("li",{parentName:"ul"},"\u7f3a\u70b9: \u53ef\u80fd\u5bfc\u81f4\u961f\u5217\u4e2d\u95f4\u7684\u7ebf\u7a0b\u4e00\u76f4\u83b7\u53d6\u4e0d\u5230\u9501\u6216\u8005\u957f\u65f6\u95f4\u83b7\u53d6\u4e0d\u5230\u9501\uff0c\u5bfc\u81f4\u5176\u4ed6\u7ebf\u7a0b\u997f\u6b7b"))),(0,l.kt)("li",{parentName:"ul"},"\u516c\u5e73\u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f18\u70b9: \u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u80fd\u5f97\u5230\u8d44\u6e90,\u90fd\u6709\u6267\u884c\u7684\u673a\u4f1a\uff0c\u4e0d\u4f1a\u997f\u6b7b\u5728\u961f\u5217\u4e2d"),(0,l.kt)("li",{parentName:"ul"},"\u7f3a\u70b9: \u541e\u5410\u91cf\u4f1a\u4e0b\u964d\u5f88\u591a\uff0c\u961f\u5217\u91cc\u9762\u9664\u4e86\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5176\u4ed6\u7684\u7ebf\u7a0b\u90fd\u4f1a\u963b\u585e\uff0ccpu\u5524\u9192\u963b\u585e\u7ebf\u7a0b\u7684\u5f00\u9500\u4f1a\u5f88\u5927")))))),(0,l.kt)("h4",{id:"\u533a\u5206\u516c\u5e73\u9501\u4e0e\u975e\u516c\u5e73\u9501"},"\u533a\u5206\u516c\u5e73\u9501\u4e0e\u975e\u516c\u5e73\u9501"),(0,l.kt)("h5",{id:"\u975e\u516c\u5e73\u9501\u7684\u5904\u7406"},"\u975e\u516c\u5e73\u9501\u7684\u5904\u7406"),(0,l.kt)("blockquote",null,(0,l.kt)("font",{color:"green"},"\u901a\u8fc7\u8f93\u51fa\u7ed3\u679c\u53ef\u4ee5\u770b\u5230\uff0c\u83b7\u53d6\u8fc7\u9501\u7684\u7ebf\u7a0b\u5728\u4e0b\u9762\u6709\u66f4\u5927\u7684\u51e0\u7387\u80fd\u518d\u6b21\u83b7\u53d6\u5230\u9501")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class SellTicketDemo {\n    public static int ticketNumber = 10;\n    /**\n     * \u975e\u516c\u5e73\u9501\n     */\n    public static final ReentrantLock NON_FAIR_LOCK = new ReentrantLock();\n\n\n    public static void nonFairLock(){\n        NON_FAIR_LOCK.lock();\n        try {\n            if (ticketNumber > 0) {\n                System.out.println("\u7ebf\u7a0b:" + Thread.currentThread().getName() + "\\t\u5356\u51fa:" + (ticketNumber --) + "\\t\u5269\u4f59:" + ticketNumber);\n            }\n        }finally {\n            NON_FAIR_LOCK.unlock();\n        }\n    }\n    public static void main(String[] args) {\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                nonFairLock();\n            }\n        },"\u552e\u7968\u54581").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                nonFairLock();\n            }\n        },"\u552e\u7968\u54582").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                nonFairLock();\n            }\n        },"\u552e\u7968\u54583").start();\n    }\n}\n\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(25168).Z,width:"254",height:"200"})),(0,l.kt)("h5",{id:"\u516c\u5e73\u9501\u7684\u5904\u7406"},"\u516c\u5e73\u9501\u7684\u5904\u7406"),(0,l.kt)("blockquote",null,(0,l.kt)("font",{color:"green"},"\u901a\u8fc7\u8f93\u51fa\u7ed3\u679c\u53ef\u4ee5\u770b\u5230\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u9501\u90fd\u662f\u968f\u673a\u7684")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class SellTicketDemo {\n    public static int ticketNumber = 10;\n    /**\n     * \u516c\u5e73\u9501\n     */\n    public static final ReentrantLock FAIR_LOCK = new ReentrantLock(true);\n    public static void fairLock(){\n        FAIR_LOCK.lock();\n        try {\n            if (ticketNumber > 0) {\n                System.out.println("\u7ebf\u7a0b:" + Thread.currentThread().getName() + "\\t\u5356\u51fa:" + (ticketNumber --) + "\\t\u5269\u4f59:" + ticketNumber);\n            }\n        }finally {\n            FAIR_LOCK.unlock();\n        }\n    }\n    public static void main(String[] args) {\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                fairLock();\n            }\n        },"\u552e\u7968\u54581").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                fairLock();\n            }\n        },"\u552e\u7968\u54582").start();\n        new Thread(() -> {\n            for (int i = 0; i < 100; i++) {\n                fairLock();\n            }\n        },"\u552e\u7968\u54583").start();\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(73824).Z,width:"254",height:"205"})),(0,l.kt)("h4",{id:"\u4e24\u79cd\u9501\u6e90\u7801"},"\u4e24\u79cd\u9501\u6e90\u7801"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4e24\u8005\u90fd\u7ee7\u627f\u81ea ",(0,l.kt)("inlineCode",{parentName:"li"},"Sync -> AbstractQueuedSynchronizer")),(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u7684\u53d8\u91cf",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"AbstractQueuedSynchronizer# state -> \u540c\u6b65\u72b6\u6001")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"AbstractQueuedSynchronizer# head ->  \u5ef6\u8fdf\u521d\u59cb\u5316\u7684\u7b49\u5f85\u961f\u5217\u5934\u3002\u9664\u4e86\u521d\u59cb\u5316\uff0c\u5b83\u53ea\u80fd\u901a\u8fc7\u65b9\u6cd5setHead\u8fdb\u884c\u4fee\u6539"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6ce8\u610f:\u5982\u679chead\u5b58\u5728\uff0c\u5b83\u7684waitStatus\u4fdd\u8bc1\u4e0d\u4f1a\u88abCANCELLED"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"AbstractQueuedSynchronizer# tail -> \u7b49\u5f85\u961f\u5217\u7684\u5c3e\u90e8\uff0c\u60f0\u6027\u521d\u59cb\u5316\u3002\u4ec5\u901a\u8fc7\u65b9\u6cd5enq\u4fee\u6539\u4ee5\u6dfb\u52a0\u65b0\u7684\u7b49\u5f85\u8282\u70b9"))))),(0,l.kt)("h5",{id:"\u975e\u516c\u5e73\u9501"},"\u975e\u516c\u5e73\u9501"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'static final class NonfairSync extends Sync {\n  private static final long serialVersionUID = 7316153563782823691L;\n\n  final void lock() {\n    // \u5982\u679c\u540c\u6b65\u72b6\u6001\u662f0\uff0c\u5c31\u5c06 \u540c\u6b65\u72b6\u6001\u4fee\u6539\u4e3a 1\uff0c\u8868\u793a\u9501\u88ab\u5360\u7528\n    if (compareAndSetState(0, 1))\n      // \u8bbe\u7f6e\u6392\u4ed6\u9501\uff0c\u5e76\u4e14\u66f4\u65b0\u540c\u6b65\u72b6\u6001state\u4e3a1\n      setExclusiveOwnerThread(Thread.currentThread());\n    else\n      acquire(1);\n  }\n  protected final boolean tryAcquire(int acquires) {\n    return nonfairTryAcquire(acquires);\n  }\n}\n\n // \n /**\n  * \u540c\u6b65\u72b6\u6001\n  */\n private volatile int state;\n    // AbstractQueuedSynchronizer\uff08AQS\uff09 \u72b6\u6001State\u7684CAS\u5904\u7406 -> \u53ea\u6709\u5f53\u524d\u540c\u6b65\u72b6\u6001state\u662f0 \u624d\u53ef\u4ee5\u8fdb\u884cswap\n protected final boolean compareAndSetState(int expect, int update) {\n   // stateOffset = unsafe.objectFieldOffset(AbstractQueuedSynchronizer.class.getDeclaredField("state"));\n   return unsafe.compareAndSwapInt(this, stateOffset, expect, update);\n }\n\n')),(0,l.kt)("h5",{id:"\u516c\u5e73\u9501"},"\u516c\u5e73\u9501"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'static final class FairSync extends Sync {\n  private static final long serialVersionUID = -3000897897090466540L;\n\n  final void lock() {\n    acquire(1);\n  }\n  \n  protected final boolean tryAcquire(int acquires) {\n    final Thread current = Thread.currentThread();\n    // \u5982\u679c\u540c\u6b65\u72b6\u6001\u662f0\uff0c\u53ef\u4ee5\u83b7\u53d6\u9501\n    int c = getState();\n    if (c == 0) {\n      // \u5224\u65ad\u81ea\u5df1\u662f\u4e0d\u662f\u961f\u5217\u7684\u7b2c\u4e00\u4e2a\n      if (!hasQueuedPredecessors() &&\n          compareAndSetState(0, acquires)) {\n        // \u8bbe\u7f6e\u6392\u4ed6\u9501\uff0c\u5e76\u4e14\u66f4\u65b0\u540c\u6b65\u72b6\u6001state\u4e3a1\n        setExclusiveOwnerThread(current);\n        return true;\n      }\n    }\n    // \u5982\u679c\u540c\u6b65\u72b6\u6001\u662f1\uff0c\u4e14\u5360\u7528\u6392\u4ed6\u9501\u662f\u6b63\u662f\u5f53\u524d\u7ebf\u7a0b\n    else if (current == getExclusiveOwnerThread()) {\n      int nextc = c + acquires;\n      if (nextc < 0)\n        throw new Error("Maximum lock count exceeded");\n      // \u4fee\u6539\u540c\u6b65\u72b6\u6001state\n      setState(nextc);\n      return true;\n    }\n    return false;\n  }\n}\n\n// \u5224\u65ad\u662f\u4e0d\u662f\u961f\u5217\u7684\u7b2c\u4e00\u4e2a\npublic final boolean hasQueuedPredecessors() {\n  Node t = tail; \n  Node h = head;\n  Node s;\n  // \u6ca1\u6709\u5934\u90e8\u8282\u70b9\n  return h != t &&\n    ((s = h.next) == null || s.thread != Thread.currentThread());\n}\n')),(0,l.kt)("h3",{id:"\u53ef\u91cd\u5165\u9501\u9012\u5f52\u9501"},"\u53ef\u91cd\u5165\u9501","[\u9012\u5f52\u9501]"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5141\u8bb8\u540c\u4e00\u4e2a\u7ebf\u7a0b\u591a\u6b21\u83b7\u53d6\u540c\u4e00\u628a\u9501,\xa0Lock(\u663e\u5f0f) \u548c Synchronized(\u9690\u5f0f) \u90fd\u662f\u53ef\u91cd\u5165\u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u91cd\u5165\u9501\u8bf4\u660e: \u9501\u7684\u64cd\u4f5c\u7c92\u5ea6\u662f\u201d\u7ebf\u7a0b\u201c\uff0c\u800c\u4e0d\u662f\u201c\u8c03\u7528\u201d")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"lock.getHoldCount()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u67e5\u770b\u9501\u7684\u6301\u6709\u8ba1\u6570,\u6bcf\u6b21\u8c03\u7528lock()\u65b9\u6cd5\u540e\uff0c\u8fd9\u4e2a\u8ba1\u6570\u5668\u4f1a\u52a01\uff0cunlock()\u65b9\u6cd5\u4f1a\u51cf1\uff0c\u53d8\u4e3a0\u5c31\u8bf4\u660e\u91ca\u653e\u4e86\u9501")))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4f7f\u7528Synchronized\u7684\u53ef\u91cd\u5165\u9501")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class RetranDemo {\n  // \u53ef\u4ee5\u9012\u5f52\u8c03\u7528\uff0c\u8bf4\u660e\u4e86\u83b7\u53d6\u5230\u9501\u540e\uff0c\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8c03\u7528\u52a0\u9501\u7684\u540c\u6b65\u65b9\u6cd5\n   public synchronized  void add() {\n        add();\n    }\n    public static void main(String[] args) {\n        Object obj= new Object();\n        new Thread(() -> {\n            synchronized (obj) {\n                    System.out.println("outline:" + Thread.currentThread().getName());\n                synchronized (obj) {\n                    System.out.println("inline:" + Thread.currentThread().getName());\n                }\n            }\n        }, "t1").start();\n    }\n}\n\n/*\noutline:t1\ninline:t1\n*/\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4f7f\u7528Lock\u7684\u53ef\u91cd\u5165\u9501")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class RetranDemo2 {\n    public static final ReentrantLock lock = new ReentrantLock();\n    public static void main(String[] args) {\n        new Thread(() -> {\n            try {\n                lock.lock();\n                System.out.println("\u5916\u5c42:" + Thread.currentThread().getName());\n                try {\n                    lock.lock();\n                    System.out.println("\u91cc\u5c42:" + Thread.currentThread().getName());\n                }finally {\n                    lock.unlock();\n                }\n            }finally {\n                lock.unlock();\n            }\n        },"Demo").start();\n    }\n}\n\n/*\n    \u5916\u5c42:Demo\n    \u91cc\u5c42:Demo\n*/\n')),(0,l.kt)("h3",{id:"\u6b7b\u9501"},"\u6b7b\u9501"),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6b7b\u9501: ",(0,l.kt)("font",{color:"red"},"\u4e24\u4e2a\u6216\u66f4\u591a\u7ebf\u7a0b\u963b\u585e\u7740\u7b49\u5f85\u5176\u5b83\u5904\u4e8e\u6b7b\u9501\u72b6\u6001\u7684\u7ebf\u7a0b\u91ca\u653e\u6240\u6301\u6709\u7684\u9501\u3002\u6b7b\u9501\u901a\u5e38\u53d1\u751f\u5728\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u4f46\u4ee5\u4e0d\u540c\u7684\u987a\u5e8f\u8bf7\u6c42\u540c\u4e00\u7ec4\u9501\u7684\u65f6\u5019"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6b7b\u9501\u7684\u56db\u4e2a\u4ea7\u751f\u6761\u4ef6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e92\u65a5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8d44\u6e90\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u4f7f\u7528(\u5360\u6709)\u65f6\uff0c\u522b\u7684\u7ebf\u7a0b\u4e0d\u80fd\u4f7f\u7528"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u53ef\u62a2\u5360"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8d44\u6e90\u8bf7\u6c42\u8005\u4e0d\u80fd\u5f3a\u5236\u4ece\u8d44\u6e90\u5360\u6709\u8005\u624b\u4e2d\u593a\u53d6\u8d44\u6e90\uff0c\u8d44\u6e90\u53ea\u80fd\u7531\u8d44\u6e90\u5360\u6709\u8005\u4e3b\u52a8\u91ca\u653e"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u8bf7\u6c42\u548c\u4fdd\u6301"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8d44\u6e90\u8bf7\u6c42\u8005\u5728\u8bf7\u6c42\u5176\u4ed6\u7684\u8d44\u6e90\u7684\u540c\u65f6\uff0c\u4fdd\u6301\u5bf9\u539f\u6709\u8d44\u6e90\u7684\u5360\u6709"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u5faa\u73af\u7b49\u5f85"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5b58\u5728\u4e00\u4e2a\u7b49\u5f85\u961f\u5217\uff1aP1\u5360\u6709P2\u7684\u8d44\u6e90\uff0cP2\u5360\u6709P3\u7684\u8d44\u6e90\uff0cP3\u5360\u6709P1\u7684\u8d44\u6e90\u3002\u8fd9\u6837\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u7b49\u5f85\u73af\u8def"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4ea7\u751f\u6b7b\u9501\u7684\u51e0\u4e2a\u5e38\u89c1\u7684\u539f\u56e0"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7cfb\u7edf\u8d44\u6e90\u4e0d\u8db3"),(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u8fd0\u884c\u987a\u5e8f\u4e0d\u5408\u9002"),(0,l.kt)("li",{parentName:"ul"},"\u8d44\u6e90\u5206\u914d\u4e0d\u5f53"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u907f\u514d\u6b7b\u9501\u7684\u51e0\u4e2a\u5e38\u89c1\u65b9\u6cd5\uff1a"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u907f\u514d\u4e00\u4e2a\u7ebf\u7a0b\u540c\u65f6\u83b7\u53d6\u591a\u4e2a\u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u907f\u514d\u4e00\u4e2a\u7ebf\u7a0b\u5728\u9501\u5185\u540c\u65f6\u5360\u7528\u591a\u4e2a\u8d44\u6e90\uff0c\u5c3d\u91cf\u4e00\u4e2a\u9501\u53ea\u64cd\u4f5c\u4e00\u4e2a\u8d44\u6e90")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5c1d\u8bd5\u4f7f\u7528\u5b9a\u65f6\u9501\uff0c \u4f7f\u7528lock.tryLock(timeout) \u6765\u4ee3\u66ff\u5185\u90e8\u9501\u673a\u5236")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5bf9\u4e8e\u6570\u636e\u5e93\u7684\u9501\uff0c\u52a0\u9501\u548c\u89e3\u9501\u5fc5\u987b\u5728\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u4e2d\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u6b7b\u9501")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9a8c\u8bc1\u662f\u5426\u6b7b\u9501"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"jps")," -> ",(0,l.kt)("inlineCode",{parentName:"li"},"jstack")))))),(0,l.kt)("h4",{id:"\u4ee3\u7801\u6f14\u793a\u6b7b\u9501"},"\u4ee3\u7801\u6f14\u793a\u6b7b\u9501"),(0,l.kt)("p",null,"\u7531\u4e8eA\u7ebf\u7a0b\u4e2d\u83b7\u53d6\u4e86A\u9501\u540e\uff0c\u8fd8\u60f3\u83b7\u53d6B\u9501;B\u7ebf\u7a0b\u4e2d\u83b7\u53d6\u4e86B\u9501\u540e\uff0c\u8fd8\u60f3\u83b7\u53d6A\u9501;\u4e24\u4e2a\u7ebf\u7a0b\u76f8\u4e92\u7b49\u5f85"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class DemoLockDemo {\n    private static final Lock lock_A = new ReentrantLock();\n    private static final Lock lock_B = new ReentrantLock();\n    public static void main(String[] args) {\n        new Thread(() -> {\n            try {\n                // \u9501 lock_A\u52a0\u9501\n                lock_A.lock();\n                System.out.println("\u5f53\u524d\u7ebf\u7a0b:"+ Thread.currentThread().getName());\n                // \u7ebf\u7a0bsleep 5s\n                TimeUnit.SECONDS.sleep(5);\n                try {\n                    // \u9501 lock_B \u52a0\u9501\n                    lock_B.lock();\n                }finally {\n                    lock_B.unlock();\n                }\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            } finally {\n                // \u91ca\u653eA\u9501\n                lock_A.unlock();\n            }\n        },"Thread-A").start();\n        new Thread(() -> {\n            try {\n                // \u9501 lock_B\u52a0\u9501\n                lock_B.lock();\n                System.out.println("\u5f53\u524d\u7ebf\u7a0b:"+ Thread.currentThread().getName());\n                // \u7ebf\u7a0bsleep 5s\n                try {\n                    // \u9501 lock_A \u52a0\u9501\n                    lock_A.lock();\n                }finally {\n                    lock_A.unlock();\n                }\n            } finally {\n                // \u91ca\u653eB\u9501\n                lock_B.unlock();\n            }\n        },"Thread-B").start();\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(87649).Z,width:"1165",height:"719"})),(0,l.kt)("h2",{id:"callable--futuretask"},"Callable & FutureTask"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u4e00\u822c\u901a\u8fc7\u521b\u5efaThread\u7c7b\u3001 \u5b9e\u73b0Runable \u63a5\u53e3\u521b\u5efa\u7ebf\u7a0b\uff0c\u4f46\u662f Runable \u5728\u7ebf\u7a0b\u7ec8\u6b62\u65f6\uff0c\u65e0\u6cd5\u8ba9\u7ebf\u7a0b\u8fd4\u56de\u7ed3\u679c -> Callable\u53ef\u4ee5\u5b9e\u73b0")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Callable \u63a5\u53e3\u7684\u7279\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9700\u8981\u5b9e\u73b0\u5728\u5b8c\u6210\u65f6\u8fd4\u56de\u7ed3\u679c\u7684 call()\u65b9\u6cd5"),(0,l.kt)("li",{parentName:"ul"},"call() \u53ef\u4ee5\u8fd4\u56de\u5f02\u5e38\uff0c\u4f46\u662fRunnable\u7684run\u65b9\u6cd5\u4e0d\u5c05"),(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u76f4\u63a5\u66ff\u6362 Runnable,\u56e0\u4e3a Thread \u7c7b\u7684\u6784\u9020\u65b9\u6cd5\u6839\u672c\u6ca1\u6709 Callable"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5982\u4f55\u4f7f\u7528Callable"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"FutureTask"),"\u53ef\u4ee5\u5bf9 Runnable\u3001Callable\u63a5\u53e3\u8fdb\u884c\u5305\u88c5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"task.isDone()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4efb\u52a1\u5b8c\u6210\uff0c\u5219\u8fd4\u56de true\uff0c\u5426\u5219\u8fd4\u56de false"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"task.get()"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u83b7\u53d6call()\u65b9\u6cd5\u8fd4\u56de\u7684\u7ed3\u679c")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"cancel()"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"FutureTask \u7684\u57fa\u672c\u539f\u7406"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u9700\u8981\u6267\u884c\u6bd4\u8f83\u8017\u65f6\u7684\u64cd\u4f5c\u65f6\uff0c\u4f46\u53c8\u4e0d\u60f3\u963b\u585e\u4e3b\u7ebf\u7a0b\u65f6\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e9b \u4f5c\u4e1a\u4ea4\u7ed9 ",(0,l.kt)("inlineCode",{parentName:"li"},"Future \u5bf9\u8c61\u5728\u540e\u53f0\u5b8c\u6210"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5f53\u4e3b\u7ebf\u7a0b\u5c06\u6765\u9700\u8981\u65f6\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7 Future \u5bf9\u8c61\u83b7\u5f97\u540e\u53f0\u4f5c\u4e1a\u7684\u8ba1\u7b97\u7ed3\u679c\u6216\u8005\u6267\u884c\u72b6\u6001"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"FutureTask \u7279\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u4e00\u822c FutureTask \u591a\u7528\u4e8e\u8017\u65f6\u7684\u8ba1\u7b97\uff0c\u4e3b\u7ebf\u7a0b\u53ef\u4ee5\u5728\u5b8c\u6210\u81ea\u5df1\u7684\u4efb\u52a1\u540e\uff0c\u518d\u53bb\u83b7\u53d6\u7ed3\u679c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"blue"}," \u4ec5\u5728\u8ba1\u7b97\u5b8c\u6210\u65f6\u624d\u80fd\u68c0\u7d22\u7ed3\u679c\u3002\u5982\u679c\u8ba1\u7b97\u5c1a\u672a\u5b8c\u6210\uff0c\u5219\u963b\u585eget()\u65b9\u6cd5")),(0,l.kt)("li",{parentName:"ul"},"\u4e00\u65e6\u8ba1\u7b97\u5b8c\u6210\uff0c\u5c31\u4e0d\u80fd\u518d\u91cd\u65b0\u5f00\u59cb\u6216\u53d6\u6d88\u8ba1\u7b97"),(0,l.kt)("li",{parentName:"ul"},"get() \u800c\u83b7\u53d6\u7ed3\u679c\u53ea\u6709\u5728\u8ba1\u7b97\u5b8c\u6210\u65f6\u83b7\u53d6\uff0c\u5426\u5219\u4f1a\u4e00\u76f4\u963b\u585e\u76f4\u5230\u4efb\u52a1\u8f6c\u5165\u5b8c\u6210\u72b6\u6001\uff0c\u7136\u540e\u4f1a\u8fd4\u56de\u7ed3\u679c\u6216\u8005\u629b\u51fa\u5f02\u5e38"),(0,l.kt)("li",{parentName:"ul"},"get()\u53ea\u8ba1\u7b97\u4e00\u6b21,\u56e0\u6b64 get \u65b9\u6cd5\u653e\u5230\u6700\u540e")))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CallableDemo {\n    public static void main(String[] args) throws Exception {\n        // \u4f7f\u7528 FutureTask\n        FutureTask<Date> task = new FutureTask<>(() -> {\n            TimeUnit.SECONDS.sleep(4);\n            return new Date();\n        });\n        // \u521b\u5efaThread \u7ebf\u7a0b\n        new Thread(task, "Thread-A").start();\n\n        System.out.println("~~~~~~");\n        // \u8ba9\u4e3b\u7ebf\u7a0b\u5904\u7406\u5176\u4ed6\u4efb\u52a1,\u8fd9\u91cc\u5047\u8bbe\u8017\u65f6\u4e3a4s\n        TimeUnit.SECONDS.sleep(4);\n        // task\u6267\u884c\u9700\u89814s,\u6240\u4ee5\u83b7\u53d6 task \u6267\u884c\u7ed3\u679c \u6b64\u65f6\u80fd\u7acb\u5373\u83b7\u53d6\u5230\n        System.out.println(task.get());\n    }\n}\n')),(0,l.kt)("h2",{id:"juc-\u8f85\u52a9\u7c7b"},"JUC \u8f85\u52a9\u7c7b"),(0,l.kt)("p",null,"JUC \u4e2d\u63d0\u4f9b\u4e86\u4e09\u79cd\u5e38\u7528\u7684\u8f85\u52a9\u7c7b\uff0c\u901a\u8fc7\u8fd9\u4e9b\u8f85\u52a9\u7c7b\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u7ebf\u7a0b\u6570\u91cf\u8fc7 \u591a\u65f6 Lock \u9501\u7684\u9891\u7e41\u64cd\u4f5c\u3002\u8fd9\u4e09\u79cd\u8f85\u52a9\u7c7b\u4e3a:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CountDownLatch")," : \u51cf\u5c11\u8ba1\u6570"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CyclicBarrier "),": \u5faa\u73af\u6805\u680f"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Semaphore")," : \u4fe1\u53f7\u91cf")),(0,l.kt)("h3",{id:"countdownlatch"},"CountDownLatch"),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"CountDownLatch \u7c7b\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u7136\u540e\u901a\u8fc7 countDown() \u65b9\u6cd5\u6765\u8fdb\u884c \u51cf 1 \u7684\u64cd\u4f5c\uff0c\u4f7f\u7528 await \u65b9\u6cd5\u7b49\u5f85\u8ba1\u6570\u5668\u4e0d\u5927\u4e8e 0\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884c await \u65b9\u6cd5 \u4e4b\u540e\u7684\u8bed\u53e5",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"CountDownLatch \u4e3b\u8981\u6709\u4e24\u4e2a\u65b9\u6cd5\uff0c\u5f53\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7ebf\u7a0b\u8c03\u7528await() \u65b9\u6cd5\u65f6\uff0c\u8fd9\u4e9b\u7ebf\u7a0b\u4f1a\u963b\u585e"),(0,l.kt)("li",{parentName:"ul"},"\u5176\u5b83\u7ebf\u7a0b\u8c03\u7528 countDown() \u65b9\u6cd5\u4f1a\u5c06\u8ba1\u6570\u5668\u51cf 1",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u8c03\u7528 countDown() \u65b9\u6cd5\u7684\u7ebf\u7a0b \u4e0d\u4f1a\u963b\u585e")))),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8ba1\u6570\u5668\u7684\u503c\u53d8\u4e3a 0 \u65f6\uff0c\u56e0 await() \u65b9\u6cd5\u963b\u585e\u7684\u7ebf\u7a0b\u4f1a\u88ab\u5524\u9192\uff0c\u7ee7\u7eed\u6267\u884c"))))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u7279\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728\u5b8c\u6210\u4e00\u7ec4\u6b63\u5728\u5176\u4ed6\u7ebf\u7a0b\u4e2d\u6267\u884c\u7684\u64cd\u4f5c\u4e4b\u524d\uff0c\u5b83\u5141\u8bb8\u4e00\u4e2a\u6216\u591a\u4e2a\u7ebf\u7a0b\u4e00\u76f4\u7b49\u5f85")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u7528\u7ed9\u5b9a\u7684\u8ba1\u6570\u521d\u59cb\u5316 CountDownLatch\u7531\u4e8e\u8c03\u7528\u4e86 countDown() \u65b9\u6cd5\uff0c\u6240\u4ee5\u5728\u5f53\u524d\u8ba1\u6570\u5230\u8fbe\u96f6\u4e4b\u524d\uff0cawait() \u65b9\u6cd5\u4f1a\u4e00\u76f4\u53d7\u963b\u585e\u3002\u4e4b\u540e\u4f1a\u91ca\u653e\u6240\u6709\u7b49\u5f85\u7684\u7ebf\u7a0b\uff0cawait \u7684\u6240\u6709\u540e\u7eed\u8c03\u7528\u90fd\u5c06\u7acb\u5373\u8fd4\u56de"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fd9\u79cd\u73b0\u8c61\u53ea\u51fa\u73b0\u4e00\u6b21\u2014\u2014\u8ba1\u6570\u65e0\u6cd5\u88ab\u91cd\u7f6e\u3002\u5982\u679c\u9700\u8981\u91cd\u7f6e\u8ba1\u6570\uff0c\u8bf7\u8003\u8651\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"CyclicBarrier"),"\u3002"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5e38\u7528\u7684\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CountDownLatch(int count)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6784\u9020\u4e00\u4e2a\u7528\u7ed9\u5b9a\u8ba1\u6570\u521d\u59cb\u5316\u7684 CountDownLatch"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"await([long time,TimeUnit unit])"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u5f53\u524d\u7ebf\u7a0b\u5728\u9501\u5b58\u5668\u5012\u8ba1\u6570\u81f30\u4e4b\u524d\u4e00\u76f4\u7b49\u5f85\uff0c\u9664\u975e\u7ebf\u7a0b\u88ab\u4e2d\u65ad\u6216\u8d85\u51fa\u4e86\u6307\u5b9a\u7684\u7b49\u5f85\u65f6\u95f4"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"countDown()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9012\u51cf\u9501\u5b58\u5668\u7684\u8ba1\u6570",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u8ba1\u6570\u5230\u8fbe\u96f6\uff0c\u5219\u91ca\u653e\u6240\u6709\u7b49\u5f85\u7684\u7ebf\u7a0b"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5f53\u524d\u8ba1\u6570\u7b49\u4e8e\u96f6\uff0c\u5219\u4e0d\u53d1\u751f\u4efb\u4f55\u64cd\u4f5c"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"getCount()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u5f53\u524d\u8ba1\u6570"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4f7f\u7528\u573a\u666f\uff1a \u67d0\u4e2a\u7ebf\u7a0b\u9700\u8981\u7b49\u5f85\u5176\u4ed6\u7ebf\u7a0b\u5904\u7406\u5b8c\u6210\u4e4b\u540e\u518d\u7ee7\u7eed\u6267\u884c"))),(0,l.kt)("h4",{id:"\u4ee3\u7801\u793a\u4f8b"},"\u4ee3\u7801\u793a\u4f8b"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u9700\u6c42\uff1a 6\u4e2a\u540c\u5b66\u9646\u7eed\u79bb\u5f00\u6559\u5ba4\u540e\u503c\u73ed\u540c\u5b66\u624d\u53ef\u4ee5\u5173\u95e8")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CountDownLatchDemo {\n    public static CountDownLatch countDownLatch = new CountDownLatch(6);\n    public static void main(String[] args) throws InterruptedException {\n        System.out.println("\u73b0\u5728\u7684\u8ba1\u6570\u5668\u4e3a:" + countDownLatch.getCount());\n        // \u521b\u5efa6\u4e2a\u7ebf\u7a0b\n        for (int i = 1; i <= 6; i++) {\n            new Thread(() -> {\n                    try {\n                        if (Thread.currentThread().getName().equals("Thread6")) {\n                            Thread.sleep(2000);\n                        }\n                        // \u6bcf\u4e2a\u7ebf\u7a0b\u5904\u7406\u5b8c\u90fd\u5c06\u8ba1\u6570\u5668\u51cf1,\u4e0d\u4f1a\u963b\u585e\u7ebf\u7a0b\n                        countDownLatch.countDown();\n                        System.out.println(Thread.currentThread().getName() + "\u79bb\u5f00\u4e86");\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n            },"Thread"+i).start();\n        }\n        // \u4e3b\u7ebf\u7a0b\u7b49\u5f85\n        countDownLatch.await();\n        // \u5f53countDownLatch\u7684\u8ba1\u6570=0,\u7ee7\u7eed\u540e\u7eed\u5904\u7406\n        System.out.println("\u73b0\u5728\u7684\u8ba1\u6570\u5668\u4e3a:" + countDownLatch.getCount());\n    }\n}\n\n/*\n    \u73b0\u5728\u7684\u8ba1\u6570\u5668\u4e3a6\n  Thread1\u79bb\u5f00\u4e86\n  Thread2\u79bb\u5f00\u4e86\n  Thread3\u79bb\u5f00\u4e86\n  Thread4\u79bb\u5f00\u4e86\n  Thread5\u79bb\u5f00\u4e86\n  Thread6\u79bb\u5f00\u4e86\n  \u73b0\u5728\u7684\u8ba1\u6570\u5668\u4e3a0\n\n*/\n')),(0,l.kt)("h3",{id:"cyclicbarrier---\u540c\u6b65\u6805\u680f"},"CyclicBarrier - \u540c\u6b65\u6805\u680f"),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5141\u8bb8\u4e00\u7ec4\u7ebf\u7a0b\u4e92\u76f8\u7b49\u5f85\uff0c\u76f4\u5230\u6240\u6709\u7ebf\u7a0b\u90fd\u5230\u8fbe\u516c\u5171\u6805\u680f\u70b9 (\u540c\u6b65\u70b9)\uff0c\u5c4f\u969c\u624d\u4f1a\u6253\u5f00\uff0c\u6240\u6709\u88ab\u5c4f\u969c\u62e6\u622a\u7684\u7ebf\u7a0b\u624d\u4f1a\u7ee7\u7eed\u6267\u884c\xa0"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5c4f\u969c\u6253\u5f00\u540e\u4f1a\u901a\u8fc7notify\u901a\u77e5\u7684\u65b9\u5f0f\u5524\u9192\u7b49\u5f85\u7684\u7ebf\u7a0b\u7ee7\u7eed\u540e\u7eed\u7684\u5904\u7406"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u6d89\u53ca\u4e00\u7ec4\u56fa\u5b9a\u5927\u5c0f\u7684\u7ebf\u7a0b\u7684\u7a0b\u5e8f\u4e2d\uff0c\u8fd9\u4e9b\u7ebf\u7a0b\u5fc5\u987b\u4e0d\u65f6\u5730\u4e92\u76f8\u7b49\u5f85\u3002\u56e0\u4e3a\u8be5 barrier \u5728\u91ca\u653e\u7b49\u5f85\u7ebf\u7a0b\u540e\u53ef\u4ee5\u91cd\u7528\uff0c\u6240\u4ee5\u79f0\u5b83\u4e3a",(0,l.kt)("strong",{parentName:"li"},"\u5faa\u73af\u7684barrier")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"CyclicBarrier \u652f\u6301\u4e00\u4e2a\u53ef\u9009\u7684 Runnable \u547d\u4ee4\uff0c\u5728\u4e00\u7ec4\u7ebf\u7a0b\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u7ebf\u7a0b\u5230\u8fbe\u4e4b\u540e\uff08\u4f46\u5728\u91ca\u653e\u6240\u6709\u7ebf\u7a0b\u4e4b\u524d\uff09\uff0c\u8be5\u547d\u4ee4\u53ea\u5728\u6bcf\u4e2a\u5c4f\u969c\u70b9\u8fd0\u884c\u4e00\u6b21")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"CyclicBarrier \u76f8\u5bf9\u4e8eCountDownLatch\u662f\u53ef\u91cd\u7f6e\u7684,\u800c\u4e14\u652f\u6301\u6700\u540e\u4e00\u4e2a\u7ebf\u7a0b\u5230\u8fbe\u540e\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406 -> \u6b64\u65f6\u6240\u6709\u7ebf\u7a0b\u6ca1\u6709\u91ca\u653e\uff0c\u8fd8\u5904\u4e8eawait\u7b49\u5f85\u72b6\u6001")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5e38\u89c1\u7684\u65b9\u6cd5",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CyclicBarrier(int parties, [Runnable barrierAction])"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"parties:  \u5728\u542f\u52a8 barrier \u524d\u5fc5\u987b\u8c03\u7528 await() \u7684\u7ebf\u7a0b\u6570"),(0,l.kt)("li",{parentName:"ul"},"barrierAction: \u5728\u542f\u52a8 barrier \u65f6\u6267\u884c\u7684\u547d\u4ee4\uff1b\u5982\u679c\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\uff0c\u5219\u8be5\u53c2\u6570\u4e3a null"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"await([long timeout, TimeUnit unit])"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5728\u6240\u6709\u53c2\u4e0e\u8005\u90fd\u5df2\u7ecf\u5728\u6b64\u5c4f\u969c\u4e0a\u8c03\u7528 await() \u65b9\u6cd5\u4e4b\u524d\u5c06\u4e00\u76f4\u7b49\u5f85,\u6216\u8005\u8d85\u51fa\u4e86\u6307\u5b9a\u7684\u7b49\u5f85\u65f6\u95f4"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"getNumberWaiting()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u5f53\u524d\u5728\u5c4f\u969c\u5904\u7b49\u5f85\u7684\u53c2\u4e0e\u8005\u6570\u76ee"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"getParties()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u8981\u6c42\u542f\u52a8\u6b64 barrier \u7684\u53c2\u4e0e\u8005\u6570\u76ee"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"isBroken()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u67e5\u8be2\u6b64\u5c4f\u969c\u662f\u5426\u5904\u4e8e\u635f\u574f\u72b6\u6001"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"reset()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5c06\u5c4f\u969c\u91cd\u7f6e\u4e3a\u5176\u521d\u59cb\u72b6\u6001 -> \u4e00\u6279\u7ebf\u7a0b\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u6253\u5f00\u5c4f\u969c\u3002\u7136\u540e\u53e6\u5916\u4e00\u6279\u7ebf\u7a0b\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u6253\u5f00\u5c4f\u969c\uff0c\u5f80\u590d\u5faa\u73af"))))),(0,l.kt)("li",{parentName:"ul"},"\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u666f",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u591a\u7ebf\u7a0b\u8ba1\u7b97\u6570\u636e\uff0c\u6700\u540e\u5408\u5e76\u8ba1\u7b97\u7ed3\u679c\uff0c\u5728\u6240\u6709\u7ebf\u7a0b\u8ba1\u7b97\u6570\u636e\u5b8c\u6210\u540e\u8c03\u7528awit()\u65b9\u6cd5")))),(0,l.kt)("h4",{id:"\u4ee3\u7801\u5b9e\u73b0"},"\u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CyclicBarrierDemo {\n    // \u521b\u5efa\u56fa\u5b9a\u503c\n    private static final  int NUM = 3;\n    // \u521b\u5efa CyclicBarrier \u5faa\u73af\u6805\u680f\n    private static  CyclicBarrier cyclicBarrier = new CyclicBarrier(NUM, () -> {\n        // runnable \u7684\u5b9e\u73b0\n        System.out.println(Thread.currentThread().getName() + "\u5b8c\u6210\u4e86\u6700\u540e\u7684\u5904\u7406...");\n    });\n    public static void main(String[] args) {\n        // \u521b\u5efa3\u4e2a\u7ebf\u7a0b\u505a\u4e1a\u52a1\u5904\u7406\n        for (int i = 1; i <= 3 ; i++) {\n            new Thread(() -> {\n                try {\n                    String tName = Thread.currentThread().getName();\n                    System.out.println(tName + "\u5904\u7406\u4e2d...");\n                    // \u83b7\u53d6\u5f53\u524d\u5728\u5c4f\u969c\u5904\u7b49\u5f85\u7684\u7ebf\u7a0b\u6570\n                    System.out.println("[" + tName + "]: \u5f53\u524d\u6709"+cyclicBarrier.getNumberWaiting()+"\u4e2a\u7ebf\u7a0b\u5728CyclicBarrier\u7684\u5c4f\u969c\u5904\u7b49\u5f85,\u4e00\u5171\u6709"+cyclicBarrier.getParties()+"\u4e2a");\n\n                    // \u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u9700\u8981\u4f7f\u7528cyclicBarrier.await() ,cyclicBarrier\u4f1a\u62e6\u622a\u7ebf\u7a0b\u6267\u884cawait \u540e\u7eed\u7684\u5904\u7406\n                    cyclicBarrier.await();\n\n                    System.out.println("[" + tName + "]: \u5f53\u524d\u6709"+cyclicBarrier.getNumberWaiting()+"\u4e2a\u7ebf\u7a0b\u5728CyclicBarrier\u7684\u5c4f\u969c\u5904\u7b49\u5f85,\u4e00\u5171\u6709"+cyclicBarrier.getParties()+"\u4e2a");\n\n                    // \u6bcf\u4e2a\u7ebf\u7a0b\u5728 CyclicBarrier \u5c4f\u969c\u7834\u635f\u540e,\u4f1a\u6267\u884cawait() \u540e\u7eed\u7684\u5904\u7406\n                    System.out.println(Thread.currentThread().getName() + "\u5904\u7406\u5b8c\u4e86...");\n                    // CyclicBarrier\u53ef\u4ee5\u91cd\u7f6e\u72b6\u6001\n                    // cyclicBarrier.reset();\n                }catch (Exception ex) {\n                    ex.printStackTrace();\n                }\n            }, "\u7ebf\u7a0b"+i).start();\n        }\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(78795).Z,width:"548",height:"266"})),(0,l.kt)("h4",{id:"\u5206\u6b65\u8ba1\u7b97\u6570\u636e"},"\u5206\u6b65\u8ba1\u7b97\u6570\u636e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CalDataDemo implements Runnable {\n    // \u5b58\u50a8\u8ba1\u7b97\u5f97\u5230\u7684\u6570\u636e\n    public static ConcurrentHashMap<String,Integer> dataMap = new ConcurrentHashMap<>();\n\n    // \u5c06\u6570\u636e\u8ba1\u7b97\u5206\u4e3a4\u4e2a\u7ebf\u7a0b\n    public  CyclicBarrier cyclicBarrier = new CyclicBarrier(4, this);\n\n    @Override\n    public void run() {\n        int res = 0;\n        // \u5bf9\u5b58\u50a8\u8ba1\u7b97\u5f97\u5230\u7684\u6570\u636e data\u8fdb\u884c\u5408\u5e76\u8ba1\u7b97\n        for(Map.Entry<String,Integer> data: dataMap.entrySet()) {\n            System.out.println(data.getValue());\n            res += data.getValue();\n        }\n        System.out.println("\u8ba1\u7b97\u7ed3\u679c\u4e3a:" + res);\n    }\n\n    public static void main(String[] args) {\n        CalDataDemo calDataDemo = new CalDataDemo();\n        // \u521b\u5efa4 \u4e2a\u7ebf\u7a0b\n        for (int i = 0; i < 4; i++) {\n            new Thread(() -> {\n                try {\n                    dataMap.put(Thread.currentThread().getName(), new Random().nextInt(10));\n                    // \u8ba1\u7b97\u5b8c\u6210\u540e,\u8c03\u7528await(),\u7b49\u5f85\u5176\u4ed6\u7ebf\u7a0b\u5b8c\u6210\n                    calDataDemo.cyclicBarrier.await();\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n            },"Thread" + i).start();\n        }\n    }\n}\n')),(0,l.kt)("h3",{id:"semaphore---\u63a7\u5236\u5e76\u53d1\u7ebf\u7a0b\u6570"},"Semaphore - \u63a7\u5236\u5e76\u53d1\u7ebf\u7a0b\u6570"),(0,l.kt)("admonition",{type:"caution"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"Semaphore \u7684\u6784\u9020\u65b9\u6cd5\u4e2d\u4f20\u5165\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6700\u5927\u4fe1\u53f7\u91cf(\u53ef\u4ee5\u770b\u6210\u6700\u5927\u7ebf\u7a0b\u6c60)\uff0c\u6bcf\u4e2a\u4fe1\u53f7\u91cf\u521d\u59cb\u5316\u4e3a\u4e00\u4e2a\u6700\u591a\u53ea\u80fd\u5206\u53d1\u4e00\u4e2a\u8bb8\u53ef\u8bc1"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528 acquire() \u65b9\u6cd5\u83b7\u5f97\u8bb8\u53ef\u8bc1\uff0crelease() \u65b9\u6cd5\u91ca\u653e\u8bb8\u53ef"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Semaphore \u901a\u5e38\u7528\u4e8e\u9650\u5236\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u67d0\u4e9b\u8d44\u6e90\uff08\u7269\u7406\u6216\u903b\u8f91\u7684\uff09\u7684\u7ebf\u7a0b\u6570\u76ee"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u83b7\u5f97\u4e00\u9879\u4efb\u52a1\u524d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5fc5\u987b\u4ece\u4fe1\u53f7\u91cf\u83b7\u53d6\u8bb8\u53ef\uff0c\u4ece\u800c\u4fdd\u8bc1\u53ef\u4ee5\u4f7f\u7528\u8be5\u9879\u3002\u8be5\u7ebf\u7a0b\u7ed3\u675f\u540e\uff0c\u5c06\u9879\u8fd4\u56de\u5230\u6c60\u4e2d\u5e76\u5c06\u8bb8\u53ef\u8fd4\u56de\u5230\u8be5\u4fe1\u53f7\u91cf\uff0c\u4ece\u800c\u5141\u8bb8\u5176\u4ed6\u7ebf\u7a0b\u83b7\u53d6\u8be5\u9879\u4efb\u52a1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06\u4fe1\u53f7\u91cf\u521d\u59cb\u5316\u4e3a 1\uff0c\u4f7f\u5f97\u5b83\u5728\u4f7f\u7528\u65f6\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u53ef\u7528\u7684\u8bb8\u53ef\uff0c\u4ece\u800c\u53ef\u7528\u4f5c\u4e00\u4e2a\u76f8\u4e92\u6392\u65a5\u7684\u9501\u3002\u8fd9\u901a\u5e38\u4e5f\u79f0\u4e3a\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\uff0c\u56e0\u4e3a\u5b83\u53ea\u80fd\u6709\u4e24\u79cd\u72b6\u6001\uff1a\u4e00\u4e2a\u53ef\u7528\u7684\u8bb8\u53ef\uff0c\u6216\u96f6\u4e2a\u53ef\u7528\u7684\u8bb8\u53ef"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6309\u6b64\u65b9\u5f0f\u4f7f\u7528\u65f6\uff0c\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\u5177\u6709\u67d0\u79cd\u5c5e\u6027\uff08\u4e0e\u5f88\u591a Lock \u5b9e\u73b0\u4e0d\u540c\uff09\uff0c\u5373\u53ef\u4ee5\u7531\u7ebf\u7a0b\u91ca\u653e\u201c\u9501\u201d\uff0c\u800c\u4e0d\u662f\u7531\u6240\u6709\u8005\uff08\u56e0\u4e3a\u4fe1\u53f7\u91cf\u6ca1\u6709\u6240\u6709\u6743\u7684\u6982\u5ff5\uff09\u3002\u5728\u67d0\u4e9b\u4e13\u95e8\u7684\u4e0a\u4e0b\u6587\uff08\u5982\u6b7b\u9501\u6062\u590d\uff09\u4e2d\u8fd9\u4f1a\u5f88\u6709\u7528\u3002"))))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"Semaphore \u662f\u4e00\u4e2a",(0,l.kt)("code",null,"\u8ba1\u6570\u4fe1\u53f7\u91cf"),"\uff0c\u4fe1\u53f7\u91cf\u7ef4\u62a4\u4e86\u4e00\u4e2a\u8bb8\u53ef\u96c6")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5e38\u89c1\u7684\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"Semaphore(int permits, boolean fair)")," -> \u521b\u5efa\u5177\u6709\u7ed9\u5b9a\u7684\u8bb8\u53ef\u6570\u548c\u7ed9\u5b9a\u7684\u516c\u5e73\u8bbe\u7f6e\u7684 Semaphore"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"permits"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u521d\u59cb\u7684\u53ef\u7528\u8bb8\u53ef\u6570\u76ee\u3002\u6b64\u503c\u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5fc5\u987b\u5728\u6388\u4e88\u4efb\u4f55\u83b7\u53d6\u524d\u8fdb\u884c\u91ca\u653e\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"fair"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u6b64\u4fe1\u53f7\u91cf\u4fdd\u8bc1\u5728\u4e89\u7528\u65f6\u6309\u5148\u8fdb\u5148\u51fa\u7684\u987a\u5e8f\u6388\u4e88\u8bb8\u53ef\uff0c\u5219\u4e3a true\uff1b\u5426\u5219\u4e3a false\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u901a\u5e38\u5e94\u8be5\u5c06\u7528\u4e8e\u63a7\u5236\u8d44\u6e90\u8bbf\u95ee\u7684\u4fe1\u53f7\u91cf\u521d\u59cb\u5316\u4e3a\u516c\u5e73\u7684\uff0c\u4ee5\u786e\u4fdd\u6240\u6709\u7ebf\u7a0b\u90fd\u53ef\u8bbf\u95ee\u8d44\u6e90\u3002\u4e3a\u5176\u4ed6\u7684\u79cd\u7c7b\u7684\u540c\u6b65\u63a7\u5236\u4f7f\u7528\u4fe1\u53f7\u91cf\u65f6\uff0c\u975e\u516c\u5e73\u6392\u5e8f\u7684\u541e\u5410\u91cf\u4f18\u52bf\u901a\u5e38\u8981\u6bd4\u516c\u5e73\u8003\u8651\u66f4\u4e3a\u91cd\u8981 ")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"acquire(int permits)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4ece\u6b64\u4fe1\u53f7\u91cf\u83b7\u53d6\u7ed9\u5b9a\u6570\u76ee\u7684\u8bb8\u53ef\uff0c\u5728\u63d0\u4f9b\u8fd9\u4e9b\u8bb8\u53ef\u524d\u4e00\u76f4\u5c06\u7ebf\u7a0b\u963b\u585e,\u5426\u5219\u7ebf\u7a0b\u88ab\u4e2d\u65ad"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"acquireUninterruptibly(int permits)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4ece\u6b64\u4fe1\u53f7\u91cf\u83b7\u53d6\u7ed9\u5b9a\u6570\u76ee\u7684\u8bb8\u53ef\uff0c\u5728\u63d0\u4f9b\u8fd9\u4e9b\u8bb8\u53ef\u524d\u4e00\u76f4\u5c06\u7ebf\u7a0b\u963b\u585e"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"release(int permits)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u91ca\u653e\u7ed9\u5b9a\u6570\u76ee\u7684\u8bb8\u53ef\uff0c\u5c06\u5176\u8fd4\u56de\u5230\u4fe1\u53f7\u91cf"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"availablePermits()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u6b64\u4fe1\u53f7\u91cf\u4e2d\u5f53\u524d\u53ef\u7528\u7684\u8bb8\u53ef\u6570"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"drainPermits()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5e76\u8fd4\u56de\u7acb\u5373\u53ef\u7528\u7684\u6240\u6709\u8bb8\u53ef"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"getQueuedThreads() #Collection<Thread>")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u4e00\u4e2a collection\uff0c\u5305\u542b\u53ef\u80fd\u7b49\u5f85\u83b7\u53d6\u7684\u7ebf\u7a0b"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"\tgetQueueLength()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u6b63\u5728\u7b49\u5f85\u83b7\u53d6\u7684\u7ebf\u7a0b\u7684\u4f30\u8ba1\u6570\u76ee"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"hasQueuedThreads()")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u67e5\u8be2\u662f\u5426\u6709\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u83b7\u53d6"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u666f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u53ef\u7528\u4e8e\u505a\u6d41\u91cf\u63a7\u5236\uff0c\u7279\u522b\u662f\u516c\u5171\u8d44\u6e90\u6709\u9650\u7684\u5e94\u7528\u573a\u666f\u3002")))),(0,l.kt)("h4",{id:"\u4ee3\u7801\u5b9e\u73b0-1"},"\u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class SemaphoreDemo {\n    // \u5b9a\u4e49\u4fe1\u53f7\u91cf,\u9650\u5236\u8bbf\u95ee\u8d44\u6e90\u7684\u7ebf\u7a0b\u6570\u91cf\u4e3a2\n    private static final int MAX_AVAILABLE = 2;\n    // \u8ba9\u6bcf\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u516c\u5e73\u7684\u5f97\u5230\u4fe1\u53f7\u91cf\u7684\u8bb8\u53ef\n    private static final boolean isFair = false;\n    private static volatile Semaphore semaphore = new Semaphore(MAX_AVAILABLE, isFair);\n    \n    public static void main(String[] args) {\n        // \u5b9a\u4e4910 \u4e2a\u7ebf\u7a0b,\u90fd\u5c1d\u8bd5\u83b7\u53d6\u8d44\u6e90\n        for (int i = 1; i <= 10; i++) {\n            new Thread(() -> {\n                try {\n                    String tName = Thread.currentThread().getName();\n                    System.out.printf("\u7ebf\u7a0b[%s]\u6b63\u5c1d\u8bd5\u83b7\u53d6\u8bb8\u53ef...\\r\\n", tName);\n                    // \u901a\u8fc7 Semaphore.acquire() \u83b7\u53d6\u8bb8\u53ef,\u8fd9\u91cc\u6307\u5b9a\u83b7\u53d61\u4e2a\u8bb8\u53ef,\u6ca1\u6709\u83b7\u53d6\u5230\u8bb8\u53ef\u7684\u7ebf\u7a0b\u4f1a\u5728\u8fd9\u91cc\u7b49\u5f85\u963b\u585e\u540e\u7eed\u7684\u5904\u7406\n                    semaphore.acquire();\n                    // \u83b7\u53d6\u5230\u8bb8\u53ef\u540e\u8fdb\u884c\u540e\u7eed\u5904\u7406\n                    System.out.printf("\u7ebf\u7a0b[%s]\u83b7\u53d6\u5230\u8bb8\u53ef...\\r\\n",tName);\n                }catch (Exception ex) {\n                     ex.printStackTrace();\n                } finally {\n                    // \u5904\u7406\u5b8c\u540e,\u91ca\u653e\u5360\u7528\u7684\u8bb8\u53ef\xe5\n                    semaphore.release();\n                }\n            }, "Thread-"+i).start();\n\n        }\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(97154).Z,width:"281",height:"400"})),(0,l.kt)("h2",{id:"\u8bfb\u5199\u9501-reentrantreadwritelock"},"\u8bfb\u5199\u9501-ReentrantReadWriteLock"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u573a\u666f:"),(0,l.kt)("p",{parentName:"blockquote"},"\u5bf9\u5171\u4eab\u8d44\u6e90\u6709\u8bfb\u548c\u5199\u7684\u64cd\u4f5c\uff0c\u4e14\u5199\u64cd\u4f5c\u6ca1\u6709\u8bfb\u64cd\u4f5c\u90a3\u4e48\u9891\u7e41\u3002\u5728\u6ca1\u6709\u5199\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bfb\u4e00\u4e2a\u8d44\u6e90\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u6240\u4ee5\u5e94\u8be5\u5141\u8bb8\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bfb\u53d6\u5171\u4eab\u8d44\u6e90"),(0,l.kt)("p",{parentName:"blockquote"},"\u4f46\u662f\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u60f3\u53bb\u5199\u8fd9\u4e9b\u5171\u4eab\u8d44\u6e90\uff0c \u5c31\u4e0d\u5e94\u8be5\u5141\u8bb8\u5176\u4ed6\u7ebf\u7a0b\u5bf9\u8be5\u8d44\u6e90\u8fdb\u884c\u8bfb\u548c\u5199\u7684\u64cd\u4f5c\u4e86")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"java \u7684\u5e76\u53d1\u5305\u63d0\u4f9b\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"\u8bfb\u5199\u9501-> ReentrantReadWriteLock"),"\uff0c \u5b83\u8868\u793a\u4e24\u4e2a\u9501"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e00\u4e2a\u662f\u8bfb\u64cd\u4f5c\u76f8\u5173\u7684\u9501\uff0c\u79f0\u4e3a ",(0,l.kt)("strong",{parentName:"li"},"\u5171\u4eab\u9501")," ,\u4f1a\u53d1\u751f\u6b7b\u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0bA\u548c\u7ebf\u7a0bB\u90fd\u8bfb\u53d6\u8bb0\u5f551\uff0c\u540c\u65f6\u4e5f\u90fd\u64cd\u4f5c\u8bb0\u5f551\uff0c\u7ebf\u7a0bA\u3001\u90fd\u5360\u6709\u9501\uff0c\u6b64\u65f6\u66f4\u65b0\u6570\u636e\u9700\u8981\u53cc\u65b9\u90fd\u91ca\u653e\u9501\uff0c\u4e8e\u662f\u4e24\u4e2a\u7ebf\u7a0b\u4e92\u76f8\u7b49\u5f85"))),(0,l.kt)("li",{parentName:"ul"},"\u4e00\u4e2a\u662f\u5199\u64cd\u4f5c\u76f8\u5173\u7684\u9501\uff0c\u79f0\u4e3a ",(0,l.kt)("strong",{parentName:"li"},"\u6392\u4ed6\u9501")," ,\u4f1a\u53d1\u751f\u6b7b\u9501",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0bA\u64cd\u4f5c\u8bb0\u5f551\uff0c\u5c06\u8bb0\u5f551\u9501\u4f4f\uff0c\u7ebf\u7a0bB\u64cd\u4f5c\u8bb0\u5f552\uff0c\u5c06\u8bb0\u5f552\u9501\u4f4f\u3002\u6b64\u65f6\u7ebf\u7a0bA\u8fd8\u60f3\u64cd\u4f5c\u8bb0\u5f552\uff0c\u7ebf\u7a0bB\u8fd8\u60f3\u64cd\u4f5c\u8bb0\u5f551\uff0c\u8fd9\u5c31\u5bfc\u81f4\u7ebf\u7a0bA\u7b49\u5f85B\u91ca\u653e\u8bb0\u5f552\u7684\u9501\uff0c\u7ebfB\u7b49\u5f85A\u91ca\u653e\u8bb0\u5f551\u7684\u9501,\u5373\u6b7b\u9501 "))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8bfb\u5199\u9501ReentrantReadWriteLock \u5185\u90e8\u7ef4\u62a4\u4e86\u4e24\u4e2a\u9501\uff0c\u4e00\u4e2a\u7528\u4e8e\u8bfb\u64cd\u4f5c\uff0c\u4e00\u4e2a\u7528\u4e8e\u5199\u64cd\u4f5c"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6240\u6709 ReadWriteLock\u5b9e\u73b0\u90fd\u5fc5\u987b\u4fdd\u8bc1 \u5199\u9501\u64cd\u4f5c\u7684\u5185\u5b58\u540c\u6b65\u6548\u679c\u4e5f\u8981\u4fdd\u6301\u4e0e\u76f8\u5173\u8bfb\u9501\u7684\u8054\u7cfb\u3002\u5373\u6210\u529f\u83b7\u53d6\u8bfb\u9501\u7684\u7ebf\u7a0b\u4f1a\u770b\u5230\u5199\u5165\u9501\u4e4b\u524d\u7248\u672c\u6240\u505a\u7684\u6240\u6709\u66f4\u65b0"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u7ebf\u7a0b\u8fdb\u5165\u8bfb\u9501\u7684\u524d\u63d0\u6761\u4ef6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6ca1\u6709\u5176\u4ed6\u7ebf\u7a0b\u7684\u5199\u9501"),(0,l.kt)("li",{parentName:"ul"},"\u6ca1\u6709\u5199\u8bf7\u6c42, \u6216\u8005\u6709\u5199\u8bf7\u6c42\uff0c\u4f46\u8c03\u7528\u7ebf\u7a0b\u548c\u6301\u6709\u9501\u7684\u7ebf\u7a0b\u662f\u540c\u4e00\u4e2a(\u53ef\u91cd\u5165\u9501)"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u7ebf\u7a0b\u8fdb\u5165\u5199\u9501\u7684\u524d\u63d0\u6761\u4ef6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6ca1\u6709\u5176\u4ed6\u7ebf\u7a0b\u7684\u8bfb\u9501"),(0,l.kt)("li",{parentName:"ul"},"\u6ca1\u6709\u5176\u4ed6\u7ebf\u7a0b\u7684\u5199\u9501"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u8bfb\u5199\u9501\u7684\u91cd\u8981\u7279\u6027"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u516c\u5e73\u9009\u62e9\u6027"),": \u652f\u6301\u975e\u516c\u5e73(\u9ed8\u8ba4)\u548c\u516c\u5e73\u7684\u9501\u83b7\u53d6\u65b9\u5f0f\uff0c\u541e\u5410\u91cf\u8fd8\u662f\u975e\u516c\u5e73\u4f18\u4e8e\u516c\u5e73"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u91cd\u8fdb\u5165"),": \u8bfb\u9501\u548c\u5199\u9501\u90fd\u652f\u6301\u7ebf\u7a0b\u91cd\u8fdb\u5165",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u8bfb\u5199\u9501\u53ef\u4ee5\u6309\u7167ReentrantLock\u7684\u65b9\u5f0f\u91cd\u65b0\u83b7\u53d6\u8bfb\u53d6\u9501\u3001\u5199\u5165\u9501,\u4f46\u662f\u53ea\u6709\u5f53\u5199\u5165\u7ebf\u7a0b\u6301\u6709\u7684\u5199\u5165\u9501\u88ab\u91ca\u653e\u540e\uff0c\u624d\u5141\u8bb8\u8bfb\u7ebf\u7a0b\u83b7\u53d6\u8bfb\u53d6\u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5199\u7ebf\u7a0b\u65e2\u53ef\u4ee5\u83b7\u53d6\u5199\u5165\u9501\uff0c\u4e5f\u53ef\u4ee5\u83b7\u53d6\u8bfb\u53d6\u9501\uff0c\u4f46\u662f\u8bfb\u7ebf\u7a0b\u53ea\u80fd\u83b7\u53d6\u8bfb\u53d6\u9501")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u9501\u964d\u7ea7"),": \u9075\u5faa\u83b7\u53d6\u5199\u9501\u3001\u83b7\u53d6\u8bfb\u9501\u518d\u91ca\u653e\u5199\u9501\u7684\u6b21\u5e8f\uff0c\u5199\u9501\u80fd\u591f\u964d\u7ea7\u6210\u4e3a\u8bfb\u9501\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5141\u8bb8\u5199\u5165\u9501\u4ee5\u91cd\u5165\u7684\u65b9\u5f0f\u964d\u7ea7\u4e3a\u8bfb\u53d6\u9501\uff0c\u5176\u5b9e\u73b0\u65b9\u5f0f\u662f\uff1a\u5148\u83b7\u53d6\u5199\u5165\u9501\uff0c\u7136\u540e\u83b7\u53d6\u8bfb\u53d6\u9501\uff0c\u6700\u540e\u91ca\u653e\u5199\u5165\u9501\u3002\u4f46\u662f\uff0c\u4ece\u8bfb\u53d6\u9501\u5347\u7ea7\u5230\u5199\u5165\u9501\u662f",(0,l.kt)("inlineCode",{parentName:"strong"},"\u4e0d\u53ef\u80fd"),"\u7684")))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8bfb\u5199\u9501\u7684\u7f3a\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5bb9\u6613\u9020\u6210\u9501\u9965\u997f\uff0c\u4e00\u76f4\u8bfb\u6ca1\u6709\u5199\u64cd\u4f5c"),(0,l.kt)("li",{parentName:"ul"},"\u8bfb\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u65e0\u6cd5\u8fdb\u884c\u5199\u64cd\u4f5c\u3002\u53ea\u6709\u8bfb\u5b8c\u6210\u4e4b\u540e\u624d\u53ef\u4ee5\u8fdb\u884c\u5199\u64cd\u4f5c\u3002\u5728\u5199\u64cd\u4f5c\u4e2d\u662f\u53ef\u4ee5\u8bfb\u7684")))),(0,l.kt)("admonition",{title:"\u6ce8\u610f",type:"caution"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728\u7ebf\u7a0b\u6301\u6709\u8bfb\u9501\u7684\u60c5\u51b5\u4e0b\uff0c\u8be5\u7ebf\u7a0b\u4e0d\u80fd\u53d6\u5f97\u5199\u9501(\u56e0\u4e3a\u83b7\u53d6\u5199\u9501\u7684\u65f6\u5019\uff0c\u5982\u679c\u53d1\u73b0\u5f53\u524d\u7684\u8bfb\u9501\u88ab\u5360\u7528\uff0c\u5c31\u9a6c\u4e0a\u83b7\u53d6\u5931\u8d25\uff0c\u4e0d\u7ba1\u8bfb\u9501\u662f\u4e0d\u662f\u88ab\u5f53\u524d\u7ebf\u7a0b\u6301\u6709),",(0,l.kt)("font",{color:"red"},"\u56e0\u4e3a\xa0\u5f53\u7ebf\u7a0b\u83b7\u53d6\u8bfb\u9501\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u6709\u5176\u4ed6\u7ebf\u7a0b\u540c\u65f6\u4e5f\u5728\u6301\u6709\u8bfb\u9501\uff0c\u56e0\u6b64\u4e0d\u80fd\u628a \u83b7\u53d6\u8bfb\u9501\u7684\u7ebf\u7a0b\u201c\u5347\u7ea7\u201d\u4e3a\u5199\u9501"),"  ")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728\u7ebf\u7a0b\u6301\u6709\u5199\u9501\u7684\u60c5\u51b5\u4e0b\uff0c\u8be5\u7ebf\u7a0b\u53ef\u4ee5\u7ee7\u7eed\u83b7\u53d6\u8bfb\u9501(\u83b7\u53d6\u8bfb\u9501\u65f6\u5982\u679c\u53d1\u73b0\u5199\u9501\u88ab\u5360\u7528\uff0c\u53ea\u6709\u5199\u9501\u6ca1\u6709\u88ab\u5f53\u524d\u7ebf\u7a0b\u5360\u7528\u7684\u60c5\u51b5\u624d\u4f1a\u83b7\u53d6\u5931\u8d25),",(0,l.kt)("font",{color:"red"},"\u56e0\u4e3a\xa0\u5bf9\u4e8e\u83b7\u5f97\u5199\u9501\u7684\u7ebf\u7a0b\uff0c\u5b83\u4e00\u5b9a\u72ec\u5360\u4e86\u8bfb\u5199\u9501\uff0c\u56e0\u6b64\u53ef\u4ee5\u7ee7\u7eed\u8ba9\u5b83\u83b7\u53d6\u8bfb\u9501\uff0c\u5f53\u5b83\u540c\u65f6\u83b7\u53d6\u4e86\u5199\u9501\u548c\u8bfb\u9501\u540e\uff0c\u8fd8\u53ef\u4ee5\u5148\u91ca \u653e\u5199\u9501\u7ee7\u7eed\u6301\u6709\u8bfb\u9501\uff0c\u8fd9\u6837\u4e00\u4e2a\u5199\u9501\u5c31\u201c\u964d\u7ea7\u201d\u4e3a\u4e86\u8bfb\u9501"))))),(0,l.kt)("h3",{id:"\u4ee3\u7801\u793a\u4f8b-1"},"\u4ee3\u7801\u793a\u4f8b"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u9700\u6c42\uff1a \u4f7f\u7528ReentrantReadWriteLock \u5bf9\u4e00\u4e2a HashMap \u8fdb\u884c\u8bfb\u548c\u5199\u64cd\u4f5c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class ReentrantReadWriteLockDemo {\n    // \u4fdd\u8bc1\u5185\u5b58\u53ef\u89c1\u6027\n    private static volatile HashMap<String,Object> cache = new HashMap<>();\n\n    // \u521b\u5efa\u8bfb\u5199\u9501\u5bf9\u8c61\n    private static final ReentrantReadWriteLock READ_WRITE_LOCK = new ReentrantReadWriteLock(true);\n\n    /**\n     * \u5199\u6570\u636e\n     */\n    public void setItem(String key,Object value) {\n        // \u83b7\u53d6\u5199\u9501\u5bf9\u8c61\n        READ_WRITE_LOCK.writeLock().lock();\n        try {\n            System.out.println("\u5f00\u59cb\u5bf9"+key+"\u8fdb\u884c\u5199\u64cd\u4f5c....");\n            cache.put(key, value);\n            System.out.println(key+"\u5199\u5165\u6210\u529f....");\n        }catch(Exception ex) {\n            ex.printStackTrace();\n        }\n        finally {\n            READ_WRITE_LOCK.writeLock().unlock();\n        }\n    }\n\n    /**\n     * \u8bfb\u6570\u636e\n     */\n    public Object getItem(String key) {\n        // \u83b7\u53d6\u8bfb\u9501\u5bf9\u8c61\n        READ_WRITE_LOCK.readLock().lock();\n        Object obj = null;\n        try {\n            System.out.println("\u5f00\u59cb\u83b7\u53d6"+key+"\u5bf9\u5e94\u7684\u7f13\u5b58\u6570\u636e....");\n            obj = cache.get(key);\n            System.out.println(key+"\u7f13\u5b58\u7ed3\u679c\u83b7\u53d6\u6210\u529f....");\n        }catch(Exception ex) {\n            ex.printStackTrace();\n        }\n        finally {\n            READ_WRITE_LOCK.readLock().unlock();\n        }\n        return obj;\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        ReentrantReadWriteLockDemo writeLockDemo = new ReentrantReadWriteLockDemo();\n        for (int i = 1; i <= 3; i++) {\n            new Thread(() -> {\n                writeLockDemo.setItem(Thread.currentThread().getName(), new Date());\n            },"Thread-" + i).start();\n        }\n        TimeUnit.MICROSECONDS.sleep(2000);\n        for (int i = 1; i <= 3; i++) {\n            new Thread(() -> {\n                Object value = writeLockDemo.getItem(Thread.currentThread().getName());\n                System.out.println(Thread.currentThread().getName()+"\u5bf9\u5e94\u7684\u7f13\u5b58\u503c\u4e3a"+value);\n            },"Thread-" + i).start();\n        }\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(52306).Z,width:"550",height:"300"})),(0,l.kt)("h3",{id:"\u9501\u964d\u7ea7\u4ee3\u7801\u793a\u4f8b"},"\u9501\u964d\u7ea7\u4ee3\u7801\u793a\u4f8b"),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"\u964d\u7ea7\u6b65\u9aa4\uff1a \u83b7\u53d6\u5199\u9501 -> \u5199\u6570\u636e -> \u83b7\u53d6\u8bfb\u9501","[\u91cd\u5165\u7684\u65b9\u5f0f]"," -> \u8bfb\u53d6\u6570\u636e -> \u91ca\u653e\u5199\u9501 -> \u91ca\u653e\u8bfb\u9501")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class ReentrantReadWriteLockDemo2 {\n    private static String cache = "";\n    private static final ReentrantReadWriteLock READ_WRITE_LOCK = new ReentrantReadWriteLock();\n    private static final ReentrantReadWriteLock.ReadLock READ_LOCK = READ_WRITE_LOCK.readLock();\n    private static final ReentrantReadWriteLock.WriteLock WRITE_LOCK = READ_WRITE_LOCK.writeLock();\n    public static void main(String[] args) {\n        new Thread(() -> {\n            try {\n                // \u83b7\u53d6\u5199\u9501\n                WRITE_LOCK.lock();\n                TimeUnit.SECONDS.sleep(5);\n                cache = "\u5199\u5165\u6570\u636e";\n                System.out.println(Thread.currentThread().getName() + "\\t[\u5199\u9501]\u5199\u5165\u5b8c\u6210");\n                // \u5199\u5165\u7ebf\u7a0b\u518d\u6b21\u5c1d\u8bd5\u83b7\u53d6\u8bfb\u9501\n                READ_LOCK.lock();\n                System.out.println(Thread.currentThread().getName() + "\\t[\u8bfb\u9501]\u83b7\u53d6\u6570\u636e:" + cache);\n                // \u91ca\u653e\u5199\u9501\n                WRITE_LOCK.unlock();\n                READ_LOCK.unlock();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        },"[\u5199\u5165\u7ebf\u7a0b]").start();\n    }\n}\n\n/*\n    // \u963b\u585e 5s\n    [\u5199\u5165\u7ebf\u7a0b]  [\u5199\u9501]\u5199\u5165\u5b8c\u6210\n    [\u5199\u5165\u7ebf\u7a0b]  [\u8bfb\u9501]\u83b7\u53d6\u6570\u636e:\u5199\u5165\u6570\u636e\n*/\n')),(0,l.kt)("h3",{id:"\u9501\u5347\u7ea7\u6d4b\u8bd5"},"\u9501\u5347\u7ea7\u6d4b\u8bd5\uff1f"),(0,l.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u83b7\u53d6\u4e86\u8bfb\u9501\u4e4b\u540e\uff0c\u662f\u65e0\u6cd5\u4ee5\u91cd\u5165\u7684\u65b9\u5f0f\u83b7\u53d6\u5230\u5199\u9501\uff0c",(0,l.kt)("strong",{parentName:"p"},"\u9664\u975e\u5728\u83b7\u53d6\u5199\u9501\u4e4b\u524d\u91ca\u653e\u6389\u8bfb\u9501")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class ReentrantReadWriteLockDemo3 {\n    private static String cache = "\u521d\u59cb\u503c1";\n    private static final ReentrantReadWriteLock READ_WRITE_LOCK = new ReentrantReadWriteLock();\n    private static final ReentrantReadWriteLock.ReadLock READ_LOCK = READ_WRITE_LOCK.readLock();\n    private static final ReentrantReadWriteLock.WriteLock WRITE_LOCK = READ_WRITE_LOCK.writeLock();\n    public static void main(String[] args) {\n        new Thread(() -> {\n            try {\n                // \u83b7\u53d6\u8bfb\u9501\n                READ_LOCK.lock();\n                System.out.println(Thread.currentThread().getName() + "\\t[\u8bfb\u9501]\u83b7\u53d6\u6570\u636e:" + cache);\n                // \u83b7\u53d6\u5199\u9501\n                System.out.println(Thread.currentThread().getName() + "\u5c1d\u8bd5\u83b7\u53d6\u5199\u9501...");\n                WRITE_LOCK.lock();\n                System.out.println(Thread.currentThread().getName() + "\u5199\u9501\u83b7\u53d6\u6210\u529f...");\n                TimeUnit.SECONDS.sleep(5);\n                cache = "\u521d\u59cb\u503c2";\n                System.out.println(Thread.currentThread().getName() + "\\t[\u5199\u9501]\u5199\u5165\u5b8c\u6210");\n                    // \u91ca\u653e\u8bfb\u9501\n                READ_LOCK.unlock();\n                // \u91ca\u653e\u5199\u9501\n                WRITE_LOCK.unlock();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        },"[\u8bfb\u53d6\u7ebf\u7a0b]").start();\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(24490).Z,width:"620",height:"227"})),(0,l.kt)("h2",{id:"\u963b\u585e\u961f\u5217blockingqueue"},"\u963b\u585e\u961f\u5217(BlockingQueue)"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"BlockingQueue \u5f88\u597d\u7684\u89e3\u51b3\u4e86\u591a\u7ebf\u7a0b\u4e2d\uff0c\u5982\u4f55\u9ad8\u6548\u5b89\u5168 \u201c\u4f20\u8f93\u201d\u6570\u636e\u7684\u95ee\u9898\u3002"),(0,l.kt)("font",{color:"red"},"\u5de5\u4f5c\u7ebf\u7a0b\u53ef\u4ee5\u5468\u671f\u7684\u5411\u963b\u585e\u961f\u5217\u4e2d\u6dfb\u52a0\u6570\u636e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4ece\u961f\u5217\u4e2d\u6d88\u8d39\u6570\u636e(\u7c7b\u4f3c\u4e8e\u6d88\u606f\u961f\u5217)")),(0,l.kt)("h3",{id:"blockingqueue-\u6982\u8ff0"},"BlockingQueue \u6982\u8ff0"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"BlockingQueue\u662f\u4e00\u4e2a\u961f\u5217, \u901a\u8fc7\u4e00\u4e2a\u5171\u4eab\u7684\u961f\u5217\uff0c\u53ef\u4ee5\u4f7f\u5f97\u6570\u636e \u7531\u961f\u5217\u7684\u4e00\u7aef\u8f93\u5165\uff0c\u4ece\u53e6\u5916\u4e00\u7aef\u8f93\u51fa\uff0c\u6709\u4ee5\u4e0b\u7684\u51e0\u4e2a\u7279\u70b9:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u961f\u5217\u662f\u7a7a\u7684\uff0c\u5c1d\u8bd5\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u5143\u7d20\u7684\u64cd\u4f5c\u4f1a\u88ab\u963b\u585e -> \u76f4\u5230\u5176\u4ed6\u7684\u7ebf\u7a0b\u5411\u7a7a\u7684\u961f\u5217\u4e2d\u63d2\u5165\u5143\u7d20")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5f53\u961f\u5217\u662f\u6ee1\u7684\uff0c\u5c1d\u8bd5\u5411\u961f\u5217\u4e2d\u6dfb\u52a0\u5143\u7d20\u7684\u64cd\u4f5c\u4f1a\u88ab\u963b\u585e -> \u76f4\u5230\u5176\u4ed6\u7684\u7ebf\u7a0b\u4ece\u961f\u5217\u4e2d\u79fb\u9664\u4e00\u4e2a")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u961f\u5217\u4e0d\u63a5\u53d7 NULL \u5143\u7d20\uff0c\u5f53\u8bd5\u56fe\u63d2\u5165\u4e00\u4e2aNULL\u5143\u7d20\u65f6\uff0c\u4f1a\u62a5 \u7a7a\u6307\u9488\u5f02\u5e38")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u961f\u5217\u53ef\u4ee5\u662f\u9650\u5b9a\u5bb9\u91cf\u7684\uff0c\u901a\u8fc7\xa0remainingCapacity()\u65b9\u6cd5\u53ef\u4ee5\u8fd4\u56de\u961f\u5217\u8fd8\u53ef\u4ee5\u6dfb\u52a0\u591a\u5c11\u5143\u7d20\uff0c\u6ca1\u6709\u6307\u5b9a\u961f\u5217\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u662f",(0,l.kt)("inlineCode",{parentName:"strong"},"Integer.MAX_VALUE"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"BlockingQueue \u65b9\u6cd5\u4ee5\u56db\u79cd\u5f62\u5f0f\u51fa\u73b0\uff0c\u5bf9\u4e8e\u4e0d\u80fd\u7acb\u5373\u6ee1\u8db3\u4f46\u53ef\u80fd\u5728\u5c06\u6765\u67d0\u4e00\u65f6\u523b\u53ef\u4ee5\u6ee1\u8db3\u7684\u64cd\u4f5c\uff0c\u8fd9\u56db\u79cd\u5f62\u5f0f\u7684\u5904\u7406\u65b9\u5f0f\u4e0d\u540c"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38"),(0,l.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u4e00\u4e2a\u7279\u6b8a\u503c\uff08",(0,l.kt)("inlineCode",{parentName:"li"},"null")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"li"},"false"),"\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u64cd\u4f5c\uff09"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u64cd\u4f5c\u53ef\u4ee5\u6210\u529f\u524d\uff0c\u65e0\u9650\u671f\u5730\u963b\u585e\u5f53\u524d\u7ebf\u7a0b"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u653e\u5f03\u524d\uff0c\u53ea\u5728\u7ed9\u5b9a\u7684\u6700\u5927\u65f6\u95f4\u9650\u5236\u5185\u963b\u585e")))),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u65b9\u6cd5/\u5904\u7406\u65b9\u5f0f"),(0,l.kt)("th",{parentName:"tr",align:null},"\u629b\u51fa\u5f02\u5e38"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8fd4\u56de\u7279\u6b8a\u503c"),(0,l.kt)("th",{parentName:"tr",align:null},"\u963b\u585e"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8d85\u65f6\u9000\u51fa"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"\u63d2\u5165"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"add(e)")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"offer(e)")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"put(e)")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"offer(e, time, unit)"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"\u79fb\u9664"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"remove()")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"poll()")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"take()")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"poll(time,unit)"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"\u68c0\u67e5"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"element()")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"peek()")),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e0d\u53ef\u7528"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e0d\u53ef\u7528")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"BlockingQueue \u5e38\u89c1\u7684\u65b9\u6cd5:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u6dfb\u52a0"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"add(E e)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5c06\u5143\u7d20\u63d2\u5165\u5230\u961f\u5217\u4e2d(\u5982\u679c\u80fd\u7acb\u5373\u63d2\u5165\uff0c\u4e14\u4e0d\u8d85\u8fc7\u5bb9\u91cf\u9650\u5236)",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u63d2\u5165\u6210\u529f\u8fd4\u56detrue"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u961f\u5217\u7a7a\u95f4\u4e0d\u8db3\uff0c\u5219\u629b\u51fa IllegalStateException"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5185\u90e8\u8c03\u7528offer(E) \u65b9\u6cd5\uff0c\u8fd4\u56de\u5931\u8d25\u7684\u8bddadd\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"offer(E e)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5c06\u5143\u7d20\u63d2\u5165\u5230\u961f\u5217\u4e2d(\u5982\u679c\u80fd\u7acb\u5373\u63d2\u5165\uff0c\u4e14\u4e0d\u8d85\u8fc7\u5bb9\u91cf\u9650\u5236)",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u63d2\u5165\u6210\u529f\u8fd4\u56detrue"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5f53\u524d\u6ca1\u6709\u53ef\u7528\u7684\u7a7a\u95f4\uff0c\u5219\u8fd4\u56de false"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"offer(E e,long timeout, TimeUnit unit)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5c06\u6307\u5b9a\u5143\u7d20\u63d2\u5165\u6b64\u961f\u5217\u4e2d\uff0c\u5982\u679c\u961f\u5217\u7a7a\u95f4\u4e0d\u8db3\uff0c\u4f1a\u5728\u5230\u8fbe\u6307\u5b9a\u7684\u7b49\u5f85\u65f6\u95f4\u524d\uff0c\u7b49\u5f85\u53ef\u7528\u7684\u7a7a\u95f4"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"put(E e)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6307\u5b9a\u5143\u7d20\u63d2\u5165\u6b64\u961f\u5217\u4e2d\uff0c\u5982\u679c\u961f\u5217\u7a7a\u95f4\u4e0d\u8db3\uff0c\u4f1a\u4e00\u76f4\u7b49\u5f85\u76f4\u5230\u53ef\u7528\u7684\u7a7a\u95f4"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u5220\u9664"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"remove()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4ece\u6b64\u961f\u5217\u4e2d\u79fb\u9664\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u5982\u679c\u961f\u5217\u4e2d\u6ca1\u6709\u5143\u7d20\uff0c\u5219\u629b\u51fa\u5f02\u5e38"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"remove(Object obj)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4ece\u6b64\u961f\u5217\u4e2d\u79fb\u9664\u6307\u5b9a\u5143\u7d20",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5220\u9664\u6210\u529f\u8fd4\u56detrue, \u5982\u679c\u5143\u7d20\u4e0d\u5b58\u5728\uff0c\u8fd4\u56defalse"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"take()"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5e76\u79fb\u9664\u6b64\u961f\u5217\u7684\u5934\u90e8\uff0c\u5982\u679c\u961f\u5217\u4e2d\u6ca1\u6709\u5143\u7d20, \u4f1a\u4e00\u76f4\u7b49\u5f85\u76f4\u5230\u5143\u7d20\u53d8\u5f97\u53ef\u7528"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"poll(long timeout, TimeUnit unit)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5e76\u79fb\u9664\u6b64\u961f\u5217\u7684\u5934\u90e8\uff0c\u5982\u679c\u961f\u5217\u4e2d\u6ca1\u6709\u5143\u7d20\uff0c\u4f1a\u5728\u6307\u5b9a\u7684\u7b49\u5f85\u65f6\u95f4\u524d\uff0c\u7b49\u5f85\u53ef\u7528\u7684\u5143\u7d20"),(0,l.kt)("li",{parentName:"ul"},"\u8d85\u8fc7\u6307\u5b9a\u7684\u65f6\u95f4\u53d6\u4e0d\u5230\u5219\u8fd4\u56de NULL"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u5176\u4ed6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"contains(Object obj)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5224\u65ad\u961f\u5217\u4e2d\u662f\u5426\u5305\u542b\u6307\u5b9a\u7684\u5143\u7d20"),(0,l.kt)("li",{parentName:"ul"},"\u4ece\u961f\u5217\u4e2d\u79fb\u9664\u5143\u7d20\uff0c\u5e76\u4e14\u5c06\u8fd9\u4e9b\u5143\u7d20\u6dfb\u52a0\u5230\u7ed9\u5b9a\u7684Collection\u4e2d"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"maxElements")," : \u6307\u5b9a\u9700\u8981\u79fb\u9664\u7684\u5143\u7d20\u6570\u91cf\u3002\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u9ed8\u8ba4\u79fb\u9664\u6240\u6709\u7684\u5143\u7d20")))))))),(0,l.kt)("h3",{id:"\u5e38\u89c1\u7684-blockingqueue\u7684\u5b9e\u73b0"},"\u5e38\u89c1\u7684 BlockingQueue\u7684\u5b9e\u73b0"),(0,l.kt)("p",null,"jdk7 \u63d0\u4f9b\u4e867\u4e2a\u963b\u585e\u961f\u5217:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"ArrayBlockingQueue"),"  -> \u7531\u6570\u636e\u7ed3\u6784\u7ec4\u6210\u7684\u6709\u8fb9\u754c\u963b\u585e\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LinkedBlockingQueue")," -> \u7531\u94fe\u8868\u7ed3\u6784\u7ec4\u6210\u7684\u6709\u8fb9\u754c\u963b\u585e\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"PriorityBlockingQueue")," -> \u652f\u6301\u4f18\u5148\u7ea7\u6392\u5e8f\u7684\u65e0\u8fb9\u754c\u963b\u585e\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"DelayQueue")," -> \u4f7f\u7528\u4f18\u5148\u7ea7\u961f\u5217\u5b9e\u73b0\u7684\u65e0\u8fb9\u754c\u963b\u585e\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"SynchronousQueue")," -> \u4e0d\u5b58\u50a8\u5143\u7d20\u7684\u963b\u585e\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LinkedTransferQueue")," -> \u7531\u94fe\u8868\u7ed3\u6784\u7ec4\u6210\u7684\u65e0\u8fb9\u754c\u963b\u585e\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"LinkedBlockingDeque")," -> \u7531\u94fe\u8868\u7ed3\u6784\u7ec4\u6210\u7684\u53cc\u5411\u963b\u585e\u961f\u5217")),(0,l.kt)("h4",{id:"arrayblockingqueue\u6709\u754c"},"ArrayBlockingQueue\uff08\u6709\u754c\uff09"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u57fa\u4e8e\u6570\u636e\u7684\u963b\u585e\u961f\u5217\u5b9e\u73b0,\u6b64\u961f\u5217\u6309 FIFO\uff08\u5148\u8fdb\u5148\u51fa\uff09\u539f\u5219\u5bf9\u5143\u7d20\u8fdb\u884c\u6392\u5e8f",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u961f\u5217\u7684\u5934\u90e8 \u662f\u5728\u961f\u5217\u4e2d\u5b58\u5728\u65f6\u95f4\u6700\u957f\u7684\u5143\u7d20"),(0,l.kt)("li",{parentName:"ul"},"\u961f\u5217\u7684\u5c3e\u90e8 \u662f\u5728\u961f\u5217\u4e2d\u5b58\u5728\u65f6\u95f4\u6700\u77ed\u7684\u5143\u7d20\u3002\u65b0\u5143\u7d20\u63d2\u5165\u5230\u961f\u5217\u7684\u5c3e\u90e8\uff0c\u961f\u5217\u83b7\u53d6\u64cd\u4f5c\u5219\u662f\u4ece\u961f\u5217\u5934\u90e8\u5f00\u59cb\u83b7\u5f97\u5143\u7d20"))),(0,l.kt)("li",{parentName:"ul"},"ArrayBlockingQueue \u5185\u90e8\uff0c\u7ef4\u62a4\u4e86\u4e00\u4e2a\u5b9a\u957f\u6570\u7ec4\uff0c\u4ee5\u4fbf\u7f13\u5b58\u961f\u5217\u4e2d\u7684\u6570\u636e\u5bf9\u8c61\u3002 \u5e76\u4e14\u5185\u90e8\u8fd8\u4fdd\u5b58\u7740\u4e24\u4e2a\u6574\u5f62\u53d8\u91cf\uff0c",(0,l.kt)("font",{color:"red"},"\u5206\u522b\u6807\u8bc6\u7740\u961f\u5217\u7684\u5934\u90e8\u548c\u5c3e\u90e8\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e")," "),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5728\u521b\u5efa ArrayBlockingQueue \u65f6\uff0c\u8fd8\u53ef\u4ee5\u63a7\u5236\u5bf9\u8c61\u7684\u5185\u90e8\u9501\u662f\u5426\u91c7\u7528\u516c\u5e73\u9501\uff0c\u9ed8\u8ba4\u91c7\u7528\u975e\u516c\u5e73\u9501")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"ArrayBlockingQueue \u5728\u751f\u4ea7\u8005\u653e\u5165\u6570\u636e\u548c\u6d88\u8d39\u8005\u83b7\u53d6\u6570\u636e\uff0c\u90fd\u662f\u5171\u7528\u540c\u4e00\u4e2a \u9501\u5bf9\u8c61"))),(0,l.kt)("h5",{id:"\u6e90\u7801\u5b9e\u73b0"},"\u6e90\u7801\u5b9e\u73b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'    public ArrayBlockingQueue(int capacity, boolean fair) {\n        if (capacity <= 0)\n            throw new IllegalArgumentException();\n          // \u521d\u59cb\u5316\u5b9a\u957f\u6570\u7ec4\n        this.items = new Object[capacity];\n            // \u521d\u59cb\u5316\u9501\n        lock = new ReentrantLock(fair);\n            // \u5f53\u961f\u5217\u4e0d\u662f\u7a7a\u7684\u5524\u9192\u6761\u4ef6\n        notEmpty = lock.newCondition();\n            // \u961f\u5217\u4e0d\u662f\u6ee1\u7684\u5524\u9192\u6761\u4ef6\n        notFull =  lock.newCondition();\n    }\n\n    /** \u5185\u90e8\u7ef4\u62a4\u7684\u5b9a\u957f\u6570\u7ec4 */\n    final Object[] items;\n\n    /** \u4e0b\u4e00\u4e2a\u7528\u4e8e\u79fb\u9664\u7684\u5143\u7d20\u7684\u7d22\u5f15\u4f4d\u7f6e */\n    int takeIndex;\n\n    /** \u4e0b\u4e00\u4e2a\u7528\u4e8e\u6dfb\u52a0\u7684\u5143\u7d20\u7684\u7d22\u5f15\u4f4d\u7f6e */\n    int putIndex;\n\n    /** \u961f\u5217\u4e2d\u5143\u7d20\u7684\u6570\u91cf */\n    int count;\n\n    /** \u5168\u5c40\u9501\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u7528\u7684\u90fd\u662f\u8fd9\u4e2a\u9501 */\n    final ReentrantLock lock;\n\n    /** \u7528\u4e8e\u5524\u9192\u7b49\u5f85\u5220\u9664 */\n    private final Condition notEmpty;\n\n    /** \u7528\u4e8e\u5524\u9192\u7b49\u5f85\u6dfb\u52a0\u7684\u6761\u4ef6 */\n    private final Condition notFull;\n  \n    /**\n     * \u68c0\u67e5\u961f\u5217\u7684\u5143\u7d20\u662f\u5426\u662f\u7a7a\u7684\n     */\n    private static void checkNotNull(Object v) {\n        if (v == null)\n            throw new NullPointerException();\n    }\n    /**\n     * \u5411\u961f\u5217\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u5e76\u4e14\u901a\u77e5\u90a3\u4e9b\u7b49\u5f85\u4ece\u5143\u7d20\u5220\u9664\u3001\u83b7\u53d6\u6570\u636e\u7684\u7ebf\u7a0b\n     */\n    private void enqueue(E x) {\n        final Object[] items = this.items;\n        items[putIndex] = x;\n        if (++putIndex == items.length)\n            putIndex = 0;\n        count++;\n        notEmpty.signal();\n    }\n\n    /**\n     * \u4ece\u961f\u5217\u4e2d\u79fb\u9664\u5143\u7d20\uff0c\u5e76\u4e14\u901a\u77e5\u90a3\u4e9b\u9700\u8981\u5411\u961f\u5217\u603b\u6dfb\u52a0\u6570\u636e\u7684\u7ebf\u7a0b\n     */\n    private E dequeue() {\n        final Object[] items = this.items;\n        @SuppressWarnings("unchecked")\n        E x = (E) items[takeIndex];\n        items[takeIndex] = null;\n        if (++takeIndex == items.length)\n            takeIndex = 0;\n        count--;\n        if (itrs != null)\n            itrs.elementDequeued();\n        notFull.signal();\n        return x;\n    }\n\n')),(0,l.kt)("h5",{id:"\u4ee3\u7801\u6f14\u793a"},"\u4ee3\u7801\u6f14\u793a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class BlockingQueueDemo {\n    // \u8bbe\u7f6e\u961f\u5217\u5927\u5c0f\u4e3a3\n    private static final int capital = 3;\n    private static BlockingQueue<String> blockingQueue = new ArrayBlockingQueue<>(capital);\n    public static void main(String[] args) throws InterruptedException {\n        five();\n    }\n\n    /**\n     * \u6d4b\u8bd5add()\u65b9\u6cd5:\u5f53\u63d2\u5165\u6570\u636e\u8d85\u8fc7\u6307\u5b9a\u7684\u961f\u5217\u5927\u5c0f,\u5c31\u629b\u51fa\u5f02\u5e38\n     *  add() \u65b9\u6cd5\u5185\u90e8\u8fd8\u662f\u6839\u636eoffer(E e)\u65b9\u6cd5\u6765\u8fdb\u884c\u7684 -> offer\u8fd4\u56defalse\u7684\u8bdd,add()\u629b\u51fa\u5f02\u5e38\n     *   public boolean add(E e) {\n     *         if (offer(e))\n     *             return true;\n     *         else\n     *             throw new IllegalStateException("Queue full");\n     *     }\n     */\n    private static void one() {\n        System.out.println(blockingQueue.add("java"));\n        System.out.println(blockingQueue.add("python"));\n        System.out.println(blockingQueue.add("javaScript"));\n        System.out.println(blockingQueue.add("go"));  // \u8f93\u51fa: Exception in thread "main" java.lang.IllegalStateException: Queue full\n    }\n\n    /**\n     * \u6d4b\u8bd5 remove \u548c element\u65b9\u6cd5\n     *  element()\u65b9\u6cd5\u5185\u90e8\u8c03\u7528\u7684\u662fpeek\u65b9\u6cd5,peek\u8fd4\u56denull\u7684\u8bdd\u5c31\u629b\u51fa\u5f02\u5e38\n     *      public E element() {\n     *         E x = peek();\n     *         if (x != null)\n     *             return x;\n     *         else\n     *             throw new NoSuchElementException();\n     *     }\n     *  remove \u5b9e\u9645\u4e0a\u8c03\u7528\u7684\u5c31\u662f\u6570\u7ec4\u7684remove\u65b9\u6cd5\n     *      remove(): \u5728\u961f\u5217\u4e2d\u6ca1\u6709\u5143\u7d20\u7684\u65f6\u5019,\u629b\u51fa\u5f02\u5e38\n     *      remove(Object): \u5728\u961f\u5217\u4e2d\u6ca1\u6709\u5143\u7d20\u7684\u65f6\u5019\u6216\u8005\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u5143\u7d20\u65f6,\u8fd4\u56defalse\n     */\n    private static void two() {\n        System.out.println(blockingQueue.add("java"));\n        System.out.println(blockingQueue.add("javaScript"));\n        System.out.println(blockingQueue.element());  // \u8f93\u51fa: java\n        System.out.println(blockingQueue.remove("java"));   // true\n        System.out.println(blockingQueue.remove("js"));     // false\n        System.out.println(blockingQueue.element());            // \u8f93\u51fa: javaScript\n        System.out.println(blockingQueue.remove("javaScript"));     // true\n        System.out.println(blockingQueue.remove());     // Exception in thread "main" java.util.NoSuchElementException\n    }\n\n    /**\n     * \u6d4b\u8bd5offer,poll\u65b9\u6cd5\n     *  offer(obj): \u5411\u961f\u5217\u4e2d\u63d2\u5165\u5143\u7d20,\u63d2\u5165\u6210\u529f\u8fd4\u56detrue,\u5426\u5219\u8fd4\u56defalse\n     *  poll(): \u83b7\u53d6\u5e76\u5220\u9664\u6307\u5b9a\u7684\u5143\u7d20,\u5982\u679c\u961f\u5217\u662f\u7a7a\u7684,\u5219\u8fd4\u56denull\n     */\n    public static void three() {\n        System.out.println(blockingQueue.offer("java"));        //true\n        System.out.println(blockingQueue.offer("python"));      //true\n        System.out.println(blockingQueue.offer("javaScript"));  //true\n        System.out.println(blockingQueue.offer("go"));          //false\n        System.out.println(blockingQueue.poll());                  //java\n        System.out.println(blockingQueue.poll());                  //python\n        System.out.println(blockingQueue.poll());                  //javaScript\n        System.out.println(blockingQueue.poll());                  //null\n    }\n\n    /**\n     * \u6d4b\u8bd5\u963b\u585e\u65b9\u6cd5\u7ec4: put / take\n     *  put:  \u5411\u961f\u5217\u4e2d\u63d2\u5165\u5143\u7d20,\u5982\u679c\u63d2\u5165\u65f6\u961f\u5217\u5df2\u7ecf\u6ee1\u4e86,\u4f1a\u963b\u585e\n     *  take: \u83b7\u53d6\u5e76\u5220\u9664\u9996\u90e8\u7684\u5143\u7d20,\u5982\u679c\u5220\u9664\u65f6\u961f\u5217\u4e2d\u6ca1\u6709\u5143\u7d20,\u4f1a\u963b\u585e\n     * @throws InterruptedException\n     */\n    public static void four() throws InterruptedException {\n        blockingQueue.put("java");\n        blockingQueue.put("python");\n        blockingQueue.put("javaScript");\n        // blockingQueue.put("go");                 //\u7531\u4e8e\u961f\u5217\u5927\u5c0f\u4e3a3,\u5b58\u5165\u7b2c\u56db\u4e2a\u5143\u7d20\u4f1a\u963b\u585e\u7b49\u5f85\n        System.out.println(blockingQueue.take());\n        System.out.println(blockingQueue.take());\n        System.out.println(blockingQueue.take());\n        // System.out.println(blockingQueue.take());  // \u7531\u4e8e\u961f\u5217\u5927\u5c0f\u4e3a3,\u5220\u9664\u7b2c\u56db\u4e2a\u5143\u7d20\u4f1a\u963b\u585e\u7b49\u5f85\n    }\n\n    /**\n     * \u6d4b\u8bd5 offer \u8d85\u65f6\u65b9\u6cd5\n     *   offer(E e, long timeout, TimeUnit unit) : \u5411\u961f\u5217\u6dfb\u52a0\u5143\u7d20,\u5982\u679c\u961f\u5217\u6ee1\u4e86,\u4f1a\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u540e\u63d2\u5165,\u5931\u8d25\u7684\u8bdd\u8fd4\u56defalse\n     * @throws InterruptedException\n     */\n    public static  void five() throws InterruptedException {\n        System.out.println(blockingQueue.offer("a"));\n        System.out.println(blockingQueue.offer("b"));\n        System.out.println(blockingQueue.offer("c"));\n        System.out.println(blockingQueue.offer("a",3L, TimeUnit.SECONDS));\n    }\n}\n\n')),(0,l.kt)("h4",{id:"linkedblockingqueue\u65e0\u754c"},"LinkedBlockingQueue\uff08\u65e0\u754c)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u57fa\u4e8e\u94fe\u8868\u7684\u963b\u585e\u961f\u5217\uff0c\u540c ArrayListBlockingQueue \u7c7b\u4f3c\uff0c\u5176\u5185\u90e8\u4e5f\u7ef4\u6301\u7740\u4e00\u4e2a\u7531\u4e00\u4e2a\u94fe\u8868\u6784\u6210\u7684\u6570\u636e\u7f13\u51b2\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u751f\u4ea7\u8005\u7aef\u548c\u6d88\u8d39\u8005\u7aef\u5206\u522b\u91c7\u7528\u4e86\u72ec\u7acb\u7684\u9501\u6765\u63a7\u5236\u6570\u636e\u540c\u6b65"),"\uff0c\u8fd9\u4e5f\u610f\u5473\u7740\u5728\u9ad8\u5e76\u53d1\u7684\u60c5\u51b5\u4e0b\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u53ef\u4ee5\u5e76\u884c\u5730\u64cd\u4f5c\u961f\u5217\u4e2d\u7684\u6570\u636e\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u6574\u4e2a\u961f\u5217\u7684\u5e76\u53d1\u6027\u80fd\u3002")),(0,l.kt)("h5",{id:"\u6e90\u7801\u5b9e\u73b0-1"},"\u6e90\u7801\u5b9e\u73b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class LinkedBlockingQueue<E> extends AbstractQueue<E>\n        implements BlockingQueue<E>, java.io.Serializable {\n  private static final long serialVersionUID = -6903933977591709194L;\n\n  /**\n     * Linked list node class\n     */\n  static class Node<E> {\n    E item;\n    /**\n         * One of:\n         * - the real successor Node\n         * - this Node, meaning the successor is head.next\n         * - null, meaning there is no successor (this is the last node)\n         */\n    Node<E> next;\n\n    Node(E x) { item = x; }\n  }\n\n  /** \u6307\u5b9a\u961f\u5217\u7684\u957f\u5ea6*/\n  private final int capacity;\n\n  /** \u961f\u5217\u4e2d\u5143\u7d20\u7684\u6570\u91cf */\n  private final AtomicInteger count = new AtomicInteger();\n\n  /**\n     * Head of linked list.\n     * Invariant: head.item == null\n     */\n  transient Node<E> head;\n\n  /**\n     * Tail of linked list.\n     * Invariant: last.next == null\n     */\n  private transient Node<E> last;\n\n  /** \u4ece\u961f\u5217\u79fb\u9664\u6570\u636e\u7684\u9501 */\n  private final ReentrantLock takeLock = new ReentrantLock();\n\n  /** \u79fb\u9664\u6570\u636e\u9501\u5bf9\u5e94\u7684\u6761\u4ef6\u5bf9\u8c61 */\n  private final Condition notEmpty = takeLock.newCondition();\n\n  /** \u5411\u961f\u5217\u6dfb\u52a0\u6570\u636e\u7684\u9501*/\n  private final ReentrantLock putLock = new ReentrantLock();\n\n  /** \u5411\u961f\u5217\u6dfb\u52a0\u6570\u636e\u7684\u9501\u5bf9\u5e94\u7684\u6761\u4ef6\u5bf9\u8c61 */\n  private final Condition notFull = putLock.newCondition();\n  \n  public void put(E e) throws InterruptedException {\n    if (e == null) throw new NullPointerException();\n    int c = -1;\n    Node<E> node = new Node<E>(e);\n    // \u5411\u961f\u5217\u4e2d\u6dfb\u52a0\u6570\u636e\uff0c\u4f7f\u7528 putLock\n    final ReentrantLock putLock = this.putLock;\n    final AtomicInteger count = this.count;\n    // \u83b7\u53d6\u53ef\u4e2d\u65ad\u9501\n    putLock.lockInterruptibly();\n    try {\n      while (count.get() == capacity) {\n        // \u961f\u5217\u6ee1\u4e86\uff0c\u8ba9\u6dfb\u52a0\u6570\u636e\u9501\u5bf9\u5e94\u7684\u6761\u4ef6\u961f\u5217\u7b49\u5f85\n        notFull.await();\n      }\n      enqueue(node);\n      // \u961f\u5217\u5143\u7d20\u6570\u91cf\u52a01\n      c = count.getAndIncrement();\n      if (c + 1 < capacity)\n        notFull.signal();\n    } finally {\n      putLock.unlock();\n    }\n    if (c == 0)\n      signalNotEmpty();\n  }\n   public E take() throws InterruptedException {\n          E x;\n          int c = -1;\n          final AtomicInteger count = this.count;\n                // \u5220\u9664\u6570\u636e\u7684\u9501\n          final ReentrantLock takeLock = this.takeLock;\n          takeLock.lockInterruptibly();\n          try {\n              while (count.get() == 0) {\n                  notEmpty.await();\n              }\n              x = dequeue();\n              c = count.getAndDecrement();\n              if (c > 1)\n                  notEmpty.signal();\n          } finally {\n              takeLock.unlock();\n          }\n          if (c == capacity)\n              signalNotFull();\n          return x;\n      }\n}\n")),(0,l.kt)("h4",{id:"priorityblockingqueue\u65e0\u754c"},"PriorityBlockingQueue\uff08\u65e0\u754c\uff09"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u963b\u585e\u961f\u5217,\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5143\u7d20\u91c7\u7528\u81ea\u7136\u6392\u5e8f\u5347\u5e8f\u6392\u5217 -> ",(0,l.kt)("strong",{parentName:"p"},"\u4e0d\u4fdd\u8bc1\u5177\u6709\u540c\u7b49\u4f18\u5148\u7ea7\u7684\u5143\u7d20\u7684\u987a\u5e8f")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7c7b\u5b9e\u73b0 ",(0,l.kt)("inlineCode",{parentName:"li"},"Comparable\u63a5\u53e3\u7684 compareTo()\u65b9\u6cd5")),(0,l.kt)("li",{parentName:"ul"},"\u8fd8\u53ef\u4ee5\u5728\u521d\u59cb\u5316 PriorityBlockingQueue\u65f6\uff0c\u6307\u5b9a\u6784\u9020\u5668\u53c2\u6570 ",(0,l.kt)("inlineCode",{parentName:"li"},"Comparator"),"\uff0c"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u6ce8\u610f\uff1aPriorityBlockingQueue \u662f\u65e0\u754c\u7684\uff0c\u4e0d\u4f1a\u963b\u585e\u6570\u636e\u751f\u4ea7\u8005\uff0c\u800c\u53ea\u4f1a\u5728\u6ca1\u6709\u53ef\u6d88\u8d39\u7684\u6570\u636e\u65f6\uff0c\u963b\u585e\u6570\u636e\u7684\u6d88\u8d39\u8005"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u751f\u4ea7\u8005\u751f\u4ea7\u6570\u636e\u7684\u901f\u5ea6\u7edd\u5bf9\u4e0d\u80fd\u5feb\u4e8e\u6d88\u8d39\u8005\u6d88\u8d39\u6570\u636e\u7684\u901f\u5ea6"),"\uff0c\u5426\u5219\u65f6\u95f4\u4e00\u957f\uff0c\u4f1a\u6700\u7ec8\u8017\u5c3d\u6240\u6709\u7684\u53ef\u7528\u5806\u5185\u5b58\u7a7a\u95f4"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u5728\u5b9e\u73b0 PriorityBlockingQueue \u65f6\uff0c\u5185\u90e8\u63a7\u5236\u7ebf\u7a0b\u540c\u6b65\u7684\u9501\u91c7\u7528\u7684\u662f\u516c\u5e73\u9501"))),(0,l.kt)("h4",{id:"delayqueue\u65e0\u754c"},"DelayQueue\uff08\u65e0\u754c\uff09"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u652f\u6301\u5ef6\u8fdf\u83b7\u53d6\u5143\u7d20\u7684\u963b\u585e\u961f\u5217\uff0c\u4f7f\u7528 PriorityQueue\u5b9e\u73b0")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u961f\u5217\u4e2d\u7684\u5143\u7d20\u5fc5\u987b\u5b9e\u73b0 ",(0,l.kt)("code",null,"Delay"),"\xa0\u63a5\u53e3\uff0c\u521b\u5efa\u5143\u7d20\u65f6\u6307\u5b9a\u9700\u8981\u591a\u4e45\u624d\u80fd\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u5f53\u524d\u5143\u7d20, \u53ea\u6709\u5f53\u5176\u6307\u5b9a\u7684\u5ef6\u8fdf\u65f6\u95f4\u5230\u4e86\uff0c\u624d\u80fd\u591f\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u8be5\u5143\u7d20")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"DelayQueue \u662f\u4e00\u4e2a\u65e0\u754c\u961f\u5217\uff0c\u56e0\u6b64\u5f80\u961f\u5217\u4e2d\u63d2\u5165\u6570\u636e\u7684 \u64cd\u4f5c(\u751f\u4ea7\u8005)\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u963b\u585e\uff0c\u800c\u53ea\u6709\u83b7\u53d6\u6570\u636e\u7684\u64cd\u4f5c(\u6d88\u8d39\u8005)\u624d\u4f1a\u88ab\u963b\u585e\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"DelayQueue\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u666f:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u7f13\u5b58\u7cfb\u7edf\u7684\u8bbe\u8ba1"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7528DelayQueue\u4fdd\u5b58\u7f13\u5b58\u5143\u7d20\u7684\u6709\u6548\u671f\uff0c\u4f7f\u7528\u7ebf\u7a0b\u5faa\u73af\u67e5\u8be2DelayQueue\uff0c\u5982\u679c\u4eceDelayQueue\u4e2d\u83b7\u53d6\u5230\u5143\u7d20\uff0c\u8868\u793a\u7f13\u5b58\u6709\u6548\u671f\u5230\u4e86"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u5b9a\u65f6\u4efb\u52a1\u8c03\u5ea6"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528DelayQueue\u4fdd\u5b58\u5f53\u5929\u9700\u8981\u6267\u884c\u7684\u4efb\u52a1\uff0c\u4e00\u65e6\u4eceDelayQueue\u4e2d\u83b7\u53d6\u5230\u4efb\u52a1\u5c31\u6267\u884c\uff0c\u6bd4\u5982TimerQueue\u5c31\u662f\u57fa\u4e8eDelayQueue\u7684")))))),(0,l.kt)("h4",{id:"synchronousqueue"},"SynchronousQueue"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("font",{color:"red"},"\u662f\u4e00\u4e2a\u4e0d\u5b58\u50a8\u5143\u7d20\u7684\u963b\u585e\u961f\u5217\uff0c\u6bcf\u4e00\u4e2aput\u64cd\u4f5c\u5fc5\u987b\u7b49\u5f85\u4e00\u4e2atake\u64cd\u4f5c\uff0c\u5426\u5219\u4e0d\u80fd\u6dfb\u52a0\u5143\u7d20")," -> \u541e\u5410\u91cf\u9ad8\u4e8e ArrayBlockingQueue \u548c LinkedBlockingQueue"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u516c\u5e73\u4e0e\u975e\u516c\u5e73\u6a21\u5f0f\u7684\u533a\u522b")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u516c\u5e73\u9501,\u5e76\u914d\u5408\u4e00\u4e2a FIFO \u961f\u5217\u6765\u963b\u585e\u591a\u4f59\u7684\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\uff0c\u4ece\u800c\u4f53\u7cfb\u6574\u4f53\u7684\u516c\u5e73\u7b56\u7565"),(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u975e\u516c\u5e73\u9501\uff0c\u540c\u65f6\u914d\u5408\u4e00\u4e2a FILO \u961f\u5217\u6765\u7ba1\u7406\u591a\u4f59\u7684\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u7531\u4e8e\u961f\u5217\u672c\u8eab\u4e0d\u5b58\u50a8\u4efb\u4f55\u7684\u5143\u7d20\uff0c\u975e\u5e38\u9002\u5408\u4f20\u9012\u6027\u573a\u666f"))),(0,l.kt)("h4",{id:"linkedtransferqueue-\u65e0\u754c"},"LinkedTransferQueue (\u65e0\u754c)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7531\u94fe\u8868\u7ed3\u6784\u7ec4\u6210\u7684\u65e0\u754c\u963b\u585e TransferQueue \u961f\u5217\u3002\u76f8\u5bf9\u4e8e\u5176\u4ed6\u963b\u585e\u961f\u5217\uff0cLinkedTransferQueue \u591a\u4e86 tryTransfer \u548c transfer \u65b9\u6cd5\u3002"),(0,l.kt)("li",{parentName:"ul"},"LinkedTransferQueue \u91c7\u7528\u4e00\u79cd ",(0,l.kt)("font",{color:"red"},"\u9884\u5360\u6a21\u5f0f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6d88\u8d39\u8005\u7ebf\u7a0b\u53d6\u5143\u7d20\u65f6\uff0c\u5982\u679c\u961f\u5217\u4e0d\u4e3a\u7a7a\uff0c\u5219\u76f4\u63a5\u53d6\u8d70\u6570\u636e"),(0,l.kt)("li",{parentName:"ul"},"\u961f\u5217\u4e3a\u7a7a\uff0c\u90a3\u5c31\u751f\u6210\u4e00\u4e2a\u8282\u70b9(\u8282\u70b9\u5143\u7d20\u4e3aNULL)\u5165\u961f\u5217\uff0c",(0,l.kt)("font",{color:"red"},"\u7136\u540e\u6d88\u8d39\u8005\u7ebf\u7a0b\u88ab\u7b49\u5f85\u5728\u8fd9\u4e2a\u8282\u70b9\u4e0a"),"\uff0c\u540e\u9762\u751f\u4ea7\u8005\u7ebf\u7a0b\u5165\u961f\u65f6\u53d1\u73b0\u6709\u4e00\u4e2a\u5143\u7d20\u4e3a null \u7684\u8282\u70b9\uff0c\u751f\u4ea7\u8005\u7ebf\u7a0b\u5c31\u4e0d\u5165\u961f\u4e86\uff0c\u76f4\u63a5\u5c31\u5c06\u5143\u7d20\u586b\u5145\u5230\u8be5\u8282\u70b9\uff0c\u5e76\u5524\u9192\u8be5\u8282\u70b9\u7b49\u5f85\u7684\u7ebf\u7a0b\uff0c\u88ab\u5524\u9192\u7684\u6d88\u8d39\u8005\u7ebf\u7a0b\u53d6\u8d70\u5143\u7d20\uff0c\u4ece\u8c03\u7528\u7684\u65b9\u6cd5\u8fd4\u56de")))),(0,l.kt)("h4",{id:"linkedblockingdeque"},"LinkedBlockingDeque"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7531\u94fe\u8868\u7ed3\u6784\u7ec4\u6210\u7684\u53cc\u5411\u963b\u585e\u961f\u5217\uff0c\u5373\u53ef\u4ee5\u4ece\u961f\u5217\u7684\u4e24\u7aef\u63d2\u5165\u548c\u79fb\u9664\u5143\u7d20"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u521d\u59cb\u5316 LinkedBlockingDeque \u65f6\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u5bb9\u91cf\u65b9\u5f0f\u5176\u8fc7\u5ea6\u81a8\u80c0\uff0c",(0,l.kt)("font",{color:"red"},"\u53e6\u5916\u53cc\u7aef\u963b\u585e\u961f\u5217\u53ef\u4ee5\u4f7f\u7528\u5728 Fork/Join \u7684\u6a21\u5f0f\u4e2d")),(0,l.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u4e00\u4e9b\u6307\u5b9a\u7684\u64cd\u4f5c\uff0c\u5728\u63d2\u5165\u6216\u8005\u83b7\u53d6\u961f\u5217\u5143\u7d20\u65f6\u5982\u679c\u961f\u5217\u72b6\u6001\u4e0d\u5141\u8bb8\u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u963b\u585e\u4f4f\u8be5\u7ebf\u7a0b\u76f4\u5230\u961f\u5217\u72b6\u6001\u53d8\u66f4\u4e3a\u5141\u8bb8\u64cd\u4f5c\uff0c\u8fd9\u91cc\u7684\u963b\u585e\u4e00\u822c\u6709\u4e24\u79cd\u60c5\u51b5:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u63d2\u5165\u5143\u7d20\u65f6: \u5982\u679c\u5f53\u524d\u961f\u5217\u5df2\u6ee1\u5c06\u4f1a\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u4e00\u76f4\u7b49\u5230\u961f\u5217\u6709\u7a7a\u7684\u4f4d\u7f6e\u65f6 \u518d\u8bb2\u8be5\u5143\u7d20\u63d2\u5165",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8be5\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u8d85\u65f6\u53c2\u6570\uff0c\u8d85\u65f6\u540e\u8fd4\u56de false \u8868\u793a\u64cd\u4f5c\u5931\u8d25"),(0,l.kt)("li",{parentName:"ul"},"\u4e5f\u53ef\u4ee5\u4e0d\u8bbe\u7f6e\u8d85\u65f6\u53c2\u6570\u4e00\u76f4\u963b\u585e\uff0c\u4e2d\u65ad\u540e\u629b\u51fa InterruptedException \u5f02\u5e38"))),(0,l.kt)("li",{parentName:"ul"},"\u8bfb\u53d6\u5143\u7d20\u65f6: \u5982\u679c\u5f53\u524d\u961f\u5217\u4e3a\u7a7a\u4f1a\u963b\u585e\u4f4f\u76f4\u5230\u961f\u5217\u4e0d\u4e3a\u7a7a\u7136\u540e\u8fd4\u56de\u5143\u7d20\uff0c\u540c\u6837\u53ef\u4ee5\u8bbe\u7f6e\u8d85\u65f6\u53c2\u6570")))),(0,l.kt)("h2",{id:"\u7ebf\u7a0b\u6c60threadpool"},"\u7ebf\u7a0b\u6c60(ThreadPool)"),(0,l.kt)("h3",{id:"\u7ebf\u7a0b\u6c60\u6982\u8ff0"},"\u7ebf\u7a0b\u6c60\u6982\u8ff0"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u7ebf\u7a0b\u6c60\u662f\u4e00\u79cd\u7ebf\u7a0b\u4f7f\u7528\u6a21\u5f0f\u3002\u7ebf\u7a0b\u8fc7\u591a\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u8fc7\u4e8e\u9891\u7e41\uff0c\u8fdb\u800c\u5f71\u54cd\u7f13\u5b58\u5c40\u90e8\u6027\u548c\u6574\u4f53\u6027\u80fd\u3002\u800c\u7ebf\u7a0b\u6c60\u7ef4\u62a4\u591a\u4e2a\u7ebf\u7a0b\uff0c\u7b49\u5f85\u7ba1\u7406\u8005\u5206\u914d\u53ef\u5e76\u53d1\u6267\u884c\u7684\u4efb\u52a1\u3002\u8fd9\u907f\u514d\u4e86\u5728\u5904\u7406\u77ed\u65f6\u95f4\u4efb\u52a1\u65f6\u521b\u5efa\u4e0e\u9500\u6bc1\u7ebf\u7a0b\u7684\u4ee3\u4ef7\u3002"),(0,l.kt)("font",{color:"red"},"\u7ebf\u7a0b\u6c60\u4e0d\u4ec5\u80fd\u591f\u4fdd\u8bc1\u5185\u6838\u7684\u5145\u5206\u5229\u7528\uff0c\u8fd8\u80fd\u9632\u6b62\u8fc7\u5206\u8c03\u5ea6")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u7ebf\u7a0b\u6c60\u7684\u4f18\u70b9")," : \u53ea\u9700\u8981\u63a7\u5236\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u5904\u7406\u8fc7\u7a0b\u4e2d\u5c06\u4efb\u52a1\u653e\u5165\u961f\u5217\uff0c\u7136\u540e\u5728\u7ebf\u7a0b\u521b\u5efa\u540e\u542f\u52a8\u8fd9\u4e9b\u4efb\u52a1\uff0c\u5982\u679c\u7ebf\u7a0b\u6570\u91cf\u8d85\u8fc7\u4e86\u6700\u5927\u6570\u91cf\uff0c\u8d85\u51fa\u6570\u91cf\u7684\u7ebf\u7a0b\u6392\u961f\u7b49\u5019\uff0c\u7b49\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\uff0c\u518d\u4ece\u961f\u5217\u4e2d\u53d6\u51fa\u4efb\u52a1\u6765\u6267\u884c\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u7ebf\u7a0b\u6c60\u7684\u4e3b\u8981\u7279\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u964d\u4f4e\u8d44\u6e90\u6d88\u8017"),": \u901a\u8fc7\u91cd\u590d\u5229\u7528\u5df2\u521b\u5efa\u7684\u7ebf\u7a0b\u964d\u4f4e\u7ebf\u7a0b\u521b\u5efa\u548c\u9500\u6bc1\u9020\u6210\u7684\u9500\u8017\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u63d0\u9ad8\u54cd\u5e94\u901f\u5ea6"),": \u5f53\u4efb\u52a1\u5230\u8fbe\u65f6\uff0c\u4efb\u52a1\u53ef\u4ee5\u4e0d\u9700\u8981\u7b49\u5f85\u7ebf\u7a0b\u521b\u5efa\u5c31\u80fd\u7acb\u5373\u6267\u884c\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u63d0\u9ad8\u7ebf\u7a0b\u7684\u53ef\u7ba1\u7406\u6027"),": \u7ebf\u7a0b\u662f\u7a00\u7f3a\u8d44\u6e90\uff0c\u5982\u679c\u65e0\u9650\u5236\u7684\u521b\u5efa\uff0c\u4e0d\u4ec5\u4f1a\u9500\u8017\u7cfb\u7edf\u8d44\u6e90\uff0c\u8fd8\u4f1a\u964d\u4f4e\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\uff0c\u4f7f\u7528\u7ebf\u7a0b\u6c60\u53ef\u4ee5\u8fdb\u884c\u7edf\u4e00\u7684\u5206\u914d\uff0c\u8c03\u4f18\u548c\u76d1\u63a7\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"java\u4e2d\u7684\u7ebf\u7a0b\u6c60\u662f\u901a\u8fc7 Executor \u6846\u67b6\u5b9e\u73b0\u7684\uff0c\u8be5\u6846\u67b6\u4e2d\u7528\u5230\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"Executor\uff0cExecutors\uff0cExecutorService\uff0cThreadPoolExecutor")," \u8fd9\u51e0\u4e2a\u7c7b")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"\u901a\u8fc7Executors\u521b\u5efa\u7ebf\u7a0b\u7684\u51e0\u79cd\u5e38\u89c1\u65b9\u5f0f"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"}," Executors.newFixedThreadPool(int nThreads)")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u91c7\u7528 LinkedBlockingQueue \u65e0\u754c\u961f\u5217\u6765\u5b58\u50a8\u4efb\u52a1"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"}," ExecutorService.newSingleThreadExecutor()")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e00\u6c601\u4e2a\u7ebf\u7a0b"),(0,l.kt)("li",{parentName:"ul"},"\u91c7\u7528 LinkedBlockingQueue \u65e0\u754c\u961f\u5217\u6765\u5b58\u50a8\u4efb\u52a1"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Executors.newCachedThreadPool()")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6c60\u6839\u636e\u9700\u6c42\u521b\u5efa\u7ebf\u7a0b\uff0c\u53ef\u4ee5\u6269\u5bb9\uff0c\u91c7\u7528 SynchronousQueue\u5b58\u50a8\u4efb\u52a1"),(0,l.kt)("li",{parentName:"ul"},"\u521b\u5efa\u4e00\u4e2a\u53ef\u7f13\u5b58\u7ebf\u7a0b\u6c60\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u957f\u5ea6\u8d85\u8fc7\u5904\u7406\u9700\u8981\uff0c\u53ef\u7075\u6d3b\u56de\u6536\u7a7a\u95f2\u7ebf\u7a0b\uff0c\u82e5\u65e0\u53ef\u56de\u6536\uff0c\u5219\u65b0\u5efa\u7ebf\u7a0b",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6c60\u4e2d\u6570\u91cf\u6ca1\u6709\u56fa\u5b9a\uff0c\u53ef\u8fbe\u5230\u6700\u5927\u503c(Interger. MAX_VALUE)"),(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u53ef\u8fdb\u884c\u7f13\u5b58\u91cd\u590d\u5229\u7528\u548c\u56de\u6536(\u56de\u6536\u9ed8\u8ba4\u65f6\u95f4\u4e3a 1 \u5206\u949f)"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u7ebf\u7a0b\u6c60\u4e2d\uff0c\u6ca1\u6709\u53ef\u7528\u7ebf\u7a0b\uff0c\u4f1a\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b"))),(0,l.kt)("li",{parentName:"ul"},"\u9002\u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u53ef\u65e0\u9650\u6269\u5927\u7684\u7ebf\u7a0b\u6c60\uff0c\u670d\u52a1\u5668\u8d1f\u8f7d\u538b\u529b\u8f83\u8f7b\uff0c\u6267\u884c\u65f6\u95f4\u8f83\u77ed\uff0c\u4efb\u52a1\u591a\u7684\u573a\u666f")))))),(0,l.kt)("h3",{id:"\u4ee3\u7801\u6f14\u793a-1"},"\u4ee3\u7801\u6f14\u793a"),(0,l.kt)("h4",{id:"newfixedthreadpool"},"newFixedThreadPool"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n  * \u6d4b\u8bd5 newFixedThreadPool\n  */\npublic static void one() {\n  // \u521b\u5efa\u56fa\u5b9a5\u4e2a\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u6c60\n  ExecutorService fixedThreadPool = Executors.newFixedThreadPool(5);\n  try {\n    for (int i = 1; i <= 10; i++) {\n      fixedThreadPool.execute(() -> {\n        System.out.println(Thread.currentThread().getName() + "\\t\u6b63\u5728\u5904\u7406");\n      });\n    }\n  }finally {\n    // \u5173\u95ed\n    fixedThreadPool.shutdown();\n  }\n}\n\n/*\n    pool-1-thread-1 \u6b63\u5728\u5904\u7406\n  pool-1-thread-5   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-4   \u6b63\u5728\u5904\u7406\n  pool-1-thread-3   \u6b63\u5728\u5904\u7406\n  pool-1-thread-2   \u6b63\u5728\u5904\u7406\n  pool-1-thread-4   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-5   \u6b63\u5728\u5904\u7406\n*/\n')),(0,l.kt)("h4",{id:"newsinglethreadexecutor"},"newSingleThreadExecutor"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},' /**\n * Executors.newSingleThreadExecutor(); -> \u521b\u5efa\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u6c60\n * \u53ea\u4f1a\u6709\u4e00\u4e2a\u7ebf\u7a0b\u6765\u5904\u7406\u4efb\u52a1\n */\npublic static void two() {\n  ExecutorService singleThreadExecutor = Executors.newSingleThreadExecutor();\n  try {\n    for (int i = 1; i <= 10; i++) {\n      singleThreadExecutor.execute(() -> {\n        System.out.println(Thread.currentThread().getName() + "\\t\u6b63\u5728\u5904\u7406");\n      });\n    }\n  }finally {\n    // \u5173\u95ed\n    singleThreadExecutor.shutdown();\n  }\n}\n\n/*\n    pool-1-thread-1 \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n  pool-1-thread-1   \u6b63\u5728\u5904\u7406\n*/\n')),(0,l.kt)("h4",{id:"newcachedthreadpool"},"newCachedThreadPool"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * Executors.newCachedThreadPool(); -> \u521b\u5efa\u53ef\u6269\u5bb9\u7684\u7ebf\u7a0b\u6c60\n */\npublic static void three() {\n  //\n  ExecutorService cachedThreadPool = Executors.newCachedThreadPool();\n  try {\n    for (int i = 1; i <= 10; i++) {\n      cachedThreadPool.execute(() -> {\n        System.out.println(Thread.currentThread().getName() + "\\t\u6b63\u5728\u5904\u7406");\n      });\n    }\n  }finally {\n    // \u5173\u95ed\n    cachedThreadPool.shutdown();\n  }\n}\n/*\n    pool-1-thread-1 \u6b63\u5728\u5904\u7406\n  pool-1-thread-5   \u6b63\u5728\u5904\u7406\n  pool-1-thread-4   \u6b63\u5728\u5904\u7406\n  pool-1-thread-6   \u6b63\u5728\u5904\u7406\n  pool-1-thread-3   \u6b63\u5728\u5904\u7406\n  pool-1-thread-2   \u6b63\u5728\u5904\u7406\n  pool-1-thread-7   \u6b63\u5728\u5904\u7406\n  pool-1-thread-8   \u6b63\u5728\u5904\u7406\n  pool-1-thread-5   \u6b63\u5728\u5904\u7406\n  pool-1-thread-8   \u6b63\u5728\u5904\u7406\n*/\n')),(0,l.kt)("h3",{id:"\u7ebf\u7a0b\u6c60\u5e95\u5c42\u5de5\u4f5c\u539f\u7406"},"\u7ebf\u7a0b\u6c60\u5e95\u5c42\u5de5\u4f5c\u539f\u7406"),(0,l.kt)("admonition",{title:"\u7ebf\u7a0b\u6c60\u5e95\u5c42\u5de5\u4f5c\u539f\u7406",type:"danger"},(0,l.kt)("ol",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ol"},"\u5728\u521b\u5efa\u4e86\u7ebf\u7a0b\u6c60\u540e\uff0c\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u6570\u4e3a\u96f6"),(0,l.kt)("li",{parentName:"ol"},"\u5f53\u8c03\u7528",(0,l.kt)("inlineCode",{parentName:"li"},"execute()"),"\u65b9\u6cd5\u6dfb\u52a0\u4e00\u4e2a\u8bf7\u6c42\u4efb\u52a1\u65f6\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u505a\u51fa\u5982\u4e0b\u5224\u65ad",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u5c0f\u4e8e ",(0,l.kt)("inlineCode",{parentName:"li"},"corePoolSize"),"\uff0c\u90a3\u4e48\u9a6c\u4e0a\u521b\u5efa\u7ebf\u7a0b\u8fd0\u884c\u8fd9\u4e2a\u4efb\u52a1"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u5927\u4e8e\u6216\u7b49\u4e8e ",(0,l.kt)("inlineCode",{parentName:"li"},"corePoolSize"),"\uff0c\u90a3\u4e48\u5c06\u8fd9\u4e2a\u4efb\u52a1\u653e\u5165\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u8fd9\u4e2a\u65f6\u5019\u961f\u5217\u6ee1\u4e86\u4e14\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u8fd8\u5c0f\u4e8e ",(0,l.kt)("inlineCode",{parentName:"li"},"maximumPoolSize"),"\uff0c\u90a3\u4e48\u8fd8\u662f\u8981\u521b\u5efa\u975e\u6838\u5fc3\u7ebf\u7a0b\u7acb\u523b\u8fd0\u884c\u8fd9\u4e2a\u4efb\u52a1;"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u961f\u5217\u6ee1\u4e86\u4e14\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u5927\u4e8e\u6216\u7b49\u4e8e ",(0,l.kt)("inlineCode",{parentName:"li"},"maximumPoolSize"),"\uff0c\u90a3\u4e48\u7ebf\u7a0b \u6c60\u4f1a\u542f\u52a8\u9971\u548c\u62d2\u7edd\u7b56\u7565\u6765\u6267\u884c"))),(0,l.kt)("li",{parentName:"ol"},"\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5b8c\u6210\u4efb\u52a1\u65f6\uff0c\u5b83\u4f1a\u4ece\u961f\u5217\u4e2d\u53d6\u4e0b\u4e00\u4e2a\u4efb\u52a1\u6765\u6267\u884c"),(0,l.kt)("li",{parentName:"ol"},"\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u65e0\u4e8b\u53ef\u505a\u8d85\u8fc7\u4e00\u5b9a\u7684\u65f6\u95f4(",(0,l.kt)("inlineCode",{parentName:"li"},"keepAliveTime"),")\u65f6\uff0c\u7ebf\u7a0b\u4f1a\u5224\u65ad:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5f53\u524d\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u5927\u4e8e ",(0,l.kt)("inlineCode",{parentName:"li"},"corePoolSize"),"\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7ebf\u7a0b\u5c31\u88ab\u505c\u6389\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u6240\u6709\u7ebf\u7a0b\u6c60\u7684\u6240\u6709\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u5b83\u6700\u7ec8\u4f1a\u6536\u7f29\u5230 ",(0,l.kt)("inlineCode",{parentName:"li"},"corePoolSize")," \u7684\u5927\u5c0f"))))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(20855).Z,width:"1027",height:"590"})),(0,l.kt)("h3",{id:"\u7ebf\u7a0b\u6c60\u53c2\u6570\u8bf4\u660e"},"\u7ebf\u7a0b\u6c60\u53c2\u6570\u8bf4\u660e"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"corePoolSize"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6c60\u7684\u6838\u5fc3\u7ebf\u7a0b\u6570"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"maximumPoolSize"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u80fd\u5bb9\u7eb3\u7684\u6700\u5927\u7ebf\u7a0b\u6570"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"keepAliveTime")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7a7a\u95f2\u7ebf\u7a0b\u5b58\u6d3b\u65f6\u95f4"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"unit"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5b58\u6d3b\u7684\u65f6\u95f4\u5355\u4f4d"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"workQueue")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5b58\u653e\u63d0\u4ea4\u4f46\u672a\u6267\u884c\u4efb\u52a1\u7684\u961f\u5217"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"threadFactory")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u521b\u5efa\u7ebf\u7a0b\u7684\u5de5\u5382\u7c7b"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"handler")," ",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7b49\u5f85\u961f\u5217\u6ee1\u540e\u7684\u62d2\u7edd\u7b56\u7565")))),(0,l.kt)("admonition",{type:"danger"},(0,l.kt)("ul",{parentName:"admonition"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6c60\u4e2d\uff0c\u6709\u4e09\u4e2a\u91cd\u8981\u7684\u53c2\u6570\u51b3\u5b9a\u5f71\u54cd\u4e86\u62d2\u7edd\u7b56\u7565 -> ",(0,l.kt)("inlineCode",{parentName:"li"},"\u5f53\u63d0\u4ea4\u7684\u4efb\u52a1\u6570 > workQueue.size() + maximumPoolSize")," \uff0c\u5c31\u4f1a\u89e6\u53d1\u7ebf\u7a0b\u6c60\u7684\u62d2\u7edd\u7b56\u7565",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"corePoolSize: \u6838\u5fc3\u7ebf\u7a0b\u6570\uff0c\u4e5f\u5373\u6700\u5c0f\u7684\u7ebf\u7a0b\u6570"),(0,l.kt)("li",{parentName:"ul"},"workQueue:\u963b\u585e\u961f\u5217\u3001\u5de5\u4f5c\u961f\u5217"),(0,l.kt)("li",{parentName:"ul"},"maximumPoolSize: \u6700\u5927\u7ebf\u7a0b\u6570"))))),(0,l.kt)("h4",{id:"\u62d2\u7edd\u7b56\u7565-"},"\u62d2\u7edd\u7b56\u7565 \ud83c\udf1f"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CallerRunsPolicy"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u201c\u8c03\u7528\u8005\u8fd0\u884c\u201d\u7684\u4e00\u79cd\u8c03\u8282\u673a\u5236"),(0,l.kt)("li",{parentName:"ul"},"\u8be5\u7b56\u7565\u4e0d\u4f1a\u4e22\u5f03\u4efb\u52a1\uff0c\u4e5f\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u800c\u662f\u5c06\u67d0\u4e9b\u4efb\u52a1\u56de\u9000\u5230\u8c03\u7528\u8005\uff0c\u4ece\u800c\u964d\u4f4e\u65b0\u4efb\u52a1\u7684\u6d41\u91cf"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"AbortPolicy(\u9ed8\u8ba4)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e22\u5f03\u4efb\u52a1\uff0c\u5e76\u629b\u51fa\u62d2\u7edd\u6267\u884c RejectedExecutionException \u5f02\u5e38\u4fe1\u606f",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6c60\u9ed8\u8ba4\u7684\u62d2\u7edd\u7b56\u7565"))),(0,l.kt)("li",{parentName:"ul"},"\u5fc5\u987b\u5904\u7406\u597d\u629b\u51fa\u7684\u5f02\u5e38\uff0c\u5426\u5219\u4f1a\u6253\u65ad\u5f53\u524d\u7684\u6267\u884c\u6d41\u7a0b\uff0c\u5f71\u54cd\u540e\u7eed\u7684\u4efb\u52a1\u6267\u884c"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"DiscardPolicy"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u76f4\u63a5\u4e22\u5f03\uff0c\u5176\u4ed6\u5565\u90fd\u6ca1\u6709"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u5141\u8bb8\u4efb\u52a1\u5931\u8d25\uff0c\u8fd9\u4e2a\u662f\u6700\u597d\u7684\u7b56\u7565"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"DiscardOldestPolicy"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e22\u5f03\u963b\u585e\u961f\u5217\u4e2d\u6700\u8001\u7684\u4e00\u4e2a\u4efb\u52a1\uff0c\u5e76\u5c06\u65b0\u4efb\u52a1\u52a0\u5165\u5230\u5de5\u4f5c\u961f\u5217\u4e2d\uff0c\u5c1d\u8bd5\u518d\u6b21\u63d0\u4ea4\u5f53\u524d\u4efb\u52a1")))),(0,l.kt)("h3",{id:"\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60"},"\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60"),(0,l.kt)("p",null,"\u5b9e\u9645\u5f00\u53d1\u4e2d\u4e00\u822c\u4e0d\u7528 Executors\u6765\u521b\u5efa\u7ebf\u7a0b\u6c60,\u963f\u91cc\u5f00\u53d1\u624b\u518c\u4e2d\u4e2d\u5f3a\u5236\u89c4\u5b9a:"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"alt",src:t(18618).Z,width:"824",height:"227"})),(0,l.kt)("h4",{id:"\u4ee3\u7801\u5b9e\u73b0-2"},"\u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class ThreadPoolDemo2 {\n    // \u6838\u5fc3\u7ebf\u7a0b\u6570,\u8fd9\u91cc\u4f7f\u7528\u5904\u7406\u5668\u4e2a\u6570\n    public static final int corePoolSize = Runtime.getRuntime().availableProcessors();  // 8\n    // \u6700\u5927\u7ebf\u7a0b\u6570\n    public static final int maximumPoolSize = corePoolSize * 3;\n    // \u5b58\u6d3b\u65f6\u95f4\n    public static final long keepAliveTime = 2L;\n    // \u9ed8\u8ba4\u7684\u7ebf\u7a0b\u5de5\u5382\n    public static final ThreadFactory factory = Executors.defaultThreadFactory();\n    // \u62d2\u7edd\u7b56\u7565\n    public static final RejectedExecutionHandler handler = new ThreadPoolExecutor.AbortPolicy();\n    public static void main(String[] args) {\n        // \u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u7ebf\u7a0b\u6c60\n        ThreadPoolExecutor poolExecutor = new ThreadPoolExecutor(corePoolSize, maximumPoolSize, keepAliveTime, TimeUnit.SECONDS,\n                                                            new LinkedBlockingDeque<>(5), factory,  handler);\n        try {\n            for (int i = 1; i <= 30; i++) {\n                poolExecutor.execute(() -> {\n                    System.out.println(Thread.currentThread().getName() + "\\t\u6b63\u5728\u5904\u7406");\n                });\n            }\n        }finally {\n            // \u5173\u95ed\n            poolExecutor.shutdown();\n        }\n    }\n}\n')),(0,l.kt)("h2",{id:"forkjoin-\u5206\u652f\u5408\u5e76\u6846\u67b6"},"Fork/Join \u5206\u652f\u5408\u5e76\u6846\u67b6"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"Fork/Join \u5b83\u53ef\u4ee5\u5c06\u4e00\u4e2a\u5927\u7684\u4efb\u52a1\u62c6\u5206\u6210\u591a\u4e2a\u5b50\u4efb\u52a1\u8fdb\u884c\u5e76\u884c\u5904\u7406\uff0c\u6700\u540e\u5c06\u5b50\u4efb\u52a1\u7ed3\u679c\u5408\u5e76\u6210\u6700\u540e\u7684\u8ba1\u7b97\u7ed3\u679c\uff0c\u5e76\u8fdb\u884c\u8f93\u51fa")," \u3002Fork/Join \u6846\u67b6\u8981\u5b8c\u6210\u4e24\u4ef6\u4e8b\u60c5",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Fork"),": \u628a\u4e00\u4e2a\u590d\u6742\u4efb\u52a1\u8fdb\u884c\u5206\u62c6\uff0c\u5927\u4e8b\u5316\u5c0f: ",(0,l.kt)("strong",{parentName:"li"},"\u4efb\u52a1\u5206\u5272"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9996\u5148Fork/Join\u6846\u67b6\u9700\u8981\u628a\u5927\u7684\u4efb\u52a1\u5206\u5272\u6210\u8db3\u591f\u5c0f\u7684\u5b50\u4efb\u52a1\uff0c\u5982\u679c\u5b50\u4efb\u52a1\u6bd4\u8f83\u5927\u7684\u8bdd\u8fd8\u8981\u5bf9\u5b50\u4efb\u52a1\u8fdb\u884c\u7ee7\u7eed\u5206\u5272"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Join"),": \u628a\u5206\u62c6\u4efb\u52a1\u7684\u7ed3\u679c\u8fdb\u884c\u5408\u5e76: ",(0,l.kt)("strong",{parentName:"li"},"\u6267\u884c\u4efb\u52a1\u5e76\u5408\u5e76\u7ed3\u679c"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5206\u5272\u7684\u5b50\u4efb\u52a1\u5206\u522b\u653e\u5230\u53cc\u7aef\u961f\u5217\u91cc\uff0c\u7136\u540e\u51e0\u4e2a\u542f\u52a8\u7ebf\u7a0b \u5206\u522b\u4ece\u53cc\u7aef\u961f\u5217\u91cc\u83b7\u53d6\u4efb\u52a1\u6267\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u5b50\u4efb\u52a1\u6267\u884c\u5b8c\u7684\u7ed3\u679c\u90fd\u653e\u5728\u53e6\u5916\u4e00\u4e2a\u961f\u5217\u91cc\uff0c \u542f\u52a8\u4e00\u4e2a\u7ebf\u7a0b\u4ece\u961f\u5217\u91cc\u53d6\u6570\u636e\uff0c\u7136\u540e\u5408\u5e76\u8fd9\u4e9b\u6570\u636e"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5728 java \u7684 Fork/Join \u6846\u67b6\u4e2d\uff0c\u4f7f\u7528\u4e24\u4e2a\u7c7b\u5b8c\u6210\u4e0a\u8ff0\u64cd\u4f5c"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"ForkJoinTask")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6211\u4eec\u8981\u4f7f\u7528 Fork/Join \u6846\u67b6\uff0c\u9996\u5148\u9700\u8981\u521b\u5efa\u4e00\u4e2a ForkJoin \u4efb\u52a1\u3002 \u8be5\u7c7b\u63d0\u4f9b\u4e86\u5728\u4efb\u52a1\u4e2d\u6267\u884c fork \u548c join \u7684\u673a\u5236"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"RecursiveAction")," "),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u6ca1\u6709\u8fd4\u56de\u7ed3\u679c\u7684\u4efb\u52a1"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"RecursiveTask")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u7528\u4e8e\u6709\u8fd4\u56de\u7ed3\u679c\u7684\u4efb\u52a1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u7ee7\u627f\u540e\u53ef\u4ee5\u5b9e\u73b0\u9012\u5f52(\u81ea\u5df1\u8c03\u81ea\u5df1)\u8c03\u7528\u7684\u4efb\u52a1")))))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"ForkJoinPool")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"ForkJoinTask \u9700\u8981\u901a\u8fc7 ForkJoinPool \u6765\u6267\u884c")))))),(0,l.kt)("admonition",{title:"fork/join \u6846\u67b6\u7684\u5b9e\u73b0\u539f\u7406",type:"caution"},(0,l.kt)("p",{parentName:"admonition"},"ForkJoinPool \u7531 ForkJoinTask \u6570\u7ec4\u548c ForkJoinWorkerThread \u6570\u7ec4\u7ec4\u6210\uff0c ForkJoinTask \u6570\u7ec4\u8d1f\u8d23\u5c06\u5b58\u653e\u4ee5\u53ca\u5c06\u7a0b\u5e8f\u63d0\u4ea4\u7ed9 ForkJoinPool\uff0c\u800c ForkJoinWorkerThread \u8d1f\u8d23\u6267\u884c\u8fd9\u4e9b\u4efb\u52a1\u3002")),(0,l.kt)("h3",{id:"forkjoin\u65b9\u6cd5\u5b9e\u73b0\u539f\u7406"},"Fork\u3001Join\u65b9\u6cd5\u5b9e\u73b0\u539f\u7406"),(0,l.kt)("h4",{id:"fork\u65b9\u6cd5"},"Fork\u65b9\u6cd5"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5f53\u8c03\u7528 ForkJoinTask\u7684fork()\u65b9\u6cd5\u65f6\uff0c\u4f1a\u628a\u4efb\u52a1\u653e\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"ForkJoinPool.WorkQueue [\u5de5\u4f5c\u7a83\u53d6\u961f\u5217]")," \u4e2d\uff0c\u5f02\u6b65\u5730\u6267\u884c\u8fd9\u4e2a\u4efb\u52a1\uff0c\u7136\u540e\u7acb\u5373\u8fd4\u56de\u7ed3\u679c"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public final ForkJoinTask<V> fork() {\n  Thread t;\n  if ((t = Thread.currentThread()) instanceof ForkJoinWorkerThread)\n    ((ForkJoinWorkerThread)t).workQueue.push(this);\n  else\n    ForkJoinPool.common.externalPush(this);\n  return this;\n}\n")))),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"push() \u65b9\u6cd5\u628a\u5f53\u524d\u4efb\u52a1\u5b58\u653e\u5728 ForkJoinTask \u6570\u7ec4\u961f\u5217\u91cc\u3002\u7136\u540e\u518d\u8c03\u7528 ForkJoinPool \u7684 signalWork()\u65b9\u6cd5\u5524\u9192\u6216\u521b\u5efa\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},"final void push(ForkJoinTask<?> task) {\n  ForkJoinTask<?>[] a; \n  ForkJoinPool p;\n  int b = base, s = top, n;\n  if ((a = array) != null) {   \n    int m = a.length - 1;   \n    U.putOrderedObject(a, ((m & s) << ASHIFT) + ABASE, task);\n    U.putOrderedInt(this, QTOP, s + 1);\n    if ((n = s - b) <= 1) {\n      if ((p = pool) != null)\n        p.signalWork(p.workQueues, this); // \u901a\u77e5\u5524\u9192\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1\n    }\n    else if (n >= m)\n      growArray();\n  }\n}\n")))),(0,l.kt)("h4",{id:"join\u65b9\u6cd5"},"Join\u65b9\u6cd5"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"Join \u65b9\u6cd5\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u5e76\u7b49\u5f85\u83b7\u53d6\u7ed3\u679c"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9996\u5148\u8c03\u7528 doJoin() \u65b9\u6cd5\uff0c\u901a\u8fc7 doJoin()\u65b9\u6cd5\u5f97\u5230\u5f53\u524d\u4efb\u52a1\u7684\u72b6\u6001\u6765\u5224\u65ad\u8fd4\u56de\u4ec0\u4e48\u7ed3\u679c\uff0c\u4efb\u52a1\u72b6\u6001\u6709 4 \u79cd:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"normal ->\u5df2\u5b8c\u6210"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4efb\u52a1\u72b6\u6001\u662f\u5df2\u5b8c\u6210\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u4efb\u52a1\u7ed3\u679c"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"cancelled -> \u88ab\u53d6\u6d88"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4efb\u52a1\u72b6\u6001\u662f\u88ab\u53d6\u6d88\uff0c\u5219\u76f4\u63a5\u629b\u51fa CancellationException"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"signal -> \u4fe1\u53f7")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"exceptional -> \u51fa\u73b0\u5f02\u5e38"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4efb\u52a1\u72b6\u6001\u662f\u629b\u51fa\u5f02\u5e38\uff0c\u5219\u76f4\u63a5\u629b\u51fa\u5bf9\u5e94\u7684\u5f02\u5e38"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"doJoin()\u65b9\u6cd5\u6d41\u7a0b\u5982\u4e0b:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9996\u5148\u901a\u8fc7\u67e5\u770b\u4efb\u52a1\u7684\u72b6\u6001\uff0c\u770b\u4efb\u52a1\u662f\u5426\u5df2\u7ecf\u6267\u884c\u5b8c\u6210\uff0c\u5982\u679c\u6267\u884c\u5b8c\u6210\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u4efb\u52a1\u72b6\u6001"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u6ca1\u6709\u6267\u884c\u5b8c\uff0c\u5219\u4ece\u4efb\u52a1\u6570\u7ec4\u91cc\u53d6\u51fa\u4efb\u52a1\u5e76\u6267\u884c"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4efb\u52a1\u987a\u5229\u6267\u884c\u5b8c\u6210\uff0c\u5219\u8bbe\u7f6e\u4efb\u52a1\u72b6\u6001\u4e3anormal\uff0c\u5982\u679c\u51fa\u73b0\u5f02\u5e38\uff0c\u5219\u8bb0\u5f55\u5f02\u5e38\uff0c\u5e76\u5c06\u4efb\u52a1\u72b6\u6001\u8bbe\u7f6e\u4e3a exceptional")))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"// java.util.concurrent.ForkJoinTask#join\npublic final V join() {\n  int s;\n  if ((s = doJoin() & DONE_MASK) != NORMAL)\n    reportException(s);\n  return getRawResult();\n}\n\n\n// java.util.concurrent.ForkJoinTask#doJoin\nprivate int doJoin() {\n  int s; \n  Thread t; \n  ForkJoinWorkerThread wt; \n  ForkJoinPool.WorkQueue w;\n  return (s = status) < 0 ? s :\n    ((t = Thread.currentThread()) instanceof ForkJoinWorkerThread) ?\n    (w = (wt = (ForkJoinWorkerThread)t).workQueue).\n    tryUnpush(this) && (s = doExec()) < 0 ? s :\n  wt.pool.awaitJoin(w, this, 0L) :\n  externalAwaitDone();\n}\n// java.util.concurrent.ForkJoinTask#doExec\nfinal int doExec() {\n  int s; boolean completed;\n  if ((s = status) >= 0) {\n    try {\n      completed = exec();\n    } catch (Throwable rex) {\n      return setExceptionalCompletion(rex);\n    }\n    if (completed)\n      s = setCompletion(NORMAL);\n  }\n  return s;\n}\n")),(0,l.kt)("h4",{id:"forkjoin-\u6846\u67b6\u7684\u5f02\u5e38\u5904\u7406"},"Fork/Join \u6846\u67b6\u7684\u5f02\u5e38\u5904\u7406"),(0,l.kt)("p",null,"ForkJoinTask \u5728\u6267\u884c\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u4f46\u662f\u6ca1\u529e\u6cd5\u5728\u4e3b\u7ebf\u7a0b\u91cc\u76f4\u63a5\u6355\u83b7\u5f02\u5e38\uff0c"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"ForkJoinTask \u63d0\u4f9b\u4e86 ",(0,l.kt)("inlineCode",{parentName:"strong"},"isCompletedAbnormally()"),"\u65b9\u6cd5\u6765\u68c0\u67e5\u4efb\u52a1\u662f\u5426\u5df2\u7ecf\u629b\u51fa\u5f02\u5e38\u6216\u5df2\u7ecf\u88ab\u53d6\u6d88\u4e86\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7 ForkJoinTask \u7684 ",(0,l.kt)("inlineCode",{parentName:"strong"},"getException()")," \u65b9\u6cd5\u83b7\u53d6\u5f02\u5e38")),(0,l.kt)("li",{parentName:"ul"},"getException \u65b9\u6cd5\u8fd4\u56de Throwable \u5bf9\u8c61",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4efb\u52a1\u88ab\u53d6\u6d88\u4e86\u5219\u8fd4\u56de CancellationException"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4efb\u52a1\u6ca1\u6709\u5b8c\u6210\u6216\u8005\u6ca1\u6709\u629b\u51fa\u5f02\u5e38\u5219\u8fd4\u56de null")))),(0,l.kt)("h4",{id:"\u4ee3\u7801\u5b9e\u73b0-3"},"\u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u901a\u8fc7fork/join \u8ba1\u7b971\u52301000 \u7684\u548c")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u81ea\u5b9a\u4e49\u7684\u4efb\u52a1\u5bf9\u8c61")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class MyTask extends RecursiveTask<Integer> {\n\n    private static final int VALUE = 10;  // \u62c6\u5206\u5dee\u503c\u4e0d\u8d85\u8fc710\n    private int begin;              // \u62c6\u5206\u7684\u5f00\u59cb\u503c\n    private int end;                // \u62c6\u5206\u7684\u7ed3\u675f\u503c\n    private int sum;                // \u8fd4\u56de\u7ed3\u679c\n\n    // \u521b\u5efa\u6709\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\n    public MyTask(int beginValue, int endValue) {\n        this.begin = beginValue;\n        this.end = endValue;\n    }\n\n    /**\n     * \u81ea\u5b9a\u4e49\u4efb\u52a1\u62c6\u5206\u4e0e\u5408\u5e76\u7684\u903b\u8f91 -> \u6bcf\u6b21fork\u4f1a\u5faa\u73af\u7684\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\n     */\n    @Override\n    protected Integer compute() {\n        if (end - begin <= VALUE) {\n            // \u62c6\u5206\u7684\u5f00\u59cb\u7ed3\u675f\u503c\u5c0f\u4e8e10,\u4e0d\u9700\u8981\u8fdb\u884c\u62c6\u5206\u64cd\u4f5c,\u76f4\u63a5\u7d2f\u52a0\n            for (int i = begin; i <= end; i++) {\n                sum +=i;\n            }\n        } else {\n            // \u62c6\u5206\u7684\u5f00\u59cb\u7ed3\u675f\u503c\u5927\u4e8e10,\u8fdb\u884c\u62c6\u5206\u64cd\u4f5c\n            int middle = (begin + end) / 2;\n            // \u5bf9\u5de6\u53f3\u8fb9\u8fdb\u884c\u62c6\u5206\n            MyTask taskLeft = new MyTask(begin, middle);\n            MyTask taskRight = new MyTask(middle + 1, end);\n            // \u5c06\u672c\u6b21\u62c6\u5206\u7684\u4efb\u52a1\u63d0\u4ea4\u5230\u5de5\u4f5c\u961f\u5217\u4e2d\u5e76\u6267\u884c -> \u5de5\u4f5c\u7ebf\u7a0b\u4f1a\u7ee7\u7eed\u6267\u884c\u961f\u5217\u4e2d\u5143\u7d20(RecursiveTask\u5bf9\u8c61)\u7684 compute\u65b9\u6cd5\n            taskLeft.fork();\n            taskRight.fork();\n            // \u540c\u6b65\u963b\u585e\u83b7\u53d6\u7ed3\u679c\n            sum = taskLeft.join() + taskRight.join();\n        }\n        return sum;\n    }\n}\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"\u5206\u652f\u5408\u5e76\u4e3b\u903b\u8f91")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class ForkJoinDemo {\n    /**\n     * \u8ba1\u7b97 1~1000 \u7684\u548c,\u62c6\u5206\u65f6,\u4e24\u4e2a\u5dee\u503c\u4e0d\u8d85\u8fc710\n     * @param args\n     */\n    public static void main(String[] args) {\n        // \u5b9a\u4e49\u4efb\u52a1\n        MyTask task = new MyTask(1, 1000);\n        // \u5b9a\u4e49\u5206\u652f\u5408\u5e76\u5de5\u4f5c\u6c60\u5bf9\u8c61\n        ForkJoinPool pool = new ForkJoinPool();\n        // \u5411\u5206\u4e4b\u5408\u5e76\u6c60\u4e2d\u63d0\u4ea4\u4efb\u52a1\n        ForkJoinTask<Integer> forkJoinTask = pool.submit(task);\n        try {\n            System.out.println(forkJoinTask.get());\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            pool.shutdown();\n        }\n    }\n}\n")),(0,l.kt)("h2",{id:"completablefuture-\u5f02\u6b65\u56de\u8c03"},"CompletableFuture \u5f02\u6b65\u56de\u8c03"),(0,l.kt)("h3",{id:"completablefuture-\u7b80\u4ecb"},"CompletableFuture \u7b80\u4ecb"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"CompletableFuture \u5728 java \u91cc\u9762\u88ab\u7528\u4e8e\u5f02\u6b65\u7f16\u7a0b\uff0c\u5f02\u6b65\u901a\u5e38\u610f\u5473\u7740\u975e\u963b\u585e\uff0c \u53ef\u4ee5\u4f7f\u5f97\u6211\u4eec\u7684\u4efb\u52a1\u5355\u72ec\u8fd0\u884c\u5728\u4e0e\u4e3b\u7ebf\u7a0b\u5206\u79bb\u7684\u5176\u4ed6\u7ebf\u7a0b\u4e2d\uff0c\u5e76\u4e14\u901a\u8fc7\u56de\u8c03\u53ef\u4ee5\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u5f97\u5230\u5f02\u6b65\u4efb\u52a1\u7684\u6267\u884c\u72b6\u6001\u3001\u662f\u5426\u5b8c\u6210\u3001\u662f\u5426\u5f02\u5e38\u7b49\u4fe1\u606f")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"CompletableFuture \u5b9e\u73b0\u4e86 ",(0,l.kt)("inlineCode",{parentName:"p"},"Future"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"CompletionStage")," \u63a5\u53e3"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5b9e\u73b0\u4e86 Future \u63a5\u53e3\u5c31\u53ef\u4ee5\u517c\u5bb9\u73b0\u5728\u6709\u7ebf\u7a0b\u6c60\u6846\u67b6"),(0,l.kt)("li",{parentName:"ul"},"CompletionStage \u63a5\u53e3\u624d\u662f\u5f02\u6b65\u7f16\u7a0b \u7684\u63a5\u53e3\u62bd\u8c61\uff0c\u91cc\u9762\u5b9a\u4e49\u591a\u79cd\u5f02\u6b65\u65b9\u6cd5"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"Future \u4e0e CompletableFuture"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Futrue\u901a\u5e38\u7528\u6765\u8868\u793a\u4e00\u4e2a\u5f02\u6b65\u4efb\u52a1\u7684\u5f15\u7528",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982\u6211\u4eec\u5c06\u4efb\u52a1\u63d0\u4ea4\u5230\u7ebf\u7a0b\u6c60\u91cc\u9762\uff0c\u7136\u540e\u6211\u4eec\u4f1a\u5f97\u5230\u4e00\u4e2a Futrue\uff0c\u5728 Future \u91cc\u9762\u6709 isDone() \u6765\u5224\u65ad\u4efb\u52a1\u662f\u5426\u5904\u7406\u7ed3\u675f\uff0c\u8fd8\u6709 get()\u53ef\u4ee5\u4e00\u76f4\u963b\u585e\u76f4\u5230\u4efb\u52a1\u7ed3\u675f\u7136\u540e\u83b7\u53d6\u7ed3\u679c"),(0,l.kt)("li",{parentName:"ul"},"\u4f46\u6574\u4f53\u6765\u8bf4Future\u8fd9\u79cd\u65b9\u5f0f\u8fd8\u662f\u540c\u6b65\u7684\uff0c\u56e0\u4e3a\u9700\u8981\u5ba2\u6237\u7aef\u4e0d\u65ad\u963b\u585e\u7b49\u5f85\u6216\u8005\u4e0d\u65ad\u8f6e\u8be2\u624d\u80fd\u77e5\u9053\u4efb\u52a1\u662f\u5426\u5b8c\u6210"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Future\u7684\u7f3a\u70b9"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u652f\u6301\u624b\u52a8\u5b8c\u6210"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u63d0\u4ea4\u4e86\u4e00\u4e2a\u4efb\u52a1\uff0c\u4f46\u662f\u6267\u884c\u592a\u6162\u4e86\uff0c\u901a\u8fc7\u5176\u4ed6\u8def\u5f84\u5df2\u7ecf\u83b7\u53d6\u5230\u4e86\u4efb\u52a1\u7ed3\u679c,\u4f46\u662f\u6ca1\u6cd5\u628a\u8fd9\u4e2a\u4efb\u52a1\u7ed3\u679c\u901a\u77e5\u5230\u6b63\u5728\u6267\u884c\u7684\u7ebf\u7a0b\uff0c\u6240\u4ee5\u5fc5\u987b\u4e3b\u52a8\u53d6\u6d88\u6216\u8005\u4e00\u76f4\u7b49\u5f85\u5b83\u6267\u884c\u5b8c\u6210"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u652f\u6301\u8fdb\u4e00\u6b65\u7684\u975e\u963b\u585e\u8c03\u7528"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7 Future \u7684 get() \u4f1a\u4e00\u76f4\u963b\u585e\u5230\u4efb\u52a1\u5b8c\u6210\uff0c\u4f46\u662f\u60f3\u5728\u83b7\u53d6\u4efb\u52a1\u4e4b\u540e\u6267\u884c\u989d\u5916\u7684\u4efb\u52a1\uff0c\u56e0\u4e3a Future \u4e0d\u652f\u6301\u56de\u8c03\u51fd\u6570\uff0c\u6240\u4ee5\u65e0\u6cd5\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u652f\u6301\u94fe\u5f0f\u8c03\u7528"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e Future \u7684\u6267\u884c\u7ed3\u679c\uff0c\u6211\u4eec\u60f3\u7ee7\u7eed\u4f20\u5230\u4e0b\u4e00\u4e2a Future \u5904\u7406\u4f7f\u7528\uff0c\u4ece\u800c\u5f62\u6210\u4e00\u4e2a\u94fe\u5f0f\u7684 pipline \u8c03\u7528\uff0c\u8fd9\u5728 Future \u4e2d\u662f\u6ca1\u6cd5\u5b9e\u73b0\u7684"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u652f\u6301\u591a\u4e2a Future \u5408\u5e76"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6bd4\u5982\u6211\u4eec\u670910\u4e2aFuture \u5e76\u884c\u6267\u884c\uff0c\u6211\u4eec\u60f3\u5728\u6240\u6709\u7684 Future \u8fd0\u884c\u5b8c\u6bd5\u4e4b\u540e\uff0c \u6267\u884c\u67d0\u4e9b\u51fd\u6570\uff0c\u662f\u6ca1\u6cd5\u901a\u8fc7Future\u5b9e\u73b0\u7684"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"\u4e0d\u652f\u6301\u5f02\u5e38\u5904\u7406"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Future \u7684 API \u6ca1\u6709\u4efb\u4f55\u7684\u5f02\u5e38\u5904\u7406\u7684 api\uff0c\u6240\u4ee5\u5728\u5f02\u6b65\u8fd0\u884c\u65f6\uff0c\u5982\u679c\u51fa\u4e86\u95ee\u9898\u662f\u4e0d\u597d\u5b9a\u4f4d\u7684"))))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"CompletableFuture \u5e38\u89c1\u7684\u65b9\u6cd5"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5f02\u6b65\u65b9\u6cd5: ",(0,l.kt)("inlineCode",{parentName:"li"},"supplyAsync\u3001runAsync")),(0,l.kt)("li",{parentName:"ul"},"\u540c\u6b65\u65b9\u6cd5: ",(0,l.kt)("inlineCode",{parentName:"li"},"thenApply\u3001thenAccept\u3001thenAcceptBoth\u3001thenRun")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("mark",null,"CompletableFuture\u53ef\u4ee5\u6307\u5b9a\u5f02\u6b65\u5904\u7406\u6d41\u7a0b\uff1a"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"thenAccept()")," :\u5904\u7406\u6b63\u5e38\u7ed3\u679c\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"exceptional()")," :\u5904\u7406\u5f02\u5e38\u7ed3\u679c\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"thenApplyAsync()")," :\u7528\u4e8e\u4e32\u884c\u5316\u53e6\u4e00\u4e2a CompletableFuture"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"anyOf()")," \u548c ",(0,l.kt)("inlineCode",{parentName:"li"},"allOf()"),": \u7528\u4e8e\u5e76\u884c\u5316\u591a\u4e2a",(0,l.kt)("inlineCode",{parentName:"li"},"CompletableFuture")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"get()"),"\u65b9\u6cd5\u83b7\u53d6\u7ed3\u679c\uff0c\u4f46\u662f\u4f1a\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u3002"))),(0,l.kt)("h3",{id:"\u4ee3\u7801\u5b9e\u73b0-4"},"\u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("font",{color:"red"},"\u60f3\u8981\u83b7\u53d6\u7ed3\u679c\u4f7f\u7528get()\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CompletableFutureDemo1 {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        asyncMethod();\n    }\n    // \u540c\u6b65\u8c03\u7528\n    public static void awaitMethod() throws ExecutionException, InterruptedException {\n        CompletableFuture<Void> completableFuture = CompletableFuture.completedFuture("message").thenRun( () -> {\n            // \u4e00\u4e2a completableFuture \u662f\u4e00\u4e2a\u4efb\u52a1\n            try {\n                TimeUnit.SECONDS.sleep(3);\n                System.out.println(Thread.currentThread().getName() + "\\tawaitMethod...");\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        });\n        // \u5982\u679c\u6267\u884c\u6210\u529f\n        completableFuture.thenAccept((res) -> {\n            System.out.println(Thread.currentThread().getName() + "\\tsuccess...");\n        });\n        // \u5982\u679c\u6267\u884c\u5f02\u5e38:\n        completableFuture.exceptionally((ex) -> {\n            ex.printStackTrace();\n            return null;\n        });\n        System.out.println(Thread.currentThread().getName() + "\\t \u4e3b\u7ebf\u7a0b");\n    }\n    // \u5f02\u6b65\u8c03\u7528\n    public static void asyncMethod() throws ExecutionException, InterruptedException {\n        // supplyAsync: \u652f\u6301\u8fd4\u56de\u503c\u7684\u5f02\u6b65\n        // runAsync:  \u4e0d\u652f\u6301\u8fd4\u56de\u503c\n        CompletableFuture<Integer> completableFuture = CompletableFuture.supplyAsync(() -> {\n            try {\n                TimeUnit.SECONDS.sleep(3);\n                System.out.println(Thread.currentThread().getName() + "\\tasyncMethod...");\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            return 100;\n        });\n        completableFuture.thenAcceptAsync((result) -> {\n            System.out.println(Thread.currentThread().getName() + "\\t\u5904\u7406\u7ed3\u679c:"+result);\n        });\n        System.out.println(Thread.currentThread().getName() + "\\t \u4e3b\u7ebf\u7a0b,\u5b50\u7ebf\u7a0b\u7ed3\u679c\u4e3a:"+completableFuture.get());\n    }\n}\n\n')),(0,l.kt)("h4",{id:"\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1"},"\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CompletableFutureDemo2 {\n    // \u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ebf\u7a0b\u6c60\n    public static Executor getExecutor() {\n        int corePoolSize = Runtime.getRuntime().availableProcessors();\n        int maxPoolSize = corePoolSize * 2;\n        long aliveTime = 0L;\n        BlockingQueue queue = new LinkedBlockingQueue<>();\n        ThreadFactory threadFactory = Executors.defaultThreadFactory();\n        ThreadPoolExecutor executor = new ThreadPoolExecutor(corePoolSize,maxPoolSize, aliveTime, TimeUnit.SECONDS,queue, threadFactory);\n        return executor;\n    }\n    /**\n     * runAsync -> \u6ca1\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1\n     */\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5f00\u59cb\u6267\u884c");\n        CompletableFuture<Void> future = CompletableFuture.runAsync(() -> {\n            try {\n                TimeUnit.SECONDS.sleep(3);\n                System.out.println("\u5b50\u7ebf\u7a0b" +Thread.currentThread().getName() + "\\t\u5f00\u59cb\u6267\u884c..");\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }).thenAccept((res) -> {\n                System.out.println("\u5b50\u7ebf\u7a0b" +Thread.currentThread().getName() + "\\t\u6267\u884c\u7ed3\u675f..");\n        });\n        future.get();\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u7ed3\u675f");\n    }\n}\n\n')),(0,l.kt)("h4",{id:"\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1"},"\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CompletableFutureDemo3 {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5f00\u59cb\u6267\u884c");\n        CompletableFuture<String> future = CompletableFuture.supplyAsync(()-> {\n            try {\n                System.out.println(Thread.currentThread().getName()+"\u5b50\u7ebf\u7a0b\u5f00\u59cb\u4efb\u52a1");\n                Thread.sleep(5000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            return Thread.currentThread().getName()+ "\\t\u5904\u7406\u5b8c\u6210";\n        });\n        System.out.println("future\u5904\u7406\u7ed3\u679c\u4e3a===>" +future.get());\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u7ed3\u675f");\n    }\n}\n')),(0,l.kt)("h4",{id:"\u7ebf\u7a0b\u4f9d\u8d56"},"\u7ebf\u7a0b\u4f9d\u8d56"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u4f9d\u8d56\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 thenApply \u65b9\u6cd5\u6765\u628a\u8fd9\u4e24\u4e2a\u7ebf\u7a0b\u4e32\u884c\u5316\u3002")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CompletableFutureDemo4 {\n    // \u7ebf\u7a0b\u4f9d\u8d56,B\u7ebf\u7a0b\u4f9d\u8d56\u4e8eA\u7ebf\u7a0b\u7684\u7ed3\u679c\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5f00\u59cb\u6267\u884c");\n        CompletableFuture<Integer> future = CompletableFuture.supplyAsync(() -> {\n            try {\n                System.out.println(Thread.currentThread().getName()+"\u5b50\u7ebf\u7a0b\u5f00\u59cb\u4efb\u52a1");\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            return 200;\n        }).thenApplyAsync(res -> res * 2);\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5904\u7406\u7ed3\u675f,\u7ed3\u679c\u4e3a:"+future.get());\n    }\n}\n')),(0,l.kt)("h4",{id:"\u6d88\u8d39\u5904\u7406\u7ed3\u679c"},"\u6d88\u8d39\u5904\u7406\u7ed3\u679c"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"thenAccept \u6d88\u8d39\u5904\u7406\u7ed3\u679c, \u63a5\u6536\u4efb\u52a1\u7684\u5904\u7406\u7ed3\u679c\uff0c\u5e76\u6d88\u8d39\u5904\u7406\uff0c\u65e0\u8fd4\u56de\u7ed3\u679c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CompletableFutureDemo5 {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5f00\u59cb\u6267\u884c");\n        CompletableFuture.supplyAsync(() -> {\n            try {\n                System.out.println(Thread.currentThread().getName()+"\u5b50\u7ebf\u7a0b\u5f00\u59cb\u4efb\u52a1");\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            return 200;\n        }).thenAcceptAsync((res) -> {\n            System.out.println(Thread.currentThread().getName()+"\u5904\u7406\u5b8c\u6210,\u5904\u7406\u7ed3\u679c\u4e3a:"+res);\n        }).get();\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5904\u7406\u7ed3\u675f");\n    }\n}\n')),(0,l.kt)("h4",{id:"\u5f02\u5e38\u5904\u7406"},"\u5f02\u5e38\u5904\u7406"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CompletableFutureDemo6 {\n    // \u5f02\u5e38\u5904\u7406\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5f00\u59cb\u6267\u884c");\n        CompletableFuture.supplyAsync(() -> {\n            try {\n                System.out.println(Thread.currentThread().getName()+"\u5b50\u7ebf\u7a0b\u5f00\u59cb\u4efb\u52a1");\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            return 200 /0;\n        }).exceptionally(ex -> {\n            ex.printStackTrace();\n            return -1;\n        }).get();\n        System.out.println("\u7ebf\u7a0b:" +Thread.currentThread().getName() + "\\t\u5904\u7406\u7ed3\u675f");\n    }\n}\n\n')))}m.isMDXComponent=!0},37207:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210724144925760-7fe34eac707bafd1349b8ec7df73d716.png"},41310:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210724152503511-255a7e5397202522887938281b02a3df.png"},27579:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210724161217302-8d872d18e23fd9add8dfb8d6379fabe6.png"},96748:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210731101233024-d69efcb15bf0f820cdbb890b9a95a243.png"},25168:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210731221041398-43b4ca1135a417442d50c5e9ceb59c18.png"},73824:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210731221355839-d8afd29a6743df50a96107fafd5fc568.png"},87649:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210801133900901-be586dffb4eab530b68d28b8c2bcb58d.png"},78795:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210802160408451-68f672a15b702d36bf57afe35400d7f9.png"},97154:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210802171259944-501786ca529a0d65cf62a3081a098941.png"},52306:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210802211136738-25500e25d0b2b6f5fcdf7dd30051c954.png"},24490:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210803094323730-0ba6b4e55d2845ac97a2f576d15423c0.png"},20855:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210804141145037-81bca9c539fa2e26a96bf23bec1b5e29.png"},18618:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210804144234047-98b7a98bf34fbc7da9d1f1164da27fae.png"},54793:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210807234509332-d034cd3a71d2ffd9b9a37a7a92d70fc8.png"},44209:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210811203829185-2a96585cb6cd495f11dba53c7ed0fd79.png"},5425:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210811204054356-72f1db322acc2787e7a63571dd0f8b9e.png"},34117:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210817193230005-a98a8c8bade68666e937b1b78f6ca332.png"},22758:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210821142030163-3d6f7aac6f735269370aa34d5bdd87c4.png"},30634:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20210821172524774-bc54a6cf3e3abf619556edf062c429ce.png"},52650:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU0ODgzNQ==,size_16,color_FFFFFF,t_70-dce84546d9e204945b060485b220b222.png"}}]);